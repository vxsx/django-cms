cmsWebpackJsonp([1],{

/***/ 106:
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nexports.__esModule = true;\n\nvar _from = __webpack_require__(107);\n\nvar _from2 = _interopRequireDefault(_from);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nexports.default = function (arr) {\n  if (Array.isArray(arr)) {\n    for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) {\n      arr2[i] = arr[i];\n    }\n\n    return arr2;\n  } else {\n    return (0, _from2.default)(arr);\n  }\n};//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTA2LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vbm9kZV9tb2R1bGVzL2JhYmVsLXJ1bnRpbWUvaGVscGVycy90b0NvbnN1bWFibGVBcnJheS5qcz8xYWVlIl0sInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xuXG5leHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlO1xuXG52YXIgX2Zyb20gPSByZXF1aXJlKFwiLi4vY29yZS1qcy9hcnJheS9mcm9tXCIpO1xuXG52YXIgX2Zyb20yID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZnJvbSk7XG5cbmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9XG5cbmV4cG9ydHMuZGVmYXVsdCA9IGZ1bmN0aW9uIChhcnIpIHtcbiAgaWYgKEFycmF5LmlzQXJyYXkoYXJyKSkge1xuICAgIGZvciAodmFyIGkgPSAwLCBhcnIyID0gQXJyYXkoYXJyLmxlbmd0aCk7IGkgPCBhcnIubGVuZ3RoOyBpKyspIHtcbiAgICAgIGFycjJbaV0gPSBhcnJbaV07XG4gICAgfVxuXG4gICAgcmV0dXJuIGFycjI7XG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuICgwLCBfZnJvbTIuZGVmYXVsdCkoYXJyKTtcbiAgfVxufTtcblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL25vZGVfbW9kdWxlcy9iYWJlbC1ydW50aW1lL2hlbHBlcnMvdG9Db25zdW1hYmxlQXJyYXkuanNcbi8vIG1vZHVsZSBpZCA9IDEwNlxuLy8gbW9kdWxlIGNodW5rcyA9IDEgMyJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///106\n");

/***/ }),

/***/ 107:
/***/ (function(module, exports, __webpack_require__) {

eval("module.exports = { \"default\": __webpack_require__(108), __esModule: true };//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTA3LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vbm9kZV9tb2R1bGVzL2JhYmVsLXJ1bnRpbWUvY29yZS1qcy9hcnJheS9mcm9tLmpzPzczZjQiXSwic291cmNlc0NvbnRlbnQiOlsibW9kdWxlLmV4cG9ydHMgPSB7IFwiZGVmYXVsdFwiOiByZXF1aXJlKFwiY29yZS1qcy9saWJyYXJ5L2ZuL2FycmF5L2Zyb21cIiksIF9fZXNNb2R1bGU6IHRydWUgfTtcblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL25vZGVfbW9kdWxlcy9iYWJlbC1ydW50aW1lL2NvcmUtanMvYXJyYXkvZnJvbS5qc1xuLy8gbW9kdWxlIGlkID0gMTA3XG4vLyBtb2R1bGUgY2h1bmtzID0gMSAzIl0sIm1hcHBpbmdzIjoiQUFBQSIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///107\n");

/***/ }),

/***/ 108:
/***/ (function(module, exports, __webpack_require__) {

eval("__webpack_require__(19);\n__webpack_require__(109);\nmodule.exports = __webpack_require__(2).Array.from;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTA4LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbGlicmFyeS9mbi9hcnJheS9mcm9tLmpzP2U3MzciXSwic291cmNlc0NvbnRlbnQiOlsicmVxdWlyZSgnLi4vLi4vbW9kdWxlcy9lczYuc3RyaW5nLml0ZXJhdG9yJyk7XG5yZXF1aXJlKCcuLi8uLi9tb2R1bGVzL2VzNi5hcnJheS5mcm9tJyk7XG5tb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoJy4uLy4uL21vZHVsZXMvX2NvcmUnKS5BcnJheS5mcm9tO1xuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9ub2RlX21vZHVsZXMvY29yZS1qcy9saWJyYXJ5L2ZuL2FycmF5L2Zyb20uanNcbi8vIG1vZHVsZSBpZCA9IDEwOFxuLy8gbW9kdWxlIGNodW5rcyA9IDEgMyJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///108\n");

/***/ }),

/***/ 109:
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\nvar ctx = __webpack_require__(18);\nvar $export = __webpack_require__(7);\nvar toObject = __webpack_require__(38);\nvar call = __webpack_require__(72);\nvar isArrayIter = __webpack_require__(73);\nvar toLength = __webpack_require__(39);\nvar createProperty = __webpack_require__(110);\nvar getIterFn = __webpack_require__(46);\n\n$export($export.S + $export.F * !__webpack_require__(76)(function (iter) { Array.from(iter); }), 'Array', {\n  // 22.1.2.1 Array.from(arrayLike, mapfn = undefined, thisArg = undefined)\n  from: function from(arrayLike /* , mapfn = undefined, thisArg = undefined */) {\n    var O = toObject(arrayLike);\n    var C = typeof this == 'function' ? this : Array;\n    var aLen = arguments.length;\n    var mapfn = aLen > 1 ? arguments[1] : undefined;\n    var mapping = mapfn !== undefined;\n    var index = 0;\n    var iterFn = getIterFn(O);\n    var length, result, step, iterator;\n    if (mapping) mapfn = ctx(mapfn, aLen > 2 ? arguments[2] : undefined, 2);\n    // if object isn't iterable or it's array with default iterator - use simple case\n    if (iterFn != undefined && !(C == Array && isArrayIter(iterFn))) {\n      for (iterator = iterFn.call(O), result = new C(); !(step = iterator.next()).done; index++) {\n        createProperty(result, index, mapping ? call(iterator, mapfn, [step.value, index], true) : step.value);\n      }\n    } else {\n      length = toLength(O.length);\n      for (result = new C(length); length > index; index++) {\n        createProperty(result, index, mapping ? mapfn(O[index], index) : O[index]);\n      }\n    }\n    result.length = index;\n    return result;\n  }\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTA5LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL2VzNi5hcnJheS5mcm9tLmpzP2FiMjIiXSwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xudmFyIGN0eCA9IHJlcXVpcmUoJy4vX2N0eCcpO1xudmFyICRleHBvcnQgPSByZXF1aXJlKCcuL19leHBvcnQnKTtcbnZhciB0b09iamVjdCA9IHJlcXVpcmUoJy4vX3RvLW9iamVjdCcpO1xudmFyIGNhbGwgPSByZXF1aXJlKCcuL19pdGVyLWNhbGwnKTtcbnZhciBpc0FycmF5SXRlciA9IHJlcXVpcmUoJy4vX2lzLWFycmF5LWl0ZXInKTtcbnZhciB0b0xlbmd0aCA9IHJlcXVpcmUoJy4vX3RvLWxlbmd0aCcpO1xudmFyIGNyZWF0ZVByb3BlcnR5ID0gcmVxdWlyZSgnLi9fY3JlYXRlLXByb3BlcnR5Jyk7XG52YXIgZ2V0SXRlckZuID0gcmVxdWlyZSgnLi9jb3JlLmdldC1pdGVyYXRvci1tZXRob2QnKTtcblxuJGV4cG9ydCgkZXhwb3J0LlMgKyAkZXhwb3J0LkYgKiAhcmVxdWlyZSgnLi9faXRlci1kZXRlY3QnKShmdW5jdGlvbiAoaXRlcikgeyBBcnJheS5mcm9tKGl0ZXIpOyB9KSwgJ0FycmF5Jywge1xuICAvLyAyMi4xLjIuMSBBcnJheS5mcm9tKGFycmF5TGlrZSwgbWFwZm4gPSB1bmRlZmluZWQsIHRoaXNBcmcgPSB1bmRlZmluZWQpXG4gIGZyb206IGZ1bmN0aW9uIGZyb20oYXJyYXlMaWtlIC8qICwgbWFwZm4gPSB1bmRlZmluZWQsIHRoaXNBcmcgPSB1bmRlZmluZWQgKi8pIHtcbiAgICB2YXIgTyA9IHRvT2JqZWN0KGFycmF5TGlrZSk7XG4gICAgdmFyIEMgPSB0eXBlb2YgdGhpcyA9PSAnZnVuY3Rpb24nID8gdGhpcyA6IEFycmF5O1xuICAgIHZhciBhTGVuID0gYXJndW1lbnRzLmxlbmd0aDtcbiAgICB2YXIgbWFwZm4gPSBhTGVuID4gMSA/IGFyZ3VtZW50c1sxXSA6IHVuZGVmaW5lZDtcbiAgICB2YXIgbWFwcGluZyA9IG1hcGZuICE9PSB1bmRlZmluZWQ7XG4gICAgdmFyIGluZGV4ID0gMDtcbiAgICB2YXIgaXRlckZuID0gZ2V0SXRlckZuKE8pO1xuICAgIHZhciBsZW5ndGgsIHJlc3VsdCwgc3RlcCwgaXRlcmF0b3I7XG4gICAgaWYgKG1hcHBpbmcpIG1hcGZuID0gY3R4KG1hcGZuLCBhTGVuID4gMiA/IGFyZ3VtZW50c1syXSA6IHVuZGVmaW5lZCwgMik7XG4gICAgLy8gaWYgb2JqZWN0IGlzbid0IGl0ZXJhYmxlIG9yIGl0J3MgYXJyYXkgd2l0aCBkZWZhdWx0IGl0ZXJhdG9yIC0gdXNlIHNpbXBsZSBjYXNlXG4gICAgaWYgKGl0ZXJGbiAhPSB1bmRlZmluZWQgJiYgIShDID09IEFycmF5ICYmIGlzQXJyYXlJdGVyKGl0ZXJGbikpKSB7XG4gICAgICBmb3IgKGl0ZXJhdG9yID0gaXRlckZuLmNhbGwoTyksIHJlc3VsdCA9IG5ldyBDKCk7ICEoc3RlcCA9IGl0ZXJhdG9yLm5leHQoKSkuZG9uZTsgaW5kZXgrKykge1xuICAgICAgICBjcmVhdGVQcm9wZXJ0eShyZXN1bHQsIGluZGV4LCBtYXBwaW5nID8gY2FsbChpdGVyYXRvciwgbWFwZm4sIFtzdGVwLnZhbHVlLCBpbmRleF0sIHRydWUpIDogc3RlcC52YWx1ZSk7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIGxlbmd0aCA9IHRvTGVuZ3RoKE8ubGVuZ3RoKTtcbiAgICAgIGZvciAocmVzdWx0ID0gbmV3IEMobGVuZ3RoKTsgbGVuZ3RoID4gaW5kZXg7IGluZGV4KyspIHtcbiAgICAgICAgY3JlYXRlUHJvcGVydHkocmVzdWx0LCBpbmRleCwgbWFwcGluZyA/IG1hcGZuKE9baW5kZXhdLCBpbmRleCkgOiBPW2luZGV4XSk7XG4gICAgICB9XG4gICAgfVxuICAgIHJlc3VsdC5sZW5ndGggPSBpbmRleDtcbiAgICByZXR1cm4gcmVzdWx0O1xuICB9XG59KTtcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL2VzNi5hcnJheS5mcm9tLmpzXG4vLyBtb2R1bGUgaWQgPSAxMDlcbi8vIG1vZHVsZSBjaHVua3MgPSAxIDMiXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///109\n");

/***/ }),

/***/ 110:
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\nvar $defineProperty = __webpack_require__(4);\nvar createDesc = __webpack_require__(17);\n\nmodule.exports = function (object, index, value) {\n  if (index in object) $defineProperty.f(object, index, createDesc(0, value));\n  else object[index] = value;\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTEwLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL19jcmVhdGUtcHJvcGVydHkuanM/N2MxNCJdLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCc7XG52YXIgJGRlZmluZVByb3BlcnR5ID0gcmVxdWlyZSgnLi9fb2JqZWN0LWRwJyk7XG52YXIgY3JlYXRlRGVzYyA9IHJlcXVpcmUoJy4vX3Byb3BlcnR5LWRlc2MnKTtcblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAob2JqZWN0LCBpbmRleCwgdmFsdWUpIHtcbiAgaWYgKGluZGV4IGluIG9iamVjdCkgJGRlZmluZVByb3BlcnR5LmYob2JqZWN0LCBpbmRleCwgY3JlYXRlRGVzYygwLCB2YWx1ZSkpO1xuICBlbHNlIG9iamVjdFtpbmRleF0gPSB2YWx1ZTtcbn07XG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL25vZGVfbW9kdWxlcy9jb3JlLWpzL2xpYnJhcnkvbW9kdWxlcy9fY3JlYXRlLXByb3BlcnR5LmpzXG4vLyBtb2R1bGUgaWQgPSAxMTBcbi8vIG1vZHVsZSBjaHVua3MgPSAxIDMiXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///110\n");

/***/ }),

/***/ 130:
/***/ (function(module, exports, __webpack_require__) {

eval("var __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;/*!\n * THIS FILE HAS BEEN MANUALLY PATCHED TO ALLOW COPYING INTO SELF/CHILDREN\n * https://github.com/FinalAngel/jstree\n */\n/*! jsTree - v3.3.0 - 2016-04-25 - (MIT) */\n!function(a){\"use strict\"; true?!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(0)], __WEBPACK_AMD_DEFINE_FACTORY__ = (a),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ?\n\t\t\t\t(__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__)):\"undefined\"!=typeof module&&module.exports?module.exports=a(require(\"jquery\")):a(jQuery)}(function(a,b){\"use strict\";if(!a.jstree){var c=0,d=!1,e=!1,f=!1,g=[],h=a(\"script:last\").attr(\"src\"),i=window.document,j=i.createElement(\"LI\"),k,l;j.setAttribute(\"role\",\"treeitem\"),k=i.createElement(\"I\"),k.className=\"jstree-icon jstree-ocl\",k.setAttribute(\"role\",\"presentation\"),j.appendChild(k),k=i.createElement(\"A\"),k.className=\"jstree-anchor\",k.setAttribute(\"href\",\"#\"),k.setAttribute(\"tabindex\",\"-1\"),l=i.createElement(\"I\"),l.className=\"jstree-icon jstree-themeicon\",l.setAttribute(\"role\",\"presentation\"),k.appendChild(l),j.appendChild(k),k=l=null,a.jstree={version:\"{{VERSION}}\",defaults:{plugins:[]},plugins:{},path:h&&-1!==h.indexOf(\"/\")?h.replace(/\\/[^\\/]+$/,\"\"):\"\",idregex:/[\\\\:&!^|()\\[\\]<>@*'+~#\";.,=\\- \\/${}%?`]/g,root:\"#\"},a.jstree.create=function(b,d){var e=new a.jstree.core(++c),f=d;return d=a.extend(!0,{},a.jstree.defaults,d),f&&f.plugins&&(d.plugins=f.plugins),a.each(d.plugins,function(a,b){\"core\"!==a&&(e=e.plugin(b,d[b]))}),a(b).data(\"jstree\",e),e.init(b,d),e},a.jstree.destroy=function(){a(\".jstree:jstree\").jstree(\"destroy\"),a(i).off(\".jstree\")},a.jstree.core=function(a){this._id=a,this._cnt=0,this._wrk=null,this._data={core:{themes:{name:!1,dots:!1,icons:!1},selected:[],last_error:{},working:!1,worker_queue:[],focused:null}}},a.jstree.reference=function(b){var c=null,d=null;if(!b||!b.id||b.tagName&&b.nodeType||(b=b.id),!d||!d.length)try{d=a(b)}catch(e){}if(!d||!d.length)try{d=a(\"#\"+b.replace(a.jstree.idregex,\"\\\\$&\"))}catch(e){}return d&&d.length&&(d=d.closest(\".jstree\")).length&&(d=d.data(\"jstree\"))?c=d:a(\".jstree\").each(function(){var d=a(this).data(\"jstree\");return d&&d._model.data[b]?(c=d,!1):void 0}),c},a.fn.jstree=function(c){var d=\"string\"==typeof c,e=Array.prototype.slice.call(arguments,1),f=null;return c!==!0||this.length?(this.each(function(){var g=a.jstree.reference(this),h=d&&g?g[c]:null;return f=d&&h?h.apply(g,e):null,g||d||c!==b&&!a.isPlainObject(c)||a.jstree.create(this,c),(g&&!d||c===!0)&&(f=g||!1),null!==f&&f!==b?!1:void 0}),null!==f&&f!==b?f:this):!1},a.expr[\":\"].jstree=a.expr.createPseudo(function(c){return function(c){return a(c).hasClass(\"jstree\")&&a(c).data(\"jstree\")!==b}}),a.jstree.defaults.core={data:!1,strings:!1,check_callback:!1,error:a.noop,animation:200,multiple:!0,themes:{name:!1,url:!1,dir:!1,dots:!0,icons:!0,stripes:!1,variant:!1,responsive:!1},expand_selected_onload:!0,worker:!0,force_text:!1,dblclick_toggle:!0},a.jstree.core.prototype={plugin:function(b,c){var d=a.jstree.plugins[b];return d?(this._data[b]={},d.prototype=this,new d(c,this)):this},init:function(b,c){this._model={data:{},changed:[],force_full_redraw:!1,redraw_timeout:!1,default_state:{loaded:!0,opened:!1,selected:!1,disabled:!1}},this._model.data[a.jstree.root]={id:a.jstree.root,parent:null,parents:[],children:[],children_d:[],state:{loaded:!1}},this.element=a(b).addClass(\"jstree jstree-\"+this._id),this.settings=c,this._data.core.ready=!1,this._data.core.loaded=!1,this._data.core.rtl=\"rtl\"===this.element.css(\"direction\"),this.element[this._data.core.rtl?\"addClass\":\"removeClass\"](\"jstree-rtl\"),this.element.attr(\"role\",\"tree\"),this.settings.core.multiple&&this.element.attr(\"aria-multiselectable\",!0),this.element.attr(\"tabindex\")||this.element.attr(\"tabindex\",\"0\"),this.bind(),this.trigger(\"init\"),this._data.core.original_container_html=this.element.find(\" > ul > li\").clone(!0),this._data.core.original_container_html.find(\"li\").addBack().contents().filter(function(){return 3===this.nodeType&&(!this.nodeValue||/^\\s+$/.test(this.nodeValue))}).remove(),this.element.html(\"<ul class='jstree-container-ul jstree-children' role='group'><li id='j\"+this._id+\"_loading' class='jstree-initial-node jstree-loading jstree-leaf jstree-last' role='tree-item'><i class='jstree-icon jstree-ocl'></i><a class='jstree-anchor' href='#'><i class='jstree-icon jstree-themeicon-hidden'></i>\"+this.get_string(\"Loading ...\")+\"</a></li></ul>\"),this.element.attr(\"aria-activedescendant\",\"j\"+this._id+\"_loading\"),this._data.core.li_height=this.get_container_ul().children(\"li\").first().height()||24,this.trigger(\"loading\"),this.load_node(a.jstree.root)},destroy:function(a){if(this._wrk)try{window.URL.revokeObjectURL(this._wrk),this._wrk=null}catch(b){}a||this.element.empty(),this.teardown()},teardown:function(){this.unbind(),this.element.removeClass(\"jstree\").removeData(\"jstree\").find(\"[class^='jstree']\").addBack().attr(\"class\",function(){return this.className.replace(/jstree[^ ]*|$/gi,\"\")}),this.element=null},bind:function(){var b=\"\",c=null,d=0;this.element.on(\"dblclick.jstree\",function(a){if(a.target.tagName&&\"input\"===a.target.tagName.toLowerCase())return!0;if(i.selection&&i.selection.empty)i.selection.empty();else if(window.getSelection){var b=window.getSelection();try{b.removeAllRanges(),b.collapse()}catch(c){}}}).on(\"mousedown.jstree\",a.proxy(function(a){a.target===this.element[0]&&(a.preventDefault(),d=+new Date)},this)).on(\"mousedown.jstree\",\".jstree-ocl\",function(a){a.preventDefault()}).on(\"click.jstree\",\".jstree-ocl\",a.proxy(function(a){this.toggle_node(a.target)},this)).on(\"dblclick.jstree\",\".jstree-anchor\",a.proxy(function(a){return a.target.tagName&&\"input\"===a.target.tagName.toLowerCase()?!0:void(this.settings.core.dblclick_toggle&&this.toggle_node(a.target))},this)).on(\"click.jstree\",\".jstree-anchor\",a.proxy(function(b){b.preventDefault(),b.currentTarget!==i.activeElement&&a(b.currentTarget).focus(),this.activate_node(b.currentTarget,b)},this)).on(\"keydown.jstree\",\".jstree-anchor\",a.proxy(function(b){if(b.target.tagName&&\"input\"===b.target.tagName.toLowerCase())return!0;if(32!==b.which&&13!==b.which&&(b.shiftKey||b.ctrlKey||b.altKey||b.metaKey))return!0;var c=null;switch(this._data.core.rtl&&(37===b.which?b.which=39:39===b.which&&(b.which=37)),b.which){case 32:b.ctrlKey&&(b.type=\"click\",a(b.currentTarget).trigger(b));break;case 13:b.type=\"click\",a(b.currentTarget).trigger(b);break;case 37:b.preventDefault(),this.is_open(b.currentTarget)?this.close_node(b.currentTarget):(c=this.get_parent(b.currentTarget),c&&c.id!==a.jstree.root&&this.get_node(c,!0).children(\".jstree-anchor\").focus());break;case 38:b.preventDefault(),c=this.get_prev_dom(b.currentTarget),c&&c.length&&c.children(\".jstree-anchor\").focus();break;case 39:b.preventDefault(),this.is_closed(b.currentTarget)?this.open_node(b.currentTarget,function(a){this.get_node(a,!0).children(\".jstree-anchor\").focus()}):this.is_open(b.currentTarget)&&(c=this.get_node(b.currentTarget,!0).children(\".jstree-children\")[0],c&&a(this._firstChild(c)).children(\".jstree-anchor\").focus());break;case 40:b.preventDefault(),c=this.get_next_dom(b.currentTarget),c&&c.length&&c.children(\".jstree-anchor\").focus();break;case 106:this.open_all();break;case 36:b.preventDefault(),c=this._firstChild(this.get_container_ul()[0]),c&&a(c).children(\".jstree-anchor\").filter(\":visible\").focus();break;case 35:b.preventDefault(),this.element.find(\".jstree-anchor\").filter(\":visible\").last().focus();break;case 113:b.preventDefault(),this.edit(b.currentTarget)}},this)).on(\"load_node.jstree\",a.proxy(function(b,c){c.status&&(c.node.id!==a.jstree.root||this._data.core.loaded||(this._data.core.loaded=!0,this._firstChild(this.get_container_ul()[0])&&this.element.attr(\"aria-activedescendant\",this._firstChild(this.get_container_ul()[0]).id),this.trigger(\"loaded\")),this._data.core.ready||setTimeout(a.proxy(function(){if(this.element&&!this.get_container_ul().find(\".jstree-loading\").length){if(this._data.core.ready=!0,this._data.core.selected.length){if(this.settings.core.expand_selected_onload){var b=[],c,d;for(c=0,d=this._data.core.selected.length;d>c;c++)b=b.concat(this._model.data[this._data.core.selected[c]].parents);for(b=a.vakata.array_unique(b),c=0,d=b.length;d>c;c++)this.open_node(b[c],!1,0)}this.trigger(\"changed\",{action:\"ready\",selected:this._data.core.selected})}this.trigger(\"ready\")}},this),0))},this)).on(\"keypress.jstree\",a.proxy(function(d){if(d.target.tagName&&\"input\"===d.target.tagName.toLowerCase())return!0;c&&clearTimeout(c),c=setTimeout(function(){b=\"\"},500);var e=String.fromCharCode(d.which).toLowerCase(),f=this.element.find(\".jstree-anchor\").filter(\":visible\"),g=f.index(i.activeElement)||0,h=!1;if(b+=e,b.length>1){if(f.slice(g).each(a.proxy(function(c,d){return 0===a(d).text().toLowerCase().indexOf(b)?(a(d).focus(),h=!0,!1):void 0},this)),h)return;if(f.slice(0,g).each(a.proxy(function(c,d){return 0===a(d).text().toLowerCase().indexOf(b)?(a(d).focus(),h=!0,!1):void 0},this)),h)return}if(new RegExp(\"^\"+e.replace(/[-\\/\\\\^$*+?.()|[\\]{}]/g,\"\\\\$&\")+\"+$\").test(b)){if(f.slice(g+1).each(a.proxy(function(b,c){return a(c).text().toLowerCase().charAt(0)===e?(a(c).focus(),h=!0,!1):void 0},this)),h)return;if(f.slice(0,g+1).each(a.proxy(function(b,c){return a(c).text().toLowerCase().charAt(0)===e?(a(c).focus(),h=!0,!1):void 0},this)),h)return}},this)).on(\"init.jstree\",a.proxy(function(){var a=this.settings.core.themes;this._data.core.themes.dots=a.dots,this._data.core.themes.stripes=a.stripes,this._data.core.themes.icons=a.icons,this.set_theme(a.name||\"default\",a.url),this.set_theme_variant(a.variant)},this)).on(\"loading.jstree\",a.proxy(function(){this[this._data.core.themes.dots?\"show_dots\":\"hide_dots\"](),this[this._data.core.themes.icons?\"show_icons\":\"hide_icons\"](),this[this._data.core.themes.stripes?\"show_stripes\":\"hide_stripes\"]()},this)).on(\"blur.jstree\",\".jstree-anchor\",a.proxy(function(b){this._data.core.focused=null,a(b.currentTarget).filter(\".jstree-hovered\").mouseleave(),this.element.attr(\"tabindex\",\"0\")},this)).on(\"focus.jstree\",\".jstree-anchor\",a.proxy(function(b){var c=this.get_node(b.currentTarget);c&&c.id&&(this._data.core.focused=c.id),this.element.find(\".jstree-hovered\").not(b.currentTarget).mouseleave(),a(b.currentTarget).mouseenter(),this.element.attr(\"tabindex\",\"-1\")},this)).on(\"focus.jstree\",a.proxy(function(){if(+new Date-d>500&&!this._data.core.focused){d=0;var a=this.get_node(this.element.attr(\"aria-activedescendant\"),!0);a&&a.find(\"> .jstree-anchor\").focus()}},this)).on(\"mouseenter.jstree\",\".jstree-anchor\",a.proxy(function(a){this.hover_node(a.currentTarget)},this)).on(\"mouseleave.jstree\",\".jstree-anchor\",a.proxy(function(a){this.dehover_node(a.currentTarget)},this))},unbind:function(){this.element.off(\".jstree\"),a(i).off(\".jstree-\"+this._id)},trigger:function(a,b){b||(b={}),b.instance=this,this.element.triggerHandler(a.replace(\".jstree\",\"\")+\".jstree\",b)},get_container:function(){return this.element},get_container_ul:function(){return this.element.children(\".jstree-children\").first()},get_string:function(b){var c=this.settings.core.strings;return a.isFunction(c)?c.call(this,b):c&&c[b]?c[b]:b},_firstChild:function(a){a=a?a.firstChild:null;while(null!==a&&1!==a.nodeType)a=a.nextSibling;return a},_nextSibling:function(a){a=a?a.nextSibling:null;while(null!==a&&1!==a.nodeType)a=a.nextSibling;return a},_previousSibling:function(a){a=a?a.previousSibling:null;while(null!==a&&1!==a.nodeType)a=a.previousSibling;return a},get_node:function(b,c){b&&b.id&&(b=b.id);var d;try{if(this._model.data[b])b=this._model.data[b];else if(\"string\"==typeof b&&this._model.data[b.replace(/^#/,\"\")])b=this._model.data[b.replace(/^#/,\"\")];else if(\"string\"==typeof b&&(d=a(\"#\"+b.replace(a.jstree.idregex,\"\\\\$&\"),this.element)).length&&this._model.data[d.closest(\".jstree-node\").attr(\"id\")])b=this._model.data[d.closest(\".jstree-node\").attr(\"id\")];else if((d=a(b,this.element)).length&&this._model.data[d.closest(\".jstree-node\").attr(\"id\")])b=this._model.data[d.closest(\".jstree-node\").attr(\"id\")];else{if(!(d=a(b,this.element)).length||!d.hasClass(\"jstree\"))return!1;b=this._model.data[a.jstree.root]}return c&&(b=b.id===a.jstree.root?this.element:a(\"#\"+b.id.replace(a.jstree.idregex,\"\\\\$&\"),this.element)),b}catch(e){return!1}},get_path:function(b,c,d){if(b=b.parents?b:this.get_node(b),!b||b.id===a.jstree.root||!b.parents)return!1;var e,f,g=[];for(g.push(d?b.id:b.text),e=0,f=b.parents.length;f>e;e++)g.push(d?b.parents[e]:this.get_text(b.parents[e]));return g=g.reverse().slice(1),c?g.join(c):g},get_next_dom:function(b,c){var d;if(b=this.get_node(b,!0),b[0]===this.element[0]){d=this._firstChild(this.get_container_ul()[0]);while(d&&0===d.offsetHeight)d=this._nextSibling(d);return d?a(d):!1}if(!b||!b.length)return!1;if(c){d=b[0];do d=this._nextSibling(d);while(d&&0===d.offsetHeight);return d?a(d):!1}if(b.hasClass(\"jstree-open\")){d=this._firstChild(b.children(\".jstree-children\")[0]);while(d&&0===d.offsetHeight)d=this._nextSibling(d);if(null!==d)return a(d)}d=b[0];do d=this._nextSibling(d);while(d&&0===d.offsetHeight);return null!==d?a(d):b.parentsUntil(\".jstree\",\".jstree-node\").nextAll(\".jstree-node:visible\").first()},get_prev_dom:function(b,c){var d;if(b=this.get_node(b,!0),b[0]===this.element[0]){d=this.get_container_ul()[0].lastChild;while(d&&0===d.offsetHeight)d=this._previousSibling(d);return d?a(d):!1}if(!b||!b.length)return!1;if(c){d=b[0];do d=this._previousSibling(d);while(d&&0===d.offsetHeight);return d?a(d):!1}d=b[0];do d=this._previousSibling(d);while(d&&0===d.offsetHeight);if(null!==d){b=a(d);while(b.hasClass(\"jstree-open\"))b=b.children(\".jstree-children\").first().children(\".jstree-node:visible:last\");return b}return d=b[0].parentNode.parentNode,d&&d.className&&-1!==d.className.indexOf(\"jstree-node\")?a(d):!1},get_parent:function(b){return b=this.get_node(b),b&&b.id!==a.jstree.root?b.parent:!1},get_children_dom:function(a){return a=this.get_node(a,!0),a[0]===this.element[0]?this.get_container_ul().children(\".jstree-node\"):a&&a.length?a.children(\".jstree-children\").children(\".jstree-node\"):!1},is_parent:function(a){return a=this.get_node(a),a&&(a.state.loaded===!1||a.children.length>0)},is_loaded:function(a){return a=this.get_node(a),a&&a.state.loaded},is_loading:function(a){return a=this.get_node(a),a&&a.state&&a.state.loading},is_open:function(a){return a=this.get_node(a),a&&a.state.opened},is_closed:function(a){return a=this.get_node(a),a&&this.is_parent(a)&&!a.state.opened},is_leaf:function(a){return!this.is_parent(a)},load_node:function(b,c){var d,e,f,g,h;if(a.isArray(b))return this._load_nodes(b.slice(),c),!0;if(b=this.get_node(b),!b)return c&&c.call(this,b,!1),!1;if(b.state.loaded){for(b.state.loaded=!1,f=0,g=b.parents.length;g>f;f++)this._model.data[b.parents[f]].children_d=a.vakata.array_filter(this._model.data[b.parents[f]].children_d,function(c){return-1===a.inArray(c,b.children_d)});for(d=0,e=b.children_d.length;e>d;d++)this._model.data[b.children_d[d]].state.selected&&(h=!0),delete this._model.data[b.children_d[d]];h&&(this._data.core.selected=a.vakata.array_filter(this._data.core.selected,function(c){return-1===a.inArray(c,b.children_d)})),b.children=[],b.children_d=[],h&&this.trigger(\"changed\",{action:\"load_node\",node:b,selected:this._data.core.selected})}return b.state.failed=!1,b.state.loading=!0,this.get_node(b,!0).addClass(\"jstree-loading\").attr(\"aria-busy\",!0),this._load_node(b,a.proxy(function(a){b=this._model.data[b.id],b.state.loading=!1,b.state.loaded=a,b.state.failed=!b.state.loaded;var d=this.get_node(b,!0),e=0,f=0,g=this._model.data,h=!1;for(e=0,f=b.children.length;f>e;e++)if(g[b.children[e]]&&!g[b.children[e]].state.hidden){h=!0;break}b.state.loaded&&d&&d.length&&(d.removeClass(\"jstree-closed jstree-open jstree-leaf\"),h?\"#\"!==b.id&&d.addClass(b.state.opened?\"jstree-open\":\"jstree-closed\"):d.addClass(\"jstree-leaf\")),d.removeClass(\"jstree-loading\").attr(\"aria-busy\",!1),this.trigger(\"load_node\",{node:b,status:a}),c&&c.call(this,b,a)},this)),!0},_load_nodes:function(a,b,c,d){var e=!0,f=function(){this._load_nodes(a,b,!0)},g=this._model.data,h,i,j=[];for(h=0,i=a.length;i>h;h++)g[a[h]]&&(!g[a[h]].state.loaded&&!g[a[h]].state.failed||!c&&d)&&(this.is_loading(a[h])||this.load_node(a[h],f),e=!1);if(e){for(h=0,i=a.length;i>h;h++)g[a[h]]&&g[a[h]].state.loaded&&j.push(a[h]);b&&!b.done&&(b.call(this,j),b.done=!0)}},load_all:function(b,c){if(b||(b=a.jstree.root),b=this.get_node(b),!b)return!1;var d=[],e=this._model.data,f=e[b.id].children_d,g,h;for(b.state&&!b.state.loaded&&d.push(b.id),g=0,h=f.length;h>g;g++)e[f[g]]&&e[f[g]].state&&!e[f[g]].state.loaded&&d.push(f[g]);d.length?this._load_nodes(d,function(){this.load_all(b,c)}):(c&&c.call(this,b),this.trigger(\"load_all\",{node:b}))},_load_node:function(b,c){var d=this.settings.core.data,e;return d?a.isFunction(d)?d.call(this,b,a.proxy(function(d){d===!1?c.call(this,!1):this[\"string\"==typeof d?\"_append_html_data\":\"_append_json_data\"](b,\"string\"==typeof d?a(a.parseHTML(d)).filter(function(){return 3!==this.nodeType}):d,function(a){c.call(this,a)})},this)):\"object\"==typeof d?d.url?(d=a.extend(!0,{},d),a.isFunction(d.url)&&(d.url=d.url.call(this,b)),a.isFunction(d.data)&&(d.data=d.data.call(this,b)),a.ajax(d).done(a.proxy(function(d,e,f){var g=f.getResponseHeader(\"Content-Type\");return g&&-1!==g.indexOf(\"json\")||\"object\"==typeof d?this._append_json_data(b,d,function(a){c.call(this,a)}):g&&-1!==g.indexOf(\"html\")||\"string\"==typeof d?this._append_html_data(b,a(a.parseHTML(d)).filter(function(){return 3!==this.nodeType}),function(a){c.call(this,a)}):(this._data.core.last_error={error:\"ajax\",plugin:\"core\",id:\"core_04\",reason:\"Could not load node\",data:JSON.stringify({id:b.id,xhr:f})},this.settings.core.error.call(this,this._data.core.last_error),c.call(this,!1))},this)).fail(a.proxy(function(a){c.call(this,!1),this._data.core.last_error={error:\"ajax\",plugin:\"core\",id:\"core_04\",reason:\"Could not load node\",data:JSON.stringify({id:b.id,xhr:a})},this.settings.core.error.call(this,this._data.core.last_error)},this))):(e=a.isArray(d)||a.isPlainObject(d)?JSON.parse(JSON.stringify(d)):d,b.id===a.jstree.root?this._append_json_data(b,e,function(a){c.call(this,a)}):(this._data.core.last_error={error:\"nodata\",plugin:\"core\",id:\"core_05\",reason:\"Could not load node\",data:JSON.stringify({id:b.id})},this.settings.core.error.call(this,this._data.core.last_error),c.call(this,!1))):\"string\"==typeof d?b.id===a.jstree.root?this._append_html_data(b,a(a.parseHTML(d)).filter(function(){return 3!==this.nodeType}),function(a){c.call(this,a)}):(this._data.core.last_error={error:\"nodata\",plugin:\"core\",id:\"core_06\",reason:\"Could not load node\",data:JSON.stringify({id:b.id})},this.settings.core.error.call(this,this._data.core.last_error),c.call(this,!1)):c.call(this,!1):b.id===a.jstree.root?this._append_html_data(b,this._data.core.original_container_html.clone(!0),function(a){c.call(this,a)}):c.call(this,!1)},_node_changed:function(a){a=this.get_node(a),a&&this._model.changed.push(a.id)},_append_html_data:function(b,c,d){b=this.get_node(b),b.children=[],b.children_d=[];var e=c.is(\"ul\")?c.children():c,f=b.id,g=[],h=[],i=this._model.data,j=i[f],k=this._data.core.selected.length,l,m,n;for(e.each(a.proxy(function(b,c){l=this._parse_model_from_html(a(c),f,j.parents.concat()),l&&(g.push(l),h.push(l),i[l].children_d.length&&(h=h.concat(i[l].children_d)))},this)),j.children=g,j.children_d=h,m=0,n=j.parents.length;n>m;m++)i[j.parents[m]].children_d=i[j.parents[m]].children_d.concat(h);this.trigger(\"model\",{nodes:h,parent:f}),f!==a.jstree.root?(this._node_changed(f),this.redraw()):(this.get_container_ul().children(\".jstree-initial-node\").remove(),this.redraw(!0)),this._data.core.selected.length!==k&&this.trigger(\"changed\",{action:\"model\",selected:this._data.core.selected}),d.call(this,!0)},_append_json_data:function(b,c,d,e){if(null!==this.element){b=this.get_node(b),b.children=[],b.children_d=[],c.d&&(c=c.d,\"string\"==typeof c&&(c=JSON.parse(c))),a.isArray(c)||(c=[c]);var f=null,g={df:this._model.default_state,dat:c,par:b.id,m:this._model.data,t_id:this._id,t_cnt:this._cnt,sel:this._data.core.selected},h=function(a,b){a.data&&(a=a.data);var c=a.dat,d=a.par,e=[],f=[],g=[],h=a.df,i=a.t_id,j=a.t_cnt,k=a.m,l=k[d],m=a.sel,n,o,p,q,r=function(a,c,d){d=d?d.concat():[],c&&d.unshift(c);var e=a.id.toString(),f,i,j,l,m={id:e,text:a.text||\"\",icon:a.icon!==b?a.icon:!0,parent:c,parents:d,children:a.children||[],children_d:a.children_d||[],data:a.data,state:{},li_attr:{id:!1},a_attr:{href:\"#\"},original:!1};for(f in h)h.hasOwnProperty(f)&&(m.state[f]=h[f]);if(a&&a.data&&a.data.jstree&&a.data.jstree.icon&&(m.icon=a.data.jstree.icon),m.icon!==b&&null!==m.icon&&\"\"!==m.icon||(m.icon=!0),a&&a.data&&(m.data=a.data,a.data.jstree))for(f in a.data.jstree)a.data.jstree.hasOwnProperty(f)&&(m.state[f]=a.data.jstree[f]);if(a&&\"object\"==typeof a.state)for(f in a.state)a.state.hasOwnProperty(f)&&(m.state[f]=a.state[f]);if(a&&\"object\"==typeof a.li_attr)for(f in a.li_attr)a.li_attr.hasOwnProperty(f)&&(m.li_attr[f]=a.li_attr[f]);if(m.li_attr.id||(m.li_attr.id=e),a&&\"object\"==typeof a.a_attr)for(f in a.a_attr)a.a_attr.hasOwnProperty(f)&&(m.a_attr[f]=a.a_attr[f]);for(a&&a.children&&a.children===!0&&(m.state.loaded=!1,m.children=[],m.children_d=[]),k[m.id]=m,f=0,i=m.children.length;i>f;f++)j=r(k[m.children[f]],m.id,d),l=k[j],m.children_d.push(j),l.children_d.length&&(m.children_d=m.children_d.concat(l.children_d));return delete a.data,delete a.children,k[m.id].original=a,m.state.selected&&g.push(m.id),m.id},s=function(a,c,d){d=d?d.concat():[],c&&d.unshift(c);var e=!1,f,l,m,n,o;do e=\"j\"+i+\"_\"+ ++j;while(k[e]);o={id:!1,text:\"string\"==typeof a?a:\"\",icon:\"object\"==typeof a&&a.icon!==b?a.icon:!0,parent:c,parents:d,children:[],children_d:[],data:null,state:{},li_attr:{id:!1},a_attr:{href:\"#\"},original:!1};for(f in h)h.hasOwnProperty(f)&&(o.state[f]=h[f]);if(a&&a.id&&(o.id=a.id.toString()),a&&a.text&&(o.text=a.text),a&&a.data&&a.data.jstree&&a.data.jstree.icon&&(o.icon=a.data.jstree.icon),o.icon!==b&&null!==o.icon&&\"\"!==o.icon||(o.icon=!0),a&&a.data&&(o.data=a.data,a.data.jstree))for(f in a.data.jstree)a.data.jstree.hasOwnProperty(f)&&(o.state[f]=a.data.jstree[f]);if(a&&\"object\"==typeof a.state)for(f in a.state)a.state.hasOwnProperty(f)&&(o.state[f]=a.state[f]);if(a&&\"object\"==typeof a.li_attr)for(f in a.li_attr)a.li_attr.hasOwnProperty(f)&&(o.li_attr[f]=a.li_attr[f]);if(o.li_attr.id&&!o.id&&(o.id=o.li_attr.id.toString()),o.id||(o.id=e),o.li_attr.id||(o.li_attr.id=o.id),a&&\"object\"==typeof a.a_attr)for(f in a.a_attr)a.a_attr.hasOwnProperty(f)&&(o.a_attr[f]=a.a_attr[f]);if(a&&a.children&&a.children.length){for(f=0,l=a.children.length;l>f;f++)m=s(a.children[f],o.id,d),n=k[m],o.children.push(m),n.children_d.length&&(o.children_d=o.children_d.concat(n.children_d));o.children_d=o.children_d.concat(o.children)}return a&&a.children&&a.children===!0&&(o.state.loaded=!1,o.children=[],o.children_d=[]),delete a.data,delete a.children,o.original=a,k[o.id]=o,o.state.selected&&g.push(o.id),o.id};if(c.length&&c[0].id!==b&&c[0].parent!==b){for(o=0,p=c.length;p>o;o++)c[o].children||(c[o].children=[]),k[c[o].id.toString()]=c[o];for(o=0,p=c.length;p>o;o++)k[c[o].parent.toString()].children.push(c[o].id.toString()),l.children_d.push(c[o].id.toString());for(o=0,p=l.children.length;p>o;o++)n=r(k[l.children[o]],d,l.parents.concat()),f.push(n),k[n].children_d.length&&(f=f.concat(k[n].children_d));for(o=0,p=l.parents.length;p>o;o++)k[l.parents[o]].children_d=k[l.parents[o]].children_d.concat(f);q={cnt:j,mod:k,sel:m,par:d,dpc:f,add:g}}else{for(o=0,p=c.length;p>o;o++)n=s(c[o],d,l.parents.concat()),n&&(e.push(n),f.push(n),k[n].children_d.length&&(f=f.concat(k[n].children_d)));for(l.children=e,l.children_d=f,o=0,p=l.parents.length;p>o;o++)k[l.parents[o]].children_d=k[l.parents[o]].children_d.concat(f);q={cnt:j,mod:k,sel:m,par:d,dpc:f,add:g}}return\"undefined\"!=typeof window&&\"undefined\"!=typeof window.document?q:void postMessage(q)},i=function(b,c){if(null!==this.element){this._cnt=b.cnt;var e,f=this._model.data;for(e in f)f.hasOwnProperty(e)&&f[e].state&&f[e].state.loading&&b.mod[e]&&(b.mod[e].state.loading=!0);if(this._model.data=b.mod,c){var g,h=b.add,i=b.sel,j=this._data.core.selected.slice();if(f=this._model.data,i.length!==j.length||a.vakata.array_unique(i.concat(j)).length!==i.length){for(e=0,g=i.length;g>e;e++)-1===a.inArray(i[e],h)&&-1===a.inArray(i[e],j)&&(f[i[e]].state.selected=!1);for(e=0,g=j.length;g>e;e++)-1===a.inArray(j[e],i)&&(f[j[e]].state.selected=!0)}}b.add.length&&(this._data.core.selected=this._data.core.selected.concat(b.add)),this.trigger(\"model\",{nodes:b.dpc,parent:b.par}),b.par!==a.jstree.root?(this._node_changed(b.par),this.redraw()):this.redraw(!0),b.add.length&&this.trigger(\"changed\",{action:\"model\",selected:this._data.core.selected}),d.call(this,!0)}};if(this.settings.core.worker&&window.Blob&&window.URL&&window.Worker)try{null===this._wrk&&(this._wrk=window.URL.createObjectURL(new window.Blob([\"self.onmessage = \"+h.toString()],{type:\"text/javascript\"}))),!this._data.core.working||e?(this._data.core.working=!0,f=new window.Worker(this._wrk),f.onmessage=a.proxy(function(a){i.call(this,a.data,!0);try{f.terminate(),f=null}catch(b){}this._data.core.worker_queue.length?this._append_json_data.apply(this,this._data.core.worker_queue.shift()):this._data.core.working=!1},this),g.par?f.postMessage(g):this._data.core.worker_queue.length?this._append_json_data.apply(this,this._data.core.worker_queue.shift()):this._data.core.working=!1):this._data.core.worker_queue.push([b,c,d,!0])}catch(j){i.call(this,h(g),!1),this._data.core.worker_queue.length?this._append_json_data.apply(this,this._data.core.worker_queue.shift()):this._data.core.working=!1}else i.call(this,h(g),!1)}},_parse_model_from_html:function(c,d,e){e=e?[].concat(e):[],d&&e.unshift(d);var f,g,h=this._model.data,i={id:!1,text:!1,icon:!0,parent:d,parents:e,children:[],children_d:[],data:null,state:{},li_attr:{id:!1},a_attr:{href:\"#\"},original:!1},j,k,l;for(j in this._model.default_state)this._model.default_state.hasOwnProperty(j)&&(i.state[j]=this._model.default_state[j]);if(k=a.vakata.attributes(c,!0),a.each(k,function(b,c){return c=a.trim(c),c.length?(i.li_attr[b]=c,void(\"id\"===b&&(i.id=c.toString()))):!0}),k=c.children(\"a\").first(),k.length&&(k=a.vakata.attributes(k,!0),a.each(k,function(b,c){c=a.trim(c),c.length&&(i.a_attr[b]=c)})),k=c.children(\"a\").first().length?c.children(\"a\").first().clone():c.clone(),k.children(\"ins, i, ul\").remove(),k=k.html(),k=a(\"<div />\").html(k),i.text=this.settings.core.force_text?k.text():k.html(),k=c.data(),i.data=k?a.extend(!0,{},k):null,i.state.opened=c.hasClass(\"jstree-open\"),i.state.selected=c.children(\"a\").hasClass(\"jstree-clicked\"),i.state.disabled=c.children(\"a\").hasClass(\"jstree-disabled\"),i.data&&i.data.jstree)for(j in i.data.jstree)i.data.jstree.hasOwnProperty(j)&&(i.state[j]=i.data.jstree[j]);k=c.children(\"a\").children(\".jstree-themeicon\"),k.length&&(i.icon=k.hasClass(\"jstree-themeicon-hidden\")?!1:k.attr(\"rel\")),i.state.icon!==b&&(i.icon=i.state.icon),i.icon!==b&&null!==i.icon&&\"\"!==i.icon||(i.icon=!0),k=c.children(\"ul\").children(\"li\");do l=\"j\"+this._id+\"_\"+ ++this._cnt;while(h[l]);return i.id=i.li_attr.id?i.li_attr.id.toString():l,k.length?(k.each(a.proxy(function(b,c){f=this._parse_model_from_html(a(c),i.id,e),g=this._model.data[f],i.children.push(f),g.children_d.length&&(i.children_d=i.children_d.concat(g.children_d))},this)),i.children_d=i.children_d.concat(i.children)):c.hasClass(\"jstree-closed\")&&(i.state.loaded=!1),i.li_attr[\"class\"]&&(i.li_attr[\"class\"]=i.li_attr[\"class\"].replace(\"jstree-closed\",\"\").replace(\"jstree-open\",\"\")),i.a_attr[\"class\"]&&(i.a_attr[\"class\"]=i.a_attr[\"class\"].replace(\"jstree-clicked\",\"\").replace(\"jstree-disabled\",\"\")),h[i.id]=i,i.state.selected&&this._data.core.selected.push(i.id),i.id},_parse_model_from_flat_json:function(a,c,d){d=d?d.concat():[],c&&d.unshift(c);var e=a.id.toString(),f=this._model.data,g=this._model.default_state,h,i,j,k,l={id:e,text:a.text||\"\",icon:a.icon!==b?a.icon:!0,parent:c,parents:d,children:a.children||[],children_d:a.children_d||[],data:a.data,state:{},li_attr:{id:!1},a_attr:{href:\"#\"},original:!1};for(h in g)g.hasOwnProperty(h)&&(l.state[h]=g[h]);if(a&&a.data&&a.data.jstree&&a.data.jstree.icon&&(l.icon=a.data.jstree.icon),l.icon!==b&&null!==l.icon&&\"\"!==l.icon||(l.icon=!0),a&&a.data&&(l.data=a.data,a.data.jstree))for(h in a.data.jstree)a.data.jstree.hasOwnProperty(h)&&(l.state[h]=a.data.jstree[h]);if(a&&\"object\"==typeof a.state)for(h in a.state)a.state.hasOwnProperty(h)&&(l.state[h]=a.state[h]);if(a&&\"object\"==typeof a.li_attr)for(h in a.li_attr)a.li_attr.hasOwnProperty(h)&&(l.li_attr[h]=a.li_attr[h]);if(l.li_attr.id||(l.li_attr.id=e),a&&\"object\"==typeof a.a_attr)for(h in a.a_attr)a.a_attr.hasOwnProperty(h)&&(l.a_attr[h]=a.a_attr[h]);for(a&&a.children&&a.children===!0&&(l.state.loaded=!1,l.children=[],l.children_d=[]),f[l.id]=l,h=0,i=l.children.length;i>h;h++)j=this._parse_model_from_flat_json(f[l.children[h]],l.id,d),k=f[j],l.children_d.push(j),k.children_d.length&&(l.children_d=l.children_d.concat(k.children_d));return delete a.data,delete a.children,f[l.id].original=a,l.state.selected&&this._data.core.selected.push(l.id),l.id},_parse_model_from_json:function(a,c,d){d=d?d.concat():[],c&&d.unshift(c);var e=!1,f,g,h,i,j=this._model.data,k=this._model.default_state,l;do e=\"j\"+this._id+\"_\"+ ++this._cnt;while(j[e]);l={id:!1,text:\"string\"==typeof a?a:\"\",icon:\"object\"==typeof a&&a.icon!==b?a.icon:!0,parent:c,parents:d,children:[],children_d:[],data:null,state:{},li_attr:{id:!1},a_attr:{href:\"#\"},original:!1};for(f in k)k.hasOwnProperty(f)&&(l.state[f]=k[f]);if(a&&a.id&&(l.id=a.id.toString()),a&&a.text&&(l.text=a.text),a&&a.data&&a.data.jstree&&a.data.jstree.icon&&(l.icon=a.data.jstree.icon),l.icon!==b&&null!==l.icon&&\"\"!==l.icon||(l.icon=!0),a&&a.data&&(l.data=a.data,a.data.jstree))for(f in a.data.jstree)a.data.jstree.hasOwnProperty(f)&&(l.state[f]=a.data.jstree[f]);if(a&&\"object\"==typeof a.state)for(f in a.state)a.state.hasOwnProperty(f)&&(l.state[f]=a.state[f]);if(a&&\"object\"==typeof a.li_attr)for(f in a.li_attr)a.li_attr.hasOwnProperty(f)&&(l.li_attr[f]=a.li_attr[f]);if(l.li_attr.id&&!l.id&&(l.id=l.li_attr.id.toString()),l.id||(l.id=e),l.li_attr.id||(l.li_attr.id=l.id),a&&\"object\"==typeof a.a_attr)for(f in a.a_attr)a.a_attr.hasOwnProperty(f)&&(l.a_attr[f]=a.a_attr[f]);if(a&&a.children&&a.children.length){for(f=0,g=a.children.length;g>f;f++)h=this._parse_model_from_json(a.children[f],l.id,d),i=j[h],l.children.push(h),i.children_d.length&&(l.children_d=l.children_d.concat(i.children_d));l.children_d=l.children_d.concat(l.children)}return a&&a.children&&a.children===!0&&(l.state.loaded=!1,l.children=[],l.children_d=[]),delete a.data,delete a.children,l.original=a,j[l.id]=l,l.state.selected&&this._data.core.selected.push(l.id),l.id},_redraw:function(){var b=this._model.force_full_redraw?this._model.data[a.jstree.root].children.concat([]):this._model.changed.concat([]),c=i.createElement(\"UL\"),d,e,f,g=this._data.core.focused;for(e=0,f=b.length;f>e;e++)d=this.redraw_node(b[e],!0,this._model.force_full_redraw),d&&this._model.force_full_redraw&&c.appendChild(d);this._model.force_full_redraw&&(c.className=this.get_container_ul()[0].className,c.setAttribute(\"role\",\"group\"),this.element.empty().append(c)),null!==g&&(d=this.get_node(g,!0),d&&d.length&&d.children(\".jstree-anchor\")[0]!==i.activeElement?d.children(\".jstree-anchor\").focus():this._data.core.focused=null),this._model.force_full_redraw=!1,this._model.changed=[],this.trigger(\"redraw\",{nodes:b})},redraw:function(a){a&&(this._model.force_full_redraw=!0),this._redraw()},draw_children:function(b){var c=this.get_node(b),d=!1,e=!1,f=!1,g=i;if(!c)return!1;if(c.id===a.jstree.root)return this.redraw(!0);if(b=this.get_node(b,!0),!b||!b.length)return!1;if(b.children(\".jstree-children\").remove(),b=b[0],c.children.length&&c.state.loaded){for(f=g.createElement(\"UL\"),f.setAttribute(\"role\",\"group\"),f.className=\"jstree-children\",d=0,e=c.children.length;e>d;d++)f.appendChild(this.redraw_node(c.children[d],!0,!0));b.appendChild(f)}},redraw_node:function(b,c,d,e){var f=this.get_node(b),g=!1,h=!1,k=!1,l=!1,m=!1,n=!1,o=\"\",p=i,q=this._model.data,r=!1,s=!1,t=null,u=0,v=0,w=!1,x=!1;if(!f)return!1;if(f.id===a.jstree.root)return this.redraw(!0);if(c=c||0===f.children.length,b=i.querySelector?this.element[0].querySelector(\"#\"+(-1!==\"0123456789\".indexOf(f.id[0])?\"\\\\3\"+f.id[0]+\" \"+f.id.substr(1).replace(a.jstree.idregex,\"\\\\$&\"):f.id.replace(a.jstree.idregex,\"\\\\$&\"))):i.getElementById(f.id))b=a(b),\nd||(g=b.parent().parent()[0],g===this.element[0]&&(g=null),h=b.index()),c||!f.children.length||b.children(\".jstree-children\").length||(c=!0),c||(k=b.children(\".jstree-children\")[0]),r=b.children(\".jstree-anchor\")[0]===i.activeElement,b.remove();else if(c=!0,!d){if(g=f.parent!==a.jstree.root?a(\"#\"+f.parent.replace(a.jstree.idregex,\"\\\\$&\"),this.element)[0]:null,!(null===g||g&&q[f.parent].state.opened))return!1;h=a.inArray(f.id,null===g?q[a.jstree.root].children:q[f.parent].children)}b=j.cloneNode(!0),o=\"jstree-node \";for(l in f.li_attr)if(f.li_attr.hasOwnProperty(l)){if(\"id\"===l)continue;\"class\"!==l?b.setAttribute(l,f.li_attr[l]):o+=f.li_attr[l]}for(f.a_attr.id||(f.a_attr.id=f.id+\"_anchor\"),b.setAttribute(\"aria-selected\",!!f.state.selected),b.setAttribute(\"aria-level\",f.parents.length),b.setAttribute(\"aria-labelledby\",f.a_attr.id),f.state.disabled&&b.setAttribute(\"aria-disabled\",!0),l=0,m=f.children.length;m>l;l++)if(!q[f.children[l]].state.hidden){w=!0;break}if(null!==f.parent&&q[f.parent]&&!f.state.hidden&&(l=a.inArray(f.id,q[f.parent].children),x=f.id,-1!==l))for(l++,m=q[f.parent].children.length;m>l;l++)if(q[q[f.parent].children[l]].state.hidden||(x=q[f.parent].children[l]),x!==f.id)break;f.state.hidden&&(o+=\" jstree-hidden\"),f.state.loaded&&!w?o+=\" jstree-leaf\":(o+=f.state.opened&&f.state.loaded?\" jstree-open\":\" jstree-closed\",b.setAttribute(\"aria-expanded\",f.state.opened&&f.state.loaded)),x===f.id&&(o+=\" jstree-last\"),b.id=f.id,b.className=o,o=(f.state.selected?\" jstree-clicked\":\"\")+(f.state.disabled?\" jstree-disabled\":\"\");for(m in f.a_attr)if(f.a_attr.hasOwnProperty(m)){if(\"href\"===m&&\"#\"===f.a_attr[m])continue;\"class\"!==m?b.childNodes[1].setAttribute(m,f.a_attr[m]):o+=\" \"+f.a_attr[m]}if(o.length&&(b.childNodes[1].className=\"jstree-anchor \"+o),(f.icon&&f.icon!==!0||f.icon===!1)&&(f.icon===!1?b.childNodes[1].childNodes[0].className+=\" jstree-themeicon-hidden\":-1===f.icon.indexOf(\"/\")&&-1===f.icon.indexOf(\".\")?b.childNodes[1].childNodes[0].className+=\" \"+f.icon+\" jstree-themeicon-custom\":(b.childNodes[1].childNodes[0].style.backgroundImage='url(\"'+f.icon+'\")',b.childNodes[1].childNodes[0].style.backgroundPosition=\"center center\",b.childNodes[1].childNodes[0].style.backgroundSize=\"auto\",b.childNodes[1].childNodes[0].className+=\" jstree-themeicon-custom\")),this.settings.core.force_text?b.childNodes[1].appendChild(p.createTextNode(f.text)):b.childNodes[1].innerHTML+=f.text,c&&f.children.length&&(f.state.opened||e)&&f.state.loaded){for(n=p.createElement(\"UL\"),n.setAttribute(\"role\",\"group\"),n.className=\"jstree-children\",l=0,m=f.children.length;m>l;l++)n.appendChild(this.redraw_node(f.children[l],c,!0));b.appendChild(n)}if(k&&b.appendChild(k),!d){for(g||(g=this.element[0]),l=0,m=g.childNodes.length;m>l;l++)if(g.childNodes[l]&&g.childNodes[l].className&&-1!==g.childNodes[l].className.indexOf(\"jstree-children\")){t=g.childNodes[l];break}t||(t=p.createElement(\"UL\"),t.setAttribute(\"role\",\"group\"),t.className=\"jstree-children\",g.appendChild(t)),g=t,h<g.childNodes.length?g.insertBefore(b,g.childNodes[h]):g.appendChild(b),r&&(u=this.element[0].scrollTop,v=this.element[0].scrollLeft,b.childNodes[1].focus(),this.element[0].scrollTop=u,this.element[0].scrollLeft=v)}return f.state.opened&&!f.state.loaded&&(f.state.opened=!1,setTimeout(a.proxy(function(){this.open_node(f.id,!1,0)},this),0)),b},open_node:function(c,d,e){var f,g,h,i;if(a.isArray(c)){for(c=c.slice(),f=0,g=c.length;g>f;f++)this.open_node(c[f],d,e);return!0}return c=this.get_node(c),c&&c.id!==a.jstree.root?(e=e===b?this.settings.core.animation:e,this.is_closed(c)?this.is_loaded(c)?(h=this.get_node(c,!0),i=this,h.length&&(e&&h.children(\".jstree-children\").length&&h.children(\".jstree-children\").stop(!0,!0),c.children.length&&!this._firstChild(h.children(\".jstree-children\")[0])&&this.draw_children(c),e?(this.trigger(\"before_open\",{node:c}),h.children(\".jstree-children\").css(\"display\",\"none\").end().removeClass(\"jstree-closed\").addClass(\"jstree-open\").attr(\"aria-expanded\",!0).children(\".jstree-children\").stop(!0,!0).slideDown(e,function(){this.style.display=\"\",i.trigger(\"after_open\",{node:c})})):(this.trigger(\"before_open\",{node:c}),h[0].className=h[0].className.replace(\"jstree-closed\",\"jstree-open\"),h[0].setAttribute(\"aria-expanded\",!0))),c.state.opened=!0,d&&d.call(this,c,!0),h.length||this.trigger(\"before_open\",{node:c}),this.trigger(\"open_node\",{node:c}),e&&h.length||this.trigger(\"after_open\",{node:c}),!0):this.is_loading(c)?setTimeout(a.proxy(function(){this.open_node(c,d,e)},this),500):void this.load_node(c,function(a,b){return b?this.open_node(a,d,e):d?d.call(this,a,!1):!1}):(d&&d.call(this,c,!1),!1)):!1},_open_to:function(b){if(b=this.get_node(b),!b||b.id===a.jstree.root)return!1;var c,d,e=b.parents;for(c=0,d=e.length;d>c;c+=1)c!==a.jstree.root&&this.open_node(e[c],!1,0);return a(\"#\"+b.id.replace(a.jstree.idregex,\"\\\\$&\"),this.element)},close_node:function(c,d){var e,f,g,h;if(a.isArray(c)){for(c=c.slice(),e=0,f=c.length;f>e;e++)this.close_node(c[e],d);return!0}return c=this.get_node(c),c&&c.id!==a.jstree.root?this.is_closed(c)?!1:(d=d===b?this.settings.core.animation:d,g=this,h=this.get_node(c,!0),c.state.opened=!1,this.trigger(\"close_node\",{node:c}),void(h.length?d?h.children(\".jstree-children\").attr(\"style\",\"display:block !important\").end().removeClass(\"jstree-open\").addClass(\"jstree-closed\").attr(\"aria-expanded\",!1).children(\".jstree-children\").stop(!0,!0).slideUp(d,function(){this.style.display=\"\",h.children(\".jstree-children\").remove(),g.trigger(\"after_close\",{node:c})}):(h[0].className=h[0].className.replace(\"jstree-open\",\"jstree-closed\"),h.attr(\"aria-expanded\",!1).children(\".jstree-children\").remove(),this.trigger(\"after_close\",{node:c})):this.trigger(\"after_close\",{node:c}))):!1},toggle_node:function(b){var c,d;if(a.isArray(b)){for(b=b.slice(),c=0,d=b.length;d>c;c++)this.toggle_node(b[c]);return!0}return this.is_closed(b)?this.open_node(b):this.is_open(b)?this.close_node(b):void 0},open_all:function(b,c,d){if(b||(b=a.jstree.root),b=this.get_node(b),!b)return!1;var e=b.id===a.jstree.root?this.get_container_ul():this.get_node(b,!0),f,g,h;if(!e.length){for(f=0,g=b.children_d.length;g>f;f++)this.is_closed(this._model.data[b.children_d[f]])&&(this._model.data[b.children_d[f]].state.opened=!0);return this.trigger(\"open_all\",{node:b})}d=d||e,h=this,e=this.is_closed(b)?e.find(\".jstree-closed\").addBack():e.find(\".jstree-closed\"),e.each(function(){h.open_node(this,function(a,b){b&&this.is_parent(a)&&this.open_all(a,c,d)},c||0)}),0===d.find(\".jstree-closed\").length&&this.trigger(\"open_all\",{node:this.get_node(d)})},close_all:function(b,c){if(b||(b=a.jstree.root),b=this.get_node(b),!b)return!1;var d=b.id===a.jstree.root?this.get_container_ul():this.get_node(b,!0),e=this,f,g;for(d.length&&(d=this.is_open(b)?d.find(\".jstree-open\").addBack():d.find(\".jstree-open\"),a(d.get().reverse()).each(function(){e.close_node(this,c||0)})),f=0,g=b.children_d.length;g>f;f++)this._model.data[b.children_d[f]].state.opened=!1;this.trigger(\"close_all\",{node:b})},is_disabled:function(a){return a=this.get_node(a),a&&a.state&&a.state.disabled},enable_node:function(b){var c,d;if(a.isArray(b)){for(b=b.slice(),c=0,d=b.length;d>c;c++)this.enable_node(b[c]);return!0}return b=this.get_node(b),b&&b.id!==a.jstree.root?(b.state.disabled=!1,this.get_node(b,!0).children(\".jstree-anchor\").removeClass(\"jstree-disabled\").attr(\"aria-disabled\",!1),void this.trigger(\"enable_node\",{node:b})):!1},disable_node:function(b){var c,d;if(a.isArray(b)){for(b=b.slice(),c=0,d=b.length;d>c;c++)this.disable_node(b[c]);return!0}return b=this.get_node(b),b&&b.id!==a.jstree.root?(b.state.disabled=!0,this.get_node(b,!0).children(\".jstree-anchor\").addClass(\"jstree-disabled\").attr(\"aria-disabled\",!0),void this.trigger(\"disable_node\",{node:b})):!1},is_hidden:function(a){return a=this.get_node(a),a.state.hidden===!0},hide_node:function(b,c){var d,e;if(a.isArray(b)){for(b=b.slice(),d=0,e=b.length;e>d;d++)this.hide_node(b[d],!0);return c||this.redraw(),!0}return b=this.get_node(b),b&&b.id!==a.jstree.root?void(b.state.hidden||(b.state.hidden=!0,this._node_changed(b.parent),c||this.redraw(),this.trigger(\"hide_node\",{node:b}))):!1},show_node:function(b,c){var d,e;if(a.isArray(b)){for(b=b.slice(),d=0,e=b.length;e>d;d++)this.show_node(b[d],!0);return c||this.redraw(),!0}return b=this.get_node(b),b&&b.id!==a.jstree.root?void(b.state.hidden&&(b.state.hidden=!1,this._node_changed(b.parent),c||this.redraw(),this.trigger(\"show_node\",{node:b}))):!1},hide_all:function(b){var c,d=this._model.data,e=[];for(c in d)d.hasOwnProperty(c)&&c!==a.jstree.root&&!d[c].state.hidden&&(d[c].state.hidden=!0,e.push(c));return this._model.force_full_redraw=!0,b||this.redraw(),this.trigger(\"hide_all\",{nodes:e}),e},show_all:function(b){var c,d=this._model.data,e=[];for(c in d)d.hasOwnProperty(c)&&c!==a.jstree.root&&d[c].state.hidden&&(d[c].state.hidden=!1,e.push(c));return this._model.force_full_redraw=!0,b||this.redraw(),this.trigger(\"show_all\",{nodes:e}),e},activate_node:function(a,c){if(this.is_disabled(a))return!1;if(c&&\"object\"==typeof c||(c={}),this._data.core.last_clicked=this._data.core.last_clicked&&this._data.core.last_clicked.id!==b?this.get_node(this._data.core.last_clicked.id):null,this._data.core.last_clicked&&!this._data.core.last_clicked.state.selected&&(this._data.core.last_clicked=null),!this._data.core.last_clicked&&this._data.core.selected.length&&(this._data.core.last_clicked=this.get_node(this._data.core.selected[this._data.core.selected.length-1])),this.settings.core.multiple&&(c.metaKey||c.ctrlKey||c.shiftKey)&&(!c.shiftKey||this._data.core.last_clicked&&this.get_parent(a)&&this.get_parent(a)===this._data.core.last_clicked.parent))if(c.shiftKey){var d=this.get_node(a).id,e=this._data.core.last_clicked.id,f=this.get_node(this._data.core.last_clicked.parent).children,g=!1,h,i;for(h=0,i=f.length;i>h;h+=1)f[h]===d&&(g=!g),f[h]===e&&(g=!g),this.is_disabled(f[h])||!g&&f[h]!==d&&f[h]!==e?this.deselect_node(f[h],!0,c):this.is_hidden(f[h])||this.select_node(f[h],!0,!1,c);this.trigger(\"changed\",{action:\"select_node\",node:this.get_node(a),selected:this._data.core.selected,event:c})}else this.is_selected(a)?this.deselect_node(a,!1,c):this.select_node(a,!1,!1,c);else!this.settings.core.multiple&&(c.metaKey||c.ctrlKey||c.shiftKey)&&this.is_selected(a)?this.deselect_node(a,!1,c):(this.deselect_all(!0),this.select_node(a,!1,!1,c),this._data.core.last_clicked=this.get_node(a));this.trigger(\"activate_node\",{node:this.get_node(a),event:c})},hover_node:function(a){if(a=this.get_node(a,!0),!a||!a.length||a.children(\".jstree-hovered\").length)return!1;var b=this.element.find(\".jstree-hovered\"),c=this.element;b&&b.length&&this.dehover_node(b),a.children(\".jstree-anchor\").addClass(\"jstree-hovered\"),this.trigger(\"hover_node\",{node:this.get_node(a)}),setTimeout(function(){c.attr(\"aria-activedescendant\",a[0].id)},0)},dehover_node:function(a){return a=this.get_node(a,!0),a&&a.length&&a.children(\".jstree-hovered\").length?(a.children(\".jstree-anchor\").removeClass(\"jstree-hovered\"),void this.trigger(\"dehover_node\",{node:this.get_node(a)})):!1},select_node:function(b,c,d,e){var f,g,h,i;if(a.isArray(b)){for(b=b.slice(),g=0,h=b.length;h>g;g++)this.select_node(b[g],c,d,e);return!0}return b=this.get_node(b),b&&b.id!==a.jstree.root?(f=this.get_node(b,!0),void(b.state.selected||(b.state.selected=!0,this._data.core.selected.push(b.id),d||(f=this._open_to(b)),f&&f.length&&f.attr(\"aria-selected\",!0).children(\".jstree-anchor\").addClass(\"jstree-clicked\"),this.trigger(\"select_node\",{node:b,selected:this._data.core.selected,event:e}),c||this.trigger(\"changed\",{action:\"select_node\",node:b,selected:this._data.core.selected,event:e})))):!1},deselect_node:function(b,c,d){var e,f,g;if(a.isArray(b)){for(b=b.slice(),e=0,f=b.length;f>e;e++)this.deselect_node(b[e],c,d);return!0}return b=this.get_node(b),b&&b.id!==a.jstree.root?(g=this.get_node(b,!0),void(b.state.selected&&(b.state.selected=!1,this._data.core.selected=a.vakata.array_remove_item(this._data.core.selected,b.id),g.length&&g.attr(\"aria-selected\",!1).children(\".jstree-anchor\").removeClass(\"jstree-clicked\"),this.trigger(\"deselect_node\",{node:b,selected:this._data.core.selected,event:d}),c||this.trigger(\"changed\",{action:\"deselect_node\",node:b,selected:this._data.core.selected,event:d})))):!1},select_all:function(b){var c=this._data.core.selected.concat([]),d,e;for(this._data.core.selected=this._model.data[a.jstree.root].children_d.concat(),d=0,e=this._data.core.selected.length;e>d;d++)this._model.data[this._data.core.selected[d]]&&(this._model.data[this._data.core.selected[d]].state.selected=!0);this.redraw(!0),this.trigger(\"select_all\",{selected:this._data.core.selected}),b||this.trigger(\"changed\",{action:\"select_all\",selected:this._data.core.selected,old_selection:c})},deselect_all:function(a){var b=this._data.core.selected.concat([]),c,d;for(c=0,d=this._data.core.selected.length;d>c;c++)this._model.data[this._data.core.selected[c]]&&(this._model.data[this._data.core.selected[c]].state.selected=!1);this._data.core.selected=[],this.element.find(\".jstree-clicked\").removeClass(\"jstree-clicked\").parent().attr(\"aria-selected\",!1),this.trigger(\"deselect_all\",{selected:this._data.core.selected,node:b}),a||this.trigger(\"changed\",{action:\"deselect_all\",selected:this._data.core.selected,old_selection:b})},is_selected:function(b){return b=this.get_node(b),b&&b.id!==a.jstree.root?b.state.selected:!1},get_selected:function(b){return b?a.map(this._data.core.selected,a.proxy(function(a){return this.get_node(a)},this)):this._data.core.selected.slice()},get_top_selected:function(b){var c=this.get_selected(!0),d={},e,f,g,h;for(e=0,f=c.length;f>e;e++)d[c[e].id]=c[e];for(e=0,f=c.length;f>e;e++)for(g=0,h=c[e].children_d.length;h>g;g++)d[c[e].children_d[g]]&&delete d[c[e].children_d[g]];c=[];for(e in d)d.hasOwnProperty(e)&&c.push(e);return b?a.map(c,a.proxy(function(a){return this.get_node(a)},this)):c},get_bottom_selected:function(b){var c=this.get_selected(!0),d=[],e,f;for(e=0,f=c.length;f>e;e++)c[e].children.length||d.push(c[e].id);return b?a.map(d,a.proxy(function(a){return this.get_node(a)},this)):d},get_state:function(){var b={core:{open:[],scroll:{left:this.element.scrollLeft(),top:this.element.scrollTop()},selected:[]}},c;for(c in this._model.data)this._model.data.hasOwnProperty(c)&&c!==a.jstree.root&&(this._model.data[c].state.opened&&b.core.open.push(c),this._model.data[c].state.selected&&b.core.selected.push(c));return b},set_state:function(c,d){if(c){if(c.core){var e,f,g,h,i;if(c.core.open)return a.isArray(c.core.open)&&c.core.open.length?this._load_nodes(c.core.open,function(a){this.open_node(a,!1,0),delete c.core.open,this.set_state(c,d)},!0):(delete c.core.open,this.set_state(c,d)),!1;if(c.core.scroll)return c.core.scroll&&c.core.scroll.left!==b&&this.element.scrollLeft(c.core.scroll.left),c.core.scroll&&c.core.scroll.top!==b&&this.element.scrollTop(c.core.scroll.top),delete c.core.scroll,this.set_state(c,d),!1;if(c.core.selected)return h=this,this.deselect_all(),a.each(c.core.selected,function(a,b){h.select_node(b,!1,!0)}),delete c.core.selected,this.set_state(c,d),!1;for(i in c)c.hasOwnProperty(i)&&\"core\"!==i&&-1===a.inArray(i,this.settings.plugins)&&delete c[i];if(a.isEmptyObject(c.core))return delete c.core,this.set_state(c,d),!1}return a.isEmptyObject(c)?(c=null,d&&d.call(this),this.trigger(\"set_state\"),!1):!0}return!1},refresh:function(b,c){this._data.core.state=c===!0?{}:this.get_state(),c&&a.isFunction(c)&&(this._data.core.state=c.call(this,this._data.core.state)),this._cnt=0,this._model.data={},this._model.data[a.jstree.root]={id:a.jstree.root,parent:null,parents:[],children:[],children_d:[],state:{loaded:!1}},this._data.core.selected=[],this._data.core.last_clicked=null,this._data.core.focused=null;var d=this.get_container_ul()[0].className;b||(this.element.html(\"<ul class='\"+d+\"' role='group'><li class='jstree-initial-node jstree-loading jstree-leaf jstree-last' role='treeitem' id='j\"+this._id+\"_loading'><i class='jstree-icon jstree-ocl'></i><a class='jstree-anchor' href='#'><i class='jstree-icon jstree-themeicon-hidden'></i>\"+this.get_string(\"Loading ...\")+\"</a></li></ul>\"),this.element.attr(\"aria-activedescendant\",\"j\"+this._id+\"_loading\")),this.load_node(a.jstree.root,function(b,c){c&&(this.get_container_ul()[0].className=d,this._firstChild(this.get_container_ul()[0])&&this.element.attr(\"aria-activedescendant\",this._firstChild(this.get_container_ul()[0]).id),this.set_state(a.extend(!0,{},this._data.core.state),function(){this.trigger(\"refresh\")})),this._data.core.state=null})},refresh_node:function(b){if(b=this.get_node(b),!b||b.id===a.jstree.root)return!1;var c=[],d=[],e=this._data.core.selected.concat([]);d.push(b.id),b.state.opened===!0&&c.push(b.id),this.get_node(b,!0).find(\".jstree-open\").each(function(){d.push(this.id),c.push(this.id)}),this._load_nodes(d,a.proxy(function(a){this.open_node(c,!1,0),this.select_node(e),this.trigger(\"refresh_node\",{node:b,nodes:a})},this),!1,!0)},set_id:function(b,c){if(b=this.get_node(b),!b||b.id===a.jstree.root)return!1;var d,e,f=this._model.data,g=b.id;for(c=c.toString(),f[b.parent].children[a.inArray(b.id,f[b.parent].children)]=c,d=0,e=b.parents.length;e>d;d++)f[b.parents[d]].children_d[a.inArray(b.id,f[b.parents[d]].children_d)]=c;for(d=0,e=b.children.length;e>d;d++)f[b.children[d]].parent=c;for(d=0,e=b.children_d.length;e>d;d++)f[b.children_d[d]].parents[a.inArray(b.id,f[b.children_d[d]].parents)]=c;return d=a.inArray(b.id,this._data.core.selected),-1!==d&&(this._data.core.selected[d]=c),d=this.get_node(b.id,!0),d&&(d.attr(\"id\",c),this.element.attr(\"aria-activedescendant\")===b.id&&this.element.attr(\"aria-activedescendant\",c)),delete f[b.id],b.id=c,b.li_attr.id=c,f[c]=b,this.trigger(\"set_id\",{node:b,\"new\":b.id,old:g}),!0},get_text:function(b){return b=this.get_node(b),b&&b.id!==a.jstree.root?b.text:!1},set_text:function(b,c){var d,e;if(a.isArray(b)){for(b=b.slice(),d=0,e=b.length;e>d;d++)this.set_text(b[d],c);return!0}return b=this.get_node(b),b&&b.id!==a.jstree.root?(b.text=c,this.get_node(b,!0).length&&this.redraw_node(b.id),this.trigger(\"set_text\",{obj:b,text:c}),!0):!1},get_json:function(b,c,d){if(b=this.get_node(b||a.jstree.root),!b)return!1;c&&c.flat&&!d&&(d=[]);var e={id:b.id,text:b.text,icon:this.get_icon(b),li_attr:a.extend(!0,{},b.li_attr),a_attr:a.extend(!0,{},b.a_attr),state:{},data:c&&c.no_data?!1:a.extend(!0,{},b.data)},f,g;if(c&&c.flat?e.parent=b.parent:e.children=[],!c||!c.no_state)for(f in b.state)b.state.hasOwnProperty(f)&&(e.state[f]=b.state[f]);if(c&&c.no_id&&(delete e.id,e.li_attr&&e.li_attr.id&&delete e.li_attr.id,e.a_attr&&e.a_attr.id&&delete e.a_attr.id),c&&c.flat&&b.id!==a.jstree.root&&d.push(e),!c||!c.no_children)for(f=0,g=b.children.length;g>f;f++)c&&c.flat?this.get_json(b.children[f],c,d):e.children.push(this.get_json(b.children[f],c));return c&&c.flat?d:b.id===a.jstree.root?e.children:e},create_node:function(c,d,e,f,g){if(null===c&&(c=a.jstree.root),c=this.get_node(c),!c)return!1;if(e=e===b?\"last\":e,!e.toString().match(/^(before|after)$/)&&!g&&!this.is_loaded(c))return this.load_node(c,function(){this.create_node(c,d,e,f,!0)});d||(d={text:this.get_string(\"New node\")}),\"string\"==typeof d&&(d={text:d}),d.text===b&&(d.text=this.get_string(\"New node\"));var h,i,j,k;switch(c.id===a.jstree.root&&(\"before\"===e&&(e=\"first\"),\"after\"===e&&(e=\"last\")),e){case\"before\":h=this.get_node(c.parent),e=a.inArray(c.id,h.children),c=h;break;case\"after\":h=this.get_node(c.parent),e=a.inArray(c.id,h.children)+1,c=h;break;case\"inside\":case\"first\":e=0;break;case\"last\":e=c.children.length;break;default:e||(e=0)}if(e>c.children.length&&(e=c.children.length),d.id||(d.id=!0),!this.check(\"create_node\",d,c,e))return this.settings.core.error.call(this,this._data.core.last_error),!1;if(d.id===!0&&delete d.id,d=this._parse_model_from_json(d,c.id,c.parents.concat()),!d)return!1;for(h=this.get_node(d),i=[],i.push(d),i=i.concat(h.children_d),this.trigger(\"model\",{nodes:i,parent:c.id}),c.children_d=c.children_d.concat(i),j=0,k=c.parents.length;k>j;j++)this._model.data[c.parents[j]].children_d=this._model.data[c.parents[j]].children_d.concat(i);for(d=h,h=[],j=0,k=c.children.length;k>j;j++)h[j>=e?j+1:j]=c.children[j];return h[e]=d.id,c.children=h,this.redraw_node(c,!0),f&&f.call(this,this.get_node(d)),this.trigger(\"create_node\",{node:this.get_node(d),parent:c.id,position:e}),d.id},rename_node:function(b,c){var d,e,f;if(a.isArray(b)){for(b=b.slice(),d=0,e=b.length;e>d;d++)this.rename_node(b[d],c);return!0}return b=this.get_node(b),b&&b.id!==a.jstree.root?(f=b.text,this.check(\"rename_node\",b,this.get_parent(b),c)?(this.set_text(b,c),this.trigger(\"rename_node\",{node:b,text:c,old:f}),!0):(this.settings.core.error.call(this,this._data.core.last_error),!1)):!1},delete_node:function(b){var c,d,e,f,g,h,i,j,k,l,m,n;if(a.isArray(b)){for(b=b.slice(),c=0,d=b.length;d>c;c++)this.delete_node(b[c]);return!0}if(b=this.get_node(b),!b||b.id===a.jstree.root)return!1;if(e=this.get_node(b.parent),f=a.inArray(b.id,e.children),l=!1,!this.check(\"delete_node\",b,e,f))return this.settings.core.error.call(this,this._data.core.last_error),!1;for(-1!==f&&(e.children=a.vakata.array_remove(e.children,f)),g=b.children_d.concat([]),g.push(b.id),h=0,i=b.parents.length;i>h;h++)this._model.data[b.parents[h]].children_d=a.vakata.array_filter(this._model.data[b.parents[h]].children_d,function(b){return-1===a.inArray(b,g)});for(j=0,k=g.length;k>j;j++)if(this._model.data[g[j]].state.selected){l=!0;break}for(l&&(this._data.core.selected=a.vakata.array_filter(this._data.core.selected,function(b){return-1===a.inArray(b,g)})),this.trigger(\"delete_node\",{node:b,parent:e.id}),l&&this.trigger(\"changed\",{action:\"delete_node\",node:b,selected:this._data.core.selected,parent:e.id}),j=0,k=g.length;k>j;j++)delete this._model.data[g[j]];return-1!==a.inArray(this._data.core.focused,g)&&(this._data.core.focused=null,m=this.element[0].scrollTop,n=this.element[0].scrollLeft,e.id===a.jstree.root?this._model.data[a.jstree.root].children[0]&&this.get_node(this._model.data[a.jstree.root].children[0],!0).children(\".jstree-anchor\").focus():this.get_node(e,!0).children(\".jstree-anchor\").focus(),this.element[0].scrollTop=m,this.element[0].scrollLeft=n),this.redraw_node(e,!0),!0},check:function(b,c,d,e,f){c=c&&c.id?c:this.get_node(c),d=d&&d.id?d:this.get_node(d);var g=b.match(/^move_node|copy_node|create_node$/i)?d:c,h=this.settings.core.check_callback;return\"move_node\"!==b||f&&f.is_multi||c.id!==d.id&&(\"move_node\"!==b||a.inArray(c.id,d.children)!==e)&&-1===a.inArray(d.id,c.children_d)?(g&&g.data&&(g=g.data),g&&g.functions&&(g.functions[b]===!1||g.functions[b]===!0)?(g.functions[b]===!1&&(this._data.core.last_error={error:\"check\",plugin:\"core\",id:\"core_02\",reason:\"Node data prevents function: \"+b,data:JSON.stringify({chk:b,pos:e,obj:c&&c.id?c.id:!1,par:d&&d.id?d.id:!1})}),g.functions[b]):h===!1||a.isFunction(h)&&h.call(this,b,c,d,e,f)===!1||h&&h[b]===!1?(this._data.core.last_error={error:\"check\",plugin:\"core\",id:\"core_03\",reason:\"User config for core.check_callback prevents function: \"+b,data:JSON.stringify({chk:b,pos:e,obj:c&&c.id?c.id:!1,par:d&&d.id?d.id:!1})},!1):!0):(this._data.core.last_error={error:\"check\",plugin:\"core\",id:\"core_01\",reason:\"Moving parent inside child\",data:JSON.stringify({chk:b,pos:e,obj:c&&c.id?c.id:!1,par:d&&d.id?d.id:!1})},!1)},last_error:function(){return this._data.core.last_error},move_node:function(c,d,e,f,g,h,i){var j,k,l,m,n,o,p,q,r,s,t,u,v,w;if(d=this.get_node(d),e=e===b?0:e,!d)return!1;if(!e.toString().match(/^(before|after)$/)&&!g&&!this.is_loaded(d))return this.load_node(d,function(){this.move_node(c,d,e,f,!0,!1,i)});if(a.isArray(c)){if(1!==c.length){for(j=0,k=c.length;k>j;j++)(r=this.move_node(c[j],d,e,f,g,!1,i))&&(d=r,e=\"after\");return this.redraw(),!0}c=c[0]}if(c=c&&c.id?c:this.get_node(c),!c||c.id===a.jstree.root)return!1;if(l=(c.parent||a.jstree.root).toString(),n=e.toString().match(/^(before|after)$/)&&d.id!==a.jstree.root?this.get_node(d.parent):d,o=i?i:this._model.data[c.id]?this:a.jstree.reference(c.id),p=!o||!o._id||this._id!==o._id,m=o&&o._id&&l&&o._model.data[l]&&o._model.data[l].children?a.inArray(c.id,o._model.data[l].children):-1,o&&o._id&&(c=o._model.data[c.id]),p)return(r=this.copy_node(c,d,e,f,g,!1,i))?(o&&o.delete_node(c),r):!1;switch(d.id===a.jstree.root&&(\"before\"===e&&(e=\"first\"),\"after\"===e&&(e=\"last\")),e){case\"before\":e=a.inArray(d.id,n.children);break;case\"after\":e=a.inArray(d.id,n.children)+1;break;case\"inside\":case\"first\":e=0;break;case\"last\":e=n.children.length;break;default:e||(e=0)}if(e>n.children.length&&(e=n.children.length),!this.check(\"move_node\",c,n,e,{core:!0,origin:i,is_multi:o&&o._id&&o._id!==this._id,is_foreign:!o||!o._id}))return this.settings.core.error.call(this,this._data.core.last_error),!1;if(c.parent===n.id){for(q=n.children.concat(),r=a.inArray(c.id,q),-1!==r&&(q=a.vakata.array_remove(q,r),e>r&&e--),r=[],s=0,t=q.length;t>s;s++)r[s>=e?s+1:s]=q[s];r[e]=c.id,n.children=r,this._node_changed(n.id),this.redraw(n.id===a.jstree.root)}else{for(r=c.children_d.concat(),r.push(c.id),s=0,t=c.parents.length;t>s;s++){for(q=[],w=o._model.data[c.parents[s]].children_d,u=0,v=w.length;v>u;u++)-1===a.inArray(w[u],r)&&q.push(w[u]);o._model.data[c.parents[s]].children_d=q}for(o._model.data[l].children=a.vakata.array_remove_item(o._model.data[l].children,c.id),s=0,t=n.parents.length;t>s;s++)this._model.data[n.parents[s]].children_d=this._model.data[n.parents[s]].children_d.concat(r);for(q=[],s=0,t=n.children.length;t>s;s++)q[s>=e?s+1:s]=n.children[s];for(q[e]=c.id,n.children=q,n.children_d.push(c.id),n.children_d=n.children_d.concat(c.children_d),c.parent=n.id,r=n.parents.concat(),r.unshift(n.id),w=c.parents.length,c.parents=r,r=r.concat(),s=0,t=c.children_d.length;t>s;s++)this._model.data[c.children_d[s]].parents=this._model.data[c.children_d[s]].parents.slice(0,-1*w),Array.prototype.push.apply(this._model.data[c.children_d[s]].parents,r);l!==a.jstree.root&&n.id!==a.jstree.root||(this._model.force_full_redraw=!0),this._model.force_full_redraw||(this._node_changed(l),this._node_changed(n.id)),h||this.redraw()}return f&&f.call(this,c,n,e),this.trigger(\"move_node\",{node:c,parent:n.id,position:e,old_parent:l,old_position:m,is_multi:o&&o._id&&o._id!==this._id,is_foreign:!o||!o._id,old_instance:o,new_instance:this}),c.id},copy_node:function(c,d,e,f,g,h,i){var j,k,l,m,n,o,p,q,r,s,t;if(d=this.get_node(d),e=e===b?0:e,!d)return!1;if(!e.toString().match(/^(before|after)$/)&&!g&&!this.is_loaded(d))return this.load_node(d,function(){this.copy_node(c,d,e,f,!0,!1,i)});if(a.isArray(c)){if(1!==c.length){for(j=0,k=c.length;k>j;j++)(m=this.copy_node(c[j],d,e,f,g,!0,i))&&(d=m,e=\"after\");return this.redraw(),!0}c=c[0]}if(c=c&&c.id?c:this.get_node(c),!c||c.id===a.jstree.root)return!1;switch(q=(c.parent||a.jstree.root).toString(),r=e.toString().match(/^(before|after)$/)&&d.id!==a.jstree.root?this.get_node(d.parent):d,s=i?i:this._model.data[c.id]?this:a.jstree.reference(c.id),t=!s||!s._id||this._id!==s._id,s&&s._id&&(c=s._model.data[c.id]),d.id===a.jstree.root&&(\"before\"===e&&(e=\"first\"),\"after\"===e&&(e=\"last\")),e){case\"before\":e=a.inArray(d.id,r.children);break;case\"after\":e=a.inArray(d.id,r.children)+1;break;case\"inside\":case\"first\":e=0;break;case\"last\":e=r.children.length;break;default:e||(e=0)}if(e>r.children.length&&(e=r.children.length),!this.check(\"copy_node\",c,r,e,{core:!0,origin:i,is_multi:s&&s._id&&s._id!==this._id,is_foreign:!s||!s._id}))return this.settings.core.error.call(this,this._data.core.last_error),!1;if(p=s?s.get_json(c,{no_id:!0,no_data:!0,no_state:!0}):c,!p)return!1;if(p.id===!0&&delete p.id,p=this._parse_model_from_json(p,r.id,r.parents.concat()),!p)return!1;for(m=this.get_node(p),c&&c.state&&c.state.loaded===!1&&(m.state.loaded=!1),l=[],l.push(p),l=l.concat(m.children_d),this.trigger(\"model\",{nodes:l,parent:r.id}),n=0,o=r.parents.length;o>n;n++)this._model.data[r.parents[n]].children_d=this._model.data[r.parents[n]].children_d.concat(l);for(l=[],n=0,o=r.children.length;o>n;n++)l[n>=e?n+1:n]=r.children[n];return l[e]=m.id,r.children=l,r.children_d.push(m.id),r.children_d=r.children_d.concat(m.children_d),r.id===a.jstree.root&&(this._model.force_full_redraw=!0),this._model.force_full_redraw||this._node_changed(r.id),h||this.redraw(r.id===a.jstree.root),f&&f.call(this,m,r,e),this.trigger(\"copy_node\",{node:m,original:c,parent:r.id,position:e,old_parent:q,old_position:s&&s._id&&q&&s._model.data[q]&&s._model.data[q].children?a.inArray(c.id,s._model.data[q].children):-1,is_multi:s&&s._id&&s._id!==this._id,is_foreign:!s||!s._id,old_instance:s,new_instance:this}),m.id},cut:function(b){if(b||(b=this._data.core.selected.concat()),a.isArray(b)||(b=[b]),!b.length)return!1;var c=[],g,h,i;for(h=0,i=b.length;i>h;h++)g=this.get_node(b[h]),g&&g.id&&g.id!==a.jstree.root&&c.push(g);return c.length?(d=c,f=this,e=\"move_node\",void this.trigger(\"cut\",{node:b})):!1},copy:function(b){if(b||(b=this._data.core.selected.concat()),a.isArray(b)||(b=[b]),!b.length)return!1;var c=[],g,h,i;for(h=0,i=b.length;i>h;h++)g=this.get_node(b[h]),g&&g.id&&g.id!==a.jstree.root&&c.push(g);return c.length?(d=c,f=this,e=\"copy_node\",void this.trigger(\"copy\",{node:b})):!1},get_buffer:function(){return{mode:e,node:d,inst:f}},can_paste:function(){return e!==!1&&d!==!1},paste:function(a,b){return a=this.get_node(a),a&&e&&e.match(/^(copy_node|move_node)$/)&&d?(this[e](d,a,b,!1,!1,!1,f)&&this.trigger(\"paste\",{parent:a.id,node:d,mode:e}),d=!1,e=!1,void(f=!1)):!1},clear_buffer:function(){d=!1,e=!1,f=!1,this.trigger(\"clear_buffer\")},edit:function(b,c,d){var e,f,g,h,j,k,l,m,n,o=!1;return(b=this.get_node(b))?this.settings.core.check_callback===!1?(this._data.core.last_error={error:\"check\",plugin:\"core\",id:\"core_07\",reason:\"Could not edit node because of check_callback\"},this.settings.core.error.call(this,this._data.core.last_error),!1):(n=b,c=\"string\"==typeof c?c:b.text,this.set_text(b,\"\"),b=this._open_to(b),n.text=c,e=this._data.core.rtl,f=this.element.width(),this._data.core.focused=n.id,g=b.children(\".jstree-anchor\").focus(),h=a(\"<span>\"),j=c,k=a(\"<div />\",{css:{position:\"absolute\",top:\"-200px\",left:e?\"0px\":\"-1000px\",visibility:\"hidden\"}}).appendTo(\"body\"),l=a(\"<input />\",{value:j,\"class\":\"jstree-rename-input\",css:{padding:\"0\",border:\"1px solid silver\",\"box-sizing\":\"border-box\",display:\"inline-block\",height:this._data.core.li_height+\"px\",lineHeight:this._data.core.li_height+\"px\",width:\"150px\"},blur:a.proxy(function(c){c.stopImmediatePropagation(),c.preventDefault();var e=h.children(\".jstree-rename-input\"),f=e.val(),i=this.settings.core.force_text,m;\"\"===f&&(f=j),k.remove(),h.replaceWith(g),h.remove(),j=i?j:a(\"<div></div>\").append(a.parseHTML(j)).html(),this.set_text(b,j),m=!!this.rename_node(b,i?a(\"<div></div>\").text(f).text():a(\"<div></div>\").append(a.parseHTML(f)).html()),m||this.set_text(b,j),this._data.core.focused=n.id,setTimeout(a.proxy(function(){var a=this.get_node(n.id,!0);a.length&&(this._data.core.focused=n.id,a.children(\".jstree-anchor\").focus())},this),0),d&&d.call(this,n,m,o),l=null},this),keydown:function(a){var b=a.which;27===b&&(o=!0,this.value=j),27!==b&&13!==b&&37!==b&&38!==b&&39!==b&&40!==b&&32!==b||a.stopImmediatePropagation(),27!==b&&13!==b||(a.preventDefault(),this.blur())},click:function(a){a.stopImmediatePropagation()},mousedown:function(a){a.stopImmediatePropagation()},keyup:function(a){l.width(Math.min(k.text(\"pW\"+this.value).width(),f))},keypress:function(a){return 13===a.which?!1:void 0}}),m={fontFamily:g.css(\"fontFamily\")||\"\",fontSize:g.css(\"fontSize\")||\"\",fontWeight:g.css(\"fontWeight\")||\"\",fontStyle:g.css(\"fontStyle\")||\"\",fontStretch:g.css(\"fontStretch\")||\"\",fontVariant:g.css(\"fontVariant\")||\"\",letterSpacing:g.css(\"letterSpacing\")||\"\",wordSpacing:g.css(\"wordSpacing\")||\"\"},h.attr(\"class\",g.attr(\"class\")).append(g.contents().clone()).append(l),g.replaceWith(h),k.css(m),l.css(m).width(Math.min(k.text(\"pW\"+l[0].value).width(),f))[0].select(),void a(i).one(\"mousedown.jstree touchstart.jstree dnd_start.vakata\",function(b){\nl&&b.target!==l&&a(l).blur()})):!1},set_theme:function(b,c){if(!b)return!1;if(c===!0){var d=this.settings.core.themes.dir;d||(d=a.jstree.path+\"/themes\"),c=d+\"/\"+b+\"/style.css\"}c&&-1===a.inArray(c,g)&&(a(\"head\").append('<link rel=\"stylesheet\" href=\"'+c+'\" type=\"text/css\" />'),g.push(c)),this._data.core.themes.name&&this.element.removeClass(\"jstree-\"+this._data.core.themes.name),this._data.core.themes.name=b,this.element.addClass(\"jstree-\"+b),this.element[this.settings.core.themes.responsive?\"addClass\":\"removeClass\"](\"jstree-\"+b+\"-responsive\"),this.trigger(\"set_theme\",{theme:b})},get_theme:function(){return this._data.core.themes.name},set_theme_variant:function(a){this._data.core.themes.variant&&this.element.removeClass(\"jstree-\"+this._data.core.themes.name+\"-\"+this._data.core.themes.variant),this._data.core.themes.variant=a,a&&this.element.addClass(\"jstree-\"+this._data.core.themes.name+\"-\"+this._data.core.themes.variant)},get_theme_variant:function(){return this._data.core.themes.variant},show_stripes:function(){this._data.core.themes.stripes=!0,this.get_container_ul().addClass(\"jstree-striped\")},hide_stripes:function(){this._data.core.themes.stripes=!1,this.get_container_ul().removeClass(\"jstree-striped\")},toggle_stripes:function(){this._data.core.themes.stripes?this.hide_stripes():this.show_stripes()},show_dots:function(){this._data.core.themes.dots=!0,this.get_container_ul().removeClass(\"jstree-no-dots\")},hide_dots:function(){this._data.core.themes.dots=!1,this.get_container_ul().addClass(\"jstree-no-dots\")},toggle_dots:function(){this._data.core.themes.dots?this.hide_dots():this.show_dots()},show_icons:function(){this._data.core.themes.icons=!0,this.get_container_ul().removeClass(\"jstree-no-icons\")},hide_icons:function(){this._data.core.themes.icons=!1,this.get_container_ul().addClass(\"jstree-no-icons\")},toggle_icons:function(){this._data.core.themes.icons?this.hide_icons():this.show_icons()},set_icon:function(c,d){var e,f,g,h;if(a.isArray(c)){for(c=c.slice(),e=0,f=c.length;f>e;e++)this.set_icon(c[e],d);return!0}return c=this.get_node(c),c&&c.id!==a.jstree.root?(h=c.icon,c.icon=d===!0||null===d||d===b||\"\"===d?!0:d,g=this.get_node(c,!0).children(\".jstree-anchor\").children(\".jstree-themeicon\"),d===!1?this.hide_icon(c):d===!0||null===d||d===b||\"\"===d?(g.removeClass(\"jstree-themeicon-custom \"+h).css(\"background\",\"\").removeAttr(\"rel\"),h===!1&&this.show_icon(c)):-1===d.indexOf(\"/\")&&-1===d.indexOf(\".\")?(g.removeClass(h).css(\"background\",\"\"),g.addClass(d+\" jstree-themeicon-custom\").attr(\"rel\",d),h===!1&&this.show_icon(c)):(g.removeClass(h).css(\"background\",\"\"),g.addClass(\"jstree-themeicon-custom\").css(\"background\",\"url('\"+d+\"') center center no-repeat\").attr(\"rel\",d),h===!1&&this.show_icon(c)),!0):!1},get_icon:function(b){return b=this.get_node(b),b&&b.id!==a.jstree.root?b.icon:!1},hide_icon:function(b){var c,d;if(a.isArray(b)){for(b=b.slice(),c=0,d=b.length;d>c;c++)this.hide_icon(b[c]);return!0}return b=this.get_node(b),b&&b!==a.jstree.root?(b.icon=!1,this.get_node(b,!0).children(\".jstree-anchor\").children(\".jstree-themeicon\").addClass(\"jstree-themeicon-hidden\"),!0):!1},show_icon:function(b){var c,d,e;if(a.isArray(b)){for(b=b.slice(),c=0,d=b.length;d>c;c++)this.show_icon(b[c]);return!0}return b=this.get_node(b),b&&b!==a.jstree.root?(e=this.get_node(b,!0),b.icon=e.length?e.children(\".jstree-anchor\").children(\".jstree-themeicon\").attr(\"rel\"):!0,b.icon||(b.icon=!0),e.children(\".jstree-anchor\").children(\".jstree-themeicon\").removeClass(\"jstree-themeicon-hidden\"),!0):!1}},a.vakata={},a.vakata.attributes=function(b,c){b=a(b)[0];var d=c?{}:[];return b&&b.attributes&&a.each(b.attributes,function(b,e){-1===a.inArray(e.name.toLowerCase(),[\"style\",\"contenteditable\",\"hasfocus\",\"tabindex\"])&&null!==e.value&&\"\"!==a.trim(e.value)&&(c?d[e.name]=e.value:d.push(e.name))}),d},a.vakata.array_unique=function(a){var c=[],d,e,f,g={};for(d=0,f=a.length;f>d;d++)g[a[d]]===b&&(c.push(a[d]),g[a[d]]=!0);return c},a.vakata.array_remove=function(a,b){return a.splice(b,1),a},a.vakata.array_remove_item=function(b,c){var d=a.inArray(c,b);return-1!==d?a.vakata.array_remove(b,d):b},a.vakata.array_filter=function(a,b,c,d,e){if(a.filter)return a.filter(b,c);d=[];for(e in a)~~e+\"\"==e+\"\"&&e>=0&&b.call(c,a[e],+e,a)&&d.push(a[e]);return d},a.jstree.plugins.changed=function(a,b){var c=[];this.trigger=function(a,d){var e,f;if(d||(d={}),\"changed\"===a.replace(\".jstree\",\"\")){d.changed={selected:[],deselected:[]};var g={};for(e=0,f=c.length;f>e;e++)g[c[e]]=1;for(e=0,f=d.selected.length;f>e;e++)g[d.selected[e]]?g[d.selected[e]]=2:d.changed.selected.push(d.selected[e]);for(e=0,f=c.length;f>e;e++)1===g[c[e]]&&d.changed.deselected.push(c[e]);c=d.selected.slice()}b.trigger.call(this,a,d)},this.refresh=function(a,d){return c=[],b.refresh.apply(this,arguments)}};var m=i.createElement(\"I\");m.className=\"jstree-icon jstree-checkbox\",m.setAttribute(\"role\",\"presentation\"),a.jstree.defaults.checkbox={visible:!0,three_state:!0,whole_node:!0,keep_selected_style:!0,cascade:\"\",tie_selection:!0},a.jstree.plugins.checkbox=function(c,d){this.bind=function(){d.bind.call(this),this._data.checkbox.uto=!1,this._data.checkbox.selected=[],this.settings.checkbox.three_state&&(this.settings.checkbox.cascade=\"up+down+undetermined\"),this.element.on(\"init.jstree\",a.proxy(function(){this._data.checkbox.visible=this.settings.checkbox.visible,this.settings.checkbox.keep_selected_style||this.element.addClass(\"jstree-checkbox-no-clicked\"),this.settings.checkbox.tie_selection&&this.element.addClass(\"jstree-checkbox-selection\")},this)).on(\"loading.jstree\",a.proxy(function(){this[this._data.checkbox.visible?\"show_checkboxes\":\"hide_checkboxes\"]()},this)),-1!==this.settings.checkbox.cascade.indexOf(\"undetermined\")&&this.element.on(\"changed.jstree uncheck_node.jstree check_node.jstree uncheck_all.jstree check_all.jstree move_node.jstree copy_node.jstree redraw.jstree open_node.jstree\",a.proxy(function(){this._data.checkbox.uto&&clearTimeout(this._data.checkbox.uto),this._data.checkbox.uto=setTimeout(a.proxy(this._undetermined,this),50)},this)),this.settings.checkbox.tie_selection||this.element.on(\"model.jstree\",a.proxy(function(a,b){var c=this._model.data,d=c[b.parent],e=b.nodes,f,g;for(f=0,g=e.length;g>f;f++)c[e[f]].state.checked=c[e[f]].state.checked||c[e[f]].original&&c[e[f]].original.state&&c[e[f]].original.state.checked,c[e[f]].state.checked&&this._data.checkbox.selected.push(e[f])},this)),-1===this.settings.checkbox.cascade.indexOf(\"up\")&&-1===this.settings.checkbox.cascade.indexOf(\"down\")||this.element.on(\"model.jstree\",a.proxy(function(b,c){var d=this._model.data,e=d[c.parent],f=c.nodes,g=[],h,i,j,k,l,m,n=this.settings.checkbox.cascade,o=this.settings.checkbox.tie_selection;if(-1!==n.indexOf(\"down\"))if(e.state[o?\"selected\":\"checked\"]){for(i=0,j=f.length;j>i;i++)d[f[i]].state[o?\"selected\":\"checked\"]=!0;this._data[o?\"core\":\"checkbox\"].selected=this._data[o?\"core\":\"checkbox\"].selected.concat(f)}else for(i=0,j=f.length;j>i;i++)if(d[f[i]].state[o?\"selected\":\"checked\"]){for(k=0,l=d[f[i]].children_d.length;l>k;k++)d[d[f[i]].children_d[k]].state[o?\"selected\":\"checked\"]=!0;this._data[o?\"core\":\"checkbox\"].selected=this._data[o?\"core\":\"checkbox\"].selected.concat(d[f[i]].children_d)}if(-1!==n.indexOf(\"up\")){for(i=0,j=e.children_d.length;j>i;i++)d[e.children_d[i]].children.length||g.push(d[e.children_d[i]].parent);for(g=a.vakata.array_unique(g),k=0,l=g.length;l>k;k++){e=d[g[k]];while(e&&e.id!==a.jstree.root){for(h=0,i=0,j=e.children.length;j>i;i++)h+=d[e.children[i]].state[o?\"selected\":\"checked\"];if(h!==j)break;e.state[o?\"selected\":\"checked\"]=!0,this._data[o?\"core\":\"checkbox\"].selected.push(e.id),m=this.get_node(e,!0),m&&m.length&&m.attr(\"aria-selected\",!0).children(\".jstree-anchor\").addClass(o?\"jstree-clicked\":\"jstree-checked\"),e=this.get_node(e.parent)}}}this._data[o?\"core\":\"checkbox\"].selected=a.vakata.array_unique(this._data[o?\"core\":\"checkbox\"].selected)},this)).on(this.settings.checkbox.tie_selection?\"select_node.jstree\":\"check_node.jstree\",a.proxy(function(b,c){var d=c.node,e=this._model.data,f=this.get_node(d.parent),g=this.get_node(d,!0),h,i,j,k,l=this.settings.checkbox.cascade,m=this.settings.checkbox.tie_selection,n={},o=this._data[m?\"core\":\"checkbox\"].selected;for(h=0,i=o.length;i>h;h++)n[o[h]]=!0;if(-1!==l.indexOf(\"down\"))for(h=0,i=d.children_d.length;i>h;h++)n[d.children_d[h]]=!0,k=e[d.children_d[h]],k.state[m?\"selected\":\"checked\"]=!0,k&&k.original&&k.original.state&&k.original.state.undetermined&&(k.original.state.undetermined=!1);if(-1!==l.indexOf(\"up\"))while(f&&f.id!==a.jstree.root){for(j=0,h=0,i=f.children.length;i>h;h++)j+=e[f.children[h]].state[m?\"selected\":\"checked\"];if(j!==i)break;f.state[m?\"selected\":\"checked\"]=!0,n[f.id]=!0,k=this.get_node(f,!0),k&&k.length&&k.attr(\"aria-selected\",!0).children(\".jstree-anchor\").addClass(m?\"jstree-clicked\":\"jstree-checked\"),f=this.get_node(f.parent)}o=[];for(h in n)n.hasOwnProperty(h)&&o.push(h);this._data[m?\"core\":\"checkbox\"].selected=o,-1!==l.indexOf(\"down\")&&g.length&&g.find(\".jstree-anchor\").addClass(m?\"jstree-clicked\":\"jstree-checked\").parent().attr(\"aria-selected\",!0)},this)).on(this.settings.checkbox.tie_selection?\"deselect_all.jstree\":\"uncheck_all.jstree\",a.proxy(function(b,c){var d=this.get_node(a.jstree.root),e=this._model.data,f,g,h;for(f=0,g=d.children_d.length;g>f;f++)h=e[d.children_d[f]],h&&h.original&&h.original.state&&h.original.state.undetermined&&(h.original.state.undetermined=!1)},this)).on(this.settings.checkbox.tie_selection?\"deselect_node.jstree\":\"uncheck_node.jstree\",a.proxy(function(b,c){var d=c.node,e=this.get_node(d,!0),f,g,h,i=this.settings.checkbox.cascade,j=this.settings.checkbox.tie_selection,k=this._data[j?\"core\":\"checkbox\"].selected,l={};if(d&&d.original&&d.original.state&&d.original.state.undetermined&&(d.original.state.undetermined=!1),-1!==i.indexOf(\"down\"))for(f=0,g=d.children_d.length;g>f;f++)h=this._model.data[d.children_d[f]],h.state[j?\"selected\":\"checked\"]=!1,h&&h.original&&h.original.state&&h.original.state.undetermined&&(h.original.state.undetermined=!1);if(-1!==i.indexOf(\"up\"))for(f=0,g=d.parents.length;g>f;f++)h=this._model.data[d.parents[f]],h.state[j?\"selected\":\"checked\"]=!1,h&&h.original&&h.original.state&&h.original.state.undetermined&&(h.original.state.undetermined=!1),h=this.get_node(d.parents[f],!0),h&&h.length&&h.attr(\"aria-selected\",!1).children(\".jstree-anchor\").removeClass(j?\"jstree-clicked\":\"jstree-checked\");for(l={},f=0,g=k.length;g>f;f++)-1!==i.indexOf(\"down\")&&-1!==a.inArray(k[f],d.children_d)||-1!==i.indexOf(\"up\")&&-1!==a.inArray(k[f],d.parents)||(l[k[f]]=!0);k=[];for(f in l)l.hasOwnProperty(f)&&k.push(f);this._data[j?\"core\":\"checkbox\"].selected=k,-1!==i.indexOf(\"down\")&&e.length&&e.find(\".jstree-anchor\").removeClass(j?\"jstree-clicked\":\"jstree-checked\").parent().attr(\"aria-selected\",!1)},this)),-1!==this.settings.checkbox.cascade.indexOf(\"up\")&&this.element.on(\"delete_node.jstree\",a.proxy(function(b,c){var d=this.get_node(c.parent),e=this._model.data,f,g,h,i,j=this.settings.checkbox.tie_selection;while(d&&d.id!==a.jstree.root&&!d.state[j?\"selected\":\"checked\"]){for(h=0,f=0,g=d.children.length;g>f;f++)h+=e[d.children[f]].state[j?\"selected\":\"checked\"];if(!(g>0&&h===g))break;d.state[j?\"selected\":\"checked\"]=!0,this._data[j?\"core\":\"checkbox\"].selected.push(d.id),i=this.get_node(d,!0),i&&i.length&&i.attr(\"aria-selected\",!0).children(\".jstree-anchor\").addClass(j?\"jstree-clicked\":\"jstree-checked\"),d=this.get_node(d.parent)}},this)).on(\"move_node.jstree\",a.proxy(function(b,c){var d=c.is_multi,e=c.old_parent,f=this.get_node(c.parent),g=this._model.data,h,i,j,k,l,m=this.settings.checkbox.tie_selection;if(!d){h=this.get_node(e);while(h&&h.id!==a.jstree.root&&!h.state[m?\"selected\":\"checked\"]){for(i=0,j=0,k=h.children.length;k>j;j++)i+=g[h.children[j]].state[m?\"selected\":\"checked\"];if(!(k>0&&i===k))break;h.state[m?\"selected\":\"checked\"]=!0,this._data[m?\"core\":\"checkbox\"].selected.push(h.id),l=this.get_node(h,!0),l&&l.length&&l.attr(\"aria-selected\",!0).children(\".jstree-anchor\").addClass(m?\"jstree-clicked\":\"jstree-checked\"),h=this.get_node(h.parent)}}h=f;while(h&&h.id!==a.jstree.root){for(i=0,j=0,k=h.children.length;k>j;j++)i+=g[h.children[j]].state[m?\"selected\":\"checked\"];if(i===k)h.state[m?\"selected\":\"checked\"]||(h.state[m?\"selected\":\"checked\"]=!0,this._data[m?\"core\":\"checkbox\"].selected.push(h.id),l=this.get_node(h,!0),l&&l.length&&l.attr(\"aria-selected\",!0).children(\".jstree-anchor\").addClass(m?\"jstree-clicked\":\"jstree-checked\"));else{if(!h.state[m?\"selected\":\"checked\"])break;h.state[m?\"selected\":\"checked\"]=!1,this._data[m?\"core\":\"checkbox\"].selected=a.vakata.array_remove_item(this._data[m?\"core\":\"checkbox\"].selected,h.id),l=this.get_node(h,!0),l&&l.length&&l.attr(\"aria-selected\",!1).children(\".jstree-anchor\").removeClass(m?\"jstree-clicked\":\"jstree-checked\")}h=this.get_node(h.parent)}},this))},this._undetermined=function(){if(null!==this.element){var c,d,e,f,g={},h=this._model.data,i=this.settings.checkbox.tie_selection,j=this._data[i?\"core\":\"checkbox\"].selected,k=[],l=this;for(c=0,d=j.length;d>c;c++)if(h[j[c]]&&h[j[c]].parents)for(e=0,f=h[j[c]].parents.length;f>e;e++){if(g[h[j[c]].parents[e]]!==b)break;h[j[c]].parents[e]!==a.jstree.root&&(g[h[j[c]].parents[e]]=!0,k.push(h[j[c]].parents[e]))}for(this.element.find(\".jstree-closed\").not(\":has(.jstree-children)\").each(function(){var i=l.get_node(this),j;if(i.state.loaded){for(c=0,d=i.children_d.length;d>c;c++)if(j=h[i.children_d[c]],!j.state.loaded&&j.original&&j.original.state&&j.original.state.undetermined&&j.original.state.undetermined===!0)for(g[j.id]===b&&j.id!==a.jstree.root&&(g[j.id]=!0,k.push(j.id)),e=0,f=j.parents.length;f>e;e++)g[j.parents[e]]===b&&j.parents[e]!==a.jstree.root&&(g[j.parents[e]]=!0,k.push(j.parents[e]))}else if(i.original&&i.original.state&&i.original.state.undetermined&&i.original.state.undetermined===!0)for(g[i.id]===b&&i.id!==a.jstree.root&&(g[i.id]=!0,k.push(i.id)),e=0,f=i.parents.length;f>e;e++)g[i.parents[e]]===b&&i.parents[e]!==a.jstree.root&&(g[i.parents[e]]=!0,k.push(i.parents[e]))}),this.element.find(\".jstree-undetermined\").removeClass(\"jstree-undetermined\"),c=0,d=k.length;d>c;c++)h[k[c]].state[i?\"selected\":\"checked\"]||(j=this.get_node(k[c],!0),j&&j.length&&j.children(\".jstree-anchor\").children(\".jstree-checkbox\").addClass(\"jstree-undetermined\"))}},this.redraw_node=function(b,c,e,f){if(b=d.redraw_node.apply(this,arguments)){var g,h,i=null,j=null;for(g=0,h=b.childNodes.length;h>g;g++)if(b.childNodes[g]&&b.childNodes[g].className&&-1!==b.childNodes[g].className.indexOf(\"jstree-anchor\")){i=b.childNodes[g];break}i&&(!this.settings.checkbox.tie_selection&&this._model.data[b.id].state.checked&&(i.className+=\" jstree-checked\"),j=m.cloneNode(!1),this._model.data[b.id].state.checkbox_disabled&&(j.className+=\" jstree-checkbox-disabled\"),i.insertBefore(j,i.childNodes[0]))}return e||-1===this.settings.checkbox.cascade.indexOf(\"undetermined\")||(this._data.checkbox.uto&&clearTimeout(this._data.checkbox.uto),this._data.checkbox.uto=setTimeout(a.proxy(this._undetermined,this),50)),b},this.show_checkboxes=function(){this._data.core.themes.checkboxes=!0,this.get_container_ul().removeClass(\"jstree-no-checkboxes\")},this.hide_checkboxes=function(){this._data.core.themes.checkboxes=!1,this.get_container_ul().addClass(\"jstree-no-checkboxes\")},this.toggle_checkboxes=function(){this._data.core.themes.checkboxes?this.hide_checkboxes():this.show_checkboxes()},this.is_undetermined=function(b){b=this.get_node(b);var c=this.settings.checkbox.cascade,d,e,f=this.settings.checkbox.tie_selection,g=this._data[f?\"core\":\"checkbox\"].selected,h=this._model.data;if(!b||b.state[f?\"selected\":\"checked\"]===!0||-1===c.indexOf(\"undetermined\")||-1===c.indexOf(\"down\")&&-1===c.indexOf(\"up\"))return!1;if(!b.state.loaded&&b.original.state.undetermined===!0)return!0;for(d=0,e=b.children_d.length;e>d;d++)if(-1!==a.inArray(b.children_d[d],g)||!h[b.children_d[d]].state.loaded&&h[b.children_d[d]].original.state.undetermined)return!0;return!1},this.disable_checkbox=function(b){var c,d,e;if(a.isArray(b)){for(b=b.slice(),c=0,d=b.length;d>c;c++)this.disable_checkbox(b[c]);return!0}return b=this.get_node(b),b&&b.id!==a.jstree.root?(e=this.get_node(b,!0),void(b.state.checkbox_disabled||(b.state.checkbox_disabled=!0,e&&e.length&&e.children(\".jstree-anchor\").children(\".jstree-checkbox\").addClass(\"jstree-checkbox-disabled\"),this.trigger(\"disable_checkbox\",{node:b})))):!1},this.enable_checkbox=function(b){var c,d,e;if(a.isArray(b)){for(b=b.slice(),c=0,d=b.length;d>c;c++)this.enable_checkbox(b[c]);return!0}return b=this.get_node(b),b&&b.id!==a.jstree.root?(e=this.get_node(b,!0),void(b.state.checkbox_disabled&&(b.state.checkbox_disabled=!1,e&&e.length&&e.children(\".jstree-anchor\").children(\".jstree-checkbox\").removeClass(\"jstree-checkbox-disabled\"),this.trigger(\"enable_checkbox\",{node:b})))):!1},this.activate_node=function(b,c){return a(c.target).hasClass(\"jstree-checkbox-disabled\")?!1:(this.settings.checkbox.tie_selection&&(this.settings.checkbox.whole_node||a(c.target).hasClass(\"jstree-checkbox\"))&&(c.ctrlKey=!0),this.settings.checkbox.tie_selection||!this.settings.checkbox.whole_node&&!a(c.target).hasClass(\"jstree-checkbox\")?d.activate_node.call(this,b,c):this.is_disabled(b)?!1:(this.is_checked(b)?this.uncheck_node(b,c):this.check_node(b,c),void this.trigger(\"activate_node\",{node:this.get_node(b)})))},this.check_node=function(b,c){if(this.settings.checkbox.tie_selection)return this.select_node(b,!1,!0,c);var d,e,f,g;if(a.isArray(b)){for(b=b.slice(),e=0,f=b.length;f>e;e++)this.check_node(b[e],c);return!0}return b=this.get_node(b),b&&b.id!==a.jstree.root?(d=this.get_node(b,!0),void(b.state.checked||(b.state.checked=!0,this._data.checkbox.selected.push(b.id),d&&d.length&&d.children(\".jstree-anchor\").addClass(\"jstree-checked\"),this.trigger(\"check_node\",{node:b,selected:this._data.checkbox.selected,event:c})))):!1},this.uncheck_node=function(b,c){if(this.settings.checkbox.tie_selection)return this.deselect_node(b,!1,c);var d,e,f;if(a.isArray(b)){for(b=b.slice(),d=0,e=b.length;e>d;d++)this.uncheck_node(b[d],c);return!0}return b=this.get_node(b),b&&b.id!==a.jstree.root?(f=this.get_node(b,!0),void(b.state.checked&&(b.state.checked=!1,this._data.checkbox.selected=a.vakata.array_remove_item(this._data.checkbox.selected,b.id),f.length&&f.children(\".jstree-anchor\").removeClass(\"jstree-checked\"),this.trigger(\"uncheck_node\",{node:b,selected:this._data.checkbox.selected,event:c})))):!1},this.check_all=function(){if(this.settings.checkbox.tie_selection)return this.select_all();var b=this._data.checkbox.selected.concat([]),c,d;for(this._data.checkbox.selected=this._model.data[a.jstree.root].children_d.concat(),c=0,d=this._data.checkbox.selected.length;d>c;c++)this._model.data[this._data.checkbox.selected[c]]&&(this._model.data[this._data.checkbox.selected[c]].state.checked=!0);this.redraw(!0),this.trigger(\"check_all\",{selected:this._data.checkbox.selected})},this.uncheck_all=function(){if(this.settings.checkbox.tie_selection)return this.deselect_all();var a=this._data.checkbox.selected.concat([]),b,c;for(b=0,c=this._data.checkbox.selected.length;c>b;b++)this._model.data[this._data.checkbox.selected[b]]&&(this._model.data[this._data.checkbox.selected[b]].state.checked=!1);this._data.checkbox.selected=[],this.element.find(\".jstree-checked\").removeClass(\"jstree-checked\"),this.trigger(\"uncheck_all\",{selected:this._data.checkbox.selected,node:a})},this.is_checked=function(b){return this.settings.checkbox.tie_selection?this.is_selected(b):(b=this.get_node(b),b&&b.id!==a.jstree.root?b.state.checked:!1)},this.get_checked=function(b){return this.settings.checkbox.tie_selection?this.get_selected(b):b?a.map(this._data.checkbox.selected,a.proxy(function(a){return this.get_node(a)},this)):this._data.checkbox.selected},this.get_top_checked=function(b){if(this.settings.checkbox.tie_selection)return this.get_top_selected(b);var c=this.get_checked(!0),d={},e,f,g,h;for(e=0,f=c.length;f>e;e++)d[c[e].id]=c[e];for(e=0,f=c.length;f>e;e++)for(g=0,h=c[e].children_d.length;h>g;g++)d[c[e].children_d[g]]&&delete d[c[e].children_d[g]];c=[];for(e in d)d.hasOwnProperty(e)&&c.push(e);return b?a.map(c,a.proxy(function(a){return this.get_node(a)},this)):c},this.get_bottom_checked=function(b){if(this.settings.checkbox.tie_selection)return this.get_bottom_selected(b);var c=this.get_checked(!0),d=[],e,f;for(e=0,f=c.length;f>e;e++)c[e].children.length||d.push(c[e].id);return b?a.map(d,a.proxy(function(a){return this.get_node(a)},this)):d},this.load_node=function(b,c){var e,f,g,h,i,j;if(!a.isArray(b)&&!this.settings.checkbox.tie_selection&&(j=this.get_node(b),j&&j.state.loaded))for(e=0,f=j.children_d.length;f>e;e++)this._model.data[j.children_d[e]].state.checked&&(i=!0,this._data.checkbox.selected=a.vakata.array_remove_item(this._data.checkbox.selected,j.children_d[e]));return d.load_node.apply(this,arguments)},this.get_state=function(){var a=d.get_state.apply(this,arguments);return this.settings.checkbox.tie_selection?a:(a.checkbox=this._data.checkbox.selected.slice(),a)},this.set_state=function(b,c){var e=d.set_state.apply(this,arguments);if(e&&b.checkbox){if(!this.settings.checkbox.tie_selection){this.uncheck_all();var f=this;a.each(b.checkbox,function(a,b){f.check_node(b)})}return delete b.checkbox,this.set_state(b,c),!1}return e},this.refresh=function(a,b){return this.settings.checkbox.tie_selection||(this._data.checkbox.selected=[]),d.refresh.apply(this,arguments)}},a.jstree.defaults.conditionalselect=function(){return!0},a.jstree.plugins.conditionalselect=function(a,b){this.activate_node=function(a,c){this.settings.conditionalselect.call(this,this.get_node(a),c)&&b.activate_node.call(this,a,c)}},a.jstree.defaults.contextmenu={select_node:!0,show_at_node:!0,items:function(b,c){return{create:{separator_before:!1,separator_after:!0,_disabled:!1,label:\"Create\",action:function(b){var c=a.jstree.reference(b.reference),d=c.get_node(b.reference);c.create_node(d,{},\"last\",function(a){setTimeout(function(){c.edit(a)},0)})}},rename:{separator_before:!1,separator_after:!1,_disabled:!1,label:\"Rename\",action:function(b){var c=a.jstree.reference(b.reference),d=c.get_node(b.reference);c.edit(d)}},remove:{separator_before:!1,icon:!1,separator_after:!1,_disabled:!1,label:\"Delete\",action:function(b){var c=a.jstree.reference(b.reference),d=c.get_node(b.reference);c.is_selected(d)?c.delete_node(c.get_selected()):c.delete_node(d)}},ccp:{separator_before:!0,icon:!1,separator_after:!1,label:\"Edit\",action:!1,submenu:{cut:{separator_before:!1,separator_after:!1,label:\"Cut\",action:function(b){var c=a.jstree.reference(b.reference),d=c.get_node(b.reference);c.is_selected(d)?c.cut(c.get_top_selected()):c.cut(d)}},copy:{separator_before:!1,icon:!1,separator_after:!1,label:\"Copy\",action:function(b){var c=a.jstree.reference(b.reference),d=c.get_node(b.reference);c.is_selected(d)?c.copy(c.get_top_selected()):c.copy(d)}},paste:{separator_before:!1,icon:!1,_disabled:function(b){return!a.jstree.reference(b.reference).can_paste()},separator_after:!1,label:\"Paste\",action:function(b){var c=a.jstree.reference(b.reference),d=c.get_node(b.reference);c.paste(d)}}}}}}},a.jstree.plugins.contextmenu=function(c,d){this.bind=function(){d.bind.call(this);var b=0,c=null,e,f;this.element.on(\"contextmenu.jstree\",\".jstree-anchor\",a.proxy(function(a,d){a.preventDefault(),b=a.ctrlKey?+new Date:0,(d||c)&&(b=+new Date+1e4),c&&clearTimeout(c),this.is_loading(a.currentTarget)||this.show_contextmenu(a.currentTarget,a.pageX,a.pageY,a)},this)).on(\"click.jstree\",\".jstree-anchor\",a.proxy(function(c){this._data.contextmenu.visible&&(!b||+new Date-b>250)&&a.vakata.context.hide(),b=0},this)).on(\"touchstart.jstree\",\".jstree-anchor\",function(b){b.originalEvent&&b.originalEvent.changedTouches&&b.originalEvent.changedTouches[0]&&(e=b.pageX,f=b.pageY,c=setTimeout(function(){a(b.currentTarget).trigger(\"contextmenu\",!0)},750))}).on(\"touchmove.vakata.jstree\",function(a){c&&a.originalEvent&&a.originalEvent.changedTouches&&a.originalEvent.changedTouches[0]&&(Math.abs(e-a.pageX)>50||Math.abs(f-a.pageY)>50)&&clearTimeout(c)}).on(\"touchend.vakata.jstree\",function(a){c&&clearTimeout(c)}),a(i).on(\"context_hide.vakata.jstree\",a.proxy(function(a,b){this._data.contextmenu.visible=!1,b.reference.removeClass(\"jstree-context\")},this))},this.teardown=function(){this._data.contextmenu.visible&&a.vakata.context.hide(),d.teardown.call(this)},this.show_contextmenu=function(c,d,e,f){if(c=this.get_node(c),!c||c.id===a.jstree.root)return!1;var g=this.settings.contextmenu,h=this.get_node(c,!0),i=h.children(\".jstree-anchor\"),j=!1,k=!1;(g.show_at_node||d===b||e===b)&&(j=i.offset(),d=j.left,e=j.top+this._data.core.li_height),this.settings.contextmenu.select_node&&!this.is_selected(c)&&this.activate_node(c,f),k=g.items,a.isFunction(k)&&(k=k.call(this,c,a.proxy(function(a){this._show_contextmenu(c,d,e,a)},this))),a.isPlainObject(k)&&this._show_contextmenu(c,d,e,k)},this._show_contextmenu=function(b,c,d,e){var f=this.get_node(b,!0),g=f.children(\".jstree-anchor\");a(i).one(\"context_show.vakata.jstree\",a.proxy(function(b,c){var d=\"jstree-contextmenu jstree-\"+this.get_theme()+\"-contextmenu\";a(c.element).addClass(d),g.addClass(\"jstree-context\")},this)),this._data.contextmenu.visible=!0,a.vakata.context.show(g,{x:c,y:d},e),this.trigger(\"show_contextmenu\",{node:b,x:c,y:d})}},function(a){var b=!1,c={element:!1,reference:!1,position_x:0,position_y:0,items:[],html:\"\",is_visible:!1};a.vakata.context={settings:{hide_onmouseleave:0,icons:!0},_trigger:function(b){a(i).triggerHandler(\"context_\"+b+\".vakata\",{reference:c.reference,element:c.element,position:{x:c.position_x,y:c.position_y}})},_execute:function(b){return b=c.items[b],b&&(!b._disabled||a.isFunction(b._disabled)&&!b._disabled({item:b,reference:c.reference,element:c.element}))&&b.action?b.action.call(null,{item:b,reference:c.reference,element:c.element,position:{x:c.position_x,y:c.position_y}}):!1},_parse:function(b,d){if(!b)return!1;d||(c.html=\"\",c.items=[]);var e=\"\",f=!1,g;return d&&(e+=\"<ul>\"),a.each(b,function(b,d){return d?(c.items.push(d),!f&&d.separator_before&&(e+=\"<li class='vakata-context-separator'><a href='#' \"+(a.vakata.context.settings.icons?\"\":'style=\"margin-left:0px;\"')+\">&#160;</a></li>\"),f=!1,e+=\"<li class='\"+(d._class||\"\")+(d._disabled===!0||a.isFunction(d._disabled)&&d._disabled({item:d,reference:c.reference,element:c.element})?\" vakata-contextmenu-disabled \":\"\")+\"' \"+(d.shortcut?\" data-shortcut='\"+d.shortcut+\"' \":\"\")+\">\",e+=\"<a href='#' rel='\"+(c.items.length-1)+\"'>\",a.vakata.context.settings.icons&&(e+=\"<i \",d.icon&&(e+=-1!==d.icon.indexOf(\"/\")||-1!==d.icon.indexOf(\".\")?\" style='background:url(\\\"\"+d.icon+\"\\\") center center no-repeat' \":\" class='\"+d.icon+\"' \"),e+=\"></i><span class='vakata-contextmenu-sep'>&#160;</span>\"),e+=(a.isFunction(d.label)?d.label({item:b,reference:c.reference,element:c.element}):d.label)+(d.shortcut?' <span class=\"vakata-contextmenu-shortcut vakata-contextmenu-shortcut-'+d.shortcut+'\">'+(d.shortcut_label||\"\")+\"</span>\":\"\")+\"</a>\",d.submenu&&(g=a.vakata.context._parse(d.submenu,!0),g&&(e+=g)),e+=\"</li>\",void(d.separator_after&&(e+=\"<li class='vakata-context-separator'><a href='#' \"+(a.vakata.context.settings.icons?\"\":'style=\"margin-left:0px;\"')+\">&#160;</a></li>\",f=!0))):!0}),e=e.replace(/<li class\\='vakata-context-separator'\\><\\/li\\>$/,\"\"),d&&(e+=\"</ul>\"),d||(c.html=e,a.vakata.context._trigger(\"parse\")),e.length>10?e:!1},_show_submenu:function(c){if(c=a(c),c.length&&c.children(\"ul\").length){var d=c.children(\"ul\"),e=c.offset().left,f=e+c.outerWidth(),g=c.offset().top,h=d.width(),i=d.height(),j=a(window).width()+a(window).scrollLeft(),k=a(window).height()+a(window).scrollTop();b?c[f-(h+10+c.outerWidth())<0?\"addClass\":\"removeClass\"](\"vakata-context-left\"):c[f+h>j&&e>j-f?\"addClass\":\"removeClass\"](\"vakata-context-right\"),g+i+10>k&&d.css(\"bottom\",\"-1px\"),c.hasClass(\"vakata-context-right\")?h>e&&d.css(\"margin-right\",e-h):h>j-f&&d.css(\"margin-left\",j-f-h),d.show()}},show:function(d,e,f){var g,h,i,j,k,l,m,n,o=!0;switch(c.element&&c.element.length&&c.element.width(\"\"),o){case!e&&!d:return!1;case!!e&&!!d:c.reference=d,c.position_x=e.x,c.position_y=e.y;break;case!e&&!!d:c.reference=d,g=d.offset(),c.position_x=g.left+d.outerHeight(),c.position_y=g.top;break;case!!e&&!d:c.position_x=e.x,c.position_y=e.y}d&&!f&&a(d).data(\"vakata_contextmenu\")&&(f=a(d).data(\"vakata_contextmenu\")),a.vakata.context._parse(f)&&c.element.html(c.html),c.items.length&&(c.element.appendTo(\"body\"),h=c.element,i=c.position_x,j=c.position_y,k=h.width(),l=h.height(),m=a(window).width()+a(window).scrollLeft(),n=a(window).height()+a(window).scrollTop(),b&&(i-=h.outerWidth()-a(d).outerWidth(),i<a(window).scrollLeft()+20&&(i=a(window).scrollLeft()+20)),i+k+20>m&&(i=m-(k+20)),j+l+20>n&&(j=n-(l+20)),c.element.css({left:i,top:j}).show().find(\"a\").first().focus().parent().addClass(\"vakata-context-hover\"),c.is_visible=!0,a.vakata.context._trigger(\"show\"))},hide:function(){c.is_visible&&(c.element.hide().find(\"ul\").hide().end().find(\":focus\").blur().end().detach(),c.is_visible=!1,a.vakata.context._trigger(\"hide\"))}},a(function(){b=\"rtl\"===a(\"body\").css(\"direction\");var d=!1;c.element=a(\"<ul class='vakata-context'></ul>\"),c.element.on(\"mouseenter\",\"li\",function(b){b.stopImmediatePropagation(),a.contains(this,b.relatedTarget)||(d&&clearTimeout(d),c.element.find(\".vakata-context-hover\").removeClass(\"vakata-context-hover\").end(),a(this).siblings().find(\"ul\").hide().end().end().parentsUntil(\".vakata-context\",\"li\").addBack().addClass(\"vakata-context-hover\"),a.vakata.context._show_submenu(this))}).on(\"mouseleave\",\"li\",function(b){a.contains(this,b.relatedTarget)||a(this).find(\".vakata-context-hover\").addBack().removeClass(\"vakata-context-hover\")}).on(\"mouseleave\",function(b){a(this).find(\".vakata-context-hover\").removeClass(\"vakata-context-hover\"),a.vakata.context.settings.hide_onmouseleave&&(d=setTimeout(function(b){return function(){a.vakata.context.hide()}}(this),a.vakata.context.settings.hide_onmouseleave))}).on(\"click\",\"a\",function(b){b.preventDefault(),a(this).blur().parent().hasClass(\"vakata-context-disabled\")||a.vakata.context._execute(a(this).attr(\"rel\"))===!1||a.vakata.context.hide()}).on(\"keydown\",\"a\",function(b){var d=null;switch(b.which){case 13:case 32:b.type=\"mouseup\",b.preventDefault(),a(b.currentTarget).trigger(b);break;case 37:c.is_visible&&(c.element.find(\".vakata-context-hover\").last().closest(\"li\").first().find(\"ul\").hide().find(\".vakata-context-hover\").removeClass(\"vakata-context-hover\").end().end().children(\"a\").focus(),b.stopImmediatePropagation(),b.preventDefault());break;case 38:c.is_visible&&(d=c.element.find(\"ul:visible\").addBack().last().children(\".vakata-context-hover\").removeClass(\"vakata-context-hover\").prevAll(\"li:not(.vakata-context-separator)\").first(),d.length||(d=c.element.find(\"ul:visible\").addBack().last().children(\"li:not(.vakata-context-separator)\").last()),d.addClass(\"vakata-context-hover\").children(\"a\").focus(),b.stopImmediatePropagation(),b.preventDefault());break;case 39:c.is_visible&&(c.element.find(\".vakata-context-hover\").last().children(\"ul\").show().children(\"li:not(.vakata-context-separator)\").removeClass(\"vakata-context-hover\").first().addClass(\"vakata-context-hover\").children(\"a\").focus(),b.stopImmediatePropagation(),b.preventDefault());break;case 40:c.is_visible&&(d=c.element.find(\"ul:visible\").addBack().last().children(\".vakata-context-hover\").removeClass(\"vakata-context-hover\").nextAll(\"li:not(.vakata-context-separator)\").first(),d.length||(d=c.element.find(\"ul:visible\").addBack().last().children(\"li:not(.vakata-context-separator)\").first()),d.addClass(\"vakata-context-hover\").children(\"a\").focus(),b.stopImmediatePropagation(),b.preventDefault());break;case 27:a.vakata.context.hide(),b.preventDefault()}}).on(\"keydown\",function(a){a.preventDefault();var b=c.element.find(\".vakata-contextmenu-shortcut-\"+a.which).parent();b.parent().not(\".vakata-context-disabled\")&&b.click()}),a(i).on(\"mousedown.vakata.jstree\",function(b){c.is_visible&&!a.contains(c.element[0],b.target)&&a.vakata.context.hide();\n}).on(\"context_show.vakata.jstree\",function(a,d){c.element.find(\"li:has(ul)\").children(\"a\").addClass(\"vakata-context-parent\"),b&&c.element.addClass(\"vakata-context-rtl\").css(\"direction\",\"rtl\"),c.element.find(\"ul\").hide().end()})})}(a),a.jstree.defaults.dnd={copy:!0,open_timeout:500,is_draggable:!0,check_while_dragging:!0,always_copy:!1,inside_pos:0,drag_selection:!0,touch:!0,large_drop_target:!1,large_drag_target:!1,use_html5:!1};var n,o;a.jstree.plugins.dnd=function(b,c){this.init=function(a,b){c.init.call(this,a,b),this.settings.dnd.use_html5=this.settings.dnd.use_html5&&\"draggable\"in i.createElement(\"span\")},this.bind=function(){c.bind.call(this),this.element.on(this.settings.dnd.use_html5?\"dragstart.jstree\":\"mousedown.jstree touchstart.jstree\",this.settings.dnd.large_drag_target?\".jstree-node\":\".jstree-anchor\",a.proxy(function(b){if(this.settings.dnd.large_drag_target&&a(b.target).closest(\".jstree-node\")[0]!==b.currentTarget)return!0;if(\"touchstart\"===b.type&&(!this.settings.dnd.touch||\"selected\"===this.settings.dnd.touch&&!a(b.currentTarget).closest(\".jstree-node\").children(\".jstree-anchor\").hasClass(\"jstree-clicked\")))return!0;var c=this.get_node(b.target),d=this.is_selected(c)&&this.settings.dnd.drag_selection?this.get_top_selected().length:1,e=d>1?d+\" \"+this.get_string(\"nodes\"):this.get_text(b.currentTarget);if(this.settings.core.force_text&&(e=a.vakata.html.escape(e)),c&&c.id&&c.id!==a.jstree.root&&(1===b.which||\"touchstart\"===b.type||\"dragstart\"===b.type)&&(this.settings.dnd.is_draggable===!0||a.isFunction(this.settings.dnd.is_draggable)&&this.settings.dnd.is_draggable.call(this,d>1?this.get_top_selected(!0):[c],b))){if(n={jstree:!0,origin:this,obj:this.get_node(c,!0),nodes:d>1?this.get_top_selected():[c.id]},o=b.currentTarget,!this.settings.dnd.use_html5)return this.element.trigger(\"mousedown.jstree\"),a.vakata.dnd.start(b,n,'<div id=\"jstree-dnd\" class=\"jstree-'+this.get_theme()+\" jstree-\"+this.get_theme()+\"-\"+this.get_theme_variant()+\" \"+(this.settings.core.themes.responsive?\" jstree-dnd-responsive\":\"\")+'\"><i class=\"jstree-icon jstree-er\"></i>'+e+'<ins class=\"jstree-copy\" style=\"display:none;\">+</ins></div>');a.vakata.dnd._trigger(\"start\",b,{helper:a(),element:o,data:n})}},this)),this.settings.dnd.use_html5&&this.element.on(\"dragover.jstree\",function(b){return b.preventDefault(),a.vakata.dnd._trigger(\"move\",b,{helper:a(),element:o,data:n}),!1}).on(\"drop.jstree\",a.proxy(function(b){return b.preventDefault(),a.vakata.dnd._trigger(\"stop\",b,{helper:a(),element:o,data:n}),!1},this))},this.redraw_node=function(a,b,d,e){if(a=c.redraw_node.apply(this,arguments),a&&this.settings.dnd.use_html5)if(this.settings.dnd.large_drag_target)a.setAttribute(\"draggable\",!0);else{var f,g,h=null;for(f=0,g=a.childNodes.length;g>f;f++)if(a.childNodes[f]&&a.childNodes[f].className&&-1!==a.childNodes[f].className.indexOf(\"jstree-anchor\")){h=a.childNodes[f];break}h&&h.setAttribute(\"draggable\",!0)}return a}},a(function(){var c=!1,d=!1,e=!1,f=!1,g=a('<div id=\"jstree-marker\">&#160;</div>').hide();a(i).on(\"dnd_start.vakata.jstree\",function(a,b){c=!1,e=!1,b&&b.data&&b.data.jstree&&g.appendTo(\"body\")}).on(\"dnd_move.vakata.jstree\",function(h,i){if(f&&(i.event&&\"dragover\"===i.event.type&&i.event.target===e.target||clearTimeout(f)),i&&i.data&&i.data.jstree&&(!i.event.target.id||\"jstree-marker\"!==i.event.target.id)){e=i.event;var j=a.jstree.reference(i.event.target),k=!1,l=!1,m=!1,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C;if(j&&j._data&&j._data.dnd)if(g.attr(\"class\",\"jstree-\"+j.get_theme()+(j.settings.core.themes.responsive?\" jstree-dnd-responsive\":\"\")),C=i.data.origin&&(i.data.origin.settings.dnd.always_copy||i.data.origin.settings.dnd.copy&&(i.event.metaKey||i.event.ctrlKey)),i.helper.children().attr(\"class\",\"jstree-\"+j.get_theme()+\" jstree-\"+j.get_theme()+\"-\"+j.get_theme_variant()+\" \"+(j.settings.core.themes.responsive?\" jstree-dnd-responsive\":\"\")).find(\".jstree-copy\").first()[C?\"show\":\"hide\"](),i.event.target!==j.element[0]&&i.event.target!==j.get_container_ul()[0]||0!==j.get_container_ul().children().length){if(k=j.settings.dnd.large_drop_target?a(i.event.target).closest(\".jstree-node\").children(\".jstree-anchor\"):a(i.event.target).closest(\".jstree-anchor\"),k&&k.length&&k.parent().is(\".jstree-closed, .jstree-open, .jstree-leaf\")&&(l=k.offset(),m=(i.event.pageY!==b?i.event.pageY:i.event.originalEvent.pageY)-l.top,q=k.outerHeight(),t=q/3>m?[\"b\",\"i\",\"a\"]:m>q-q/3?[\"a\",\"i\",\"b\"]:m>q/2?[\"i\",\"a\",\"b\"]:[\"i\",\"b\",\"a\"],a.each(t,function(b,e){switch(e){case\"b\":o=l.left-6,p=l.top,r=j.get_parent(k),s=k.parent().index();break;case\"i\":A=j.settings.dnd.inside_pos,B=j.get_node(k.parent()),o=l.left-2,p=l.top+q/2+1,r=B.id,s=\"first\"===A?0:\"last\"===A?B.children.length:Math.min(A,B.children.length);break;case\"a\":o=l.left-6,p=l.top+q,r=j.get_parent(k),s=k.parent().index()+1}for(u=!0,v=0,w=i.data.nodes.length;w>v;v++)if(x=i.data.origin&&(i.data.origin.settings.dnd.always_copy||i.data.origin.settings.dnd.copy&&(i.event.metaKey||i.event.ctrlKey))?\"copy_node\":\"move_node\",y=s,\"move_node\"===x&&\"a\"===e&&i.data.origin&&i.data.origin===j&&r===j.get_parent(i.data.nodes[v])&&(z=j.get_node(r),y>a.inArray(i.data.nodes[v],z.children)&&(y-=1)),u=u&&(j&&j.settings&&j.settings.dnd&&j.settings.dnd.check_while_dragging===!1||j.check(x,i.data.origin&&i.data.origin!==j?i.data.origin.get_node(i.data.nodes[v]):i.data.nodes[v],r,y,{dnd:!0,ref:j.get_node(k.parent()),pos:e,origin:i.data.origin,is_multi:i.data.origin&&i.data.origin!==j,is_foreign:!i.data.origin})),!u){j&&j.last_error&&(d=j.last_error());break}return\"i\"===e&&k.parent().is(\".jstree-closed\")&&j.settings.dnd.open_timeout&&(f=setTimeout(function(a,b){return function(){a.open_node(b)}}(j,k),j.settings.dnd.open_timeout)),u?(c={ins:j,par:r,pos:\"i\"!==e||\"last\"!==A||0!==s||j.is_loaded(B)?s:\"last\"},g.css({left:o+\"px\",top:p+\"px\"}).show(),i.helper.find(\".jstree-icon\").first().removeClass(\"jstree-er\").addClass(\"jstree-ok\"),i.event.originalEvent&&i.event.originalEvent.dataTransfer&&(i.event.originalEvent.dataTransfer.dropEffect=C?\"copy\":\"move\"),d={},t=!0,!1):void 0}),t===!0))return}else{for(u=!0,v=0,w=i.data.nodes.length;w>v;v++)if(u=u&&j.check(i.data.origin&&(i.data.origin.settings.dnd.always_copy||i.data.origin.settings.dnd.copy&&(i.event.metaKey||i.event.ctrlKey))?\"copy_node\":\"move_node\",i.data.origin&&i.data.origin!==j?i.data.origin.get_node(i.data.nodes[v]):i.data.nodes[v],a.jstree.root,\"last\",{dnd:!0,ref:j.get_node(a.jstree.root),pos:\"i\",origin:i.data.origin,is_multi:i.data.origin&&i.data.origin!==j,is_foreign:!i.data.origin}),!u)break;if(u)return c={ins:j,par:a.jstree.root,pos:\"last\"},g.hide(),i.helper.find(\".jstree-icon\").first().removeClass(\"jstree-er\").addClass(\"jstree-ok\"),void(i.event.originalEvent&&i.event.originalEvent.dataTransfer&&(i.event.originalEvent.dataTransfer.dropEffect=C?\"copy\":\"move\"))}c=!1,i.helper.find(\".jstree-icon\").removeClass(\"jstree-ok\").addClass(\"jstree-er\"),i.event.originalEvent&&i.event.originalEvent.dataTransfer&&(i.event.originalEvent.dataTransfer.dropEffect=\"none\"),g.hide()}}).on(\"dnd_scroll.vakata.jstree\",function(a,b){b&&b.data&&b.data.jstree&&(g.hide(),c=!1,e=!1,b.helper.find(\".jstree-icon\").first().removeClass(\"jstree-ok\").addClass(\"jstree-er\"))}).on(\"dnd_stop.vakata.jstree\",function(b,h){if(f&&clearTimeout(f),h&&h.data&&h.data.jstree){g.hide().detach();var i,j,k=[];if(c){for(i=0,j=h.data.nodes.length;j>i;i++)k[i]=h.data.origin?h.data.origin.get_node(h.data.nodes[i]):h.data.nodes[i];c.ins[h.data.origin&&(h.data.origin.settings.dnd.always_copy||h.data.origin.settings.dnd.copy&&(h.event.metaKey||h.event.ctrlKey))?\"copy_node\":\"move_node\"](k,c.par,c.pos,!1,!1,!1,h.data.origin)}else i=a(h.event.target).closest(\".jstree\"),i.length&&d&&d.error&&\"check\"===d.error&&(i=i.jstree(!0),i&&i.settings.core.error.call(this,d));e=!1,c=!1}}).on(\"keyup.jstree keydown.jstree\",function(b,h){h=a.vakata.dnd._get(),h&&h.data&&h.data.jstree&&(\"keyup\"===b.type&&27===b.which?(f&&clearTimeout(f),c=!1,d=!1,e=!1,f=!1,g.hide().detach(),a.vakata.dnd._clean()):(h.helper.find(\".jstree-copy\").first()[h.data.origin&&(h.data.origin.settings.dnd.always_copy||h.data.origin.settings.dnd.copy&&(b.metaKey||b.ctrlKey))?\"show\":\"hide\"](),e&&(e.metaKey=b.metaKey,e.ctrlKey=b.ctrlKey,a.vakata.dnd._trigger(\"move\",e))))})}),function(a){a.vakata.html={div:a(\"<div />\"),escape:function(b){return a.vakata.html.div.text(b).html()},strip:function(b){return a.vakata.html.div.empty().append(a.parseHTML(b)).text()}};var c={element:!1,target:!1,is_down:!1,is_drag:!1,helper:!1,helper_w:0,data:!1,init_x:0,init_y:0,scroll_l:0,scroll_t:0,scroll_e:!1,scroll_i:!1,is_touch:!1};a.vakata.dnd={settings:{scroll_speed:10,scroll_proximity:20,helper_left:5,helper_top:10,threshold:5,threshold_touch:50},_trigger:function(c,d,e){e===b&&(e=a.vakata.dnd._get()),e.event=d,a(i).triggerHandler(\"dnd_\"+c+\".vakata\",e)},_get:function(){return{data:c.data,element:c.element,helper:c.helper}},_clean:function(){c.helper&&c.helper.remove(),c.scroll_i&&(clearInterval(c.scroll_i),c.scroll_i=!1),c={element:!1,target:!1,is_down:!1,is_drag:!1,helper:!1,helper_w:0,data:!1,init_x:0,init_y:0,scroll_l:0,scroll_t:0,scroll_e:!1,scroll_i:!1,is_touch:!1},a(i).off(\"mousemove.vakata.jstree touchmove.vakata.jstree\",a.vakata.dnd.drag),a(i).off(\"mouseup.vakata.jstree touchend.vakata.jstree\",a.vakata.dnd.stop)},_scroll:function(b){if(!c.scroll_e||!c.scroll_l&&!c.scroll_t)return c.scroll_i&&(clearInterval(c.scroll_i),c.scroll_i=!1),!1;if(!c.scroll_i)return c.scroll_i=setInterval(a.vakata.dnd._scroll,100),!1;if(b===!0)return!1;var d=c.scroll_e.scrollTop(),e=c.scroll_e.scrollLeft();c.scroll_e.scrollTop(d+c.scroll_t*a.vakata.dnd.settings.scroll_speed),c.scroll_e.scrollLeft(e+c.scroll_l*a.vakata.dnd.settings.scroll_speed),d===c.scroll_e.scrollTop()&&e===c.scroll_e.scrollLeft()||a.vakata.dnd._trigger(\"scroll\",c.scroll_e)},start:function(b,d,e){\"touchstart\"===b.type&&b.originalEvent&&b.originalEvent.changedTouches&&b.originalEvent.changedTouches[0]&&(b.pageX=b.originalEvent.changedTouches[0].pageX,b.pageY=b.originalEvent.changedTouches[0].pageY,b.target=i.elementFromPoint(b.originalEvent.changedTouches[0].pageX-window.pageXOffset,b.originalEvent.changedTouches[0].pageY-window.pageYOffset)),c.is_drag&&a.vakata.dnd.stop({});try{b.currentTarget.unselectable=\"on\",b.currentTarget.onselectstart=function(){return!1},b.currentTarget.style&&(b.currentTarget.style.touchAction=\"none\",b.currentTarget.style.msTouchAction=\"none\",b.currentTarget.style.MozUserSelect=\"none\")}catch(f){}return c.init_x=b.pageX,c.init_y=b.pageY,c.data=d,c.is_down=!0,c.element=b.currentTarget,c.target=b.target,c.is_touch=\"touchstart\"===b.type,e!==!1&&(c.helper=a(\"<div id='vakata-dnd'></div>\").html(e).css({display:\"block\",margin:\"0\",padding:\"0\",position:\"absolute\",top:\"-2000px\",lineHeight:\"16px\",zIndex:\"10000\"})),a(i).on(\"mousemove.vakata.jstree touchmove.vakata.jstree\",a.vakata.dnd.drag),a(i).on(\"mouseup.vakata.jstree touchend.vakata.jstree\",a.vakata.dnd.stop),!1},drag:function(b){if(\"touchmove\"===b.type&&b.originalEvent&&b.originalEvent.changedTouches&&b.originalEvent.changedTouches[0]&&(b.pageX=b.originalEvent.changedTouches[0].pageX,b.pageY=b.originalEvent.changedTouches[0].pageY,b.target=i.elementFromPoint(b.originalEvent.changedTouches[0].pageX-window.pageXOffset,b.originalEvent.changedTouches[0].pageY-window.pageYOffset)),c.is_down){if(!c.is_drag){if(!(Math.abs(b.pageX-c.init_x)>(c.is_touch?a.vakata.dnd.settings.threshold_touch:a.vakata.dnd.settings.threshold)||Math.abs(b.pageY-c.init_y)>(c.is_touch?a.vakata.dnd.settings.threshold_touch:a.vakata.dnd.settings.threshold)))return;c.helper&&(c.helper.appendTo(\"body\"),c.helper_w=c.helper.outerWidth()),c.is_drag=!0,a.vakata.dnd._trigger(\"start\",b)}var d=!1,e=!1,f=!1,g=!1,h=!1,j=!1,k=!1,l=!1,m=!1,n=!1;return c.scroll_t=0,c.scroll_l=0,c.scroll_e=!1,a(a(b.target).parentsUntil(\"body\").addBack().get().reverse()).filter(function(){return/^auto|scroll$/.test(a(this).css(\"overflow\"))&&(this.scrollHeight>this.offsetHeight||this.scrollWidth>this.offsetWidth)}).each(function(){var d=a(this),e=d.offset();return this.scrollHeight>this.offsetHeight&&(e.top+d.height()-b.pageY<a.vakata.dnd.settings.scroll_proximity&&(c.scroll_t=1),b.pageY-e.top<a.vakata.dnd.settings.scroll_proximity&&(c.scroll_t=-1)),this.scrollWidth>this.offsetWidth&&(e.left+d.width()-b.pageX<a.vakata.dnd.settings.scroll_proximity&&(c.scroll_l=1),b.pageX-e.left<a.vakata.dnd.settings.scroll_proximity&&(c.scroll_l=-1)),c.scroll_t||c.scroll_l?(c.scroll_e=a(this),!1):void 0}),c.scroll_e||(d=a(i),e=a(window),f=d.height(),g=e.height(),h=d.width(),j=e.width(),k=d.scrollTop(),l=d.scrollLeft(),f>g&&b.pageY-k<a.vakata.dnd.settings.scroll_proximity&&(c.scroll_t=-1),f>g&&g-(b.pageY-k)<a.vakata.dnd.settings.scroll_proximity&&(c.scroll_t=1),h>j&&b.pageX-l<a.vakata.dnd.settings.scroll_proximity&&(c.scroll_l=-1),h>j&&j-(b.pageX-l)<a.vakata.dnd.settings.scroll_proximity&&(c.scroll_l=1),(c.scroll_t||c.scroll_l)&&(c.scroll_e=d)),c.scroll_e&&a.vakata.dnd._scroll(!0),c.helper&&(m=parseInt(b.pageY+a.vakata.dnd.settings.helper_top,10),n=parseInt(b.pageX+a.vakata.dnd.settings.helper_left,10),f&&m+25>f&&(m=f-50),h&&n+c.helper_w>h&&(n=h-(c.helper_w+2)),c.helper.css({left:n+\"px\",top:m+\"px\"})),a.vakata.dnd._trigger(\"move\",b),!1}},stop:function(b){if(\"touchend\"===b.type&&b.originalEvent&&b.originalEvent.changedTouches&&b.originalEvent.changedTouches[0]&&(b.pageX=b.originalEvent.changedTouches[0].pageX,b.pageY=b.originalEvent.changedTouches[0].pageY,b.target=i.elementFromPoint(b.originalEvent.changedTouches[0].pageX-window.pageXOffset,b.originalEvent.changedTouches[0].pageY-window.pageYOffset)),c.is_drag)a.vakata.dnd._trigger(\"stop\",b);else if(\"touchend\"===b.type&&b.target===c.target){var d=setTimeout(function(){a(b.target).click()},100);a(b.target).one(\"click\",function(){d&&clearTimeout(d)})}return a.vakata.dnd._clean(),!1}}}(a),a.jstree.defaults.massload=null,a.jstree.plugins.massload=function(b,c){this.init=function(a,b){this._data.massload={},c.init.call(this,a,b)},this._load_nodes=function(b,d,e,f){var g=this.settings.massload,h=JSON.stringify(b),i=[],j=this._model.data,k,l,m;if(!e){for(k=0,l=b.length;l>k;k++)j[b[k]]&&(j[b[k]].state.loaded||j[b[k]].state.failed)&&!f||(i.push(b[k]),m=this.get_node(b[k],!0),m&&m.length&&m.addClass(\"jstree-loading\").attr(\"aria-busy\",!0));if(this._data.massload={},i.length){if(a.isFunction(g))return g.call(this,i,a.proxy(function(a){var g,h;if(a)for(g in a)a.hasOwnProperty(g)&&(this._data.massload[g]=a[g]);for(g=0,h=b.length;h>g;g++)m=this.get_node(b[g],!0),m&&m.length&&m.removeClass(\"jstree-loading\").attr(\"aria-busy\",!1);c._load_nodes.call(this,b,d,e,f)},this));if(\"object\"==typeof g&&g&&g.url)return g=a.extend(!0,{},g),a.isFunction(g.url)&&(g.url=g.url.call(this,i)),a.isFunction(g.data)&&(g.data=g.data.call(this,i)),a.ajax(g).done(a.proxy(function(a,g,h){var i,j;if(a)for(i in a)a.hasOwnProperty(i)&&(this._data.massload[i]=a[i]);for(i=0,j=b.length;j>i;i++)m=this.get_node(b[i],!0),m&&m.length&&m.removeClass(\"jstree-loading\").attr(\"aria-busy\",!1);c._load_nodes.call(this,b,d,e,f)},this)).fail(a.proxy(function(a){c._load_nodes.call(this,b,d,e,f)},this))}}return c._load_nodes.call(this,b,d,e,f)},this._load_node=function(b,d){var e=this._data.massload[b.id],f=null,g;return e?(f=this[\"string\"==typeof e?\"_append_html_data\":\"_append_json_data\"](b,\"string\"==typeof e?a(a.parseHTML(e)).filter(function(){return 3!==this.nodeType}):e,function(a){d.call(this,a)}),g=this.get_node(b.id,!0),g&&g.length&&g.removeClass(\"jstree-loading\").attr(\"aria-busy\",!1),delete this._data.massload[b.id],f):c._load_node.call(this,b,d)}},a.jstree.defaults.search={ajax:!1,fuzzy:!1,case_sensitive:!1,show_only_matches:!1,show_only_matches_children:!1,close_opened_onclear:!0,search_leaves_only:!1,search_callback:!1},a.jstree.plugins.search=function(c,d){this.bind=function(){d.bind.call(this),this._data.search.str=\"\",this._data.search.dom=a(),this._data.search.res=[],this._data.search.opn=[],this._data.search.som=!1,this._data.search.smc=!1,this._data.search.hdn=[],this.element.on(\"search.jstree\",a.proxy(function(b,c){if(this._data.search.som&&c.res.length){var d=this._model.data,e,f,g=[],h,i;for(e=0,f=c.res.length;f>e;e++)if(d[c.res[e]]&&!d[c.res[e]].state.hidden&&(g.push(c.res[e]),g=g.concat(d[c.res[e]].parents),this._data.search.smc))for(h=0,i=d[c.res[e]].children_d.length;i>h;h++)d[d[c.res[e]].children_d[h]]&&!d[d[c.res[e]].children_d[h]].state.hidden&&g.push(d[c.res[e]].children_d[h]);g=a.vakata.array_remove_item(a.vakata.array_unique(g),a.jstree.root),this._data.search.hdn=this.hide_all(!0),this.show_node(g,!0),this.redraw(!0)}},this)).on(\"clear_search.jstree\",a.proxy(function(a,b){this._data.search.som&&b.res.length&&(this.show_node(this._data.search.hdn,!0),this.redraw(!0))},this))},this.search=function(c,d,e,f,g,h){if(c===!1||\"\"===a.trim(c.toString()))return this.clear_search();f=this.get_node(f),f=f&&f.id?f.id:null,c=c.toString();var i=this.settings.search,j=i.ajax?i.ajax:!1,k=this._model.data,l=null,m=[],n=[],o,p;if(this._data.search.res.length&&!g&&this.clear_search(),e===b&&(e=i.show_only_matches),h===b&&(h=i.show_only_matches_children),!d&&j!==!1)return a.isFunction(j)?j.call(this,c,a.proxy(function(b){b&&b.d&&(b=b.d),this._load_nodes(a.isArray(b)?a.vakata.array_unique(b):[],function(){this.search(c,!0,e,f,g)})},this),f):(j=a.extend({},j),j.data||(j.data={}),j.data.str=c,f&&(j.data.inside=f),a.ajax(j).fail(a.proxy(function(){this._data.core.last_error={error:\"ajax\",plugin:\"search\",id:\"search_01\",reason:\"Could not load search parents\",data:JSON.stringify(j)},this.settings.core.error.call(this,this._data.core.last_error)},this)).done(a.proxy(function(b){b&&b.d&&(b=b.d),this._load_nodes(a.isArray(b)?a.vakata.array_unique(b):[],function(){this.search(c,!0,e,f,g)})},this)));if(g||(this._data.search.str=c,this._data.search.dom=a(),this._data.search.res=[],this._data.search.opn=[],this._data.search.som=e,this._data.search.smc=h),l=new a.vakata.search(c,!0,{caseSensitive:i.case_sensitive,fuzzy:i.fuzzy}),a.each(k[f?f:a.jstree.root].children_d,function(a,b){var d=k[b];d.text&&!d.state.hidden&&(!i.search_leaves_only||d.state.loaded&&0===d.children.length)&&(i.search_callback&&i.search_callback.call(this,c,d)||!i.search_callback&&l.search(d.text).isMatch)&&(m.push(b),n=n.concat(d.parents))}),m.length){for(n=a.vakata.array_unique(n),o=0,p=n.length;p>o;o++)n[o]!==a.jstree.root&&k[n[o]]&&this.open_node(n[o],null,0)===!0&&this._data.search.opn.push(n[o]);g?(this._data.search.dom=this._data.search.dom.add(a(this.element[0].querySelectorAll(\"#\"+a.map(m,function(b){return-1!==\"0123456789\".indexOf(b[0])?\"\\\\3\"+b[0]+\" \"+b.substr(1).replace(a.jstree.idregex,\"\\\\$&\"):b.replace(a.jstree.idregex,\"\\\\$&\")}).join(\", #\")))),this._data.search.res=a.vakata.array_unique(this._data.search.res.concat(m))):(this._data.search.dom=a(this.element[0].querySelectorAll(\"#\"+a.map(m,function(b){return-1!==\"0123456789\".indexOf(b[0])?\"\\\\3\"+b[0]+\" \"+b.substr(1).replace(a.jstree.idregex,\"\\\\$&\"):b.replace(a.jstree.idregex,\"\\\\$&\")}).join(\", #\"))),this._data.search.res=m),this._data.search.dom.children(\".jstree-anchor\").addClass(\"jstree-search\")}this.trigger(\"search\",{nodes:this._data.search.dom,str:c,res:this._data.search.res,show_only_matches:e})},this.clear_search=function(){this.settings.search.close_opened_onclear&&this.close_node(this._data.search.opn,0),this.trigger(\"clear_search\",{nodes:this._data.search.dom,str:this._data.search.str,res:this._data.search.res}),this._data.search.res.length&&(this._data.search.dom=a(this.element[0].querySelectorAll(\"#\"+a.map(this._data.search.res,function(b){return-1!==\"0123456789\".indexOf(b[0])?\"\\\\3\"+b[0]+\" \"+b.substr(1).replace(a.jstree.idregex,\"\\\\$&\"):b.replace(a.jstree.idregex,\"\\\\$&\")}).join(\", #\"))),this._data.search.dom.children(\".jstree-anchor\").removeClass(\"jstree-search\")),this._data.search.str=\"\",this._data.search.res=[],this._data.search.opn=[],this._data.search.dom=a()},this.redraw_node=function(b,c,e,f){if(b=d.redraw_node.apply(this,arguments),b&&-1!==a.inArray(b.id,this._data.search.res)){var g,h,i=null;for(g=0,h=b.childNodes.length;h>g;g++)if(b.childNodes[g]&&b.childNodes[g].className&&-1!==b.childNodes[g].className.indexOf(\"jstree-anchor\")){i=b.childNodes[g];break}i&&(i.className+=\" jstree-search\")}return b}},function(a){a.vakata.search=function(b,c,d){d=d||{},d=a.extend({},a.vakata.search.defaults,d),d.fuzzy!==!1&&(d.fuzzy=!0),b=d.caseSensitive?b:b.toLowerCase();var e=d.location,f=d.distance,g=d.threshold,h=b.length,i,j,k,l;return h>32&&(d.fuzzy=!1),d.fuzzy&&(i=1<<h-1,j=function(){var a={},c=0;for(c=0;h>c;c++)a[b.charAt(c)]=0;for(c=0;h>c;c++)a[b.charAt(c)]|=1<<h-c-1;return a}(),k=function(a,b){var c=a/h,d=Math.abs(e-b);return f?c+d/f:d?1:c}),l=function(a){if(a=d.caseSensitive?a:a.toLowerCase(),b===a||-1!==a.indexOf(b))return{isMatch:!0,score:0};if(!d.fuzzy)return{isMatch:!1,score:1};var c,f,l=a.length,m=g,n=a.indexOf(b,e),o,p,q=h+l,r,s,t,u,v,w=1,x=[];for(-1!==n&&(m=Math.min(k(0,n),m),n=a.lastIndexOf(b,e+h),-1!==n&&(m=Math.min(k(0,n),m))),n=-1,c=0;h>c;c++){o=0,p=q;while(p>o)k(c,e+p)<=m?o=p:q=p,p=Math.floor((q-o)/2+o);for(q=p,s=Math.max(1,e-p+1),t=Math.min(e+p,l)+h,u=new Array(t+2),u[t+1]=(1<<c)-1,f=t;f>=s;f--)if(v=j[a.charAt(f-1)],0===c?u[f]=(u[f+1]<<1|1)&v:u[f]=(u[f+1]<<1|1)&v|((r[f+1]|r[f])<<1|1)|r[f+1],u[f]&i&&(w=k(c,f-1),m>=w)){if(m=w,n=f-1,x.push(n),!(n>e))break;s=Math.max(1,2*e-n)}if(k(c+1,e)>m)break;r=u}return{isMatch:n>=0,score:w}},c===!0?{search:l}:l(c)},a.vakata.search.defaults={location:0,distance:100,threshold:.6,fuzzy:!1,caseSensitive:!1}}(a),a.jstree.defaults.sort=function(a,b){return this.get_text(a)>this.get_text(b)?1:-1},a.jstree.plugins.sort=function(b,c){this.bind=function(){c.bind.call(this),this.element.on(\"model.jstree\",a.proxy(function(a,b){this.sort(b.parent,!0)},this)).on(\"rename_node.jstree create_node.jstree\",a.proxy(function(a,b){this.sort(b.parent||b.node.parent,!1),this.redraw_node(b.parent||b.node.parent,!0)},this)).on(\"move_node.jstree copy_node.jstree\",a.proxy(function(a,b){this.sort(b.parent,!1),this.redraw_node(b.parent,!0)},this))},this.sort=function(b,c){var d,e;if(b=this.get_node(b),b&&b.children&&b.children.length&&(b.children.sort(a.proxy(this.settings.sort,this)),c))for(d=0,e=b.children_d.length;e>d;d++)this.sort(b.children_d[d],!1)}};var p=!1;a.jstree.defaults.state={key:\"jstree\",events:\"changed.jstree open_node.jstree close_node.jstree check_node.jstree uncheck_node.jstree\",ttl:!1,filter:!1},a.jstree.plugins.state=function(b,c){this.bind=function(){c.bind.call(this);var b=a.proxy(function(){this.element.on(this.settings.state.events,a.proxy(function(){p&&clearTimeout(p),p=setTimeout(a.proxy(function(){this.save_state()},this),100)},this)),this.trigger(\"state_ready\")},this);this.element.on(\"ready.jstree\",a.proxy(function(a,c){this.element.one(\"restore_state.jstree\",b),this.restore_state()||b()},this))},this.save_state=function(){var b={state:this.get_state(),ttl:this.settings.state.ttl,sec:+new Date};a.vakata.storage.set(this.settings.state.key,JSON.stringify(b))},this.restore_state=function(){var b=a.vakata.storage.get(this.settings.state.key);if(b)try{b=JSON.parse(b)}catch(c){return!1}return b&&b.ttl&&b.sec&&+new Date-b.sec>b.ttl?!1:(b&&b.state&&(b=b.state),b&&a.isFunction(this.settings.state.filter)&&(b=this.settings.state.filter.call(this,b)),b?(this.element.one(\"set_state.jstree\",function(c,d){d.instance.trigger(\"restore_state\",{state:a.extend(!0,{},b)})}),this.set_state(b),!0):!1)},this.clear_state=function(){return a.vakata.storage.del(this.settings.state.key)}},function(a,b){a.vakata.storage={set:function(a,b){return window.localStorage.setItem(a,b)},get:function(a){return window.localStorage.getItem(a)},del:function(a){return window.localStorage.removeItem(a)}}}(a),a.jstree.defaults.types={\"default\":{}},a.jstree.defaults.types[a.jstree.root]={},a.jstree.plugins.types=function(c,d){this.init=function(c,e){var f,g;if(e&&e.types&&e.types[\"default\"])for(f in e.types)if(\"default\"!==f&&f!==a.jstree.root&&e.types.hasOwnProperty(f))for(g in e.types[\"default\"])e.types[\"default\"].hasOwnProperty(g)&&e.types[f][g]===b&&(e.types[f][g]=e.types[\"default\"][g]);d.init.call(this,c,e),this._model.data[a.jstree.root].type=a.jstree.root},this.refresh=function(b,c){d.refresh.call(this,b,c),this._model.data[a.jstree.root].type=a.jstree.root},this.bind=function(){this.element.on(\"model.jstree\",a.proxy(function(c,d){var e=this._model.data,f=d.nodes,g=this.settings.types,h,i,j=\"default\",k;for(h=0,i=f.length;i>h;h++){if(j=\"default\",e[f[h]].original&&e[f[h]].original.type&&g[e[f[h]].original.type]&&(j=e[f[h]].original.type),e[f[h]].data&&e[f[h]].data.jstree&&e[f[h]].data.jstree.type&&g[e[f[h]].data.jstree.type]&&(j=e[f[h]].data.jstree.type),e[f[h]].type=j,e[f[h]].icon===!0&&g[j].icon!==b&&(e[f[h]].icon=g[j].icon),g[j].li_attr!==b&&\"object\"==typeof g[j].li_attr)for(k in g[j].li_attr)if(g[j].li_attr.hasOwnProperty(k)){if(\"id\"===k)continue;e[f[h]].li_attr[k]===b?e[f[h]].li_attr[k]=g[j].li_attr[k]:\"class\"===k&&(e[f[h]].li_attr[\"class\"]=g[j].li_attr[\"class\"]+\" \"+e[f[h]].li_attr[\"class\"])}if(g[j].a_attr!==b&&\"object\"==typeof g[j].a_attr)for(k in g[j].a_attr)if(g[j].a_attr.hasOwnProperty(k)){if(\"id\"===k)continue;e[f[h]].a_attr[k]===b?e[f[h]].a_attr[k]=g[j].a_attr[k]:\"href\"===k&&\"#\"===e[f[h]].a_attr[k]?e[f[h]].a_attr.href=g[j].a_attr.href:\"class\"===k&&(e[f[h]].a_attr[\"class\"]=g[j].a_attr[\"class\"]+\" \"+e[f[h]].a_attr[\"class\"])}}e[a.jstree.root].type=a.jstree.root},this)),d.bind.call(this)},this.get_json=function(b,c,e){var f,g,h=this._model.data,i=c?a.extend(!0,{},c,{no_id:!1}):{},j=d.get_json.call(this,b,i,e);if(j===!1)return!1;if(a.isArray(j))for(f=0,g=j.length;g>f;f++)j[f].type=j[f].id&&h[j[f].id]&&h[j[f].id].type?h[j[f].id].type:\"default\",c&&c.no_id&&(delete j[f].id,j[f].li_attr&&j[f].li_attr.id&&delete j[f].li_attr.id,j[f].a_attr&&j[f].a_attr.id&&delete j[f].a_attr.id);else j.type=j.id&&h[j.id]&&h[j.id].type?h[j.id].type:\"default\",c&&c.no_id&&(j=this._delete_ids(j));return j},this._delete_ids=function(b){if(a.isArray(b)){for(var c=0,d=b.length;d>c;c++)b[c]=this._delete_ids(b[c]);return b}return delete b.id,b.li_attr&&b.li_attr.id&&delete b.li_attr.id,b.a_attr&&b.a_attr.id&&delete b.a_attr.id,b.children&&a.isArray(b.children)&&(b.children=this._delete_ids(b.children)),b},this.check=function(c,e,f,g,h){if(d.check.call(this,c,e,f,g,h)===!1)return!1;e=e&&e.id?e:this.get_node(e),f=f&&f.id?f:this.get_node(f);var i=e&&e.id?h&&h.origin?h.origin:a.jstree.reference(e.id):null,j,k,l,m;switch(i=i&&i._model&&i._model.data?i._model.data:null,c){case\"create_node\":case\"move_node\":case\"copy_node\":if(\"move_node\"!==c||-1===a.inArray(e.id,f.children)){if(j=this.get_rules(f),j.max_children!==b&&-1!==j.max_children&&j.max_children===f.children.length)return this._data.core.last_error={error:\"check\",plugin:\"types\",id:\"types_01\",reason:\"max_children prevents function: \"+c,data:JSON.stringify({chk:c,pos:g,obj:e&&e.id?e.id:!1,par:f&&f.id?f.id:!1})},!1;if(j.valid_children!==b&&-1!==j.valid_children&&-1===a.inArray(e.type||\"default\",j.valid_children))return this._data.core.last_error={error:\"check\",plugin:\"types\",id:\"types_02\",reason:\"valid_children prevents function: \"+c,data:JSON.stringify({chk:c,pos:g,obj:e&&e.id?e.id:!1,par:f&&f.id?f.id:!1})},!1;if(i&&e.children_d&&e.parents){for(k=0,l=0,m=e.children_d.length;m>l;l++)k=Math.max(k,i[e.children_d[l]].parents.length);k=k-e.parents.length+1}(0>=k||k===b)&&(k=1);do{if(j.max_depth!==b&&-1!==j.max_depth&&j.max_depth<k)return this._data.core.last_error={error:\"check\",plugin:\"types\",id:\"types_03\",reason:\"max_depth prevents function: \"+c,data:JSON.stringify({chk:c,pos:g,obj:e&&e.id?e.id:!1,par:f&&f.id?f.id:!1})},!1;f=this.get_node(f.parent),j=this.get_rules(f),k++}while(f)}}return!0},this.get_rules=function(a){if(a=this.get_node(a),!a)return!1;var c=this.get_type(a,!0);return c.max_depth===b&&(c.max_depth=-1),c.max_children===b&&(c.max_children=-1),c.valid_children===b&&(c.valid_children=-1),c},this.get_type=function(b,c){return b=this.get_node(b),b?c?a.extend({type:b.type},this.settings.types[b.type]):b.type:!1},this.set_type=function(c,d){var e=this._model.data,f,g,h,i,j,k,l,m;if(a.isArray(c)){for(c=c.slice(),g=0,h=c.length;h>g;g++)this.set_type(c[g],d);return!0}if(f=this.settings.types,c=this.get_node(c),!f[d]||!c)return!1;if(l=this.get_node(c,!0),l&&l.length&&(m=l.children(\".jstree-anchor\")),i=c.type,j=this.get_icon(c),c.type=d,(j===!0||f[i]&&f[i].icon!==b&&j===f[i].icon)&&this.set_icon(c,f[d].icon!==b?f[d].icon:!0),f[i].li_attr!==b&&\"object\"==typeof f[i].li_attr)for(k in f[i].li_attr)if(f[i].li_attr.hasOwnProperty(k)){if(\"id\"===k)continue;\"class\"===k?(e[c.id].li_attr[\"class\"]=(e[c.id].li_attr[\"class\"]||\"\").replace(f[i].li_attr[k],\"\"),l&&l.removeClass(f[i].li_attr[k])):e[c.id].li_attr[k]===f[i].li_attr[k]&&(e[c.id].li_attr[k]=null,l&&l.removeAttr(k))}if(f[i].a_attr!==b&&\"object\"==typeof f[i].a_attr)for(k in f[i].a_attr)if(f[i].a_attr.hasOwnProperty(k)){if(\"id\"===k)continue;\"class\"===k?(e[c.id].a_attr[\"class\"]=(e[c.id].a_attr[\"class\"]||\"\").replace(f[i].a_attr[k],\"\"),m&&m.removeClass(f[i].a_attr[k])):e[c.id].a_attr[k]===f[i].a_attr[k]&&(\"href\"===k?(e[c.id].a_attr[k]=\"#\",m&&m.attr(\"href\",\"#\")):(delete e[c.id].a_attr[k],m&&m.removeAttr(k)))}if(f[d].li_attr!==b&&\"object\"==typeof f[d].li_attr)for(k in f[d].li_attr)if(f[d].li_attr.hasOwnProperty(k)){if(\"id\"===k)continue;e[c.id].li_attr[k]===b?(e[c.id].li_attr[k]=f[d].li_attr[k],l&&(\"class\"===k?l.addClass(f[d].li_attr[k]):l.attr(k,f[d].li_attr[k]))):\"class\"===k&&(e[c.id].li_attr[\"class\"]=f[d].li_attr[k]+\" \"+e[c.id].li_attr[\"class\"],l&&l.addClass(f[d].li_attr[k]))}if(f[d].a_attr!==b&&\"object\"==typeof f[d].a_attr)for(k in f[d].a_attr)if(f[d].a_attr.hasOwnProperty(k)){if(\"id\"===k)continue;e[c.id].a_attr[k]===b?(e[c.id].a_attr[k]=f[d].a_attr[k],m&&(\"class\"===k?m.addClass(f[d].a_attr[k]):m.attr(k,f[d].a_attr[k]))):\"href\"===k&&\"#\"===e[c.id].a_attr[k]?(e[c.id].a_attr.href=f[d].a_attr.href,m&&m.attr(\"href\",f[d].a_attr.href)):\"class\"===k&&(e[c.id].a_attr[\"class\"]=f[d].a_attr[\"class\"]+\" \"+e[c.id].a_attr[\"class\"],m&&m.addClass(f[d].a_attr[k]))}return!0}},a.jstree.defaults.unique={case_sensitive:!1,duplicate:function(a,b){return a+\" (\"+b+\")\"}},a.jstree.plugins.unique=function(c,d){this.check=function(b,c,e,f,g){if(d.check.call(this,b,c,e,f,g)===!1)return!1;if(c=c&&c.id?c:this.get_node(c),e=e&&e.id?e:this.get_node(e),!e||!e.children)return!0;var h=\"rename_node\"===b?f:c.text,i=[],j=this.settings.unique.case_sensitive,k=this._model.data,l,m;for(l=0,m=e.children.length;m>l;l++)i.push(j?k[e.children[l]].text:k[e.children[l]].text.toLowerCase());switch(j||(h=h.toLowerCase()),b){case\"delete_node\":return!0;case\"rename_node\":return l=-1===a.inArray(h,i)||c.text&&c.text[j?\"toString\":\"toLowerCase\"]()===h,l||(this._data.core.last_error={error:\"check\",plugin:\"unique\",id:\"unique_01\",reason:\"Child with name \"+h+\" already exists. Preventing: \"+b,data:JSON.stringify({chk:b,pos:f,obj:c&&c.id?c.id:!1,par:e&&e.id?e.id:!1})}),l;case\"create_node\":return l=-1===a.inArray(h,i),l||(this._data.core.last_error={error:\"check\",plugin:\"unique\",id:\"unique_04\",reason:\"Child with name \"+h+\" already exists. Preventing: \"+b,data:JSON.stringify({chk:b,pos:f,obj:c&&c.id?c.id:!1,par:e&&e.id?e.id:!1})}),l;case\"copy_node\":return l=-1===a.inArray(h,i),l||(this._data.core.last_error={error:\"check\",plugin:\"unique\",id:\"unique_02\",reason:\"Child with name \"+h+\" already exists. Preventing: \"+b,data:JSON.stringify({chk:b,pos:f,obj:c&&c.id?c.id:!1,par:e&&e.id?e.id:!1})}),l;case\"move_node\":return l=c.parent===e.id&&(!g||!g.is_multi)||-1===a.inArray(h,i),l||(this._data.core.last_error={error:\"check\",plugin:\"unique\",id:\"unique_03\",reason:\"Child with name \"+h+\" already exists. Preventing: \"+b,data:JSON.stringify({chk:b,pos:f,obj:c&&c.id?c.id:!1,par:e&&e.id?e.id:!1})}),l}return!0},this.create_node=function(c,e,f,g,h){if(!e||e.text===b){if(null===c&&(c=a.jstree.root),c=this.get_node(c),!c)return d.create_node.call(this,c,e,f,g,h);if(f=f===b?\"last\":f,!f.toString().match(/^(before|after)$/)&&!h&&!this.is_loaded(c))return d.create_node.call(this,c,e,f,g,h);\ne||(e={});var i,j,k,l,m,n=this._model.data,o=this.settings.unique.case_sensitive,p=this.settings.unique.duplicate;for(j=i=this.get_string(\"New node\"),k=[],l=0,m=c.children.length;m>l;l++)k.push(o?n[c.children[l]].text:n[c.children[l]].text.toLowerCase());l=1;while(-1!==a.inArray(o?j:j.toLowerCase(),k))j=p.call(this,i,++l).toString();e.text=j}return d.create_node.call(this,c,e,f,g,h)}};var q=i.createElement(\"DIV\");if(q.setAttribute(\"unselectable\",\"on\"),q.setAttribute(\"role\",\"presentation\"),q.className=\"jstree-wholerow\",q.innerHTML=\"&#160;\",a.jstree.plugins.wholerow=function(b,c){this.bind=function(){c.bind.call(this),this.element.on(\"ready.jstree set_state.jstree\",a.proxy(function(){this.hide_dots()},this)).on(\"init.jstree loading.jstree ready.jstree\",a.proxy(function(){this.get_container_ul().addClass(\"jstree-wholerow-ul\")},this)).on(\"deselect_all.jstree\",a.proxy(function(a,b){this.element.find(\".jstree-wholerow-clicked\").removeClass(\"jstree-wholerow-clicked\")},this)).on(\"changed.jstree\",a.proxy(function(a,b){this.element.find(\".jstree-wholerow-clicked\").removeClass(\"jstree-wholerow-clicked\");var c=!1,d,e;for(d=0,e=b.selected.length;e>d;d++)c=this.get_node(b.selected[d],!0),c&&c.length&&c.children(\".jstree-wholerow\").addClass(\"jstree-wholerow-clicked\")},this)).on(\"open_node.jstree\",a.proxy(function(a,b){this.get_node(b.node,!0).find(\".jstree-clicked\").parent().children(\".jstree-wholerow\").addClass(\"jstree-wholerow-clicked\")},this)).on(\"hover_node.jstree dehover_node.jstree\",a.proxy(function(a,b){\"hover_node\"===a.type&&this.is_disabled(b.node)||this.get_node(b.node,!0).children(\".jstree-wholerow\")[\"hover_node\"===a.type?\"addClass\":\"removeClass\"](\"jstree-wholerow-hovered\")},this)).on(\"contextmenu.jstree\",\".jstree-wholerow\",a.proxy(function(b){if(this._data.contextmenu){b.preventDefault();var c=a.Event(\"contextmenu\",{metaKey:b.metaKey,ctrlKey:b.ctrlKey,altKey:b.altKey,shiftKey:b.shiftKey,pageX:b.pageX,pageY:b.pageY});a(b.currentTarget).closest(\".jstree-node\").children(\".jstree-anchor\").first().trigger(c)}},this)).on(\"click.jstree\",\".jstree-wholerow\",function(b){b.stopImmediatePropagation();var c=a.Event(\"click\",{metaKey:b.metaKey,ctrlKey:b.ctrlKey,altKey:b.altKey,shiftKey:b.shiftKey});a(b.currentTarget).closest(\".jstree-node\").children(\".jstree-anchor\").first().trigger(c).focus()}).on(\"click.jstree\",\".jstree-leaf > .jstree-ocl\",a.proxy(function(b){b.stopImmediatePropagation();var c=a.Event(\"click\",{metaKey:b.metaKey,ctrlKey:b.ctrlKey,altKey:b.altKey,shiftKey:b.shiftKey});a(b.currentTarget).closest(\".jstree-node\").children(\".jstree-anchor\").first().trigger(c).focus()},this)).on(\"mouseover.jstree\",\".jstree-wholerow, .jstree-icon\",a.proxy(function(a){return a.stopImmediatePropagation(),this.is_disabled(a.currentTarget)||this.hover_node(a.currentTarget),!1},this)).on(\"mouseleave.jstree\",\".jstree-node\",a.proxy(function(a){this.dehover_node(a.currentTarget)},this))},this.teardown=function(){this.settings.wholerow&&this.element.find(\".jstree-wholerow\").remove(),c.teardown.call(this)},this.redraw_node=function(b,d,e,f){if(b=c.redraw_node.apply(this,arguments)){var g=q.cloneNode(!0);-1!==a.inArray(b.id,this._data.core.selected)&&(g.className+=\" jstree-wholerow-clicked\"),this._data.core.focused&&this._data.core.focused===b.id&&(g.className+=\" jstree-wholerow-hovered\"),b.insertBefore(g,b.childNodes[0])}return b}},i.registerElement&&Object&&Object.create){var r=Object.create(HTMLElement.prototype);r.createdCallback=function(){var b={core:{},plugins:[]},c;for(c in a.jstree.plugins)a.jstree.plugins.hasOwnProperty(c)&&this.attributes[c]&&(b.plugins.push(c),this.getAttribute(c)&&JSON.parse(this.getAttribute(c))&&(b[c]=JSON.parse(this.getAttribute(c))));for(c in a.jstree.defaults.core)a.jstree.defaults.core.hasOwnProperty(c)&&this.attributes[c]&&(b.core[c]=JSON.parse(this.getAttribute(c))||this.getAttribute(c));a(this).jstree(b)};try{i.registerElement(\"vakata-jstree\",{prototype:r})}catch(s){}}}});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTMwLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vY21zL3N0YXRpYy9jbXMvanMvbGlicy9qc3RyZWUvanN0cmVlLm1pbi5qcz84NWFjIl0sInNvdXJjZXNDb250ZW50IjpbIi8qIVxuICogVEhJUyBGSUxFIEhBUyBCRUVOIE1BTlVBTExZIFBBVENIRUQgVE8gQUxMT1cgQ09QWUlORyBJTlRPIFNFTEYvQ0hJTERSRU5cbiAqIGh0dHBzOi8vZ2l0aHViLmNvbS9GaW5hbEFuZ2VsL2pzdHJlZVxuICovXG4vKiEganNUcmVlIC0gdjMuMy4wIC0gMjAxNi0wNC0yNSAtIChNSVQpICovXG4hZnVuY3Rpb24oYSl7XCJ1c2Ugc3RyaWN0XCI7XCJmdW5jdGlvblwiPT10eXBlb2YgZGVmaW5lJiZkZWZpbmUuYW1kP2RlZmluZShbXCJqcXVlcnlcIl0sYSk6XCJ1bmRlZmluZWRcIiE9dHlwZW9mIG1vZHVsZSYmbW9kdWxlLmV4cG9ydHM/bW9kdWxlLmV4cG9ydHM9YShyZXF1aXJlKFwianF1ZXJ5XCIpKTphKGpRdWVyeSl9KGZ1bmN0aW9uKGEsYil7XCJ1c2Ugc3RyaWN0XCI7aWYoIWEuanN0cmVlKXt2YXIgYz0wLGQ9ITEsZT0hMSxmPSExLGc9W10saD1hKFwic2NyaXB0Omxhc3RcIikuYXR0cihcInNyY1wiKSxpPXdpbmRvdy5kb2N1bWVudCxqPWkuY3JlYXRlRWxlbWVudChcIkxJXCIpLGssbDtqLnNldEF0dHJpYnV0ZShcInJvbGVcIixcInRyZWVpdGVtXCIpLGs9aS5jcmVhdGVFbGVtZW50KFwiSVwiKSxrLmNsYXNzTmFtZT1cImpzdHJlZS1pY29uIGpzdHJlZS1vY2xcIixrLnNldEF0dHJpYnV0ZShcInJvbGVcIixcInByZXNlbnRhdGlvblwiKSxqLmFwcGVuZENoaWxkKGspLGs9aS5jcmVhdGVFbGVtZW50KFwiQVwiKSxrLmNsYXNzTmFtZT1cImpzdHJlZS1hbmNob3JcIixrLnNldEF0dHJpYnV0ZShcImhyZWZcIixcIiNcIiksay5zZXRBdHRyaWJ1dGUoXCJ0YWJpbmRleFwiLFwiLTFcIiksbD1pLmNyZWF0ZUVsZW1lbnQoXCJJXCIpLGwuY2xhc3NOYW1lPVwianN0cmVlLWljb24ganN0cmVlLXRoZW1laWNvblwiLGwuc2V0QXR0cmlidXRlKFwicm9sZVwiLFwicHJlc2VudGF0aW9uXCIpLGsuYXBwZW5kQ2hpbGQobCksai5hcHBlbmRDaGlsZChrKSxrPWw9bnVsbCxhLmpzdHJlZT17dmVyc2lvbjpcInt7VkVSU0lPTn19XCIsZGVmYXVsdHM6e3BsdWdpbnM6W119LHBsdWdpbnM6e30scGF0aDpoJiYtMSE9PWguaW5kZXhPZihcIi9cIik/aC5yZXBsYWNlKC9cXC9bXlxcL10rJC8sXCJcIik6XCJcIixpZHJlZ2V4Oi9bXFxcXDomIV58KClcXFtcXF08PkAqJyt+I1wiOy4sPVxcLSBcXC8ke30lP2BdL2cscm9vdDpcIiNcIn0sYS5qc3RyZWUuY3JlYXRlPWZ1bmN0aW9uKGIsZCl7dmFyIGU9bmV3IGEuanN0cmVlLmNvcmUoKytjKSxmPWQ7cmV0dXJuIGQ9YS5leHRlbmQoITAse30sYS5qc3RyZWUuZGVmYXVsdHMsZCksZiYmZi5wbHVnaW5zJiYoZC5wbHVnaW5zPWYucGx1Z2lucyksYS5lYWNoKGQucGx1Z2lucyxmdW5jdGlvbihhLGIpe1wiY29yZVwiIT09YSYmKGU9ZS5wbHVnaW4oYixkW2JdKSl9KSxhKGIpLmRhdGEoXCJqc3RyZWVcIixlKSxlLmluaXQoYixkKSxlfSxhLmpzdHJlZS5kZXN0cm95PWZ1bmN0aW9uKCl7YShcIi5qc3RyZWU6anN0cmVlXCIpLmpzdHJlZShcImRlc3Ryb3lcIiksYShpKS5vZmYoXCIuanN0cmVlXCIpfSxhLmpzdHJlZS5jb3JlPWZ1bmN0aW9uKGEpe3RoaXMuX2lkPWEsdGhpcy5fY250PTAsdGhpcy5fd3JrPW51bGwsdGhpcy5fZGF0YT17Y29yZTp7dGhlbWVzOntuYW1lOiExLGRvdHM6ITEsaWNvbnM6ITF9LHNlbGVjdGVkOltdLGxhc3RfZXJyb3I6e30sd29ya2luZzohMSx3b3JrZXJfcXVldWU6W10sZm9jdXNlZDpudWxsfX19LGEuanN0cmVlLnJlZmVyZW5jZT1mdW5jdGlvbihiKXt2YXIgYz1udWxsLGQ9bnVsbDtpZighYnx8IWIuaWR8fGIudGFnTmFtZSYmYi5ub2RlVHlwZXx8KGI9Yi5pZCksIWR8fCFkLmxlbmd0aCl0cnl7ZD1hKGIpfWNhdGNoKGUpe31pZighZHx8IWQubGVuZ3RoKXRyeXtkPWEoXCIjXCIrYi5yZXBsYWNlKGEuanN0cmVlLmlkcmVnZXgsXCJcXFxcJCZcIikpfWNhdGNoKGUpe31yZXR1cm4gZCYmZC5sZW5ndGgmJihkPWQuY2xvc2VzdChcIi5qc3RyZWVcIikpLmxlbmd0aCYmKGQ9ZC5kYXRhKFwianN0cmVlXCIpKT9jPWQ6YShcIi5qc3RyZWVcIikuZWFjaChmdW5jdGlvbigpe3ZhciBkPWEodGhpcykuZGF0YShcImpzdHJlZVwiKTtyZXR1cm4gZCYmZC5fbW9kZWwuZGF0YVtiXT8oYz1kLCExKTp2b2lkIDB9KSxjfSxhLmZuLmpzdHJlZT1mdW5jdGlvbihjKXt2YXIgZD1cInN0cmluZ1wiPT10eXBlb2YgYyxlPUFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywxKSxmPW51bGw7cmV0dXJuIGMhPT0hMHx8dGhpcy5sZW5ndGg/KHRoaXMuZWFjaChmdW5jdGlvbigpe3ZhciBnPWEuanN0cmVlLnJlZmVyZW5jZSh0aGlzKSxoPWQmJmc/Z1tjXTpudWxsO3JldHVybiBmPWQmJmg/aC5hcHBseShnLGUpOm51bGwsZ3x8ZHx8YyE9PWImJiFhLmlzUGxhaW5PYmplY3QoYyl8fGEuanN0cmVlLmNyZWF0ZSh0aGlzLGMpLChnJiYhZHx8Yz09PSEwKSYmKGY9Z3x8ITEpLG51bGwhPT1mJiZmIT09Yj8hMTp2b2lkIDB9KSxudWxsIT09ZiYmZiE9PWI/Zjp0aGlzKTohMX0sYS5leHByW1wiOlwiXS5qc3RyZWU9YS5leHByLmNyZWF0ZVBzZXVkbyhmdW5jdGlvbihjKXtyZXR1cm4gZnVuY3Rpb24oYyl7cmV0dXJuIGEoYykuaGFzQ2xhc3MoXCJqc3RyZWVcIikmJmEoYykuZGF0YShcImpzdHJlZVwiKSE9PWJ9fSksYS5qc3RyZWUuZGVmYXVsdHMuY29yZT17ZGF0YTohMSxzdHJpbmdzOiExLGNoZWNrX2NhbGxiYWNrOiExLGVycm9yOmEubm9vcCxhbmltYXRpb246MjAwLG11bHRpcGxlOiEwLHRoZW1lczp7bmFtZTohMSx1cmw6ITEsZGlyOiExLGRvdHM6ITAsaWNvbnM6ITAsc3RyaXBlczohMSx2YXJpYW50OiExLHJlc3BvbnNpdmU6ITF9LGV4cGFuZF9zZWxlY3RlZF9vbmxvYWQ6ITAsd29ya2VyOiEwLGZvcmNlX3RleHQ6ITEsZGJsY2xpY2tfdG9nZ2xlOiEwfSxhLmpzdHJlZS5jb3JlLnByb3RvdHlwZT17cGx1Z2luOmZ1bmN0aW9uKGIsYyl7dmFyIGQ9YS5qc3RyZWUucGx1Z2luc1tiXTtyZXR1cm4gZD8odGhpcy5fZGF0YVtiXT17fSxkLnByb3RvdHlwZT10aGlzLG5ldyBkKGMsdGhpcykpOnRoaXN9LGluaXQ6ZnVuY3Rpb24oYixjKXt0aGlzLl9tb2RlbD17ZGF0YTp7fSxjaGFuZ2VkOltdLGZvcmNlX2Z1bGxfcmVkcmF3OiExLHJlZHJhd190aW1lb3V0OiExLGRlZmF1bHRfc3RhdGU6e2xvYWRlZDohMCxvcGVuZWQ6ITEsc2VsZWN0ZWQ6ITEsZGlzYWJsZWQ6ITF9fSx0aGlzLl9tb2RlbC5kYXRhW2EuanN0cmVlLnJvb3RdPXtpZDphLmpzdHJlZS5yb290LHBhcmVudDpudWxsLHBhcmVudHM6W10sY2hpbGRyZW46W10sY2hpbGRyZW5fZDpbXSxzdGF0ZTp7bG9hZGVkOiExfX0sdGhpcy5lbGVtZW50PWEoYikuYWRkQ2xhc3MoXCJqc3RyZWUganN0cmVlLVwiK3RoaXMuX2lkKSx0aGlzLnNldHRpbmdzPWMsdGhpcy5fZGF0YS5jb3JlLnJlYWR5PSExLHRoaXMuX2RhdGEuY29yZS5sb2FkZWQ9ITEsdGhpcy5fZGF0YS5jb3JlLnJ0bD1cInJ0bFwiPT09dGhpcy5lbGVtZW50LmNzcyhcImRpcmVjdGlvblwiKSx0aGlzLmVsZW1lbnRbdGhpcy5fZGF0YS5jb3JlLnJ0bD9cImFkZENsYXNzXCI6XCJyZW1vdmVDbGFzc1wiXShcImpzdHJlZS1ydGxcIiksdGhpcy5lbGVtZW50LmF0dHIoXCJyb2xlXCIsXCJ0cmVlXCIpLHRoaXMuc2V0dGluZ3MuY29yZS5tdWx0aXBsZSYmdGhpcy5lbGVtZW50LmF0dHIoXCJhcmlhLW11bHRpc2VsZWN0YWJsZVwiLCEwKSx0aGlzLmVsZW1lbnQuYXR0cihcInRhYmluZGV4XCIpfHx0aGlzLmVsZW1lbnQuYXR0cihcInRhYmluZGV4XCIsXCIwXCIpLHRoaXMuYmluZCgpLHRoaXMudHJpZ2dlcihcImluaXRcIiksdGhpcy5fZGF0YS5jb3JlLm9yaWdpbmFsX2NvbnRhaW5lcl9odG1sPXRoaXMuZWxlbWVudC5maW5kKFwiID4gdWwgPiBsaVwiKS5jbG9uZSghMCksdGhpcy5fZGF0YS5jb3JlLm9yaWdpbmFsX2NvbnRhaW5lcl9odG1sLmZpbmQoXCJsaVwiKS5hZGRCYWNrKCkuY29udGVudHMoKS5maWx0ZXIoZnVuY3Rpb24oKXtyZXR1cm4gMz09PXRoaXMubm9kZVR5cGUmJighdGhpcy5ub2RlVmFsdWV8fC9eXFxzKyQvLnRlc3QodGhpcy5ub2RlVmFsdWUpKX0pLnJlbW92ZSgpLHRoaXMuZWxlbWVudC5odG1sKFwiPHVsIGNsYXNzPSdqc3RyZWUtY29udGFpbmVyLXVsIGpzdHJlZS1jaGlsZHJlbicgcm9sZT0nZ3JvdXAnPjxsaSBpZD0nalwiK3RoaXMuX2lkK1wiX2xvYWRpbmcnIGNsYXNzPSdqc3RyZWUtaW5pdGlhbC1ub2RlIGpzdHJlZS1sb2FkaW5nIGpzdHJlZS1sZWFmIGpzdHJlZS1sYXN0JyByb2xlPSd0cmVlLWl0ZW0nPjxpIGNsYXNzPSdqc3RyZWUtaWNvbiBqc3RyZWUtb2NsJz48L2k+PGEgY2xhc3M9J2pzdHJlZS1hbmNob3InIGhyZWY9JyMnPjxpIGNsYXNzPSdqc3RyZWUtaWNvbiBqc3RyZWUtdGhlbWVpY29uLWhpZGRlbic+PC9pPlwiK3RoaXMuZ2V0X3N0cmluZyhcIkxvYWRpbmcgLi4uXCIpK1wiPC9hPjwvbGk+PC91bD5cIiksdGhpcy5lbGVtZW50LmF0dHIoXCJhcmlhLWFjdGl2ZWRlc2NlbmRhbnRcIixcImpcIit0aGlzLl9pZCtcIl9sb2FkaW5nXCIpLHRoaXMuX2RhdGEuY29yZS5saV9oZWlnaHQ9dGhpcy5nZXRfY29udGFpbmVyX3VsKCkuY2hpbGRyZW4oXCJsaVwiKS5maXJzdCgpLmhlaWdodCgpfHwyNCx0aGlzLnRyaWdnZXIoXCJsb2FkaW5nXCIpLHRoaXMubG9hZF9ub2RlKGEuanN0cmVlLnJvb3QpfSxkZXN0cm95OmZ1bmN0aW9uKGEpe2lmKHRoaXMuX3dyayl0cnl7d2luZG93LlVSTC5yZXZva2VPYmplY3RVUkwodGhpcy5fd3JrKSx0aGlzLl93cms9bnVsbH1jYXRjaChiKXt9YXx8dGhpcy5lbGVtZW50LmVtcHR5KCksdGhpcy50ZWFyZG93bigpfSx0ZWFyZG93bjpmdW5jdGlvbigpe3RoaXMudW5iaW5kKCksdGhpcy5lbGVtZW50LnJlbW92ZUNsYXNzKFwianN0cmVlXCIpLnJlbW92ZURhdGEoXCJqc3RyZWVcIikuZmluZChcIltjbGFzc149J2pzdHJlZSddXCIpLmFkZEJhY2soKS5hdHRyKFwiY2xhc3NcIixmdW5jdGlvbigpe3JldHVybiB0aGlzLmNsYXNzTmFtZS5yZXBsYWNlKC9qc3RyZWVbXiBdKnwkL2dpLFwiXCIpfSksdGhpcy5lbGVtZW50PW51bGx9LGJpbmQ6ZnVuY3Rpb24oKXt2YXIgYj1cIlwiLGM9bnVsbCxkPTA7dGhpcy5lbGVtZW50Lm9uKFwiZGJsY2xpY2suanN0cmVlXCIsZnVuY3Rpb24oYSl7aWYoYS50YXJnZXQudGFnTmFtZSYmXCJpbnB1dFwiPT09YS50YXJnZXQudGFnTmFtZS50b0xvd2VyQ2FzZSgpKXJldHVybiEwO2lmKGkuc2VsZWN0aW9uJiZpLnNlbGVjdGlvbi5lbXB0eSlpLnNlbGVjdGlvbi5lbXB0eSgpO2Vsc2UgaWYod2luZG93LmdldFNlbGVjdGlvbil7dmFyIGI9d2luZG93LmdldFNlbGVjdGlvbigpO3RyeXtiLnJlbW92ZUFsbFJhbmdlcygpLGIuY29sbGFwc2UoKX1jYXRjaChjKXt9fX0pLm9uKFwibW91c2Vkb3duLmpzdHJlZVwiLGEucHJveHkoZnVuY3Rpb24oYSl7YS50YXJnZXQ9PT10aGlzLmVsZW1lbnRbMF0mJihhLnByZXZlbnREZWZhdWx0KCksZD0rbmV3IERhdGUpfSx0aGlzKSkub24oXCJtb3VzZWRvd24uanN0cmVlXCIsXCIuanN0cmVlLW9jbFwiLGZ1bmN0aW9uKGEpe2EucHJldmVudERlZmF1bHQoKX0pLm9uKFwiY2xpY2suanN0cmVlXCIsXCIuanN0cmVlLW9jbFwiLGEucHJveHkoZnVuY3Rpb24oYSl7dGhpcy50b2dnbGVfbm9kZShhLnRhcmdldCl9LHRoaXMpKS5vbihcImRibGNsaWNrLmpzdHJlZVwiLFwiLmpzdHJlZS1hbmNob3JcIixhLnByb3h5KGZ1bmN0aW9uKGEpe3JldHVybiBhLnRhcmdldC50YWdOYW1lJiZcImlucHV0XCI9PT1hLnRhcmdldC50YWdOYW1lLnRvTG93ZXJDYXNlKCk/ITA6dm9pZCh0aGlzLnNldHRpbmdzLmNvcmUuZGJsY2xpY2tfdG9nZ2xlJiZ0aGlzLnRvZ2dsZV9ub2RlKGEudGFyZ2V0KSl9LHRoaXMpKS5vbihcImNsaWNrLmpzdHJlZVwiLFwiLmpzdHJlZS1hbmNob3JcIixhLnByb3h5KGZ1bmN0aW9uKGIpe2IucHJldmVudERlZmF1bHQoKSxiLmN1cnJlbnRUYXJnZXQhPT1pLmFjdGl2ZUVsZW1lbnQmJmEoYi5jdXJyZW50VGFyZ2V0KS5mb2N1cygpLHRoaXMuYWN0aXZhdGVfbm9kZShiLmN1cnJlbnRUYXJnZXQsYil9LHRoaXMpKS5vbihcImtleWRvd24uanN0cmVlXCIsXCIuanN0cmVlLWFuY2hvclwiLGEucHJveHkoZnVuY3Rpb24oYil7aWYoYi50YXJnZXQudGFnTmFtZSYmXCJpbnB1dFwiPT09Yi50YXJnZXQudGFnTmFtZS50b0xvd2VyQ2FzZSgpKXJldHVybiEwO2lmKDMyIT09Yi53aGljaCYmMTMhPT1iLndoaWNoJiYoYi5zaGlmdEtleXx8Yi5jdHJsS2V5fHxiLmFsdEtleXx8Yi5tZXRhS2V5KSlyZXR1cm4hMDt2YXIgYz1udWxsO3N3aXRjaCh0aGlzLl9kYXRhLmNvcmUucnRsJiYoMzc9PT1iLndoaWNoP2Iud2hpY2g9Mzk6Mzk9PT1iLndoaWNoJiYoYi53aGljaD0zNykpLGIud2hpY2gpe2Nhc2UgMzI6Yi5jdHJsS2V5JiYoYi50eXBlPVwiY2xpY2tcIixhKGIuY3VycmVudFRhcmdldCkudHJpZ2dlcihiKSk7YnJlYWs7Y2FzZSAxMzpiLnR5cGU9XCJjbGlja1wiLGEoYi5jdXJyZW50VGFyZ2V0KS50cmlnZ2VyKGIpO2JyZWFrO2Nhc2UgMzc6Yi5wcmV2ZW50RGVmYXVsdCgpLHRoaXMuaXNfb3BlbihiLmN1cnJlbnRUYXJnZXQpP3RoaXMuY2xvc2Vfbm9kZShiLmN1cnJlbnRUYXJnZXQpOihjPXRoaXMuZ2V0X3BhcmVudChiLmN1cnJlbnRUYXJnZXQpLGMmJmMuaWQhPT1hLmpzdHJlZS5yb290JiZ0aGlzLmdldF9ub2RlKGMsITApLmNoaWxkcmVuKFwiLmpzdHJlZS1hbmNob3JcIikuZm9jdXMoKSk7YnJlYWs7Y2FzZSAzODpiLnByZXZlbnREZWZhdWx0KCksYz10aGlzLmdldF9wcmV2X2RvbShiLmN1cnJlbnRUYXJnZXQpLGMmJmMubGVuZ3RoJiZjLmNoaWxkcmVuKFwiLmpzdHJlZS1hbmNob3JcIikuZm9jdXMoKTticmVhaztjYXNlIDM5OmIucHJldmVudERlZmF1bHQoKSx0aGlzLmlzX2Nsb3NlZChiLmN1cnJlbnRUYXJnZXQpP3RoaXMub3Blbl9ub2RlKGIuY3VycmVudFRhcmdldCxmdW5jdGlvbihhKXt0aGlzLmdldF9ub2RlKGEsITApLmNoaWxkcmVuKFwiLmpzdHJlZS1hbmNob3JcIikuZm9jdXMoKX0pOnRoaXMuaXNfb3BlbihiLmN1cnJlbnRUYXJnZXQpJiYoYz10aGlzLmdldF9ub2RlKGIuY3VycmVudFRhcmdldCwhMCkuY2hpbGRyZW4oXCIuanN0cmVlLWNoaWxkcmVuXCIpWzBdLGMmJmEodGhpcy5fZmlyc3RDaGlsZChjKSkuY2hpbGRyZW4oXCIuanN0cmVlLWFuY2hvclwiKS5mb2N1cygpKTticmVhaztjYXNlIDQwOmIucHJldmVudERlZmF1bHQoKSxjPXRoaXMuZ2V0X25leHRfZG9tKGIuY3VycmVudFRhcmdldCksYyYmYy5sZW5ndGgmJmMuY2hpbGRyZW4oXCIuanN0cmVlLWFuY2hvclwiKS5mb2N1cygpO2JyZWFrO2Nhc2UgMTA2OnRoaXMub3Blbl9hbGwoKTticmVhaztjYXNlIDM2OmIucHJldmVudERlZmF1bHQoKSxjPXRoaXMuX2ZpcnN0Q2hpbGQodGhpcy5nZXRfY29udGFpbmVyX3VsKClbMF0pLGMmJmEoYykuY2hpbGRyZW4oXCIuanN0cmVlLWFuY2hvclwiKS5maWx0ZXIoXCI6dmlzaWJsZVwiKS5mb2N1cygpO2JyZWFrO2Nhc2UgMzU6Yi5wcmV2ZW50RGVmYXVsdCgpLHRoaXMuZWxlbWVudC5maW5kKFwiLmpzdHJlZS1hbmNob3JcIikuZmlsdGVyKFwiOnZpc2libGVcIikubGFzdCgpLmZvY3VzKCk7YnJlYWs7Y2FzZSAxMTM6Yi5wcmV2ZW50RGVmYXVsdCgpLHRoaXMuZWRpdChiLmN1cnJlbnRUYXJnZXQpfX0sdGhpcykpLm9uKFwibG9hZF9ub2RlLmpzdHJlZVwiLGEucHJveHkoZnVuY3Rpb24oYixjKXtjLnN0YXR1cyYmKGMubm9kZS5pZCE9PWEuanN0cmVlLnJvb3R8fHRoaXMuX2RhdGEuY29yZS5sb2FkZWR8fCh0aGlzLl9kYXRhLmNvcmUubG9hZGVkPSEwLHRoaXMuX2ZpcnN0Q2hpbGQodGhpcy5nZXRfY29udGFpbmVyX3VsKClbMF0pJiZ0aGlzLmVsZW1lbnQuYXR0cihcImFyaWEtYWN0aXZlZGVzY2VuZGFudFwiLHRoaXMuX2ZpcnN0Q2hpbGQodGhpcy5nZXRfY29udGFpbmVyX3VsKClbMF0pLmlkKSx0aGlzLnRyaWdnZXIoXCJsb2FkZWRcIikpLHRoaXMuX2RhdGEuY29yZS5yZWFkeXx8c2V0VGltZW91dChhLnByb3h5KGZ1bmN0aW9uKCl7aWYodGhpcy5lbGVtZW50JiYhdGhpcy5nZXRfY29udGFpbmVyX3VsKCkuZmluZChcIi5qc3RyZWUtbG9hZGluZ1wiKS5sZW5ndGgpe2lmKHRoaXMuX2RhdGEuY29yZS5yZWFkeT0hMCx0aGlzLl9kYXRhLmNvcmUuc2VsZWN0ZWQubGVuZ3RoKXtpZih0aGlzLnNldHRpbmdzLmNvcmUuZXhwYW5kX3NlbGVjdGVkX29ubG9hZCl7dmFyIGI9W10sYyxkO2ZvcihjPTAsZD10aGlzLl9kYXRhLmNvcmUuc2VsZWN0ZWQubGVuZ3RoO2Q+YztjKyspYj1iLmNvbmNhdCh0aGlzLl9tb2RlbC5kYXRhW3RoaXMuX2RhdGEuY29yZS5zZWxlY3RlZFtjXV0ucGFyZW50cyk7Zm9yKGI9YS52YWthdGEuYXJyYXlfdW5pcXVlKGIpLGM9MCxkPWIubGVuZ3RoO2Q+YztjKyspdGhpcy5vcGVuX25vZGUoYltjXSwhMSwwKX10aGlzLnRyaWdnZXIoXCJjaGFuZ2VkXCIse2FjdGlvbjpcInJlYWR5XCIsc2VsZWN0ZWQ6dGhpcy5fZGF0YS5jb3JlLnNlbGVjdGVkfSl9dGhpcy50cmlnZ2VyKFwicmVhZHlcIil9fSx0aGlzKSwwKSl9LHRoaXMpKS5vbihcImtleXByZXNzLmpzdHJlZVwiLGEucHJveHkoZnVuY3Rpb24oZCl7aWYoZC50YXJnZXQudGFnTmFtZSYmXCJpbnB1dFwiPT09ZC50YXJnZXQudGFnTmFtZS50b0xvd2VyQ2FzZSgpKXJldHVybiEwO2MmJmNsZWFyVGltZW91dChjKSxjPXNldFRpbWVvdXQoZnVuY3Rpb24oKXtiPVwiXCJ9LDUwMCk7dmFyIGU9U3RyaW5nLmZyb21DaGFyQ29kZShkLndoaWNoKS50b0xvd2VyQ2FzZSgpLGY9dGhpcy5lbGVtZW50LmZpbmQoXCIuanN0cmVlLWFuY2hvclwiKS5maWx0ZXIoXCI6dmlzaWJsZVwiKSxnPWYuaW5kZXgoaS5hY3RpdmVFbGVtZW50KXx8MCxoPSExO2lmKGIrPWUsYi5sZW5ndGg+MSl7aWYoZi5zbGljZShnKS5lYWNoKGEucHJveHkoZnVuY3Rpb24oYyxkKXtyZXR1cm4gMD09PWEoZCkudGV4dCgpLnRvTG93ZXJDYXNlKCkuaW5kZXhPZihiKT8oYShkKS5mb2N1cygpLGg9ITAsITEpOnZvaWQgMH0sdGhpcykpLGgpcmV0dXJuO2lmKGYuc2xpY2UoMCxnKS5lYWNoKGEucHJveHkoZnVuY3Rpb24oYyxkKXtyZXR1cm4gMD09PWEoZCkudGV4dCgpLnRvTG93ZXJDYXNlKCkuaW5kZXhPZihiKT8oYShkKS5mb2N1cygpLGg9ITAsITEpOnZvaWQgMH0sdGhpcykpLGgpcmV0dXJufWlmKG5ldyBSZWdFeHAoXCJeXCIrZS5yZXBsYWNlKC9bLVxcL1xcXFxeJCorPy4oKXxbXFxde31dL2csXCJcXFxcJCZcIikrXCIrJFwiKS50ZXN0KGIpKXtpZihmLnNsaWNlKGcrMSkuZWFjaChhLnByb3h5KGZ1bmN0aW9uKGIsYyl7cmV0dXJuIGEoYykudGV4dCgpLnRvTG93ZXJDYXNlKCkuY2hhckF0KDApPT09ZT8oYShjKS5mb2N1cygpLGg9ITAsITEpOnZvaWQgMH0sdGhpcykpLGgpcmV0dXJuO2lmKGYuc2xpY2UoMCxnKzEpLmVhY2goYS5wcm94eShmdW5jdGlvbihiLGMpe3JldHVybiBhKGMpLnRleHQoKS50b0xvd2VyQ2FzZSgpLmNoYXJBdCgwKT09PWU/KGEoYykuZm9jdXMoKSxoPSEwLCExKTp2b2lkIDB9LHRoaXMpKSxoKXJldHVybn19LHRoaXMpKS5vbihcImluaXQuanN0cmVlXCIsYS5wcm94eShmdW5jdGlvbigpe3ZhciBhPXRoaXMuc2V0dGluZ3MuY29yZS50aGVtZXM7dGhpcy5fZGF0YS5jb3JlLnRoZW1lcy5kb3RzPWEuZG90cyx0aGlzLl9kYXRhLmNvcmUudGhlbWVzLnN0cmlwZXM9YS5zdHJpcGVzLHRoaXMuX2RhdGEuY29yZS50aGVtZXMuaWNvbnM9YS5pY29ucyx0aGlzLnNldF90aGVtZShhLm5hbWV8fFwiZGVmYXVsdFwiLGEudXJsKSx0aGlzLnNldF90aGVtZV92YXJpYW50KGEudmFyaWFudCl9LHRoaXMpKS5vbihcImxvYWRpbmcuanN0cmVlXCIsYS5wcm94eShmdW5jdGlvbigpe3RoaXNbdGhpcy5fZGF0YS5jb3JlLnRoZW1lcy5kb3RzP1wic2hvd19kb3RzXCI6XCJoaWRlX2RvdHNcIl0oKSx0aGlzW3RoaXMuX2RhdGEuY29yZS50aGVtZXMuaWNvbnM/XCJzaG93X2ljb25zXCI6XCJoaWRlX2ljb25zXCJdKCksdGhpc1t0aGlzLl9kYXRhLmNvcmUudGhlbWVzLnN0cmlwZXM/XCJzaG93X3N0cmlwZXNcIjpcImhpZGVfc3RyaXBlc1wiXSgpfSx0aGlzKSkub24oXCJibHVyLmpzdHJlZVwiLFwiLmpzdHJlZS1hbmNob3JcIixhLnByb3h5KGZ1bmN0aW9uKGIpe3RoaXMuX2RhdGEuY29yZS5mb2N1c2VkPW51bGwsYShiLmN1cnJlbnRUYXJnZXQpLmZpbHRlcihcIi5qc3RyZWUtaG92ZXJlZFwiKS5tb3VzZWxlYXZlKCksdGhpcy5lbGVtZW50LmF0dHIoXCJ0YWJpbmRleFwiLFwiMFwiKX0sdGhpcykpLm9uKFwiZm9jdXMuanN0cmVlXCIsXCIuanN0cmVlLWFuY2hvclwiLGEucHJveHkoZnVuY3Rpb24oYil7dmFyIGM9dGhpcy5nZXRfbm9kZShiLmN1cnJlbnRUYXJnZXQpO2MmJmMuaWQmJih0aGlzLl9kYXRhLmNvcmUuZm9jdXNlZD1jLmlkKSx0aGlzLmVsZW1lbnQuZmluZChcIi5qc3RyZWUtaG92ZXJlZFwiKS5ub3QoYi5jdXJyZW50VGFyZ2V0KS5tb3VzZWxlYXZlKCksYShiLmN1cnJlbnRUYXJnZXQpLm1vdXNlZW50ZXIoKSx0aGlzLmVsZW1lbnQuYXR0cihcInRhYmluZGV4XCIsXCItMVwiKX0sdGhpcykpLm9uKFwiZm9jdXMuanN0cmVlXCIsYS5wcm94eShmdW5jdGlvbigpe2lmKCtuZXcgRGF0ZS1kPjUwMCYmIXRoaXMuX2RhdGEuY29yZS5mb2N1c2VkKXtkPTA7dmFyIGE9dGhpcy5nZXRfbm9kZSh0aGlzLmVsZW1lbnQuYXR0cihcImFyaWEtYWN0aXZlZGVzY2VuZGFudFwiKSwhMCk7YSYmYS5maW5kKFwiPiAuanN0cmVlLWFuY2hvclwiKS5mb2N1cygpfX0sdGhpcykpLm9uKFwibW91c2VlbnRlci5qc3RyZWVcIixcIi5qc3RyZWUtYW5jaG9yXCIsYS5wcm94eShmdW5jdGlvbihhKXt0aGlzLmhvdmVyX25vZGUoYS5jdXJyZW50VGFyZ2V0KX0sdGhpcykpLm9uKFwibW91c2VsZWF2ZS5qc3RyZWVcIixcIi5qc3RyZWUtYW5jaG9yXCIsYS5wcm94eShmdW5jdGlvbihhKXt0aGlzLmRlaG92ZXJfbm9kZShhLmN1cnJlbnRUYXJnZXQpfSx0aGlzKSl9LHVuYmluZDpmdW5jdGlvbigpe3RoaXMuZWxlbWVudC5vZmYoXCIuanN0cmVlXCIpLGEoaSkub2ZmKFwiLmpzdHJlZS1cIit0aGlzLl9pZCl9LHRyaWdnZXI6ZnVuY3Rpb24oYSxiKXtifHwoYj17fSksYi5pbnN0YW5jZT10aGlzLHRoaXMuZWxlbWVudC50cmlnZ2VySGFuZGxlcihhLnJlcGxhY2UoXCIuanN0cmVlXCIsXCJcIikrXCIuanN0cmVlXCIsYil9LGdldF9jb250YWluZXI6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5lbGVtZW50fSxnZXRfY29udGFpbmVyX3VsOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZWxlbWVudC5jaGlsZHJlbihcIi5qc3RyZWUtY2hpbGRyZW5cIikuZmlyc3QoKX0sZ2V0X3N0cmluZzpmdW5jdGlvbihiKXt2YXIgYz10aGlzLnNldHRpbmdzLmNvcmUuc3RyaW5ncztyZXR1cm4gYS5pc0Z1bmN0aW9uKGMpP2MuY2FsbCh0aGlzLGIpOmMmJmNbYl0/Y1tiXTpifSxfZmlyc3RDaGlsZDpmdW5jdGlvbihhKXthPWE/YS5maXJzdENoaWxkOm51bGw7d2hpbGUobnVsbCE9PWEmJjEhPT1hLm5vZGVUeXBlKWE9YS5uZXh0U2libGluZztyZXR1cm4gYX0sX25leHRTaWJsaW5nOmZ1bmN0aW9uKGEpe2E9YT9hLm5leHRTaWJsaW5nOm51bGw7d2hpbGUobnVsbCE9PWEmJjEhPT1hLm5vZGVUeXBlKWE9YS5uZXh0U2libGluZztyZXR1cm4gYX0sX3ByZXZpb3VzU2libGluZzpmdW5jdGlvbihhKXthPWE/YS5wcmV2aW91c1NpYmxpbmc6bnVsbDt3aGlsZShudWxsIT09YSYmMSE9PWEubm9kZVR5cGUpYT1hLnByZXZpb3VzU2libGluZztyZXR1cm4gYX0sZ2V0X25vZGU6ZnVuY3Rpb24oYixjKXtiJiZiLmlkJiYoYj1iLmlkKTt2YXIgZDt0cnl7aWYodGhpcy5fbW9kZWwuZGF0YVtiXSliPXRoaXMuX21vZGVsLmRhdGFbYl07ZWxzZSBpZihcInN0cmluZ1wiPT10eXBlb2YgYiYmdGhpcy5fbW9kZWwuZGF0YVtiLnJlcGxhY2UoL14jLyxcIlwiKV0pYj10aGlzLl9tb2RlbC5kYXRhW2IucmVwbGFjZSgvXiMvLFwiXCIpXTtlbHNlIGlmKFwic3RyaW5nXCI9PXR5cGVvZiBiJiYoZD1hKFwiI1wiK2IucmVwbGFjZShhLmpzdHJlZS5pZHJlZ2V4LFwiXFxcXCQmXCIpLHRoaXMuZWxlbWVudCkpLmxlbmd0aCYmdGhpcy5fbW9kZWwuZGF0YVtkLmNsb3Nlc3QoXCIuanN0cmVlLW5vZGVcIikuYXR0cihcImlkXCIpXSliPXRoaXMuX21vZGVsLmRhdGFbZC5jbG9zZXN0KFwiLmpzdHJlZS1ub2RlXCIpLmF0dHIoXCJpZFwiKV07ZWxzZSBpZigoZD1hKGIsdGhpcy5lbGVtZW50KSkubGVuZ3RoJiZ0aGlzLl9tb2RlbC5kYXRhW2QuY2xvc2VzdChcIi5qc3RyZWUtbm9kZVwiKS5hdHRyKFwiaWRcIildKWI9dGhpcy5fbW9kZWwuZGF0YVtkLmNsb3Nlc3QoXCIuanN0cmVlLW5vZGVcIikuYXR0cihcImlkXCIpXTtlbHNle2lmKCEoZD1hKGIsdGhpcy5lbGVtZW50KSkubGVuZ3RofHwhZC5oYXNDbGFzcyhcImpzdHJlZVwiKSlyZXR1cm4hMTtiPXRoaXMuX21vZGVsLmRhdGFbYS5qc3RyZWUucm9vdF19cmV0dXJuIGMmJihiPWIuaWQ9PT1hLmpzdHJlZS5yb290P3RoaXMuZWxlbWVudDphKFwiI1wiK2IuaWQucmVwbGFjZShhLmpzdHJlZS5pZHJlZ2V4LFwiXFxcXCQmXCIpLHRoaXMuZWxlbWVudCkpLGJ9Y2F0Y2goZSl7cmV0dXJuITF9fSxnZXRfcGF0aDpmdW5jdGlvbihiLGMsZCl7aWYoYj1iLnBhcmVudHM/Yjp0aGlzLmdldF9ub2RlKGIpLCFifHxiLmlkPT09YS5qc3RyZWUucm9vdHx8IWIucGFyZW50cylyZXR1cm4hMTt2YXIgZSxmLGc9W107Zm9yKGcucHVzaChkP2IuaWQ6Yi50ZXh0KSxlPTAsZj1iLnBhcmVudHMubGVuZ3RoO2Y+ZTtlKyspZy5wdXNoKGQ/Yi5wYXJlbnRzW2VdOnRoaXMuZ2V0X3RleHQoYi5wYXJlbnRzW2VdKSk7cmV0dXJuIGc9Zy5yZXZlcnNlKCkuc2xpY2UoMSksYz9nLmpvaW4oYyk6Z30sZ2V0X25leHRfZG9tOmZ1bmN0aW9uKGIsYyl7dmFyIGQ7aWYoYj10aGlzLmdldF9ub2RlKGIsITApLGJbMF09PT10aGlzLmVsZW1lbnRbMF0pe2Q9dGhpcy5fZmlyc3RDaGlsZCh0aGlzLmdldF9jb250YWluZXJfdWwoKVswXSk7d2hpbGUoZCYmMD09PWQub2Zmc2V0SGVpZ2h0KWQ9dGhpcy5fbmV4dFNpYmxpbmcoZCk7cmV0dXJuIGQ/YShkKTohMX1pZighYnx8IWIubGVuZ3RoKXJldHVybiExO2lmKGMpe2Q9YlswXTtkbyBkPXRoaXMuX25leHRTaWJsaW5nKGQpO3doaWxlKGQmJjA9PT1kLm9mZnNldEhlaWdodCk7cmV0dXJuIGQ/YShkKTohMX1pZihiLmhhc0NsYXNzKFwianN0cmVlLW9wZW5cIikpe2Q9dGhpcy5fZmlyc3RDaGlsZChiLmNoaWxkcmVuKFwiLmpzdHJlZS1jaGlsZHJlblwiKVswXSk7d2hpbGUoZCYmMD09PWQub2Zmc2V0SGVpZ2h0KWQ9dGhpcy5fbmV4dFNpYmxpbmcoZCk7aWYobnVsbCE9PWQpcmV0dXJuIGEoZCl9ZD1iWzBdO2RvIGQ9dGhpcy5fbmV4dFNpYmxpbmcoZCk7d2hpbGUoZCYmMD09PWQub2Zmc2V0SGVpZ2h0KTtyZXR1cm4gbnVsbCE9PWQ/YShkKTpiLnBhcmVudHNVbnRpbChcIi5qc3RyZWVcIixcIi5qc3RyZWUtbm9kZVwiKS5uZXh0QWxsKFwiLmpzdHJlZS1ub2RlOnZpc2libGVcIikuZmlyc3QoKX0sZ2V0X3ByZXZfZG9tOmZ1bmN0aW9uKGIsYyl7dmFyIGQ7aWYoYj10aGlzLmdldF9ub2RlKGIsITApLGJbMF09PT10aGlzLmVsZW1lbnRbMF0pe2Q9dGhpcy5nZXRfY29udGFpbmVyX3VsKClbMF0ubGFzdENoaWxkO3doaWxlKGQmJjA9PT1kLm9mZnNldEhlaWdodClkPXRoaXMuX3ByZXZpb3VzU2libGluZyhkKTtyZXR1cm4gZD9hKGQpOiExfWlmKCFifHwhYi5sZW5ndGgpcmV0dXJuITE7aWYoYyl7ZD1iWzBdO2RvIGQ9dGhpcy5fcHJldmlvdXNTaWJsaW5nKGQpO3doaWxlKGQmJjA9PT1kLm9mZnNldEhlaWdodCk7cmV0dXJuIGQ/YShkKTohMX1kPWJbMF07ZG8gZD10aGlzLl9wcmV2aW91c1NpYmxpbmcoZCk7d2hpbGUoZCYmMD09PWQub2Zmc2V0SGVpZ2h0KTtpZihudWxsIT09ZCl7Yj1hKGQpO3doaWxlKGIuaGFzQ2xhc3MoXCJqc3RyZWUtb3BlblwiKSliPWIuY2hpbGRyZW4oXCIuanN0cmVlLWNoaWxkcmVuXCIpLmZpcnN0KCkuY2hpbGRyZW4oXCIuanN0cmVlLW5vZGU6dmlzaWJsZTpsYXN0XCIpO3JldHVybiBifXJldHVybiBkPWJbMF0ucGFyZW50Tm9kZS5wYXJlbnROb2RlLGQmJmQuY2xhc3NOYW1lJiYtMSE9PWQuY2xhc3NOYW1lLmluZGV4T2YoXCJqc3RyZWUtbm9kZVwiKT9hKGQpOiExfSxnZXRfcGFyZW50OmZ1bmN0aW9uKGIpe3JldHVybiBiPXRoaXMuZ2V0X25vZGUoYiksYiYmYi5pZCE9PWEuanN0cmVlLnJvb3Q/Yi5wYXJlbnQ6ITF9LGdldF9jaGlsZHJlbl9kb206ZnVuY3Rpb24oYSl7cmV0dXJuIGE9dGhpcy5nZXRfbm9kZShhLCEwKSxhWzBdPT09dGhpcy5lbGVtZW50WzBdP3RoaXMuZ2V0X2NvbnRhaW5lcl91bCgpLmNoaWxkcmVuKFwiLmpzdHJlZS1ub2RlXCIpOmEmJmEubGVuZ3RoP2EuY2hpbGRyZW4oXCIuanN0cmVlLWNoaWxkcmVuXCIpLmNoaWxkcmVuKFwiLmpzdHJlZS1ub2RlXCIpOiExfSxpc19wYXJlbnQ6ZnVuY3Rpb24oYSl7cmV0dXJuIGE9dGhpcy5nZXRfbm9kZShhKSxhJiYoYS5zdGF0ZS5sb2FkZWQ9PT0hMXx8YS5jaGlsZHJlbi5sZW5ndGg+MCl9LGlzX2xvYWRlZDpmdW5jdGlvbihhKXtyZXR1cm4gYT10aGlzLmdldF9ub2RlKGEpLGEmJmEuc3RhdGUubG9hZGVkfSxpc19sb2FkaW5nOmZ1bmN0aW9uKGEpe3JldHVybiBhPXRoaXMuZ2V0X25vZGUoYSksYSYmYS5zdGF0ZSYmYS5zdGF0ZS5sb2FkaW5nfSxpc19vcGVuOmZ1bmN0aW9uKGEpe3JldHVybiBhPXRoaXMuZ2V0X25vZGUoYSksYSYmYS5zdGF0ZS5vcGVuZWR9LGlzX2Nsb3NlZDpmdW5jdGlvbihhKXtyZXR1cm4gYT10aGlzLmdldF9ub2RlKGEpLGEmJnRoaXMuaXNfcGFyZW50KGEpJiYhYS5zdGF0ZS5vcGVuZWR9LGlzX2xlYWY6ZnVuY3Rpb24oYSl7cmV0dXJuIXRoaXMuaXNfcGFyZW50KGEpfSxsb2FkX25vZGU6ZnVuY3Rpb24oYixjKXt2YXIgZCxlLGYsZyxoO2lmKGEuaXNBcnJheShiKSlyZXR1cm4gdGhpcy5fbG9hZF9ub2RlcyhiLnNsaWNlKCksYyksITA7aWYoYj10aGlzLmdldF9ub2RlKGIpLCFiKXJldHVybiBjJiZjLmNhbGwodGhpcyxiLCExKSwhMTtpZihiLnN0YXRlLmxvYWRlZCl7Zm9yKGIuc3RhdGUubG9hZGVkPSExLGY9MCxnPWIucGFyZW50cy5sZW5ndGg7Zz5mO2YrKyl0aGlzLl9tb2RlbC5kYXRhW2IucGFyZW50c1tmXV0uY2hpbGRyZW5fZD1hLnZha2F0YS5hcnJheV9maWx0ZXIodGhpcy5fbW9kZWwuZGF0YVtiLnBhcmVudHNbZl1dLmNoaWxkcmVuX2QsZnVuY3Rpb24oYyl7cmV0dXJuLTE9PT1hLmluQXJyYXkoYyxiLmNoaWxkcmVuX2QpfSk7Zm9yKGQ9MCxlPWIuY2hpbGRyZW5fZC5sZW5ndGg7ZT5kO2QrKyl0aGlzLl9tb2RlbC5kYXRhW2IuY2hpbGRyZW5fZFtkXV0uc3RhdGUuc2VsZWN0ZWQmJihoPSEwKSxkZWxldGUgdGhpcy5fbW9kZWwuZGF0YVtiLmNoaWxkcmVuX2RbZF1dO2gmJih0aGlzLl9kYXRhLmNvcmUuc2VsZWN0ZWQ9YS52YWthdGEuYXJyYXlfZmlsdGVyKHRoaXMuX2RhdGEuY29yZS5zZWxlY3RlZCxmdW5jdGlvbihjKXtyZXR1cm4tMT09PWEuaW5BcnJheShjLGIuY2hpbGRyZW5fZCl9KSksYi5jaGlsZHJlbj1bXSxiLmNoaWxkcmVuX2Q9W10saCYmdGhpcy50cmlnZ2VyKFwiY2hhbmdlZFwiLHthY3Rpb246XCJsb2FkX25vZGVcIixub2RlOmIsc2VsZWN0ZWQ6dGhpcy5fZGF0YS5jb3JlLnNlbGVjdGVkfSl9cmV0dXJuIGIuc3RhdGUuZmFpbGVkPSExLGIuc3RhdGUubG9hZGluZz0hMCx0aGlzLmdldF9ub2RlKGIsITApLmFkZENsYXNzKFwianN0cmVlLWxvYWRpbmdcIikuYXR0cihcImFyaWEtYnVzeVwiLCEwKSx0aGlzLl9sb2FkX25vZGUoYixhLnByb3h5KGZ1bmN0aW9uKGEpe2I9dGhpcy5fbW9kZWwuZGF0YVtiLmlkXSxiLnN0YXRlLmxvYWRpbmc9ITEsYi5zdGF0ZS5sb2FkZWQ9YSxiLnN0YXRlLmZhaWxlZD0hYi5zdGF0ZS5sb2FkZWQ7dmFyIGQ9dGhpcy5nZXRfbm9kZShiLCEwKSxlPTAsZj0wLGc9dGhpcy5fbW9kZWwuZGF0YSxoPSExO2ZvcihlPTAsZj1iLmNoaWxkcmVuLmxlbmd0aDtmPmU7ZSsrKWlmKGdbYi5jaGlsZHJlbltlXV0mJiFnW2IuY2hpbGRyZW5bZV1dLnN0YXRlLmhpZGRlbil7aD0hMDticmVha31iLnN0YXRlLmxvYWRlZCYmZCYmZC5sZW5ndGgmJihkLnJlbW92ZUNsYXNzKFwianN0cmVlLWNsb3NlZCBqc3RyZWUtb3BlbiBqc3RyZWUtbGVhZlwiKSxoP1wiI1wiIT09Yi5pZCYmZC5hZGRDbGFzcyhiLnN0YXRlLm9wZW5lZD9cImpzdHJlZS1vcGVuXCI6XCJqc3RyZWUtY2xvc2VkXCIpOmQuYWRkQ2xhc3MoXCJqc3RyZWUtbGVhZlwiKSksZC5yZW1vdmVDbGFzcyhcImpzdHJlZS1sb2FkaW5nXCIpLmF0dHIoXCJhcmlhLWJ1c3lcIiwhMSksdGhpcy50cmlnZ2VyKFwibG9hZF9ub2RlXCIse25vZGU6YixzdGF0dXM6YX0pLGMmJmMuY2FsbCh0aGlzLGIsYSl9LHRoaXMpKSwhMH0sX2xvYWRfbm9kZXM6ZnVuY3Rpb24oYSxiLGMsZCl7dmFyIGU9ITAsZj1mdW5jdGlvbigpe3RoaXMuX2xvYWRfbm9kZXMoYSxiLCEwKX0sZz10aGlzLl9tb2RlbC5kYXRhLGgsaSxqPVtdO2ZvcihoPTAsaT1hLmxlbmd0aDtpPmg7aCsrKWdbYVtoXV0mJighZ1thW2hdXS5zdGF0ZS5sb2FkZWQmJiFnW2FbaF1dLnN0YXRlLmZhaWxlZHx8IWMmJmQpJiYodGhpcy5pc19sb2FkaW5nKGFbaF0pfHx0aGlzLmxvYWRfbm9kZShhW2hdLGYpLGU9ITEpO2lmKGUpe2ZvcihoPTAsaT1hLmxlbmd0aDtpPmg7aCsrKWdbYVtoXV0mJmdbYVtoXV0uc3RhdGUubG9hZGVkJiZqLnB1c2goYVtoXSk7YiYmIWIuZG9uZSYmKGIuY2FsbCh0aGlzLGopLGIuZG9uZT0hMCl9fSxsb2FkX2FsbDpmdW5jdGlvbihiLGMpe2lmKGJ8fChiPWEuanN0cmVlLnJvb3QpLGI9dGhpcy5nZXRfbm9kZShiKSwhYilyZXR1cm4hMTt2YXIgZD1bXSxlPXRoaXMuX21vZGVsLmRhdGEsZj1lW2IuaWRdLmNoaWxkcmVuX2QsZyxoO2ZvcihiLnN0YXRlJiYhYi5zdGF0ZS5sb2FkZWQmJmQucHVzaChiLmlkKSxnPTAsaD1mLmxlbmd0aDtoPmc7ZysrKWVbZltnXV0mJmVbZltnXV0uc3RhdGUmJiFlW2ZbZ11dLnN0YXRlLmxvYWRlZCYmZC5wdXNoKGZbZ10pO2QubGVuZ3RoP3RoaXMuX2xvYWRfbm9kZXMoZCxmdW5jdGlvbigpe3RoaXMubG9hZF9hbGwoYixjKX0pOihjJiZjLmNhbGwodGhpcyxiKSx0aGlzLnRyaWdnZXIoXCJsb2FkX2FsbFwiLHtub2RlOmJ9KSl9LF9sb2FkX25vZGU6ZnVuY3Rpb24oYixjKXt2YXIgZD10aGlzLnNldHRpbmdzLmNvcmUuZGF0YSxlO3JldHVybiBkP2EuaXNGdW5jdGlvbihkKT9kLmNhbGwodGhpcyxiLGEucHJveHkoZnVuY3Rpb24oZCl7ZD09PSExP2MuY2FsbCh0aGlzLCExKTp0aGlzW1wic3RyaW5nXCI9PXR5cGVvZiBkP1wiX2FwcGVuZF9odG1sX2RhdGFcIjpcIl9hcHBlbmRfanNvbl9kYXRhXCJdKGIsXCJzdHJpbmdcIj09dHlwZW9mIGQ/YShhLnBhcnNlSFRNTChkKSkuZmlsdGVyKGZ1bmN0aW9uKCl7cmV0dXJuIDMhPT10aGlzLm5vZGVUeXBlfSk6ZCxmdW5jdGlvbihhKXtjLmNhbGwodGhpcyxhKX0pfSx0aGlzKSk6XCJvYmplY3RcIj09dHlwZW9mIGQ/ZC51cmw/KGQ9YS5leHRlbmQoITAse30sZCksYS5pc0Z1bmN0aW9uKGQudXJsKSYmKGQudXJsPWQudXJsLmNhbGwodGhpcyxiKSksYS5pc0Z1bmN0aW9uKGQuZGF0YSkmJihkLmRhdGE9ZC5kYXRhLmNhbGwodGhpcyxiKSksYS5hamF4KGQpLmRvbmUoYS5wcm94eShmdW5jdGlvbihkLGUsZil7dmFyIGc9Zi5nZXRSZXNwb25zZUhlYWRlcihcIkNvbnRlbnQtVHlwZVwiKTtyZXR1cm4gZyYmLTEhPT1nLmluZGV4T2YoXCJqc29uXCIpfHxcIm9iamVjdFwiPT10eXBlb2YgZD90aGlzLl9hcHBlbmRfanNvbl9kYXRhKGIsZCxmdW5jdGlvbihhKXtjLmNhbGwodGhpcyxhKX0pOmcmJi0xIT09Zy5pbmRleE9mKFwiaHRtbFwiKXx8XCJzdHJpbmdcIj09dHlwZW9mIGQ/dGhpcy5fYXBwZW5kX2h0bWxfZGF0YShiLGEoYS5wYXJzZUhUTUwoZCkpLmZpbHRlcihmdW5jdGlvbigpe3JldHVybiAzIT09dGhpcy5ub2RlVHlwZX0pLGZ1bmN0aW9uKGEpe2MuY2FsbCh0aGlzLGEpfSk6KHRoaXMuX2RhdGEuY29yZS5sYXN0X2Vycm9yPXtlcnJvcjpcImFqYXhcIixwbHVnaW46XCJjb3JlXCIsaWQ6XCJjb3JlXzA0XCIscmVhc29uOlwiQ291bGQgbm90IGxvYWQgbm9kZVwiLGRhdGE6SlNPTi5zdHJpbmdpZnkoe2lkOmIuaWQseGhyOmZ9KX0sdGhpcy5zZXR0aW5ncy5jb3JlLmVycm9yLmNhbGwodGhpcyx0aGlzLl9kYXRhLmNvcmUubGFzdF9lcnJvciksYy5jYWxsKHRoaXMsITEpKX0sdGhpcykpLmZhaWwoYS5wcm94eShmdW5jdGlvbihhKXtjLmNhbGwodGhpcywhMSksdGhpcy5fZGF0YS5jb3JlLmxhc3RfZXJyb3I9e2Vycm9yOlwiYWpheFwiLHBsdWdpbjpcImNvcmVcIixpZDpcImNvcmVfMDRcIixyZWFzb246XCJDb3VsZCBub3QgbG9hZCBub2RlXCIsZGF0YTpKU09OLnN0cmluZ2lmeSh7aWQ6Yi5pZCx4aHI6YX0pfSx0aGlzLnNldHRpbmdzLmNvcmUuZXJyb3IuY2FsbCh0aGlzLHRoaXMuX2RhdGEuY29yZS5sYXN0X2Vycm9yKX0sdGhpcykpKTooZT1hLmlzQXJyYXkoZCl8fGEuaXNQbGFpbk9iamVjdChkKT9KU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KGQpKTpkLGIuaWQ9PT1hLmpzdHJlZS5yb290P3RoaXMuX2FwcGVuZF9qc29uX2RhdGEoYixlLGZ1bmN0aW9uKGEpe2MuY2FsbCh0aGlzLGEpfSk6KHRoaXMuX2RhdGEuY29yZS5sYXN0X2Vycm9yPXtlcnJvcjpcIm5vZGF0YVwiLHBsdWdpbjpcImNvcmVcIixpZDpcImNvcmVfMDVcIixyZWFzb246XCJDb3VsZCBub3QgbG9hZCBub2RlXCIsZGF0YTpKU09OLnN0cmluZ2lmeSh7aWQ6Yi5pZH0pfSx0aGlzLnNldHRpbmdzLmNvcmUuZXJyb3IuY2FsbCh0aGlzLHRoaXMuX2RhdGEuY29yZS5sYXN0X2Vycm9yKSxjLmNhbGwodGhpcywhMSkpKTpcInN0cmluZ1wiPT10eXBlb2YgZD9iLmlkPT09YS5qc3RyZWUucm9vdD90aGlzLl9hcHBlbmRfaHRtbF9kYXRhKGIsYShhLnBhcnNlSFRNTChkKSkuZmlsdGVyKGZ1bmN0aW9uKCl7cmV0dXJuIDMhPT10aGlzLm5vZGVUeXBlfSksZnVuY3Rpb24oYSl7Yy5jYWxsKHRoaXMsYSl9KToodGhpcy5fZGF0YS5jb3JlLmxhc3RfZXJyb3I9e2Vycm9yOlwibm9kYXRhXCIscGx1Z2luOlwiY29yZVwiLGlkOlwiY29yZV8wNlwiLHJlYXNvbjpcIkNvdWxkIG5vdCBsb2FkIG5vZGVcIixkYXRhOkpTT04uc3RyaW5naWZ5KHtpZDpiLmlkfSl9LHRoaXMuc2V0dGluZ3MuY29yZS5lcnJvci5jYWxsKHRoaXMsdGhpcy5fZGF0YS5jb3JlLmxhc3RfZXJyb3IpLGMuY2FsbCh0aGlzLCExKSk6Yy5jYWxsKHRoaXMsITEpOmIuaWQ9PT1hLmpzdHJlZS5yb290P3RoaXMuX2FwcGVuZF9odG1sX2RhdGEoYix0aGlzLl9kYXRhLmNvcmUub3JpZ2luYWxfY29udGFpbmVyX2h0bWwuY2xvbmUoITApLGZ1bmN0aW9uKGEpe2MuY2FsbCh0aGlzLGEpfSk6Yy5jYWxsKHRoaXMsITEpfSxfbm9kZV9jaGFuZ2VkOmZ1bmN0aW9uKGEpe2E9dGhpcy5nZXRfbm9kZShhKSxhJiZ0aGlzLl9tb2RlbC5jaGFuZ2VkLnB1c2goYS5pZCl9LF9hcHBlbmRfaHRtbF9kYXRhOmZ1bmN0aW9uKGIsYyxkKXtiPXRoaXMuZ2V0X25vZGUoYiksYi5jaGlsZHJlbj1bXSxiLmNoaWxkcmVuX2Q9W107dmFyIGU9Yy5pcyhcInVsXCIpP2MuY2hpbGRyZW4oKTpjLGY9Yi5pZCxnPVtdLGg9W10saT10aGlzLl9tb2RlbC5kYXRhLGo9aVtmXSxrPXRoaXMuX2RhdGEuY29yZS5zZWxlY3RlZC5sZW5ndGgsbCxtLG47Zm9yKGUuZWFjaChhLnByb3h5KGZ1bmN0aW9uKGIsYyl7bD10aGlzLl9wYXJzZV9tb2RlbF9mcm9tX2h0bWwoYShjKSxmLGoucGFyZW50cy5jb25jYXQoKSksbCYmKGcucHVzaChsKSxoLnB1c2gobCksaVtsXS5jaGlsZHJlbl9kLmxlbmd0aCYmKGg9aC5jb25jYXQoaVtsXS5jaGlsZHJlbl9kKSkpfSx0aGlzKSksai5jaGlsZHJlbj1nLGouY2hpbGRyZW5fZD1oLG09MCxuPWoucGFyZW50cy5sZW5ndGg7bj5tO20rKylpW2oucGFyZW50c1ttXV0uY2hpbGRyZW5fZD1pW2oucGFyZW50c1ttXV0uY2hpbGRyZW5fZC5jb25jYXQoaCk7dGhpcy50cmlnZ2VyKFwibW9kZWxcIix7bm9kZXM6aCxwYXJlbnQ6Zn0pLGYhPT1hLmpzdHJlZS5yb290Pyh0aGlzLl9ub2RlX2NoYW5nZWQoZiksdGhpcy5yZWRyYXcoKSk6KHRoaXMuZ2V0X2NvbnRhaW5lcl91bCgpLmNoaWxkcmVuKFwiLmpzdHJlZS1pbml0aWFsLW5vZGVcIikucmVtb3ZlKCksdGhpcy5yZWRyYXcoITApKSx0aGlzLl9kYXRhLmNvcmUuc2VsZWN0ZWQubGVuZ3RoIT09ayYmdGhpcy50cmlnZ2VyKFwiY2hhbmdlZFwiLHthY3Rpb246XCJtb2RlbFwiLHNlbGVjdGVkOnRoaXMuX2RhdGEuY29yZS5zZWxlY3RlZH0pLGQuY2FsbCh0aGlzLCEwKX0sX2FwcGVuZF9qc29uX2RhdGE6ZnVuY3Rpb24oYixjLGQsZSl7aWYobnVsbCE9PXRoaXMuZWxlbWVudCl7Yj10aGlzLmdldF9ub2RlKGIpLGIuY2hpbGRyZW49W10sYi5jaGlsZHJlbl9kPVtdLGMuZCYmKGM9Yy5kLFwic3RyaW5nXCI9PXR5cGVvZiBjJiYoYz1KU09OLnBhcnNlKGMpKSksYS5pc0FycmF5KGMpfHwoYz1bY10pO3ZhciBmPW51bGwsZz17ZGY6dGhpcy5fbW9kZWwuZGVmYXVsdF9zdGF0ZSxkYXQ6YyxwYXI6Yi5pZCxtOnRoaXMuX21vZGVsLmRhdGEsdF9pZDp0aGlzLl9pZCx0X2NudDp0aGlzLl9jbnQsc2VsOnRoaXMuX2RhdGEuY29yZS5zZWxlY3RlZH0saD1mdW5jdGlvbihhLGIpe2EuZGF0YSYmKGE9YS5kYXRhKTt2YXIgYz1hLmRhdCxkPWEucGFyLGU9W10sZj1bXSxnPVtdLGg9YS5kZixpPWEudF9pZCxqPWEudF9jbnQsaz1hLm0sbD1rW2RdLG09YS5zZWwsbixvLHAscSxyPWZ1bmN0aW9uKGEsYyxkKXtkPWQ/ZC5jb25jYXQoKTpbXSxjJiZkLnVuc2hpZnQoYyk7dmFyIGU9YS5pZC50b1N0cmluZygpLGYsaSxqLGwsbT17aWQ6ZSx0ZXh0OmEudGV4dHx8XCJcIixpY29uOmEuaWNvbiE9PWI/YS5pY29uOiEwLHBhcmVudDpjLHBhcmVudHM6ZCxjaGlsZHJlbjphLmNoaWxkcmVufHxbXSxjaGlsZHJlbl9kOmEuY2hpbGRyZW5fZHx8W10sZGF0YTphLmRhdGEsc3RhdGU6e30sbGlfYXR0cjp7aWQ6ITF9LGFfYXR0cjp7aHJlZjpcIiNcIn0sb3JpZ2luYWw6ITF9O2ZvcihmIGluIGgpaC5oYXNPd25Qcm9wZXJ0eShmKSYmKG0uc3RhdGVbZl09aFtmXSk7aWYoYSYmYS5kYXRhJiZhLmRhdGEuanN0cmVlJiZhLmRhdGEuanN0cmVlLmljb24mJihtLmljb249YS5kYXRhLmpzdHJlZS5pY29uKSxtLmljb24hPT1iJiZudWxsIT09bS5pY29uJiZcIlwiIT09bS5pY29ufHwobS5pY29uPSEwKSxhJiZhLmRhdGEmJihtLmRhdGE9YS5kYXRhLGEuZGF0YS5qc3RyZWUpKWZvcihmIGluIGEuZGF0YS5qc3RyZWUpYS5kYXRhLmpzdHJlZS5oYXNPd25Qcm9wZXJ0eShmKSYmKG0uc3RhdGVbZl09YS5kYXRhLmpzdHJlZVtmXSk7aWYoYSYmXCJvYmplY3RcIj09dHlwZW9mIGEuc3RhdGUpZm9yKGYgaW4gYS5zdGF0ZSlhLnN0YXRlLmhhc093blByb3BlcnR5KGYpJiYobS5zdGF0ZVtmXT1hLnN0YXRlW2ZdKTtpZihhJiZcIm9iamVjdFwiPT10eXBlb2YgYS5saV9hdHRyKWZvcihmIGluIGEubGlfYXR0cilhLmxpX2F0dHIuaGFzT3duUHJvcGVydHkoZikmJihtLmxpX2F0dHJbZl09YS5saV9hdHRyW2ZdKTtpZihtLmxpX2F0dHIuaWR8fChtLmxpX2F0dHIuaWQ9ZSksYSYmXCJvYmplY3RcIj09dHlwZW9mIGEuYV9hdHRyKWZvcihmIGluIGEuYV9hdHRyKWEuYV9hdHRyLmhhc093blByb3BlcnR5KGYpJiYobS5hX2F0dHJbZl09YS5hX2F0dHJbZl0pO2ZvcihhJiZhLmNoaWxkcmVuJiZhLmNoaWxkcmVuPT09ITAmJihtLnN0YXRlLmxvYWRlZD0hMSxtLmNoaWxkcmVuPVtdLG0uY2hpbGRyZW5fZD1bXSksa1ttLmlkXT1tLGY9MCxpPW0uY2hpbGRyZW4ubGVuZ3RoO2k+ZjtmKyspaj1yKGtbbS5jaGlsZHJlbltmXV0sbS5pZCxkKSxsPWtbal0sbS5jaGlsZHJlbl9kLnB1c2goaiksbC5jaGlsZHJlbl9kLmxlbmd0aCYmKG0uY2hpbGRyZW5fZD1tLmNoaWxkcmVuX2QuY29uY2F0KGwuY2hpbGRyZW5fZCkpO3JldHVybiBkZWxldGUgYS5kYXRhLGRlbGV0ZSBhLmNoaWxkcmVuLGtbbS5pZF0ub3JpZ2luYWw9YSxtLnN0YXRlLnNlbGVjdGVkJiZnLnB1c2gobS5pZCksbS5pZH0scz1mdW5jdGlvbihhLGMsZCl7ZD1kP2QuY29uY2F0KCk6W10sYyYmZC51bnNoaWZ0KGMpO3ZhciBlPSExLGYsbCxtLG4sbztkbyBlPVwialwiK2krXCJfXCIrICsrajt3aGlsZShrW2VdKTtvPXtpZDohMSx0ZXh0Olwic3RyaW5nXCI9PXR5cGVvZiBhP2E6XCJcIixpY29uOlwib2JqZWN0XCI9PXR5cGVvZiBhJiZhLmljb24hPT1iP2EuaWNvbjohMCxwYXJlbnQ6YyxwYXJlbnRzOmQsY2hpbGRyZW46W10sY2hpbGRyZW5fZDpbXSxkYXRhOm51bGwsc3RhdGU6e30sbGlfYXR0cjp7aWQ6ITF9LGFfYXR0cjp7aHJlZjpcIiNcIn0sb3JpZ2luYWw6ITF9O2ZvcihmIGluIGgpaC5oYXNPd25Qcm9wZXJ0eShmKSYmKG8uc3RhdGVbZl09aFtmXSk7aWYoYSYmYS5pZCYmKG8uaWQ9YS5pZC50b1N0cmluZygpKSxhJiZhLnRleHQmJihvLnRleHQ9YS50ZXh0KSxhJiZhLmRhdGEmJmEuZGF0YS5qc3RyZWUmJmEuZGF0YS5qc3RyZWUuaWNvbiYmKG8uaWNvbj1hLmRhdGEuanN0cmVlLmljb24pLG8uaWNvbiE9PWImJm51bGwhPT1vLmljb24mJlwiXCIhPT1vLmljb258fChvLmljb249ITApLGEmJmEuZGF0YSYmKG8uZGF0YT1hLmRhdGEsYS5kYXRhLmpzdHJlZSkpZm9yKGYgaW4gYS5kYXRhLmpzdHJlZSlhLmRhdGEuanN0cmVlLmhhc093blByb3BlcnR5KGYpJiYoby5zdGF0ZVtmXT1hLmRhdGEuanN0cmVlW2ZdKTtpZihhJiZcIm9iamVjdFwiPT10eXBlb2YgYS5zdGF0ZSlmb3IoZiBpbiBhLnN0YXRlKWEuc3RhdGUuaGFzT3duUHJvcGVydHkoZikmJihvLnN0YXRlW2ZdPWEuc3RhdGVbZl0pO2lmKGEmJlwib2JqZWN0XCI9PXR5cGVvZiBhLmxpX2F0dHIpZm9yKGYgaW4gYS5saV9hdHRyKWEubGlfYXR0ci5oYXNPd25Qcm9wZXJ0eShmKSYmKG8ubGlfYXR0cltmXT1hLmxpX2F0dHJbZl0pO2lmKG8ubGlfYXR0ci5pZCYmIW8uaWQmJihvLmlkPW8ubGlfYXR0ci5pZC50b1N0cmluZygpKSxvLmlkfHwoby5pZD1lKSxvLmxpX2F0dHIuaWR8fChvLmxpX2F0dHIuaWQ9by5pZCksYSYmXCJvYmplY3RcIj09dHlwZW9mIGEuYV9hdHRyKWZvcihmIGluIGEuYV9hdHRyKWEuYV9hdHRyLmhhc093blByb3BlcnR5KGYpJiYoby5hX2F0dHJbZl09YS5hX2F0dHJbZl0pO2lmKGEmJmEuY2hpbGRyZW4mJmEuY2hpbGRyZW4ubGVuZ3RoKXtmb3IoZj0wLGw9YS5jaGlsZHJlbi5sZW5ndGg7bD5mO2YrKyltPXMoYS5jaGlsZHJlbltmXSxvLmlkLGQpLG49a1ttXSxvLmNoaWxkcmVuLnB1c2gobSksbi5jaGlsZHJlbl9kLmxlbmd0aCYmKG8uY2hpbGRyZW5fZD1vLmNoaWxkcmVuX2QuY29uY2F0KG4uY2hpbGRyZW5fZCkpO28uY2hpbGRyZW5fZD1vLmNoaWxkcmVuX2QuY29uY2F0KG8uY2hpbGRyZW4pfXJldHVybiBhJiZhLmNoaWxkcmVuJiZhLmNoaWxkcmVuPT09ITAmJihvLnN0YXRlLmxvYWRlZD0hMSxvLmNoaWxkcmVuPVtdLG8uY2hpbGRyZW5fZD1bXSksZGVsZXRlIGEuZGF0YSxkZWxldGUgYS5jaGlsZHJlbixvLm9yaWdpbmFsPWEsa1tvLmlkXT1vLG8uc3RhdGUuc2VsZWN0ZWQmJmcucHVzaChvLmlkKSxvLmlkfTtpZihjLmxlbmd0aCYmY1swXS5pZCE9PWImJmNbMF0ucGFyZW50IT09Yil7Zm9yKG89MCxwPWMubGVuZ3RoO3A+bztvKyspY1tvXS5jaGlsZHJlbnx8KGNbb10uY2hpbGRyZW49W10pLGtbY1tvXS5pZC50b1N0cmluZygpXT1jW29dO2ZvcihvPTAscD1jLmxlbmd0aDtwPm87bysrKWtbY1tvXS5wYXJlbnQudG9TdHJpbmcoKV0uY2hpbGRyZW4ucHVzaChjW29dLmlkLnRvU3RyaW5nKCkpLGwuY2hpbGRyZW5fZC5wdXNoKGNbb10uaWQudG9TdHJpbmcoKSk7Zm9yKG89MCxwPWwuY2hpbGRyZW4ubGVuZ3RoO3A+bztvKyspbj1yKGtbbC5jaGlsZHJlbltvXV0sZCxsLnBhcmVudHMuY29uY2F0KCkpLGYucHVzaChuKSxrW25dLmNoaWxkcmVuX2QubGVuZ3RoJiYoZj1mLmNvbmNhdChrW25dLmNoaWxkcmVuX2QpKTtmb3Iobz0wLHA9bC5wYXJlbnRzLmxlbmd0aDtwPm87bysrKWtbbC5wYXJlbnRzW29dXS5jaGlsZHJlbl9kPWtbbC5wYXJlbnRzW29dXS5jaGlsZHJlbl9kLmNvbmNhdChmKTtxPXtjbnQ6aixtb2Q6ayxzZWw6bSxwYXI6ZCxkcGM6ZixhZGQ6Z319ZWxzZXtmb3Iobz0wLHA9Yy5sZW5ndGg7cD5vO28rKyluPXMoY1tvXSxkLGwucGFyZW50cy5jb25jYXQoKSksbiYmKGUucHVzaChuKSxmLnB1c2gobiksa1tuXS5jaGlsZHJlbl9kLmxlbmd0aCYmKGY9Zi5jb25jYXQoa1tuXS5jaGlsZHJlbl9kKSkpO2ZvcihsLmNoaWxkcmVuPWUsbC5jaGlsZHJlbl9kPWYsbz0wLHA9bC5wYXJlbnRzLmxlbmd0aDtwPm87bysrKWtbbC5wYXJlbnRzW29dXS5jaGlsZHJlbl9kPWtbbC5wYXJlbnRzW29dXS5jaGlsZHJlbl9kLmNvbmNhdChmKTtxPXtjbnQ6aixtb2Q6ayxzZWw6bSxwYXI6ZCxkcGM6ZixhZGQ6Z319cmV0dXJuXCJ1bmRlZmluZWRcIiE9dHlwZW9mIHdpbmRvdyYmXCJ1bmRlZmluZWRcIiE9dHlwZW9mIHdpbmRvdy5kb2N1bWVudD9xOnZvaWQgcG9zdE1lc3NhZ2UocSl9LGk9ZnVuY3Rpb24oYixjKXtpZihudWxsIT09dGhpcy5lbGVtZW50KXt0aGlzLl9jbnQ9Yi5jbnQ7dmFyIGUsZj10aGlzLl9tb2RlbC5kYXRhO2ZvcihlIGluIGYpZi5oYXNPd25Qcm9wZXJ0eShlKSYmZltlXS5zdGF0ZSYmZltlXS5zdGF0ZS5sb2FkaW5nJiZiLm1vZFtlXSYmKGIubW9kW2VdLnN0YXRlLmxvYWRpbmc9ITApO2lmKHRoaXMuX21vZGVsLmRhdGE9Yi5tb2QsYyl7dmFyIGcsaD1iLmFkZCxpPWIuc2VsLGo9dGhpcy5fZGF0YS5jb3JlLnNlbGVjdGVkLnNsaWNlKCk7aWYoZj10aGlzLl9tb2RlbC5kYXRhLGkubGVuZ3RoIT09ai5sZW5ndGh8fGEudmFrYXRhLmFycmF5X3VuaXF1ZShpLmNvbmNhdChqKSkubGVuZ3RoIT09aS5sZW5ndGgpe2ZvcihlPTAsZz1pLmxlbmd0aDtnPmU7ZSsrKS0xPT09YS5pbkFycmF5KGlbZV0saCkmJi0xPT09YS5pbkFycmF5KGlbZV0saikmJihmW2lbZV1dLnN0YXRlLnNlbGVjdGVkPSExKTtmb3IoZT0wLGc9ai5sZW5ndGg7Zz5lO2UrKyktMT09PWEuaW5BcnJheShqW2VdLGkpJiYoZltqW2VdXS5zdGF0ZS5zZWxlY3RlZD0hMCl9fWIuYWRkLmxlbmd0aCYmKHRoaXMuX2RhdGEuY29yZS5zZWxlY3RlZD10aGlzLl9kYXRhLmNvcmUuc2VsZWN0ZWQuY29uY2F0KGIuYWRkKSksdGhpcy50cmlnZ2VyKFwibW9kZWxcIix7bm9kZXM6Yi5kcGMscGFyZW50OmIucGFyfSksYi5wYXIhPT1hLmpzdHJlZS5yb290Pyh0aGlzLl9ub2RlX2NoYW5nZWQoYi5wYXIpLHRoaXMucmVkcmF3KCkpOnRoaXMucmVkcmF3KCEwKSxiLmFkZC5sZW5ndGgmJnRoaXMudHJpZ2dlcihcImNoYW5nZWRcIix7YWN0aW9uOlwibW9kZWxcIixzZWxlY3RlZDp0aGlzLl9kYXRhLmNvcmUuc2VsZWN0ZWR9KSxkLmNhbGwodGhpcywhMCl9fTtpZih0aGlzLnNldHRpbmdzLmNvcmUud29ya2VyJiZ3aW5kb3cuQmxvYiYmd2luZG93LlVSTCYmd2luZG93Lldvcmtlcil0cnl7bnVsbD09PXRoaXMuX3dyayYmKHRoaXMuX3dyaz13aW5kb3cuVVJMLmNyZWF0ZU9iamVjdFVSTChuZXcgd2luZG93LkJsb2IoW1wic2VsZi5vbm1lc3NhZ2UgPSBcIitoLnRvU3RyaW5nKCldLHt0eXBlOlwidGV4dC9qYXZhc2NyaXB0XCJ9KSkpLCF0aGlzLl9kYXRhLmNvcmUud29ya2luZ3x8ZT8odGhpcy5fZGF0YS5jb3JlLndvcmtpbmc9ITAsZj1uZXcgd2luZG93Lldvcmtlcih0aGlzLl93cmspLGYub25tZXNzYWdlPWEucHJveHkoZnVuY3Rpb24oYSl7aS5jYWxsKHRoaXMsYS5kYXRhLCEwKTt0cnl7Zi50ZXJtaW5hdGUoKSxmPW51bGx9Y2F0Y2goYil7fXRoaXMuX2RhdGEuY29yZS53b3JrZXJfcXVldWUubGVuZ3RoP3RoaXMuX2FwcGVuZF9qc29uX2RhdGEuYXBwbHkodGhpcyx0aGlzLl9kYXRhLmNvcmUud29ya2VyX3F1ZXVlLnNoaWZ0KCkpOnRoaXMuX2RhdGEuY29yZS53b3JraW5nPSExfSx0aGlzKSxnLnBhcj9mLnBvc3RNZXNzYWdlKGcpOnRoaXMuX2RhdGEuY29yZS53b3JrZXJfcXVldWUubGVuZ3RoP3RoaXMuX2FwcGVuZF9qc29uX2RhdGEuYXBwbHkodGhpcyx0aGlzLl9kYXRhLmNvcmUud29ya2VyX3F1ZXVlLnNoaWZ0KCkpOnRoaXMuX2RhdGEuY29yZS53b3JraW5nPSExKTp0aGlzLl9kYXRhLmNvcmUud29ya2VyX3F1ZXVlLnB1c2goW2IsYyxkLCEwXSl9Y2F0Y2goail7aS5jYWxsKHRoaXMsaChnKSwhMSksdGhpcy5fZGF0YS5jb3JlLndvcmtlcl9xdWV1ZS5sZW5ndGg/dGhpcy5fYXBwZW5kX2pzb25fZGF0YS5hcHBseSh0aGlzLHRoaXMuX2RhdGEuY29yZS53b3JrZXJfcXVldWUuc2hpZnQoKSk6dGhpcy5fZGF0YS5jb3JlLndvcmtpbmc9ITF9ZWxzZSBpLmNhbGwodGhpcyxoKGcpLCExKX19LF9wYXJzZV9tb2RlbF9mcm9tX2h0bWw6ZnVuY3Rpb24oYyxkLGUpe2U9ZT9bXS5jb25jYXQoZSk6W10sZCYmZS51bnNoaWZ0KGQpO3ZhciBmLGcsaD10aGlzLl9tb2RlbC5kYXRhLGk9e2lkOiExLHRleHQ6ITEsaWNvbjohMCxwYXJlbnQ6ZCxwYXJlbnRzOmUsY2hpbGRyZW46W10sY2hpbGRyZW5fZDpbXSxkYXRhOm51bGwsc3RhdGU6e30sbGlfYXR0cjp7aWQ6ITF9LGFfYXR0cjp7aHJlZjpcIiNcIn0sb3JpZ2luYWw6ITF9LGosayxsO2ZvcihqIGluIHRoaXMuX21vZGVsLmRlZmF1bHRfc3RhdGUpdGhpcy5fbW9kZWwuZGVmYXVsdF9zdGF0ZS5oYXNPd25Qcm9wZXJ0eShqKSYmKGkuc3RhdGVbal09dGhpcy5fbW9kZWwuZGVmYXVsdF9zdGF0ZVtqXSk7aWYoaz1hLnZha2F0YS5hdHRyaWJ1dGVzKGMsITApLGEuZWFjaChrLGZ1bmN0aW9uKGIsYyl7cmV0dXJuIGM9YS50cmltKGMpLGMubGVuZ3RoPyhpLmxpX2F0dHJbYl09Yyx2b2lkKFwiaWRcIj09PWImJihpLmlkPWMudG9TdHJpbmcoKSkpKTohMH0pLGs9Yy5jaGlsZHJlbihcImFcIikuZmlyc3QoKSxrLmxlbmd0aCYmKGs9YS52YWthdGEuYXR0cmlidXRlcyhrLCEwKSxhLmVhY2goayxmdW5jdGlvbihiLGMpe2M9YS50cmltKGMpLGMubGVuZ3RoJiYoaS5hX2F0dHJbYl09Yyl9KSksaz1jLmNoaWxkcmVuKFwiYVwiKS5maXJzdCgpLmxlbmd0aD9jLmNoaWxkcmVuKFwiYVwiKS5maXJzdCgpLmNsb25lKCk6Yy5jbG9uZSgpLGsuY2hpbGRyZW4oXCJpbnMsIGksIHVsXCIpLnJlbW92ZSgpLGs9ay5odG1sKCksaz1hKFwiPGRpdiAvPlwiKS5odG1sKGspLGkudGV4dD10aGlzLnNldHRpbmdzLmNvcmUuZm9yY2VfdGV4dD9rLnRleHQoKTprLmh0bWwoKSxrPWMuZGF0YSgpLGkuZGF0YT1rP2EuZXh0ZW5kKCEwLHt9LGspOm51bGwsaS5zdGF0ZS5vcGVuZWQ9Yy5oYXNDbGFzcyhcImpzdHJlZS1vcGVuXCIpLGkuc3RhdGUuc2VsZWN0ZWQ9Yy5jaGlsZHJlbihcImFcIikuaGFzQ2xhc3MoXCJqc3RyZWUtY2xpY2tlZFwiKSxpLnN0YXRlLmRpc2FibGVkPWMuY2hpbGRyZW4oXCJhXCIpLmhhc0NsYXNzKFwianN0cmVlLWRpc2FibGVkXCIpLGkuZGF0YSYmaS5kYXRhLmpzdHJlZSlmb3IoaiBpbiBpLmRhdGEuanN0cmVlKWkuZGF0YS5qc3RyZWUuaGFzT3duUHJvcGVydHkoaikmJihpLnN0YXRlW2pdPWkuZGF0YS5qc3RyZWVbal0pO2s9Yy5jaGlsZHJlbihcImFcIikuY2hpbGRyZW4oXCIuanN0cmVlLXRoZW1laWNvblwiKSxrLmxlbmd0aCYmKGkuaWNvbj1rLmhhc0NsYXNzKFwianN0cmVlLXRoZW1laWNvbi1oaWRkZW5cIik/ITE6ay5hdHRyKFwicmVsXCIpKSxpLnN0YXRlLmljb24hPT1iJiYoaS5pY29uPWkuc3RhdGUuaWNvbiksaS5pY29uIT09YiYmbnVsbCE9PWkuaWNvbiYmXCJcIiE9PWkuaWNvbnx8KGkuaWNvbj0hMCksaz1jLmNoaWxkcmVuKFwidWxcIikuY2hpbGRyZW4oXCJsaVwiKTtkbyBsPVwialwiK3RoaXMuX2lkK1wiX1wiKyArK3RoaXMuX2NudDt3aGlsZShoW2xdKTtyZXR1cm4gaS5pZD1pLmxpX2F0dHIuaWQ/aS5saV9hdHRyLmlkLnRvU3RyaW5nKCk6bCxrLmxlbmd0aD8oay5lYWNoKGEucHJveHkoZnVuY3Rpb24oYixjKXtmPXRoaXMuX3BhcnNlX21vZGVsX2Zyb21faHRtbChhKGMpLGkuaWQsZSksZz10aGlzLl9tb2RlbC5kYXRhW2ZdLGkuY2hpbGRyZW4ucHVzaChmKSxnLmNoaWxkcmVuX2QubGVuZ3RoJiYoaS5jaGlsZHJlbl9kPWkuY2hpbGRyZW5fZC5jb25jYXQoZy5jaGlsZHJlbl9kKSl9LHRoaXMpKSxpLmNoaWxkcmVuX2Q9aS5jaGlsZHJlbl9kLmNvbmNhdChpLmNoaWxkcmVuKSk6Yy5oYXNDbGFzcyhcImpzdHJlZS1jbG9zZWRcIikmJihpLnN0YXRlLmxvYWRlZD0hMSksaS5saV9hdHRyW1wiY2xhc3NcIl0mJihpLmxpX2F0dHJbXCJjbGFzc1wiXT1pLmxpX2F0dHJbXCJjbGFzc1wiXS5yZXBsYWNlKFwianN0cmVlLWNsb3NlZFwiLFwiXCIpLnJlcGxhY2UoXCJqc3RyZWUtb3BlblwiLFwiXCIpKSxpLmFfYXR0cltcImNsYXNzXCJdJiYoaS5hX2F0dHJbXCJjbGFzc1wiXT1pLmFfYXR0cltcImNsYXNzXCJdLnJlcGxhY2UoXCJqc3RyZWUtY2xpY2tlZFwiLFwiXCIpLnJlcGxhY2UoXCJqc3RyZWUtZGlzYWJsZWRcIixcIlwiKSksaFtpLmlkXT1pLGkuc3RhdGUuc2VsZWN0ZWQmJnRoaXMuX2RhdGEuY29yZS5zZWxlY3RlZC5wdXNoKGkuaWQpLGkuaWR9LF9wYXJzZV9tb2RlbF9mcm9tX2ZsYXRfanNvbjpmdW5jdGlvbihhLGMsZCl7ZD1kP2QuY29uY2F0KCk6W10sYyYmZC51bnNoaWZ0KGMpO3ZhciBlPWEuaWQudG9TdHJpbmcoKSxmPXRoaXMuX21vZGVsLmRhdGEsZz10aGlzLl9tb2RlbC5kZWZhdWx0X3N0YXRlLGgsaSxqLGssbD17aWQ6ZSx0ZXh0OmEudGV4dHx8XCJcIixpY29uOmEuaWNvbiE9PWI/YS5pY29uOiEwLHBhcmVudDpjLHBhcmVudHM6ZCxjaGlsZHJlbjphLmNoaWxkcmVufHxbXSxjaGlsZHJlbl9kOmEuY2hpbGRyZW5fZHx8W10sZGF0YTphLmRhdGEsc3RhdGU6e30sbGlfYXR0cjp7aWQ6ITF9LGFfYXR0cjp7aHJlZjpcIiNcIn0sb3JpZ2luYWw6ITF9O2ZvcihoIGluIGcpZy5oYXNPd25Qcm9wZXJ0eShoKSYmKGwuc3RhdGVbaF09Z1toXSk7aWYoYSYmYS5kYXRhJiZhLmRhdGEuanN0cmVlJiZhLmRhdGEuanN0cmVlLmljb24mJihsLmljb249YS5kYXRhLmpzdHJlZS5pY29uKSxsLmljb24hPT1iJiZudWxsIT09bC5pY29uJiZcIlwiIT09bC5pY29ufHwobC5pY29uPSEwKSxhJiZhLmRhdGEmJihsLmRhdGE9YS5kYXRhLGEuZGF0YS5qc3RyZWUpKWZvcihoIGluIGEuZGF0YS5qc3RyZWUpYS5kYXRhLmpzdHJlZS5oYXNPd25Qcm9wZXJ0eShoKSYmKGwuc3RhdGVbaF09YS5kYXRhLmpzdHJlZVtoXSk7aWYoYSYmXCJvYmplY3RcIj09dHlwZW9mIGEuc3RhdGUpZm9yKGggaW4gYS5zdGF0ZSlhLnN0YXRlLmhhc093blByb3BlcnR5KGgpJiYobC5zdGF0ZVtoXT1hLnN0YXRlW2hdKTtpZihhJiZcIm9iamVjdFwiPT10eXBlb2YgYS5saV9hdHRyKWZvcihoIGluIGEubGlfYXR0cilhLmxpX2F0dHIuaGFzT3duUHJvcGVydHkoaCkmJihsLmxpX2F0dHJbaF09YS5saV9hdHRyW2hdKTtpZihsLmxpX2F0dHIuaWR8fChsLmxpX2F0dHIuaWQ9ZSksYSYmXCJvYmplY3RcIj09dHlwZW9mIGEuYV9hdHRyKWZvcihoIGluIGEuYV9hdHRyKWEuYV9hdHRyLmhhc093blByb3BlcnR5KGgpJiYobC5hX2F0dHJbaF09YS5hX2F0dHJbaF0pO2ZvcihhJiZhLmNoaWxkcmVuJiZhLmNoaWxkcmVuPT09ITAmJihsLnN0YXRlLmxvYWRlZD0hMSxsLmNoaWxkcmVuPVtdLGwuY2hpbGRyZW5fZD1bXSksZltsLmlkXT1sLGg9MCxpPWwuY2hpbGRyZW4ubGVuZ3RoO2k+aDtoKyspaj10aGlzLl9wYXJzZV9tb2RlbF9mcm9tX2ZsYXRfanNvbihmW2wuY2hpbGRyZW5baF1dLGwuaWQsZCksaz1mW2pdLGwuY2hpbGRyZW5fZC5wdXNoKGopLGsuY2hpbGRyZW5fZC5sZW5ndGgmJihsLmNoaWxkcmVuX2Q9bC5jaGlsZHJlbl9kLmNvbmNhdChrLmNoaWxkcmVuX2QpKTtyZXR1cm4gZGVsZXRlIGEuZGF0YSxkZWxldGUgYS5jaGlsZHJlbixmW2wuaWRdLm9yaWdpbmFsPWEsbC5zdGF0ZS5zZWxlY3RlZCYmdGhpcy5fZGF0YS5jb3JlLnNlbGVjdGVkLnB1c2gobC5pZCksbC5pZH0sX3BhcnNlX21vZGVsX2Zyb21fanNvbjpmdW5jdGlvbihhLGMsZCl7ZD1kP2QuY29uY2F0KCk6W10sYyYmZC51bnNoaWZ0KGMpO3ZhciBlPSExLGYsZyxoLGksaj10aGlzLl9tb2RlbC5kYXRhLGs9dGhpcy5fbW9kZWwuZGVmYXVsdF9zdGF0ZSxsO2RvIGU9XCJqXCIrdGhpcy5faWQrXCJfXCIrICsrdGhpcy5fY250O3doaWxlKGpbZV0pO2w9e2lkOiExLHRleHQ6XCJzdHJpbmdcIj09dHlwZW9mIGE/YTpcIlwiLGljb246XCJvYmplY3RcIj09dHlwZW9mIGEmJmEuaWNvbiE9PWI/YS5pY29uOiEwLHBhcmVudDpjLHBhcmVudHM6ZCxjaGlsZHJlbjpbXSxjaGlsZHJlbl9kOltdLGRhdGE6bnVsbCxzdGF0ZTp7fSxsaV9hdHRyOntpZDohMX0sYV9hdHRyOntocmVmOlwiI1wifSxvcmlnaW5hbDohMX07Zm9yKGYgaW4gaylrLmhhc093blByb3BlcnR5KGYpJiYobC5zdGF0ZVtmXT1rW2ZdKTtpZihhJiZhLmlkJiYobC5pZD1hLmlkLnRvU3RyaW5nKCkpLGEmJmEudGV4dCYmKGwudGV4dD1hLnRleHQpLGEmJmEuZGF0YSYmYS5kYXRhLmpzdHJlZSYmYS5kYXRhLmpzdHJlZS5pY29uJiYobC5pY29uPWEuZGF0YS5qc3RyZWUuaWNvbiksbC5pY29uIT09YiYmbnVsbCE9PWwuaWNvbiYmXCJcIiE9PWwuaWNvbnx8KGwuaWNvbj0hMCksYSYmYS5kYXRhJiYobC5kYXRhPWEuZGF0YSxhLmRhdGEuanN0cmVlKSlmb3IoZiBpbiBhLmRhdGEuanN0cmVlKWEuZGF0YS5qc3RyZWUuaGFzT3duUHJvcGVydHkoZikmJihsLnN0YXRlW2ZdPWEuZGF0YS5qc3RyZWVbZl0pO2lmKGEmJlwib2JqZWN0XCI9PXR5cGVvZiBhLnN0YXRlKWZvcihmIGluIGEuc3RhdGUpYS5zdGF0ZS5oYXNPd25Qcm9wZXJ0eShmKSYmKGwuc3RhdGVbZl09YS5zdGF0ZVtmXSk7aWYoYSYmXCJvYmplY3RcIj09dHlwZW9mIGEubGlfYXR0cilmb3IoZiBpbiBhLmxpX2F0dHIpYS5saV9hdHRyLmhhc093blByb3BlcnR5KGYpJiYobC5saV9hdHRyW2ZdPWEubGlfYXR0cltmXSk7aWYobC5saV9hdHRyLmlkJiYhbC5pZCYmKGwuaWQ9bC5saV9hdHRyLmlkLnRvU3RyaW5nKCkpLGwuaWR8fChsLmlkPWUpLGwubGlfYXR0ci5pZHx8KGwubGlfYXR0ci5pZD1sLmlkKSxhJiZcIm9iamVjdFwiPT10eXBlb2YgYS5hX2F0dHIpZm9yKGYgaW4gYS5hX2F0dHIpYS5hX2F0dHIuaGFzT3duUHJvcGVydHkoZikmJihsLmFfYXR0cltmXT1hLmFfYXR0cltmXSk7aWYoYSYmYS5jaGlsZHJlbiYmYS5jaGlsZHJlbi5sZW5ndGgpe2ZvcihmPTAsZz1hLmNoaWxkcmVuLmxlbmd0aDtnPmY7ZisrKWg9dGhpcy5fcGFyc2VfbW9kZWxfZnJvbV9qc29uKGEuY2hpbGRyZW5bZl0sbC5pZCxkKSxpPWpbaF0sbC5jaGlsZHJlbi5wdXNoKGgpLGkuY2hpbGRyZW5fZC5sZW5ndGgmJihsLmNoaWxkcmVuX2Q9bC5jaGlsZHJlbl9kLmNvbmNhdChpLmNoaWxkcmVuX2QpKTtsLmNoaWxkcmVuX2Q9bC5jaGlsZHJlbl9kLmNvbmNhdChsLmNoaWxkcmVuKX1yZXR1cm4gYSYmYS5jaGlsZHJlbiYmYS5jaGlsZHJlbj09PSEwJiYobC5zdGF0ZS5sb2FkZWQ9ITEsbC5jaGlsZHJlbj1bXSxsLmNoaWxkcmVuX2Q9W10pLGRlbGV0ZSBhLmRhdGEsZGVsZXRlIGEuY2hpbGRyZW4sbC5vcmlnaW5hbD1hLGpbbC5pZF09bCxsLnN0YXRlLnNlbGVjdGVkJiZ0aGlzLl9kYXRhLmNvcmUuc2VsZWN0ZWQucHVzaChsLmlkKSxsLmlkfSxfcmVkcmF3OmZ1bmN0aW9uKCl7dmFyIGI9dGhpcy5fbW9kZWwuZm9yY2VfZnVsbF9yZWRyYXc/dGhpcy5fbW9kZWwuZGF0YVthLmpzdHJlZS5yb290XS5jaGlsZHJlbi5jb25jYXQoW10pOnRoaXMuX21vZGVsLmNoYW5nZWQuY29uY2F0KFtdKSxjPWkuY3JlYXRlRWxlbWVudChcIlVMXCIpLGQsZSxmLGc9dGhpcy5fZGF0YS5jb3JlLmZvY3VzZWQ7Zm9yKGU9MCxmPWIubGVuZ3RoO2Y+ZTtlKyspZD10aGlzLnJlZHJhd19ub2RlKGJbZV0sITAsdGhpcy5fbW9kZWwuZm9yY2VfZnVsbF9yZWRyYXcpLGQmJnRoaXMuX21vZGVsLmZvcmNlX2Z1bGxfcmVkcmF3JiZjLmFwcGVuZENoaWxkKGQpO3RoaXMuX21vZGVsLmZvcmNlX2Z1bGxfcmVkcmF3JiYoYy5jbGFzc05hbWU9dGhpcy5nZXRfY29udGFpbmVyX3VsKClbMF0uY2xhc3NOYW1lLGMuc2V0QXR0cmlidXRlKFwicm9sZVwiLFwiZ3JvdXBcIiksdGhpcy5lbGVtZW50LmVtcHR5KCkuYXBwZW5kKGMpKSxudWxsIT09ZyYmKGQ9dGhpcy5nZXRfbm9kZShnLCEwKSxkJiZkLmxlbmd0aCYmZC5jaGlsZHJlbihcIi5qc3RyZWUtYW5jaG9yXCIpWzBdIT09aS5hY3RpdmVFbGVtZW50P2QuY2hpbGRyZW4oXCIuanN0cmVlLWFuY2hvclwiKS5mb2N1cygpOnRoaXMuX2RhdGEuY29yZS5mb2N1c2VkPW51bGwpLHRoaXMuX21vZGVsLmZvcmNlX2Z1bGxfcmVkcmF3PSExLHRoaXMuX21vZGVsLmNoYW5nZWQ9W10sdGhpcy50cmlnZ2VyKFwicmVkcmF3XCIse25vZGVzOmJ9KX0scmVkcmF3OmZ1bmN0aW9uKGEpe2EmJih0aGlzLl9tb2RlbC5mb3JjZV9mdWxsX3JlZHJhdz0hMCksdGhpcy5fcmVkcmF3KCl9LGRyYXdfY2hpbGRyZW46ZnVuY3Rpb24oYil7dmFyIGM9dGhpcy5nZXRfbm9kZShiKSxkPSExLGU9ITEsZj0hMSxnPWk7aWYoIWMpcmV0dXJuITE7aWYoYy5pZD09PWEuanN0cmVlLnJvb3QpcmV0dXJuIHRoaXMucmVkcmF3KCEwKTtpZihiPXRoaXMuZ2V0X25vZGUoYiwhMCksIWJ8fCFiLmxlbmd0aClyZXR1cm4hMTtpZihiLmNoaWxkcmVuKFwiLmpzdHJlZS1jaGlsZHJlblwiKS5yZW1vdmUoKSxiPWJbMF0sYy5jaGlsZHJlbi5sZW5ndGgmJmMuc3RhdGUubG9hZGVkKXtmb3IoZj1nLmNyZWF0ZUVsZW1lbnQoXCJVTFwiKSxmLnNldEF0dHJpYnV0ZShcInJvbGVcIixcImdyb3VwXCIpLGYuY2xhc3NOYW1lPVwianN0cmVlLWNoaWxkcmVuXCIsZD0wLGU9Yy5jaGlsZHJlbi5sZW5ndGg7ZT5kO2QrKylmLmFwcGVuZENoaWxkKHRoaXMucmVkcmF3X25vZGUoYy5jaGlsZHJlbltkXSwhMCwhMCkpO2IuYXBwZW5kQ2hpbGQoZil9fSxyZWRyYXdfbm9kZTpmdW5jdGlvbihiLGMsZCxlKXt2YXIgZj10aGlzLmdldF9ub2RlKGIpLGc9ITEsaD0hMSxrPSExLGw9ITEsbT0hMSxuPSExLG89XCJcIixwPWkscT10aGlzLl9tb2RlbC5kYXRhLHI9ITEscz0hMSx0PW51bGwsdT0wLHY9MCx3PSExLHg9ITE7aWYoIWYpcmV0dXJuITE7aWYoZi5pZD09PWEuanN0cmVlLnJvb3QpcmV0dXJuIHRoaXMucmVkcmF3KCEwKTtpZihjPWN8fDA9PT1mLmNoaWxkcmVuLmxlbmd0aCxiPWkucXVlcnlTZWxlY3Rvcj90aGlzLmVsZW1lbnRbMF0ucXVlcnlTZWxlY3RvcihcIiNcIisoLTEhPT1cIjAxMjM0NTY3ODlcIi5pbmRleE9mKGYuaWRbMF0pP1wiXFxcXDNcIitmLmlkWzBdK1wiIFwiK2YuaWQuc3Vic3RyKDEpLnJlcGxhY2UoYS5qc3RyZWUuaWRyZWdleCxcIlxcXFwkJlwiKTpmLmlkLnJlcGxhY2UoYS5qc3RyZWUuaWRyZWdleCxcIlxcXFwkJlwiKSkpOmkuZ2V0RWxlbWVudEJ5SWQoZi5pZCkpYj1hKGIpLFxuZHx8KGc9Yi5wYXJlbnQoKS5wYXJlbnQoKVswXSxnPT09dGhpcy5lbGVtZW50WzBdJiYoZz1udWxsKSxoPWIuaW5kZXgoKSksY3x8IWYuY2hpbGRyZW4ubGVuZ3RofHxiLmNoaWxkcmVuKFwiLmpzdHJlZS1jaGlsZHJlblwiKS5sZW5ndGh8fChjPSEwKSxjfHwoaz1iLmNoaWxkcmVuKFwiLmpzdHJlZS1jaGlsZHJlblwiKVswXSkscj1iLmNoaWxkcmVuKFwiLmpzdHJlZS1hbmNob3JcIilbMF09PT1pLmFjdGl2ZUVsZW1lbnQsYi5yZW1vdmUoKTtlbHNlIGlmKGM9ITAsIWQpe2lmKGc9Zi5wYXJlbnQhPT1hLmpzdHJlZS5yb290P2EoXCIjXCIrZi5wYXJlbnQucmVwbGFjZShhLmpzdHJlZS5pZHJlZ2V4LFwiXFxcXCQmXCIpLHRoaXMuZWxlbWVudClbMF06bnVsbCwhKG51bGw9PT1nfHxnJiZxW2YucGFyZW50XS5zdGF0ZS5vcGVuZWQpKXJldHVybiExO2g9YS5pbkFycmF5KGYuaWQsbnVsbD09PWc/cVthLmpzdHJlZS5yb290XS5jaGlsZHJlbjpxW2YucGFyZW50XS5jaGlsZHJlbil9Yj1qLmNsb25lTm9kZSghMCksbz1cImpzdHJlZS1ub2RlIFwiO2ZvcihsIGluIGYubGlfYXR0cilpZihmLmxpX2F0dHIuaGFzT3duUHJvcGVydHkobCkpe2lmKFwiaWRcIj09PWwpY29udGludWU7XCJjbGFzc1wiIT09bD9iLnNldEF0dHJpYnV0ZShsLGYubGlfYXR0cltsXSk6bys9Zi5saV9hdHRyW2xdfWZvcihmLmFfYXR0ci5pZHx8KGYuYV9hdHRyLmlkPWYuaWQrXCJfYW5jaG9yXCIpLGIuc2V0QXR0cmlidXRlKFwiYXJpYS1zZWxlY3RlZFwiLCEhZi5zdGF0ZS5zZWxlY3RlZCksYi5zZXRBdHRyaWJ1dGUoXCJhcmlhLWxldmVsXCIsZi5wYXJlbnRzLmxlbmd0aCksYi5zZXRBdHRyaWJ1dGUoXCJhcmlhLWxhYmVsbGVkYnlcIixmLmFfYXR0ci5pZCksZi5zdGF0ZS5kaXNhYmxlZCYmYi5zZXRBdHRyaWJ1dGUoXCJhcmlhLWRpc2FibGVkXCIsITApLGw9MCxtPWYuY2hpbGRyZW4ubGVuZ3RoO20+bDtsKyspaWYoIXFbZi5jaGlsZHJlbltsXV0uc3RhdGUuaGlkZGVuKXt3PSEwO2JyZWFrfWlmKG51bGwhPT1mLnBhcmVudCYmcVtmLnBhcmVudF0mJiFmLnN0YXRlLmhpZGRlbiYmKGw9YS5pbkFycmF5KGYuaWQscVtmLnBhcmVudF0uY2hpbGRyZW4pLHg9Zi5pZCwtMSE9PWwpKWZvcihsKyssbT1xW2YucGFyZW50XS5jaGlsZHJlbi5sZW5ndGg7bT5sO2wrKylpZihxW3FbZi5wYXJlbnRdLmNoaWxkcmVuW2xdXS5zdGF0ZS5oaWRkZW58fCh4PXFbZi5wYXJlbnRdLmNoaWxkcmVuW2xdKSx4IT09Zi5pZClicmVhaztmLnN0YXRlLmhpZGRlbiYmKG8rPVwiIGpzdHJlZS1oaWRkZW5cIiksZi5zdGF0ZS5sb2FkZWQmJiF3P28rPVwiIGpzdHJlZS1sZWFmXCI6KG8rPWYuc3RhdGUub3BlbmVkJiZmLnN0YXRlLmxvYWRlZD9cIiBqc3RyZWUtb3BlblwiOlwiIGpzdHJlZS1jbG9zZWRcIixiLnNldEF0dHJpYnV0ZShcImFyaWEtZXhwYW5kZWRcIixmLnN0YXRlLm9wZW5lZCYmZi5zdGF0ZS5sb2FkZWQpKSx4PT09Zi5pZCYmKG8rPVwiIGpzdHJlZS1sYXN0XCIpLGIuaWQ9Zi5pZCxiLmNsYXNzTmFtZT1vLG89KGYuc3RhdGUuc2VsZWN0ZWQ/XCIganN0cmVlLWNsaWNrZWRcIjpcIlwiKSsoZi5zdGF0ZS5kaXNhYmxlZD9cIiBqc3RyZWUtZGlzYWJsZWRcIjpcIlwiKTtmb3IobSBpbiBmLmFfYXR0cilpZihmLmFfYXR0ci5oYXNPd25Qcm9wZXJ0eShtKSl7aWYoXCJocmVmXCI9PT1tJiZcIiNcIj09PWYuYV9hdHRyW21dKWNvbnRpbnVlO1wiY2xhc3NcIiE9PW0/Yi5jaGlsZE5vZGVzWzFdLnNldEF0dHJpYnV0ZShtLGYuYV9hdHRyW21dKTpvKz1cIiBcIitmLmFfYXR0clttXX1pZihvLmxlbmd0aCYmKGIuY2hpbGROb2Rlc1sxXS5jbGFzc05hbWU9XCJqc3RyZWUtYW5jaG9yIFwiK28pLChmLmljb24mJmYuaWNvbiE9PSEwfHxmLmljb249PT0hMSkmJihmLmljb249PT0hMT9iLmNoaWxkTm9kZXNbMV0uY2hpbGROb2Rlc1swXS5jbGFzc05hbWUrPVwiIGpzdHJlZS10aGVtZWljb24taGlkZGVuXCI6LTE9PT1mLmljb24uaW5kZXhPZihcIi9cIikmJi0xPT09Zi5pY29uLmluZGV4T2YoXCIuXCIpP2IuY2hpbGROb2Rlc1sxXS5jaGlsZE5vZGVzWzBdLmNsYXNzTmFtZSs9XCIgXCIrZi5pY29uK1wiIGpzdHJlZS10aGVtZWljb24tY3VzdG9tXCI6KGIuY2hpbGROb2Rlc1sxXS5jaGlsZE5vZGVzWzBdLnN0eWxlLmJhY2tncm91bmRJbWFnZT0ndXJsKFwiJytmLmljb24rJ1wiKScsYi5jaGlsZE5vZGVzWzFdLmNoaWxkTm9kZXNbMF0uc3R5bGUuYmFja2dyb3VuZFBvc2l0aW9uPVwiY2VudGVyIGNlbnRlclwiLGIuY2hpbGROb2Rlc1sxXS5jaGlsZE5vZGVzWzBdLnN0eWxlLmJhY2tncm91bmRTaXplPVwiYXV0b1wiLGIuY2hpbGROb2Rlc1sxXS5jaGlsZE5vZGVzWzBdLmNsYXNzTmFtZSs9XCIganN0cmVlLXRoZW1laWNvbi1jdXN0b21cIikpLHRoaXMuc2V0dGluZ3MuY29yZS5mb3JjZV90ZXh0P2IuY2hpbGROb2Rlc1sxXS5hcHBlbmRDaGlsZChwLmNyZWF0ZVRleHROb2RlKGYudGV4dCkpOmIuY2hpbGROb2Rlc1sxXS5pbm5lckhUTUwrPWYudGV4dCxjJiZmLmNoaWxkcmVuLmxlbmd0aCYmKGYuc3RhdGUub3BlbmVkfHxlKSYmZi5zdGF0ZS5sb2FkZWQpe2ZvcihuPXAuY3JlYXRlRWxlbWVudChcIlVMXCIpLG4uc2V0QXR0cmlidXRlKFwicm9sZVwiLFwiZ3JvdXBcIiksbi5jbGFzc05hbWU9XCJqc3RyZWUtY2hpbGRyZW5cIixsPTAsbT1mLmNoaWxkcmVuLmxlbmd0aDttPmw7bCsrKW4uYXBwZW5kQ2hpbGQodGhpcy5yZWRyYXdfbm9kZShmLmNoaWxkcmVuW2xdLGMsITApKTtiLmFwcGVuZENoaWxkKG4pfWlmKGsmJmIuYXBwZW5kQ2hpbGQoayksIWQpe2ZvcihnfHwoZz10aGlzLmVsZW1lbnRbMF0pLGw9MCxtPWcuY2hpbGROb2Rlcy5sZW5ndGg7bT5sO2wrKylpZihnLmNoaWxkTm9kZXNbbF0mJmcuY2hpbGROb2Rlc1tsXS5jbGFzc05hbWUmJi0xIT09Zy5jaGlsZE5vZGVzW2xdLmNsYXNzTmFtZS5pbmRleE9mKFwianN0cmVlLWNoaWxkcmVuXCIpKXt0PWcuY2hpbGROb2Rlc1tsXTticmVha310fHwodD1wLmNyZWF0ZUVsZW1lbnQoXCJVTFwiKSx0LnNldEF0dHJpYnV0ZShcInJvbGVcIixcImdyb3VwXCIpLHQuY2xhc3NOYW1lPVwianN0cmVlLWNoaWxkcmVuXCIsZy5hcHBlbmRDaGlsZCh0KSksZz10LGg8Zy5jaGlsZE5vZGVzLmxlbmd0aD9nLmluc2VydEJlZm9yZShiLGcuY2hpbGROb2Rlc1toXSk6Zy5hcHBlbmRDaGlsZChiKSxyJiYodT10aGlzLmVsZW1lbnRbMF0uc2Nyb2xsVG9wLHY9dGhpcy5lbGVtZW50WzBdLnNjcm9sbExlZnQsYi5jaGlsZE5vZGVzWzFdLmZvY3VzKCksdGhpcy5lbGVtZW50WzBdLnNjcm9sbFRvcD11LHRoaXMuZWxlbWVudFswXS5zY3JvbGxMZWZ0PXYpfXJldHVybiBmLnN0YXRlLm9wZW5lZCYmIWYuc3RhdGUubG9hZGVkJiYoZi5zdGF0ZS5vcGVuZWQ9ITEsc2V0VGltZW91dChhLnByb3h5KGZ1bmN0aW9uKCl7dGhpcy5vcGVuX25vZGUoZi5pZCwhMSwwKX0sdGhpcyksMCkpLGJ9LG9wZW5fbm9kZTpmdW5jdGlvbihjLGQsZSl7dmFyIGYsZyxoLGk7aWYoYS5pc0FycmF5KGMpKXtmb3IoYz1jLnNsaWNlKCksZj0wLGc9Yy5sZW5ndGg7Zz5mO2YrKyl0aGlzLm9wZW5fbm9kZShjW2ZdLGQsZSk7cmV0dXJuITB9cmV0dXJuIGM9dGhpcy5nZXRfbm9kZShjKSxjJiZjLmlkIT09YS5qc3RyZWUucm9vdD8oZT1lPT09Yj90aGlzLnNldHRpbmdzLmNvcmUuYW5pbWF0aW9uOmUsdGhpcy5pc19jbG9zZWQoYyk/dGhpcy5pc19sb2FkZWQoYyk/KGg9dGhpcy5nZXRfbm9kZShjLCEwKSxpPXRoaXMsaC5sZW5ndGgmJihlJiZoLmNoaWxkcmVuKFwiLmpzdHJlZS1jaGlsZHJlblwiKS5sZW5ndGgmJmguY2hpbGRyZW4oXCIuanN0cmVlLWNoaWxkcmVuXCIpLnN0b3AoITAsITApLGMuY2hpbGRyZW4ubGVuZ3RoJiYhdGhpcy5fZmlyc3RDaGlsZChoLmNoaWxkcmVuKFwiLmpzdHJlZS1jaGlsZHJlblwiKVswXSkmJnRoaXMuZHJhd19jaGlsZHJlbihjKSxlPyh0aGlzLnRyaWdnZXIoXCJiZWZvcmVfb3BlblwiLHtub2RlOmN9KSxoLmNoaWxkcmVuKFwiLmpzdHJlZS1jaGlsZHJlblwiKS5jc3MoXCJkaXNwbGF5XCIsXCJub25lXCIpLmVuZCgpLnJlbW92ZUNsYXNzKFwianN0cmVlLWNsb3NlZFwiKS5hZGRDbGFzcyhcImpzdHJlZS1vcGVuXCIpLmF0dHIoXCJhcmlhLWV4cGFuZGVkXCIsITApLmNoaWxkcmVuKFwiLmpzdHJlZS1jaGlsZHJlblwiKS5zdG9wKCEwLCEwKS5zbGlkZURvd24oZSxmdW5jdGlvbigpe3RoaXMuc3R5bGUuZGlzcGxheT1cIlwiLGkudHJpZ2dlcihcImFmdGVyX29wZW5cIix7bm9kZTpjfSl9KSk6KHRoaXMudHJpZ2dlcihcImJlZm9yZV9vcGVuXCIse25vZGU6Y30pLGhbMF0uY2xhc3NOYW1lPWhbMF0uY2xhc3NOYW1lLnJlcGxhY2UoXCJqc3RyZWUtY2xvc2VkXCIsXCJqc3RyZWUtb3BlblwiKSxoWzBdLnNldEF0dHJpYnV0ZShcImFyaWEtZXhwYW5kZWRcIiwhMCkpKSxjLnN0YXRlLm9wZW5lZD0hMCxkJiZkLmNhbGwodGhpcyxjLCEwKSxoLmxlbmd0aHx8dGhpcy50cmlnZ2VyKFwiYmVmb3JlX29wZW5cIix7bm9kZTpjfSksdGhpcy50cmlnZ2VyKFwib3Blbl9ub2RlXCIse25vZGU6Y30pLGUmJmgubGVuZ3RofHx0aGlzLnRyaWdnZXIoXCJhZnRlcl9vcGVuXCIse25vZGU6Y30pLCEwKTp0aGlzLmlzX2xvYWRpbmcoYyk/c2V0VGltZW91dChhLnByb3h5KGZ1bmN0aW9uKCl7dGhpcy5vcGVuX25vZGUoYyxkLGUpfSx0aGlzKSw1MDApOnZvaWQgdGhpcy5sb2FkX25vZGUoYyxmdW5jdGlvbihhLGIpe3JldHVybiBiP3RoaXMub3Blbl9ub2RlKGEsZCxlKTpkP2QuY2FsbCh0aGlzLGEsITEpOiExfSk6KGQmJmQuY2FsbCh0aGlzLGMsITEpLCExKSk6ITF9LF9vcGVuX3RvOmZ1bmN0aW9uKGIpe2lmKGI9dGhpcy5nZXRfbm9kZShiKSwhYnx8Yi5pZD09PWEuanN0cmVlLnJvb3QpcmV0dXJuITE7dmFyIGMsZCxlPWIucGFyZW50cztmb3IoYz0wLGQ9ZS5sZW5ndGg7ZD5jO2MrPTEpYyE9PWEuanN0cmVlLnJvb3QmJnRoaXMub3Blbl9ub2RlKGVbY10sITEsMCk7cmV0dXJuIGEoXCIjXCIrYi5pZC5yZXBsYWNlKGEuanN0cmVlLmlkcmVnZXgsXCJcXFxcJCZcIiksdGhpcy5lbGVtZW50KX0sY2xvc2Vfbm9kZTpmdW5jdGlvbihjLGQpe3ZhciBlLGYsZyxoO2lmKGEuaXNBcnJheShjKSl7Zm9yKGM9Yy5zbGljZSgpLGU9MCxmPWMubGVuZ3RoO2Y+ZTtlKyspdGhpcy5jbG9zZV9ub2RlKGNbZV0sZCk7cmV0dXJuITB9cmV0dXJuIGM9dGhpcy5nZXRfbm9kZShjKSxjJiZjLmlkIT09YS5qc3RyZWUucm9vdD90aGlzLmlzX2Nsb3NlZChjKT8hMTooZD1kPT09Yj90aGlzLnNldHRpbmdzLmNvcmUuYW5pbWF0aW9uOmQsZz10aGlzLGg9dGhpcy5nZXRfbm9kZShjLCEwKSxjLnN0YXRlLm9wZW5lZD0hMSx0aGlzLnRyaWdnZXIoXCJjbG9zZV9ub2RlXCIse25vZGU6Y30pLHZvaWQoaC5sZW5ndGg/ZD9oLmNoaWxkcmVuKFwiLmpzdHJlZS1jaGlsZHJlblwiKS5hdHRyKFwic3R5bGVcIixcImRpc3BsYXk6YmxvY2sgIWltcG9ydGFudFwiKS5lbmQoKS5yZW1vdmVDbGFzcyhcImpzdHJlZS1vcGVuXCIpLmFkZENsYXNzKFwianN0cmVlLWNsb3NlZFwiKS5hdHRyKFwiYXJpYS1leHBhbmRlZFwiLCExKS5jaGlsZHJlbihcIi5qc3RyZWUtY2hpbGRyZW5cIikuc3RvcCghMCwhMCkuc2xpZGVVcChkLGZ1bmN0aW9uKCl7dGhpcy5zdHlsZS5kaXNwbGF5PVwiXCIsaC5jaGlsZHJlbihcIi5qc3RyZWUtY2hpbGRyZW5cIikucmVtb3ZlKCksZy50cmlnZ2VyKFwiYWZ0ZXJfY2xvc2VcIix7bm9kZTpjfSl9KTooaFswXS5jbGFzc05hbWU9aFswXS5jbGFzc05hbWUucmVwbGFjZShcImpzdHJlZS1vcGVuXCIsXCJqc3RyZWUtY2xvc2VkXCIpLGguYXR0cihcImFyaWEtZXhwYW5kZWRcIiwhMSkuY2hpbGRyZW4oXCIuanN0cmVlLWNoaWxkcmVuXCIpLnJlbW92ZSgpLHRoaXMudHJpZ2dlcihcImFmdGVyX2Nsb3NlXCIse25vZGU6Y30pKTp0aGlzLnRyaWdnZXIoXCJhZnRlcl9jbG9zZVwiLHtub2RlOmN9KSkpOiExfSx0b2dnbGVfbm9kZTpmdW5jdGlvbihiKXt2YXIgYyxkO2lmKGEuaXNBcnJheShiKSl7Zm9yKGI9Yi5zbGljZSgpLGM9MCxkPWIubGVuZ3RoO2Q+YztjKyspdGhpcy50b2dnbGVfbm9kZShiW2NdKTtyZXR1cm4hMH1yZXR1cm4gdGhpcy5pc19jbG9zZWQoYik/dGhpcy5vcGVuX25vZGUoYik6dGhpcy5pc19vcGVuKGIpP3RoaXMuY2xvc2Vfbm9kZShiKTp2b2lkIDB9LG9wZW5fYWxsOmZ1bmN0aW9uKGIsYyxkKXtpZihifHwoYj1hLmpzdHJlZS5yb290KSxiPXRoaXMuZ2V0X25vZGUoYiksIWIpcmV0dXJuITE7dmFyIGU9Yi5pZD09PWEuanN0cmVlLnJvb3Q/dGhpcy5nZXRfY29udGFpbmVyX3VsKCk6dGhpcy5nZXRfbm9kZShiLCEwKSxmLGcsaDtpZighZS5sZW5ndGgpe2ZvcihmPTAsZz1iLmNoaWxkcmVuX2QubGVuZ3RoO2c+ZjtmKyspdGhpcy5pc19jbG9zZWQodGhpcy5fbW9kZWwuZGF0YVtiLmNoaWxkcmVuX2RbZl1dKSYmKHRoaXMuX21vZGVsLmRhdGFbYi5jaGlsZHJlbl9kW2ZdXS5zdGF0ZS5vcGVuZWQ9ITApO3JldHVybiB0aGlzLnRyaWdnZXIoXCJvcGVuX2FsbFwiLHtub2RlOmJ9KX1kPWR8fGUsaD10aGlzLGU9dGhpcy5pc19jbG9zZWQoYik/ZS5maW5kKFwiLmpzdHJlZS1jbG9zZWRcIikuYWRkQmFjaygpOmUuZmluZChcIi5qc3RyZWUtY2xvc2VkXCIpLGUuZWFjaChmdW5jdGlvbigpe2gub3Blbl9ub2RlKHRoaXMsZnVuY3Rpb24oYSxiKXtiJiZ0aGlzLmlzX3BhcmVudChhKSYmdGhpcy5vcGVuX2FsbChhLGMsZCl9LGN8fDApfSksMD09PWQuZmluZChcIi5qc3RyZWUtY2xvc2VkXCIpLmxlbmd0aCYmdGhpcy50cmlnZ2VyKFwib3Blbl9hbGxcIix7bm9kZTp0aGlzLmdldF9ub2RlKGQpfSl9LGNsb3NlX2FsbDpmdW5jdGlvbihiLGMpe2lmKGJ8fChiPWEuanN0cmVlLnJvb3QpLGI9dGhpcy5nZXRfbm9kZShiKSwhYilyZXR1cm4hMTt2YXIgZD1iLmlkPT09YS5qc3RyZWUucm9vdD90aGlzLmdldF9jb250YWluZXJfdWwoKTp0aGlzLmdldF9ub2RlKGIsITApLGU9dGhpcyxmLGc7Zm9yKGQubGVuZ3RoJiYoZD10aGlzLmlzX29wZW4oYik/ZC5maW5kKFwiLmpzdHJlZS1vcGVuXCIpLmFkZEJhY2soKTpkLmZpbmQoXCIuanN0cmVlLW9wZW5cIiksYShkLmdldCgpLnJldmVyc2UoKSkuZWFjaChmdW5jdGlvbigpe2UuY2xvc2Vfbm9kZSh0aGlzLGN8fDApfSkpLGY9MCxnPWIuY2hpbGRyZW5fZC5sZW5ndGg7Zz5mO2YrKyl0aGlzLl9tb2RlbC5kYXRhW2IuY2hpbGRyZW5fZFtmXV0uc3RhdGUub3BlbmVkPSExO3RoaXMudHJpZ2dlcihcImNsb3NlX2FsbFwiLHtub2RlOmJ9KX0saXNfZGlzYWJsZWQ6ZnVuY3Rpb24oYSl7cmV0dXJuIGE9dGhpcy5nZXRfbm9kZShhKSxhJiZhLnN0YXRlJiZhLnN0YXRlLmRpc2FibGVkfSxlbmFibGVfbm9kZTpmdW5jdGlvbihiKXt2YXIgYyxkO2lmKGEuaXNBcnJheShiKSl7Zm9yKGI9Yi5zbGljZSgpLGM9MCxkPWIubGVuZ3RoO2Q+YztjKyspdGhpcy5lbmFibGVfbm9kZShiW2NdKTtyZXR1cm4hMH1yZXR1cm4gYj10aGlzLmdldF9ub2RlKGIpLGImJmIuaWQhPT1hLmpzdHJlZS5yb290PyhiLnN0YXRlLmRpc2FibGVkPSExLHRoaXMuZ2V0X25vZGUoYiwhMCkuY2hpbGRyZW4oXCIuanN0cmVlLWFuY2hvclwiKS5yZW1vdmVDbGFzcyhcImpzdHJlZS1kaXNhYmxlZFwiKS5hdHRyKFwiYXJpYS1kaXNhYmxlZFwiLCExKSx2b2lkIHRoaXMudHJpZ2dlcihcImVuYWJsZV9ub2RlXCIse25vZGU6Yn0pKTohMX0sZGlzYWJsZV9ub2RlOmZ1bmN0aW9uKGIpe3ZhciBjLGQ7aWYoYS5pc0FycmF5KGIpKXtmb3IoYj1iLnNsaWNlKCksYz0wLGQ9Yi5sZW5ndGg7ZD5jO2MrKyl0aGlzLmRpc2FibGVfbm9kZShiW2NdKTtyZXR1cm4hMH1yZXR1cm4gYj10aGlzLmdldF9ub2RlKGIpLGImJmIuaWQhPT1hLmpzdHJlZS5yb290PyhiLnN0YXRlLmRpc2FibGVkPSEwLHRoaXMuZ2V0X25vZGUoYiwhMCkuY2hpbGRyZW4oXCIuanN0cmVlLWFuY2hvclwiKS5hZGRDbGFzcyhcImpzdHJlZS1kaXNhYmxlZFwiKS5hdHRyKFwiYXJpYS1kaXNhYmxlZFwiLCEwKSx2b2lkIHRoaXMudHJpZ2dlcihcImRpc2FibGVfbm9kZVwiLHtub2RlOmJ9KSk6ITF9LGlzX2hpZGRlbjpmdW5jdGlvbihhKXtyZXR1cm4gYT10aGlzLmdldF9ub2RlKGEpLGEuc3RhdGUuaGlkZGVuPT09ITB9LGhpZGVfbm9kZTpmdW5jdGlvbihiLGMpe3ZhciBkLGU7aWYoYS5pc0FycmF5KGIpKXtmb3IoYj1iLnNsaWNlKCksZD0wLGU9Yi5sZW5ndGg7ZT5kO2QrKyl0aGlzLmhpZGVfbm9kZShiW2RdLCEwKTtyZXR1cm4gY3x8dGhpcy5yZWRyYXcoKSwhMH1yZXR1cm4gYj10aGlzLmdldF9ub2RlKGIpLGImJmIuaWQhPT1hLmpzdHJlZS5yb290P3ZvaWQoYi5zdGF0ZS5oaWRkZW58fChiLnN0YXRlLmhpZGRlbj0hMCx0aGlzLl9ub2RlX2NoYW5nZWQoYi5wYXJlbnQpLGN8fHRoaXMucmVkcmF3KCksdGhpcy50cmlnZ2VyKFwiaGlkZV9ub2RlXCIse25vZGU6Yn0pKSk6ITF9LHNob3dfbm9kZTpmdW5jdGlvbihiLGMpe3ZhciBkLGU7aWYoYS5pc0FycmF5KGIpKXtmb3IoYj1iLnNsaWNlKCksZD0wLGU9Yi5sZW5ndGg7ZT5kO2QrKyl0aGlzLnNob3dfbm9kZShiW2RdLCEwKTtyZXR1cm4gY3x8dGhpcy5yZWRyYXcoKSwhMH1yZXR1cm4gYj10aGlzLmdldF9ub2RlKGIpLGImJmIuaWQhPT1hLmpzdHJlZS5yb290P3ZvaWQoYi5zdGF0ZS5oaWRkZW4mJihiLnN0YXRlLmhpZGRlbj0hMSx0aGlzLl9ub2RlX2NoYW5nZWQoYi5wYXJlbnQpLGN8fHRoaXMucmVkcmF3KCksdGhpcy50cmlnZ2VyKFwic2hvd19ub2RlXCIse25vZGU6Yn0pKSk6ITF9LGhpZGVfYWxsOmZ1bmN0aW9uKGIpe3ZhciBjLGQ9dGhpcy5fbW9kZWwuZGF0YSxlPVtdO2ZvcihjIGluIGQpZC5oYXNPd25Qcm9wZXJ0eShjKSYmYyE9PWEuanN0cmVlLnJvb3QmJiFkW2NdLnN0YXRlLmhpZGRlbiYmKGRbY10uc3RhdGUuaGlkZGVuPSEwLGUucHVzaChjKSk7cmV0dXJuIHRoaXMuX21vZGVsLmZvcmNlX2Z1bGxfcmVkcmF3PSEwLGJ8fHRoaXMucmVkcmF3KCksdGhpcy50cmlnZ2VyKFwiaGlkZV9hbGxcIix7bm9kZXM6ZX0pLGV9LHNob3dfYWxsOmZ1bmN0aW9uKGIpe3ZhciBjLGQ9dGhpcy5fbW9kZWwuZGF0YSxlPVtdO2ZvcihjIGluIGQpZC5oYXNPd25Qcm9wZXJ0eShjKSYmYyE9PWEuanN0cmVlLnJvb3QmJmRbY10uc3RhdGUuaGlkZGVuJiYoZFtjXS5zdGF0ZS5oaWRkZW49ITEsZS5wdXNoKGMpKTtyZXR1cm4gdGhpcy5fbW9kZWwuZm9yY2VfZnVsbF9yZWRyYXc9ITAsYnx8dGhpcy5yZWRyYXcoKSx0aGlzLnRyaWdnZXIoXCJzaG93X2FsbFwiLHtub2RlczplfSksZX0sYWN0aXZhdGVfbm9kZTpmdW5jdGlvbihhLGMpe2lmKHRoaXMuaXNfZGlzYWJsZWQoYSkpcmV0dXJuITE7aWYoYyYmXCJvYmplY3RcIj09dHlwZW9mIGN8fChjPXt9KSx0aGlzLl9kYXRhLmNvcmUubGFzdF9jbGlja2VkPXRoaXMuX2RhdGEuY29yZS5sYXN0X2NsaWNrZWQmJnRoaXMuX2RhdGEuY29yZS5sYXN0X2NsaWNrZWQuaWQhPT1iP3RoaXMuZ2V0X25vZGUodGhpcy5fZGF0YS5jb3JlLmxhc3RfY2xpY2tlZC5pZCk6bnVsbCx0aGlzLl9kYXRhLmNvcmUubGFzdF9jbGlja2VkJiYhdGhpcy5fZGF0YS5jb3JlLmxhc3RfY2xpY2tlZC5zdGF0ZS5zZWxlY3RlZCYmKHRoaXMuX2RhdGEuY29yZS5sYXN0X2NsaWNrZWQ9bnVsbCksIXRoaXMuX2RhdGEuY29yZS5sYXN0X2NsaWNrZWQmJnRoaXMuX2RhdGEuY29yZS5zZWxlY3RlZC5sZW5ndGgmJih0aGlzLl9kYXRhLmNvcmUubGFzdF9jbGlja2VkPXRoaXMuZ2V0X25vZGUodGhpcy5fZGF0YS5jb3JlLnNlbGVjdGVkW3RoaXMuX2RhdGEuY29yZS5zZWxlY3RlZC5sZW5ndGgtMV0pKSx0aGlzLnNldHRpbmdzLmNvcmUubXVsdGlwbGUmJihjLm1ldGFLZXl8fGMuY3RybEtleXx8Yy5zaGlmdEtleSkmJighYy5zaGlmdEtleXx8dGhpcy5fZGF0YS5jb3JlLmxhc3RfY2xpY2tlZCYmdGhpcy5nZXRfcGFyZW50KGEpJiZ0aGlzLmdldF9wYXJlbnQoYSk9PT10aGlzLl9kYXRhLmNvcmUubGFzdF9jbGlja2VkLnBhcmVudCkpaWYoYy5zaGlmdEtleSl7dmFyIGQ9dGhpcy5nZXRfbm9kZShhKS5pZCxlPXRoaXMuX2RhdGEuY29yZS5sYXN0X2NsaWNrZWQuaWQsZj10aGlzLmdldF9ub2RlKHRoaXMuX2RhdGEuY29yZS5sYXN0X2NsaWNrZWQucGFyZW50KS5jaGlsZHJlbixnPSExLGgsaTtmb3IoaD0wLGk9Zi5sZW5ndGg7aT5oO2grPTEpZltoXT09PWQmJihnPSFnKSxmW2hdPT09ZSYmKGc9IWcpLHRoaXMuaXNfZGlzYWJsZWQoZltoXSl8fCFnJiZmW2hdIT09ZCYmZltoXSE9PWU/dGhpcy5kZXNlbGVjdF9ub2RlKGZbaF0sITAsYyk6dGhpcy5pc19oaWRkZW4oZltoXSl8fHRoaXMuc2VsZWN0X25vZGUoZltoXSwhMCwhMSxjKTt0aGlzLnRyaWdnZXIoXCJjaGFuZ2VkXCIse2FjdGlvbjpcInNlbGVjdF9ub2RlXCIsbm9kZTp0aGlzLmdldF9ub2RlKGEpLHNlbGVjdGVkOnRoaXMuX2RhdGEuY29yZS5zZWxlY3RlZCxldmVudDpjfSl9ZWxzZSB0aGlzLmlzX3NlbGVjdGVkKGEpP3RoaXMuZGVzZWxlY3Rfbm9kZShhLCExLGMpOnRoaXMuc2VsZWN0X25vZGUoYSwhMSwhMSxjKTtlbHNlIXRoaXMuc2V0dGluZ3MuY29yZS5tdWx0aXBsZSYmKGMubWV0YUtleXx8Yy5jdHJsS2V5fHxjLnNoaWZ0S2V5KSYmdGhpcy5pc19zZWxlY3RlZChhKT90aGlzLmRlc2VsZWN0X25vZGUoYSwhMSxjKToodGhpcy5kZXNlbGVjdF9hbGwoITApLHRoaXMuc2VsZWN0X25vZGUoYSwhMSwhMSxjKSx0aGlzLl9kYXRhLmNvcmUubGFzdF9jbGlja2VkPXRoaXMuZ2V0X25vZGUoYSkpO3RoaXMudHJpZ2dlcihcImFjdGl2YXRlX25vZGVcIix7bm9kZTp0aGlzLmdldF9ub2RlKGEpLGV2ZW50OmN9KX0saG92ZXJfbm9kZTpmdW5jdGlvbihhKXtpZihhPXRoaXMuZ2V0X25vZGUoYSwhMCksIWF8fCFhLmxlbmd0aHx8YS5jaGlsZHJlbihcIi5qc3RyZWUtaG92ZXJlZFwiKS5sZW5ndGgpcmV0dXJuITE7dmFyIGI9dGhpcy5lbGVtZW50LmZpbmQoXCIuanN0cmVlLWhvdmVyZWRcIiksYz10aGlzLmVsZW1lbnQ7YiYmYi5sZW5ndGgmJnRoaXMuZGVob3Zlcl9ub2RlKGIpLGEuY2hpbGRyZW4oXCIuanN0cmVlLWFuY2hvclwiKS5hZGRDbGFzcyhcImpzdHJlZS1ob3ZlcmVkXCIpLHRoaXMudHJpZ2dlcihcImhvdmVyX25vZGVcIix7bm9kZTp0aGlzLmdldF9ub2RlKGEpfSksc2V0VGltZW91dChmdW5jdGlvbigpe2MuYXR0cihcImFyaWEtYWN0aXZlZGVzY2VuZGFudFwiLGFbMF0uaWQpfSwwKX0sZGVob3Zlcl9ub2RlOmZ1bmN0aW9uKGEpe3JldHVybiBhPXRoaXMuZ2V0X25vZGUoYSwhMCksYSYmYS5sZW5ndGgmJmEuY2hpbGRyZW4oXCIuanN0cmVlLWhvdmVyZWRcIikubGVuZ3RoPyhhLmNoaWxkcmVuKFwiLmpzdHJlZS1hbmNob3JcIikucmVtb3ZlQ2xhc3MoXCJqc3RyZWUtaG92ZXJlZFwiKSx2b2lkIHRoaXMudHJpZ2dlcihcImRlaG92ZXJfbm9kZVwiLHtub2RlOnRoaXMuZ2V0X25vZGUoYSl9KSk6ITF9LHNlbGVjdF9ub2RlOmZ1bmN0aW9uKGIsYyxkLGUpe3ZhciBmLGcsaCxpO2lmKGEuaXNBcnJheShiKSl7Zm9yKGI9Yi5zbGljZSgpLGc9MCxoPWIubGVuZ3RoO2g+ZztnKyspdGhpcy5zZWxlY3Rfbm9kZShiW2ddLGMsZCxlKTtyZXR1cm4hMH1yZXR1cm4gYj10aGlzLmdldF9ub2RlKGIpLGImJmIuaWQhPT1hLmpzdHJlZS5yb290PyhmPXRoaXMuZ2V0X25vZGUoYiwhMCksdm9pZChiLnN0YXRlLnNlbGVjdGVkfHwoYi5zdGF0ZS5zZWxlY3RlZD0hMCx0aGlzLl9kYXRhLmNvcmUuc2VsZWN0ZWQucHVzaChiLmlkKSxkfHwoZj10aGlzLl9vcGVuX3RvKGIpKSxmJiZmLmxlbmd0aCYmZi5hdHRyKFwiYXJpYS1zZWxlY3RlZFwiLCEwKS5jaGlsZHJlbihcIi5qc3RyZWUtYW5jaG9yXCIpLmFkZENsYXNzKFwianN0cmVlLWNsaWNrZWRcIiksdGhpcy50cmlnZ2VyKFwic2VsZWN0X25vZGVcIix7bm9kZTpiLHNlbGVjdGVkOnRoaXMuX2RhdGEuY29yZS5zZWxlY3RlZCxldmVudDplfSksY3x8dGhpcy50cmlnZ2VyKFwiY2hhbmdlZFwiLHthY3Rpb246XCJzZWxlY3Rfbm9kZVwiLG5vZGU6YixzZWxlY3RlZDp0aGlzLl9kYXRhLmNvcmUuc2VsZWN0ZWQsZXZlbnQ6ZX0pKSkpOiExfSxkZXNlbGVjdF9ub2RlOmZ1bmN0aW9uKGIsYyxkKXt2YXIgZSxmLGc7aWYoYS5pc0FycmF5KGIpKXtmb3IoYj1iLnNsaWNlKCksZT0wLGY9Yi5sZW5ndGg7Zj5lO2UrKyl0aGlzLmRlc2VsZWN0X25vZGUoYltlXSxjLGQpO3JldHVybiEwfXJldHVybiBiPXRoaXMuZ2V0X25vZGUoYiksYiYmYi5pZCE9PWEuanN0cmVlLnJvb3Q/KGc9dGhpcy5nZXRfbm9kZShiLCEwKSx2b2lkKGIuc3RhdGUuc2VsZWN0ZWQmJihiLnN0YXRlLnNlbGVjdGVkPSExLHRoaXMuX2RhdGEuY29yZS5zZWxlY3RlZD1hLnZha2F0YS5hcnJheV9yZW1vdmVfaXRlbSh0aGlzLl9kYXRhLmNvcmUuc2VsZWN0ZWQsYi5pZCksZy5sZW5ndGgmJmcuYXR0cihcImFyaWEtc2VsZWN0ZWRcIiwhMSkuY2hpbGRyZW4oXCIuanN0cmVlLWFuY2hvclwiKS5yZW1vdmVDbGFzcyhcImpzdHJlZS1jbGlja2VkXCIpLHRoaXMudHJpZ2dlcihcImRlc2VsZWN0X25vZGVcIix7bm9kZTpiLHNlbGVjdGVkOnRoaXMuX2RhdGEuY29yZS5zZWxlY3RlZCxldmVudDpkfSksY3x8dGhpcy50cmlnZ2VyKFwiY2hhbmdlZFwiLHthY3Rpb246XCJkZXNlbGVjdF9ub2RlXCIsbm9kZTpiLHNlbGVjdGVkOnRoaXMuX2RhdGEuY29yZS5zZWxlY3RlZCxldmVudDpkfSkpKSk6ITF9LHNlbGVjdF9hbGw6ZnVuY3Rpb24oYil7dmFyIGM9dGhpcy5fZGF0YS5jb3JlLnNlbGVjdGVkLmNvbmNhdChbXSksZCxlO2Zvcih0aGlzLl9kYXRhLmNvcmUuc2VsZWN0ZWQ9dGhpcy5fbW9kZWwuZGF0YVthLmpzdHJlZS5yb290XS5jaGlsZHJlbl9kLmNvbmNhdCgpLGQ9MCxlPXRoaXMuX2RhdGEuY29yZS5zZWxlY3RlZC5sZW5ndGg7ZT5kO2QrKyl0aGlzLl9tb2RlbC5kYXRhW3RoaXMuX2RhdGEuY29yZS5zZWxlY3RlZFtkXV0mJih0aGlzLl9tb2RlbC5kYXRhW3RoaXMuX2RhdGEuY29yZS5zZWxlY3RlZFtkXV0uc3RhdGUuc2VsZWN0ZWQ9ITApO3RoaXMucmVkcmF3KCEwKSx0aGlzLnRyaWdnZXIoXCJzZWxlY3RfYWxsXCIse3NlbGVjdGVkOnRoaXMuX2RhdGEuY29yZS5zZWxlY3RlZH0pLGJ8fHRoaXMudHJpZ2dlcihcImNoYW5nZWRcIix7YWN0aW9uOlwic2VsZWN0X2FsbFwiLHNlbGVjdGVkOnRoaXMuX2RhdGEuY29yZS5zZWxlY3RlZCxvbGRfc2VsZWN0aW9uOmN9KX0sZGVzZWxlY3RfYWxsOmZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuX2RhdGEuY29yZS5zZWxlY3RlZC5jb25jYXQoW10pLGMsZDtmb3IoYz0wLGQ9dGhpcy5fZGF0YS5jb3JlLnNlbGVjdGVkLmxlbmd0aDtkPmM7YysrKXRoaXMuX21vZGVsLmRhdGFbdGhpcy5fZGF0YS5jb3JlLnNlbGVjdGVkW2NdXSYmKHRoaXMuX21vZGVsLmRhdGFbdGhpcy5fZGF0YS5jb3JlLnNlbGVjdGVkW2NdXS5zdGF0ZS5zZWxlY3RlZD0hMSk7dGhpcy5fZGF0YS5jb3JlLnNlbGVjdGVkPVtdLHRoaXMuZWxlbWVudC5maW5kKFwiLmpzdHJlZS1jbGlja2VkXCIpLnJlbW92ZUNsYXNzKFwianN0cmVlLWNsaWNrZWRcIikucGFyZW50KCkuYXR0cihcImFyaWEtc2VsZWN0ZWRcIiwhMSksdGhpcy50cmlnZ2VyKFwiZGVzZWxlY3RfYWxsXCIse3NlbGVjdGVkOnRoaXMuX2RhdGEuY29yZS5zZWxlY3RlZCxub2RlOmJ9KSxhfHx0aGlzLnRyaWdnZXIoXCJjaGFuZ2VkXCIse2FjdGlvbjpcImRlc2VsZWN0X2FsbFwiLHNlbGVjdGVkOnRoaXMuX2RhdGEuY29yZS5zZWxlY3RlZCxvbGRfc2VsZWN0aW9uOmJ9KX0saXNfc2VsZWN0ZWQ6ZnVuY3Rpb24oYil7cmV0dXJuIGI9dGhpcy5nZXRfbm9kZShiKSxiJiZiLmlkIT09YS5qc3RyZWUucm9vdD9iLnN0YXRlLnNlbGVjdGVkOiExfSxnZXRfc2VsZWN0ZWQ6ZnVuY3Rpb24oYil7cmV0dXJuIGI/YS5tYXAodGhpcy5fZGF0YS5jb3JlLnNlbGVjdGVkLGEucHJveHkoZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMuZ2V0X25vZGUoYSl9LHRoaXMpKTp0aGlzLl9kYXRhLmNvcmUuc2VsZWN0ZWQuc2xpY2UoKX0sZ2V0X3RvcF9zZWxlY3RlZDpmdW5jdGlvbihiKXt2YXIgYz10aGlzLmdldF9zZWxlY3RlZCghMCksZD17fSxlLGYsZyxoO2ZvcihlPTAsZj1jLmxlbmd0aDtmPmU7ZSsrKWRbY1tlXS5pZF09Y1tlXTtmb3IoZT0wLGY9Yy5sZW5ndGg7Zj5lO2UrKylmb3IoZz0wLGg9Y1tlXS5jaGlsZHJlbl9kLmxlbmd0aDtoPmc7ZysrKWRbY1tlXS5jaGlsZHJlbl9kW2ddXSYmZGVsZXRlIGRbY1tlXS5jaGlsZHJlbl9kW2ddXTtjPVtdO2ZvcihlIGluIGQpZC5oYXNPd25Qcm9wZXJ0eShlKSYmYy5wdXNoKGUpO3JldHVybiBiP2EubWFwKGMsYS5wcm94eShmdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5nZXRfbm9kZShhKX0sdGhpcykpOmN9LGdldF9ib3R0b21fc2VsZWN0ZWQ6ZnVuY3Rpb24oYil7dmFyIGM9dGhpcy5nZXRfc2VsZWN0ZWQoITApLGQ9W10sZSxmO2ZvcihlPTAsZj1jLmxlbmd0aDtmPmU7ZSsrKWNbZV0uY2hpbGRyZW4ubGVuZ3RofHxkLnB1c2goY1tlXS5pZCk7cmV0dXJuIGI/YS5tYXAoZCxhLnByb3h5KGZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLmdldF9ub2RlKGEpfSx0aGlzKSk6ZH0sZ2V0X3N0YXRlOmZ1bmN0aW9uKCl7dmFyIGI9e2NvcmU6e29wZW46W10sc2Nyb2xsOntsZWZ0OnRoaXMuZWxlbWVudC5zY3JvbGxMZWZ0KCksdG9wOnRoaXMuZWxlbWVudC5zY3JvbGxUb3AoKX0sc2VsZWN0ZWQ6W119fSxjO2ZvcihjIGluIHRoaXMuX21vZGVsLmRhdGEpdGhpcy5fbW9kZWwuZGF0YS5oYXNPd25Qcm9wZXJ0eShjKSYmYyE9PWEuanN0cmVlLnJvb3QmJih0aGlzLl9tb2RlbC5kYXRhW2NdLnN0YXRlLm9wZW5lZCYmYi5jb3JlLm9wZW4ucHVzaChjKSx0aGlzLl9tb2RlbC5kYXRhW2NdLnN0YXRlLnNlbGVjdGVkJiZiLmNvcmUuc2VsZWN0ZWQucHVzaChjKSk7cmV0dXJuIGJ9LHNldF9zdGF0ZTpmdW5jdGlvbihjLGQpe2lmKGMpe2lmKGMuY29yZSl7dmFyIGUsZixnLGgsaTtpZihjLmNvcmUub3BlbilyZXR1cm4gYS5pc0FycmF5KGMuY29yZS5vcGVuKSYmYy5jb3JlLm9wZW4ubGVuZ3RoP3RoaXMuX2xvYWRfbm9kZXMoYy5jb3JlLm9wZW4sZnVuY3Rpb24oYSl7dGhpcy5vcGVuX25vZGUoYSwhMSwwKSxkZWxldGUgYy5jb3JlLm9wZW4sdGhpcy5zZXRfc3RhdGUoYyxkKX0sITApOihkZWxldGUgYy5jb3JlLm9wZW4sdGhpcy5zZXRfc3RhdGUoYyxkKSksITE7aWYoYy5jb3JlLnNjcm9sbClyZXR1cm4gYy5jb3JlLnNjcm9sbCYmYy5jb3JlLnNjcm9sbC5sZWZ0IT09YiYmdGhpcy5lbGVtZW50LnNjcm9sbExlZnQoYy5jb3JlLnNjcm9sbC5sZWZ0KSxjLmNvcmUuc2Nyb2xsJiZjLmNvcmUuc2Nyb2xsLnRvcCE9PWImJnRoaXMuZWxlbWVudC5zY3JvbGxUb3AoYy5jb3JlLnNjcm9sbC50b3ApLGRlbGV0ZSBjLmNvcmUuc2Nyb2xsLHRoaXMuc2V0X3N0YXRlKGMsZCksITE7aWYoYy5jb3JlLnNlbGVjdGVkKXJldHVybiBoPXRoaXMsdGhpcy5kZXNlbGVjdF9hbGwoKSxhLmVhY2goYy5jb3JlLnNlbGVjdGVkLGZ1bmN0aW9uKGEsYil7aC5zZWxlY3Rfbm9kZShiLCExLCEwKX0pLGRlbGV0ZSBjLmNvcmUuc2VsZWN0ZWQsdGhpcy5zZXRfc3RhdGUoYyxkKSwhMTtmb3IoaSBpbiBjKWMuaGFzT3duUHJvcGVydHkoaSkmJlwiY29yZVwiIT09aSYmLTE9PT1hLmluQXJyYXkoaSx0aGlzLnNldHRpbmdzLnBsdWdpbnMpJiZkZWxldGUgY1tpXTtpZihhLmlzRW1wdHlPYmplY3QoYy5jb3JlKSlyZXR1cm4gZGVsZXRlIGMuY29yZSx0aGlzLnNldF9zdGF0ZShjLGQpLCExfXJldHVybiBhLmlzRW1wdHlPYmplY3QoYyk/KGM9bnVsbCxkJiZkLmNhbGwodGhpcyksdGhpcy50cmlnZ2VyKFwic2V0X3N0YXRlXCIpLCExKTohMH1yZXR1cm4hMX0scmVmcmVzaDpmdW5jdGlvbihiLGMpe3RoaXMuX2RhdGEuY29yZS5zdGF0ZT1jPT09ITA/e306dGhpcy5nZXRfc3RhdGUoKSxjJiZhLmlzRnVuY3Rpb24oYykmJih0aGlzLl9kYXRhLmNvcmUuc3RhdGU9Yy5jYWxsKHRoaXMsdGhpcy5fZGF0YS5jb3JlLnN0YXRlKSksdGhpcy5fY250PTAsdGhpcy5fbW9kZWwuZGF0YT17fSx0aGlzLl9tb2RlbC5kYXRhW2EuanN0cmVlLnJvb3RdPXtpZDphLmpzdHJlZS5yb290LHBhcmVudDpudWxsLHBhcmVudHM6W10sY2hpbGRyZW46W10sY2hpbGRyZW5fZDpbXSxzdGF0ZTp7bG9hZGVkOiExfX0sdGhpcy5fZGF0YS5jb3JlLnNlbGVjdGVkPVtdLHRoaXMuX2RhdGEuY29yZS5sYXN0X2NsaWNrZWQ9bnVsbCx0aGlzLl9kYXRhLmNvcmUuZm9jdXNlZD1udWxsO3ZhciBkPXRoaXMuZ2V0X2NvbnRhaW5lcl91bCgpWzBdLmNsYXNzTmFtZTtifHwodGhpcy5lbGVtZW50Lmh0bWwoXCI8dWwgY2xhc3M9J1wiK2QrXCInIHJvbGU9J2dyb3VwJz48bGkgY2xhc3M9J2pzdHJlZS1pbml0aWFsLW5vZGUganN0cmVlLWxvYWRpbmcganN0cmVlLWxlYWYganN0cmVlLWxhc3QnIHJvbGU9J3RyZWVpdGVtJyBpZD0nalwiK3RoaXMuX2lkK1wiX2xvYWRpbmcnPjxpIGNsYXNzPSdqc3RyZWUtaWNvbiBqc3RyZWUtb2NsJz48L2k+PGEgY2xhc3M9J2pzdHJlZS1hbmNob3InIGhyZWY9JyMnPjxpIGNsYXNzPSdqc3RyZWUtaWNvbiBqc3RyZWUtdGhlbWVpY29uLWhpZGRlbic+PC9pPlwiK3RoaXMuZ2V0X3N0cmluZyhcIkxvYWRpbmcgLi4uXCIpK1wiPC9hPjwvbGk+PC91bD5cIiksdGhpcy5lbGVtZW50LmF0dHIoXCJhcmlhLWFjdGl2ZWRlc2NlbmRhbnRcIixcImpcIit0aGlzLl9pZCtcIl9sb2FkaW5nXCIpKSx0aGlzLmxvYWRfbm9kZShhLmpzdHJlZS5yb290LGZ1bmN0aW9uKGIsYyl7YyYmKHRoaXMuZ2V0X2NvbnRhaW5lcl91bCgpWzBdLmNsYXNzTmFtZT1kLHRoaXMuX2ZpcnN0Q2hpbGQodGhpcy5nZXRfY29udGFpbmVyX3VsKClbMF0pJiZ0aGlzLmVsZW1lbnQuYXR0cihcImFyaWEtYWN0aXZlZGVzY2VuZGFudFwiLHRoaXMuX2ZpcnN0Q2hpbGQodGhpcy5nZXRfY29udGFpbmVyX3VsKClbMF0pLmlkKSx0aGlzLnNldF9zdGF0ZShhLmV4dGVuZCghMCx7fSx0aGlzLl9kYXRhLmNvcmUuc3RhdGUpLGZ1bmN0aW9uKCl7dGhpcy50cmlnZ2VyKFwicmVmcmVzaFwiKX0pKSx0aGlzLl9kYXRhLmNvcmUuc3RhdGU9bnVsbH0pfSxyZWZyZXNoX25vZGU6ZnVuY3Rpb24oYil7aWYoYj10aGlzLmdldF9ub2RlKGIpLCFifHxiLmlkPT09YS5qc3RyZWUucm9vdClyZXR1cm4hMTt2YXIgYz1bXSxkPVtdLGU9dGhpcy5fZGF0YS5jb3JlLnNlbGVjdGVkLmNvbmNhdChbXSk7ZC5wdXNoKGIuaWQpLGIuc3RhdGUub3BlbmVkPT09ITAmJmMucHVzaChiLmlkKSx0aGlzLmdldF9ub2RlKGIsITApLmZpbmQoXCIuanN0cmVlLW9wZW5cIikuZWFjaChmdW5jdGlvbigpe2QucHVzaCh0aGlzLmlkKSxjLnB1c2godGhpcy5pZCl9KSx0aGlzLl9sb2FkX25vZGVzKGQsYS5wcm94eShmdW5jdGlvbihhKXt0aGlzLm9wZW5fbm9kZShjLCExLDApLHRoaXMuc2VsZWN0X25vZGUoZSksdGhpcy50cmlnZ2VyKFwicmVmcmVzaF9ub2RlXCIse25vZGU6Yixub2RlczphfSl9LHRoaXMpLCExLCEwKX0sc2V0X2lkOmZ1bmN0aW9uKGIsYyl7aWYoYj10aGlzLmdldF9ub2RlKGIpLCFifHxiLmlkPT09YS5qc3RyZWUucm9vdClyZXR1cm4hMTt2YXIgZCxlLGY9dGhpcy5fbW9kZWwuZGF0YSxnPWIuaWQ7Zm9yKGM9Yy50b1N0cmluZygpLGZbYi5wYXJlbnRdLmNoaWxkcmVuW2EuaW5BcnJheShiLmlkLGZbYi5wYXJlbnRdLmNoaWxkcmVuKV09YyxkPTAsZT1iLnBhcmVudHMubGVuZ3RoO2U+ZDtkKyspZltiLnBhcmVudHNbZF1dLmNoaWxkcmVuX2RbYS5pbkFycmF5KGIuaWQsZltiLnBhcmVudHNbZF1dLmNoaWxkcmVuX2QpXT1jO2ZvcihkPTAsZT1iLmNoaWxkcmVuLmxlbmd0aDtlPmQ7ZCsrKWZbYi5jaGlsZHJlbltkXV0ucGFyZW50PWM7Zm9yKGQ9MCxlPWIuY2hpbGRyZW5fZC5sZW5ndGg7ZT5kO2QrKylmW2IuY2hpbGRyZW5fZFtkXV0ucGFyZW50c1thLmluQXJyYXkoYi5pZCxmW2IuY2hpbGRyZW5fZFtkXV0ucGFyZW50cyldPWM7cmV0dXJuIGQ9YS5pbkFycmF5KGIuaWQsdGhpcy5fZGF0YS5jb3JlLnNlbGVjdGVkKSwtMSE9PWQmJih0aGlzLl9kYXRhLmNvcmUuc2VsZWN0ZWRbZF09YyksZD10aGlzLmdldF9ub2RlKGIuaWQsITApLGQmJihkLmF0dHIoXCJpZFwiLGMpLHRoaXMuZWxlbWVudC5hdHRyKFwiYXJpYS1hY3RpdmVkZXNjZW5kYW50XCIpPT09Yi5pZCYmdGhpcy5lbGVtZW50LmF0dHIoXCJhcmlhLWFjdGl2ZWRlc2NlbmRhbnRcIixjKSksZGVsZXRlIGZbYi5pZF0sYi5pZD1jLGIubGlfYXR0ci5pZD1jLGZbY109Yix0aGlzLnRyaWdnZXIoXCJzZXRfaWRcIix7bm9kZTpiLFwibmV3XCI6Yi5pZCxvbGQ6Z30pLCEwfSxnZXRfdGV4dDpmdW5jdGlvbihiKXtyZXR1cm4gYj10aGlzLmdldF9ub2RlKGIpLGImJmIuaWQhPT1hLmpzdHJlZS5yb290P2IudGV4dDohMX0sc2V0X3RleHQ6ZnVuY3Rpb24oYixjKXt2YXIgZCxlO2lmKGEuaXNBcnJheShiKSl7Zm9yKGI9Yi5zbGljZSgpLGQ9MCxlPWIubGVuZ3RoO2U+ZDtkKyspdGhpcy5zZXRfdGV4dChiW2RdLGMpO3JldHVybiEwfXJldHVybiBiPXRoaXMuZ2V0X25vZGUoYiksYiYmYi5pZCE9PWEuanN0cmVlLnJvb3Q/KGIudGV4dD1jLHRoaXMuZ2V0X25vZGUoYiwhMCkubGVuZ3RoJiZ0aGlzLnJlZHJhd19ub2RlKGIuaWQpLHRoaXMudHJpZ2dlcihcInNldF90ZXh0XCIse29iajpiLHRleHQ6Y30pLCEwKTohMX0sZ2V0X2pzb246ZnVuY3Rpb24oYixjLGQpe2lmKGI9dGhpcy5nZXRfbm9kZShifHxhLmpzdHJlZS5yb290KSwhYilyZXR1cm4hMTtjJiZjLmZsYXQmJiFkJiYoZD1bXSk7dmFyIGU9e2lkOmIuaWQsdGV4dDpiLnRleHQsaWNvbjp0aGlzLmdldF9pY29uKGIpLGxpX2F0dHI6YS5leHRlbmQoITAse30sYi5saV9hdHRyKSxhX2F0dHI6YS5leHRlbmQoITAse30sYi5hX2F0dHIpLHN0YXRlOnt9LGRhdGE6YyYmYy5ub19kYXRhPyExOmEuZXh0ZW5kKCEwLHt9LGIuZGF0YSl9LGYsZztpZihjJiZjLmZsYXQ/ZS5wYXJlbnQ9Yi5wYXJlbnQ6ZS5jaGlsZHJlbj1bXSwhY3x8IWMubm9fc3RhdGUpZm9yKGYgaW4gYi5zdGF0ZSliLnN0YXRlLmhhc093blByb3BlcnR5KGYpJiYoZS5zdGF0ZVtmXT1iLnN0YXRlW2ZdKTtpZihjJiZjLm5vX2lkJiYoZGVsZXRlIGUuaWQsZS5saV9hdHRyJiZlLmxpX2F0dHIuaWQmJmRlbGV0ZSBlLmxpX2F0dHIuaWQsZS5hX2F0dHImJmUuYV9hdHRyLmlkJiZkZWxldGUgZS5hX2F0dHIuaWQpLGMmJmMuZmxhdCYmYi5pZCE9PWEuanN0cmVlLnJvb3QmJmQucHVzaChlKSwhY3x8IWMubm9fY2hpbGRyZW4pZm9yKGY9MCxnPWIuY2hpbGRyZW4ubGVuZ3RoO2c+ZjtmKyspYyYmYy5mbGF0P3RoaXMuZ2V0X2pzb24oYi5jaGlsZHJlbltmXSxjLGQpOmUuY2hpbGRyZW4ucHVzaCh0aGlzLmdldF9qc29uKGIuY2hpbGRyZW5bZl0sYykpO3JldHVybiBjJiZjLmZsYXQ/ZDpiLmlkPT09YS5qc3RyZWUucm9vdD9lLmNoaWxkcmVuOmV9LGNyZWF0ZV9ub2RlOmZ1bmN0aW9uKGMsZCxlLGYsZyl7aWYobnVsbD09PWMmJihjPWEuanN0cmVlLnJvb3QpLGM9dGhpcy5nZXRfbm9kZShjKSwhYylyZXR1cm4hMTtpZihlPWU9PT1iP1wibGFzdFwiOmUsIWUudG9TdHJpbmcoKS5tYXRjaCgvXihiZWZvcmV8YWZ0ZXIpJC8pJiYhZyYmIXRoaXMuaXNfbG9hZGVkKGMpKXJldHVybiB0aGlzLmxvYWRfbm9kZShjLGZ1bmN0aW9uKCl7dGhpcy5jcmVhdGVfbm9kZShjLGQsZSxmLCEwKX0pO2R8fChkPXt0ZXh0OnRoaXMuZ2V0X3N0cmluZyhcIk5ldyBub2RlXCIpfSksXCJzdHJpbmdcIj09dHlwZW9mIGQmJihkPXt0ZXh0OmR9KSxkLnRleHQ9PT1iJiYoZC50ZXh0PXRoaXMuZ2V0X3N0cmluZyhcIk5ldyBub2RlXCIpKTt2YXIgaCxpLGosaztzd2l0Y2goYy5pZD09PWEuanN0cmVlLnJvb3QmJihcImJlZm9yZVwiPT09ZSYmKGU9XCJmaXJzdFwiKSxcImFmdGVyXCI9PT1lJiYoZT1cImxhc3RcIikpLGUpe2Nhc2VcImJlZm9yZVwiOmg9dGhpcy5nZXRfbm9kZShjLnBhcmVudCksZT1hLmluQXJyYXkoYy5pZCxoLmNoaWxkcmVuKSxjPWg7YnJlYWs7Y2FzZVwiYWZ0ZXJcIjpoPXRoaXMuZ2V0X25vZGUoYy5wYXJlbnQpLGU9YS5pbkFycmF5KGMuaWQsaC5jaGlsZHJlbikrMSxjPWg7YnJlYWs7Y2FzZVwiaW5zaWRlXCI6Y2FzZVwiZmlyc3RcIjplPTA7YnJlYWs7Y2FzZVwibGFzdFwiOmU9Yy5jaGlsZHJlbi5sZW5ndGg7YnJlYWs7ZGVmYXVsdDplfHwoZT0wKX1pZihlPmMuY2hpbGRyZW4ubGVuZ3RoJiYoZT1jLmNoaWxkcmVuLmxlbmd0aCksZC5pZHx8KGQuaWQ9ITApLCF0aGlzLmNoZWNrKFwiY3JlYXRlX25vZGVcIixkLGMsZSkpcmV0dXJuIHRoaXMuc2V0dGluZ3MuY29yZS5lcnJvci5jYWxsKHRoaXMsdGhpcy5fZGF0YS5jb3JlLmxhc3RfZXJyb3IpLCExO2lmKGQuaWQ9PT0hMCYmZGVsZXRlIGQuaWQsZD10aGlzLl9wYXJzZV9tb2RlbF9mcm9tX2pzb24oZCxjLmlkLGMucGFyZW50cy5jb25jYXQoKSksIWQpcmV0dXJuITE7Zm9yKGg9dGhpcy5nZXRfbm9kZShkKSxpPVtdLGkucHVzaChkKSxpPWkuY29uY2F0KGguY2hpbGRyZW5fZCksdGhpcy50cmlnZ2VyKFwibW9kZWxcIix7bm9kZXM6aSxwYXJlbnQ6Yy5pZH0pLGMuY2hpbGRyZW5fZD1jLmNoaWxkcmVuX2QuY29uY2F0KGkpLGo9MCxrPWMucGFyZW50cy5sZW5ndGg7az5qO2orKyl0aGlzLl9tb2RlbC5kYXRhW2MucGFyZW50c1tqXV0uY2hpbGRyZW5fZD10aGlzLl9tb2RlbC5kYXRhW2MucGFyZW50c1tqXV0uY2hpbGRyZW5fZC5jb25jYXQoaSk7Zm9yKGQ9aCxoPVtdLGo9MCxrPWMuY2hpbGRyZW4ubGVuZ3RoO2s+ajtqKyspaFtqPj1lP2orMTpqXT1jLmNoaWxkcmVuW2pdO3JldHVybiBoW2VdPWQuaWQsYy5jaGlsZHJlbj1oLHRoaXMucmVkcmF3X25vZGUoYywhMCksZiYmZi5jYWxsKHRoaXMsdGhpcy5nZXRfbm9kZShkKSksdGhpcy50cmlnZ2VyKFwiY3JlYXRlX25vZGVcIix7bm9kZTp0aGlzLmdldF9ub2RlKGQpLHBhcmVudDpjLmlkLHBvc2l0aW9uOmV9KSxkLmlkfSxyZW5hbWVfbm9kZTpmdW5jdGlvbihiLGMpe3ZhciBkLGUsZjtpZihhLmlzQXJyYXkoYikpe2ZvcihiPWIuc2xpY2UoKSxkPTAsZT1iLmxlbmd0aDtlPmQ7ZCsrKXRoaXMucmVuYW1lX25vZGUoYltkXSxjKTtyZXR1cm4hMH1yZXR1cm4gYj10aGlzLmdldF9ub2RlKGIpLGImJmIuaWQhPT1hLmpzdHJlZS5yb290PyhmPWIudGV4dCx0aGlzLmNoZWNrKFwicmVuYW1lX25vZGVcIixiLHRoaXMuZ2V0X3BhcmVudChiKSxjKT8odGhpcy5zZXRfdGV4dChiLGMpLHRoaXMudHJpZ2dlcihcInJlbmFtZV9ub2RlXCIse25vZGU6Yix0ZXh0OmMsb2xkOmZ9KSwhMCk6KHRoaXMuc2V0dGluZ3MuY29yZS5lcnJvci5jYWxsKHRoaXMsdGhpcy5fZGF0YS5jb3JlLmxhc3RfZXJyb3IpLCExKSk6ITF9LGRlbGV0ZV9ub2RlOmZ1bmN0aW9uKGIpe3ZhciBjLGQsZSxmLGcsaCxpLGosayxsLG0sbjtpZihhLmlzQXJyYXkoYikpe2ZvcihiPWIuc2xpY2UoKSxjPTAsZD1iLmxlbmd0aDtkPmM7YysrKXRoaXMuZGVsZXRlX25vZGUoYltjXSk7cmV0dXJuITB9aWYoYj10aGlzLmdldF9ub2RlKGIpLCFifHxiLmlkPT09YS5qc3RyZWUucm9vdClyZXR1cm4hMTtpZihlPXRoaXMuZ2V0X25vZGUoYi5wYXJlbnQpLGY9YS5pbkFycmF5KGIuaWQsZS5jaGlsZHJlbiksbD0hMSwhdGhpcy5jaGVjayhcImRlbGV0ZV9ub2RlXCIsYixlLGYpKXJldHVybiB0aGlzLnNldHRpbmdzLmNvcmUuZXJyb3IuY2FsbCh0aGlzLHRoaXMuX2RhdGEuY29yZS5sYXN0X2Vycm9yKSwhMTtmb3IoLTEhPT1mJiYoZS5jaGlsZHJlbj1hLnZha2F0YS5hcnJheV9yZW1vdmUoZS5jaGlsZHJlbixmKSksZz1iLmNoaWxkcmVuX2QuY29uY2F0KFtdKSxnLnB1c2goYi5pZCksaD0wLGk9Yi5wYXJlbnRzLmxlbmd0aDtpPmg7aCsrKXRoaXMuX21vZGVsLmRhdGFbYi5wYXJlbnRzW2hdXS5jaGlsZHJlbl9kPWEudmFrYXRhLmFycmF5X2ZpbHRlcih0aGlzLl9tb2RlbC5kYXRhW2IucGFyZW50c1toXV0uY2hpbGRyZW5fZCxmdW5jdGlvbihiKXtyZXR1cm4tMT09PWEuaW5BcnJheShiLGcpfSk7Zm9yKGo9MCxrPWcubGVuZ3RoO2s+ajtqKyspaWYodGhpcy5fbW9kZWwuZGF0YVtnW2pdXS5zdGF0ZS5zZWxlY3RlZCl7bD0hMDticmVha31mb3IobCYmKHRoaXMuX2RhdGEuY29yZS5zZWxlY3RlZD1hLnZha2F0YS5hcnJheV9maWx0ZXIodGhpcy5fZGF0YS5jb3JlLnNlbGVjdGVkLGZ1bmN0aW9uKGIpe3JldHVybi0xPT09YS5pbkFycmF5KGIsZyl9KSksdGhpcy50cmlnZ2VyKFwiZGVsZXRlX25vZGVcIix7bm9kZTpiLHBhcmVudDplLmlkfSksbCYmdGhpcy50cmlnZ2VyKFwiY2hhbmdlZFwiLHthY3Rpb246XCJkZWxldGVfbm9kZVwiLG5vZGU6YixzZWxlY3RlZDp0aGlzLl9kYXRhLmNvcmUuc2VsZWN0ZWQscGFyZW50OmUuaWR9KSxqPTAsaz1nLmxlbmd0aDtrPmo7aisrKWRlbGV0ZSB0aGlzLl9tb2RlbC5kYXRhW2dbal1dO3JldHVybi0xIT09YS5pbkFycmF5KHRoaXMuX2RhdGEuY29yZS5mb2N1c2VkLGcpJiYodGhpcy5fZGF0YS5jb3JlLmZvY3VzZWQ9bnVsbCxtPXRoaXMuZWxlbWVudFswXS5zY3JvbGxUb3Asbj10aGlzLmVsZW1lbnRbMF0uc2Nyb2xsTGVmdCxlLmlkPT09YS5qc3RyZWUucm9vdD90aGlzLl9tb2RlbC5kYXRhW2EuanN0cmVlLnJvb3RdLmNoaWxkcmVuWzBdJiZ0aGlzLmdldF9ub2RlKHRoaXMuX21vZGVsLmRhdGFbYS5qc3RyZWUucm9vdF0uY2hpbGRyZW5bMF0sITApLmNoaWxkcmVuKFwiLmpzdHJlZS1hbmNob3JcIikuZm9jdXMoKTp0aGlzLmdldF9ub2RlKGUsITApLmNoaWxkcmVuKFwiLmpzdHJlZS1hbmNob3JcIikuZm9jdXMoKSx0aGlzLmVsZW1lbnRbMF0uc2Nyb2xsVG9wPW0sdGhpcy5lbGVtZW50WzBdLnNjcm9sbExlZnQ9biksdGhpcy5yZWRyYXdfbm9kZShlLCEwKSwhMH0sY2hlY2s6ZnVuY3Rpb24oYixjLGQsZSxmKXtjPWMmJmMuaWQ/Yzp0aGlzLmdldF9ub2RlKGMpLGQ9ZCYmZC5pZD9kOnRoaXMuZ2V0X25vZGUoZCk7dmFyIGc9Yi5tYXRjaCgvXm1vdmVfbm9kZXxjb3B5X25vZGV8Y3JlYXRlX25vZGUkL2kpP2Q6YyxoPXRoaXMuc2V0dGluZ3MuY29yZS5jaGVja19jYWxsYmFjaztyZXR1cm5cIm1vdmVfbm9kZVwiIT09Ynx8ZiYmZi5pc19tdWx0aXx8Yy5pZCE9PWQuaWQmJihcIm1vdmVfbm9kZVwiIT09Ynx8YS5pbkFycmF5KGMuaWQsZC5jaGlsZHJlbikhPT1lKSYmLTE9PT1hLmluQXJyYXkoZC5pZCxjLmNoaWxkcmVuX2QpPyhnJiZnLmRhdGEmJihnPWcuZGF0YSksZyYmZy5mdW5jdGlvbnMmJihnLmZ1bmN0aW9uc1tiXT09PSExfHxnLmZ1bmN0aW9uc1tiXT09PSEwKT8oZy5mdW5jdGlvbnNbYl09PT0hMSYmKHRoaXMuX2RhdGEuY29yZS5sYXN0X2Vycm9yPXtlcnJvcjpcImNoZWNrXCIscGx1Z2luOlwiY29yZVwiLGlkOlwiY29yZV8wMlwiLHJlYXNvbjpcIk5vZGUgZGF0YSBwcmV2ZW50cyBmdW5jdGlvbjogXCIrYixkYXRhOkpTT04uc3RyaW5naWZ5KHtjaGs6Yixwb3M6ZSxvYmo6YyYmYy5pZD9jLmlkOiExLHBhcjpkJiZkLmlkP2QuaWQ6ITF9KX0pLGcuZnVuY3Rpb25zW2JdKTpoPT09ITF8fGEuaXNGdW5jdGlvbihoKSYmaC5jYWxsKHRoaXMsYixjLGQsZSxmKT09PSExfHxoJiZoW2JdPT09ITE/KHRoaXMuX2RhdGEuY29yZS5sYXN0X2Vycm9yPXtlcnJvcjpcImNoZWNrXCIscGx1Z2luOlwiY29yZVwiLGlkOlwiY29yZV8wM1wiLHJlYXNvbjpcIlVzZXIgY29uZmlnIGZvciBjb3JlLmNoZWNrX2NhbGxiYWNrIHByZXZlbnRzIGZ1bmN0aW9uOiBcIitiLGRhdGE6SlNPTi5zdHJpbmdpZnkoe2NoazpiLHBvczplLG9iajpjJiZjLmlkP2MuaWQ6ITEscGFyOmQmJmQuaWQ/ZC5pZDohMX0pfSwhMSk6ITApOih0aGlzLl9kYXRhLmNvcmUubGFzdF9lcnJvcj17ZXJyb3I6XCJjaGVja1wiLHBsdWdpbjpcImNvcmVcIixpZDpcImNvcmVfMDFcIixyZWFzb246XCJNb3ZpbmcgcGFyZW50IGluc2lkZSBjaGlsZFwiLGRhdGE6SlNPTi5zdHJpbmdpZnkoe2NoazpiLHBvczplLG9iajpjJiZjLmlkP2MuaWQ6ITEscGFyOmQmJmQuaWQ/ZC5pZDohMX0pfSwhMSl9LGxhc3RfZXJyb3I6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fZGF0YS5jb3JlLmxhc3RfZXJyb3J9LG1vdmVfbm9kZTpmdW5jdGlvbihjLGQsZSxmLGcsaCxpKXt2YXIgaixrLGwsbSxuLG8scCxxLHIscyx0LHUsdix3O2lmKGQ9dGhpcy5nZXRfbm9kZShkKSxlPWU9PT1iPzA6ZSwhZClyZXR1cm4hMTtpZighZS50b1N0cmluZygpLm1hdGNoKC9eKGJlZm9yZXxhZnRlcikkLykmJiFnJiYhdGhpcy5pc19sb2FkZWQoZCkpcmV0dXJuIHRoaXMubG9hZF9ub2RlKGQsZnVuY3Rpb24oKXt0aGlzLm1vdmVfbm9kZShjLGQsZSxmLCEwLCExLGkpfSk7aWYoYS5pc0FycmF5KGMpKXtpZigxIT09Yy5sZW5ndGgpe2ZvcihqPTAsaz1jLmxlbmd0aDtrPmo7aisrKShyPXRoaXMubW92ZV9ub2RlKGNbal0sZCxlLGYsZywhMSxpKSkmJihkPXIsZT1cImFmdGVyXCIpO3JldHVybiB0aGlzLnJlZHJhdygpLCEwfWM9Y1swXX1pZihjPWMmJmMuaWQ/Yzp0aGlzLmdldF9ub2RlKGMpLCFjfHxjLmlkPT09YS5qc3RyZWUucm9vdClyZXR1cm4hMTtpZihsPShjLnBhcmVudHx8YS5qc3RyZWUucm9vdCkudG9TdHJpbmcoKSxuPWUudG9TdHJpbmcoKS5tYXRjaCgvXihiZWZvcmV8YWZ0ZXIpJC8pJiZkLmlkIT09YS5qc3RyZWUucm9vdD90aGlzLmdldF9ub2RlKGQucGFyZW50KTpkLG89aT9pOnRoaXMuX21vZGVsLmRhdGFbYy5pZF0/dGhpczphLmpzdHJlZS5yZWZlcmVuY2UoYy5pZCkscD0hb3x8IW8uX2lkfHx0aGlzLl9pZCE9PW8uX2lkLG09byYmby5faWQmJmwmJm8uX21vZGVsLmRhdGFbbF0mJm8uX21vZGVsLmRhdGFbbF0uY2hpbGRyZW4/YS5pbkFycmF5KGMuaWQsby5fbW9kZWwuZGF0YVtsXS5jaGlsZHJlbik6LTEsbyYmby5faWQmJihjPW8uX21vZGVsLmRhdGFbYy5pZF0pLHApcmV0dXJuKHI9dGhpcy5jb3B5X25vZGUoYyxkLGUsZixnLCExLGkpKT8obyYmby5kZWxldGVfbm9kZShjKSxyKTohMTtzd2l0Y2goZC5pZD09PWEuanN0cmVlLnJvb3QmJihcImJlZm9yZVwiPT09ZSYmKGU9XCJmaXJzdFwiKSxcImFmdGVyXCI9PT1lJiYoZT1cImxhc3RcIikpLGUpe2Nhc2VcImJlZm9yZVwiOmU9YS5pbkFycmF5KGQuaWQsbi5jaGlsZHJlbik7YnJlYWs7Y2FzZVwiYWZ0ZXJcIjplPWEuaW5BcnJheShkLmlkLG4uY2hpbGRyZW4pKzE7YnJlYWs7Y2FzZVwiaW5zaWRlXCI6Y2FzZVwiZmlyc3RcIjplPTA7YnJlYWs7Y2FzZVwibGFzdFwiOmU9bi5jaGlsZHJlbi5sZW5ndGg7YnJlYWs7ZGVmYXVsdDplfHwoZT0wKX1pZihlPm4uY2hpbGRyZW4ubGVuZ3RoJiYoZT1uLmNoaWxkcmVuLmxlbmd0aCksIXRoaXMuY2hlY2soXCJtb3ZlX25vZGVcIixjLG4sZSx7Y29yZTohMCxvcmlnaW46aSxpc19tdWx0aTpvJiZvLl9pZCYmby5faWQhPT10aGlzLl9pZCxpc19mb3JlaWduOiFvfHwhby5faWR9KSlyZXR1cm4gdGhpcy5zZXR0aW5ncy5jb3JlLmVycm9yLmNhbGwodGhpcyx0aGlzLl9kYXRhLmNvcmUubGFzdF9lcnJvciksITE7aWYoYy5wYXJlbnQ9PT1uLmlkKXtmb3IocT1uLmNoaWxkcmVuLmNvbmNhdCgpLHI9YS5pbkFycmF5KGMuaWQscSksLTEhPT1yJiYocT1hLnZha2F0YS5hcnJheV9yZW1vdmUocSxyKSxlPnImJmUtLSkscj1bXSxzPTAsdD1xLmxlbmd0aDt0PnM7cysrKXJbcz49ZT9zKzE6c109cVtzXTtyW2VdPWMuaWQsbi5jaGlsZHJlbj1yLHRoaXMuX25vZGVfY2hhbmdlZChuLmlkKSx0aGlzLnJlZHJhdyhuLmlkPT09YS5qc3RyZWUucm9vdCl9ZWxzZXtmb3Iocj1jLmNoaWxkcmVuX2QuY29uY2F0KCksci5wdXNoKGMuaWQpLHM9MCx0PWMucGFyZW50cy5sZW5ndGg7dD5zO3MrKyl7Zm9yKHE9W10sdz1vLl9tb2RlbC5kYXRhW2MucGFyZW50c1tzXV0uY2hpbGRyZW5fZCx1PTAsdj13Lmxlbmd0aDt2PnU7dSsrKS0xPT09YS5pbkFycmF5KHdbdV0scikmJnEucHVzaCh3W3VdKTtvLl9tb2RlbC5kYXRhW2MucGFyZW50c1tzXV0uY2hpbGRyZW5fZD1xfWZvcihvLl9tb2RlbC5kYXRhW2xdLmNoaWxkcmVuPWEudmFrYXRhLmFycmF5X3JlbW92ZV9pdGVtKG8uX21vZGVsLmRhdGFbbF0uY2hpbGRyZW4sYy5pZCkscz0wLHQ9bi5wYXJlbnRzLmxlbmd0aDt0PnM7cysrKXRoaXMuX21vZGVsLmRhdGFbbi5wYXJlbnRzW3NdXS5jaGlsZHJlbl9kPXRoaXMuX21vZGVsLmRhdGFbbi5wYXJlbnRzW3NdXS5jaGlsZHJlbl9kLmNvbmNhdChyKTtmb3IocT1bXSxzPTAsdD1uLmNoaWxkcmVuLmxlbmd0aDt0PnM7cysrKXFbcz49ZT9zKzE6c109bi5jaGlsZHJlbltzXTtmb3IocVtlXT1jLmlkLG4uY2hpbGRyZW49cSxuLmNoaWxkcmVuX2QucHVzaChjLmlkKSxuLmNoaWxkcmVuX2Q9bi5jaGlsZHJlbl9kLmNvbmNhdChjLmNoaWxkcmVuX2QpLGMucGFyZW50PW4uaWQscj1uLnBhcmVudHMuY29uY2F0KCksci51bnNoaWZ0KG4uaWQpLHc9Yy5wYXJlbnRzLmxlbmd0aCxjLnBhcmVudHM9cixyPXIuY29uY2F0KCkscz0wLHQ9Yy5jaGlsZHJlbl9kLmxlbmd0aDt0PnM7cysrKXRoaXMuX21vZGVsLmRhdGFbYy5jaGlsZHJlbl9kW3NdXS5wYXJlbnRzPXRoaXMuX21vZGVsLmRhdGFbYy5jaGlsZHJlbl9kW3NdXS5wYXJlbnRzLnNsaWNlKDAsLTEqdyksQXJyYXkucHJvdG90eXBlLnB1c2guYXBwbHkodGhpcy5fbW9kZWwuZGF0YVtjLmNoaWxkcmVuX2Rbc11dLnBhcmVudHMscik7bCE9PWEuanN0cmVlLnJvb3QmJm4uaWQhPT1hLmpzdHJlZS5yb290fHwodGhpcy5fbW9kZWwuZm9yY2VfZnVsbF9yZWRyYXc9ITApLHRoaXMuX21vZGVsLmZvcmNlX2Z1bGxfcmVkcmF3fHwodGhpcy5fbm9kZV9jaGFuZ2VkKGwpLHRoaXMuX25vZGVfY2hhbmdlZChuLmlkKSksaHx8dGhpcy5yZWRyYXcoKX1yZXR1cm4gZiYmZi5jYWxsKHRoaXMsYyxuLGUpLHRoaXMudHJpZ2dlcihcIm1vdmVfbm9kZVwiLHtub2RlOmMscGFyZW50Om4uaWQscG9zaXRpb246ZSxvbGRfcGFyZW50Omwsb2xkX3Bvc2l0aW9uOm0saXNfbXVsdGk6byYmby5faWQmJm8uX2lkIT09dGhpcy5faWQsaXNfZm9yZWlnbjohb3x8IW8uX2lkLG9sZF9pbnN0YW5jZTpvLG5ld19pbnN0YW5jZTp0aGlzfSksYy5pZH0sY29weV9ub2RlOmZ1bmN0aW9uKGMsZCxlLGYsZyxoLGkpe3ZhciBqLGssbCxtLG4sbyxwLHEscixzLHQ7aWYoZD10aGlzLmdldF9ub2RlKGQpLGU9ZT09PWI/MDplLCFkKXJldHVybiExO2lmKCFlLnRvU3RyaW5nKCkubWF0Y2goL14oYmVmb3JlfGFmdGVyKSQvKSYmIWcmJiF0aGlzLmlzX2xvYWRlZChkKSlyZXR1cm4gdGhpcy5sb2FkX25vZGUoZCxmdW5jdGlvbigpe3RoaXMuY29weV9ub2RlKGMsZCxlLGYsITAsITEsaSl9KTtpZihhLmlzQXJyYXkoYykpe2lmKDEhPT1jLmxlbmd0aCl7Zm9yKGo9MCxrPWMubGVuZ3RoO2s+ajtqKyspKG09dGhpcy5jb3B5X25vZGUoY1tqXSxkLGUsZixnLCEwLGkpKSYmKGQ9bSxlPVwiYWZ0ZXJcIik7cmV0dXJuIHRoaXMucmVkcmF3KCksITB9Yz1jWzBdfWlmKGM9YyYmYy5pZD9jOnRoaXMuZ2V0X25vZGUoYyksIWN8fGMuaWQ9PT1hLmpzdHJlZS5yb290KXJldHVybiExO3N3aXRjaChxPShjLnBhcmVudHx8YS5qc3RyZWUucm9vdCkudG9TdHJpbmcoKSxyPWUudG9TdHJpbmcoKS5tYXRjaCgvXihiZWZvcmV8YWZ0ZXIpJC8pJiZkLmlkIT09YS5qc3RyZWUucm9vdD90aGlzLmdldF9ub2RlKGQucGFyZW50KTpkLHM9aT9pOnRoaXMuX21vZGVsLmRhdGFbYy5pZF0/dGhpczphLmpzdHJlZS5yZWZlcmVuY2UoYy5pZCksdD0hc3x8IXMuX2lkfHx0aGlzLl9pZCE9PXMuX2lkLHMmJnMuX2lkJiYoYz1zLl9tb2RlbC5kYXRhW2MuaWRdKSxkLmlkPT09YS5qc3RyZWUucm9vdCYmKFwiYmVmb3JlXCI9PT1lJiYoZT1cImZpcnN0XCIpLFwiYWZ0ZXJcIj09PWUmJihlPVwibGFzdFwiKSksZSl7Y2FzZVwiYmVmb3JlXCI6ZT1hLmluQXJyYXkoZC5pZCxyLmNoaWxkcmVuKTticmVhaztjYXNlXCJhZnRlclwiOmU9YS5pbkFycmF5KGQuaWQsci5jaGlsZHJlbikrMTticmVhaztjYXNlXCJpbnNpZGVcIjpjYXNlXCJmaXJzdFwiOmU9MDticmVhaztjYXNlXCJsYXN0XCI6ZT1yLmNoaWxkcmVuLmxlbmd0aDticmVhaztkZWZhdWx0OmV8fChlPTApfWlmKGU+ci5jaGlsZHJlbi5sZW5ndGgmJihlPXIuY2hpbGRyZW4ubGVuZ3RoKSwhdGhpcy5jaGVjayhcImNvcHlfbm9kZVwiLGMscixlLHtjb3JlOiEwLG9yaWdpbjppLGlzX211bHRpOnMmJnMuX2lkJiZzLl9pZCE9PXRoaXMuX2lkLGlzX2ZvcmVpZ246IXN8fCFzLl9pZH0pKXJldHVybiB0aGlzLnNldHRpbmdzLmNvcmUuZXJyb3IuY2FsbCh0aGlzLHRoaXMuX2RhdGEuY29yZS5sYXN0X2Vycm9yKSwhMTtpZihwPXM/cy5nZXRfanNvbihjLHtub19pZDohMCxub19kYXRhOiEwLG5vX3N0YXRlOiEwfSk6YywhcClyZXR1cm4hMTtpZihwLmlkPT09ITAmJmRlbGV0ZSBwLmlkLHA9dGhpcy5fcGFyc2VfbW9kZWxfZnJvbV9qc29uKHAsci5pZCxyLnBhcmVudHMuY29uY2F0KCkpLCFwKXJldHVybiExO2ZvcihtPXRoaXMuZ2V0X25vZGUocCksYyYmYy5zdGF0ZSYmYy5zdGF0ZS5sb2FkZWQ9PT0hMSYmKG0uc3RhdGUubG9hZGVkPSExKSxsPVtdLGwucHVzaChwKSxsPWwuY29uY2F0KG0uY2hpbGRyZW5fZCksdGhpcy50cmlnZ2VyKFwibW9kZWxcIix7bm9kZXM6bCxwYXJlbnQ6ci5pZH0pLG49MCxvPXIucGFyZW50cy5sZW5ndGg7bz5uO24rKyl0aGlzLl9tb2RlbC5kYXRhW3IucGFyZW50c1tuXV0uY2hpbGRyZW5fZD10aGlzLl9tb2RlbC5kYXRhW3IucGFyZW50c1tuXV0uY2hpbGRyZW5fZC5jb25jYXQobCk7Zm9yKGw9W10sbj0wLG89ci5jaGlsZHJlbi5sZW5ndGg7bz5uO24rKylsW24+PWU/bisxOm5dPXIuY2hpbGRyZW5bbl07cmV0dXJuIGxbZV09bS5pZCxyLmNoaWxkcmVuPWwsci5jaGlsZHJlbl9kLnB1c2gobS5pZCksci5jaGlsZHJlbl9kPXIuY2hpbGRyZW5fZC5jb25jYXQobS5jaGlsZHJlbl9kKSxyLmlkPT09YS5qc3RyZWUucm9vdCYmKHRoaXMuX21vZGVsLmZvcmNlX2Z1bGxfcmVkcmF3PSEwKSx0aGlzLl9tb2RlbC5mb3JjZV9mdWxsX3JlZHJhd3x8dGhpcy5fbm9kZV9jaGFuZ2VkKHIuaWQpLGh8fHRoaXMucmVkcmF3KHIuaWQ9PT1hLmpzdHJlZS5yb290KSxmJiZmLmNhbGwodGhpcyxtLHIsZSksdGhpcy50cmlnZ2VyKFwiY29weV9ub2RlXCIse25vZGU6bSxvcmlnaW5hbDpjLHBhcmVudDpyLmlkLHBvc2l0aW9uOmUsb2xkX3BhcmVudDpxLG9sZF9wb3NpdGlvbjpzJiZzLl9pZCYmcSYmcy5fbW9kZWwuZGF0YVtxXSYmcy5fbW9kZWwuZGF0YVtxXS5jaGlsZHJlbj9hLmluQXJyYXkoYy5pZCxzLl9tb2RlbC5kYXRhW3FdLmNoaWxkcmVuKTotMSxpc19tdWx0aTpzJiZzLl9pZCYmcy5faWQhPT10aGlzLl9pZCxpc19mb3JlaWduOiFzfHwhcy5faWQsb2xkX2luc3RhbmNlOnMsbmV3X2luc3RhbmNlOnRoaXN9KSxtLmlkfSxjdXQ6ZnVuY3Rpb24oYil7aWYoYnx8KGI9dGhpcy5fZGF0YS5jb3JlLnNlbGVjdGVkLmNvbmNhdCgpKSxhLmlzQXJyYXkoYil8fChiPVtiXSksIWIubGVuZ3RoKXJldHVybiExO3ZhciBjPVtdLGcsaCxpO2ZvcihoPTAsaT1iLmxlbmd0aDtpPmg7aCsrKWc9dGhpcy5nZXRfbm9kZShiW2hdKSxnJiZnLmlkJiZnLmlkIT09YS5qc3RyZWUucm9vdCYmYy5wdXNoKGcpO3JldHVybiBjLmxlbmd0aD8oZD1jLGY9dGhpcyxlPVwibW92ZV9ub2RlXCIsdm9pZCB0aGlzLnRyaWdnZXIoXCJjdXRcIix7bm9kZTpifSkpOiExfSxjb3B5OmZ1bmN0aW9uKGIpe2lmKGJ8fChiPXRoaXMuX2RhdGEuY29yZS5zZWxlY3RlZC5jb25jYXQoKSksYS5pc0FycmF5KGIpfHwoYj1bYl0pLCFiLmxlbmd0aClyZXR1cm4hMTt2YXIgYz1bXSxnLGgsaTtmb3IoaD0wLGk9Yi5sZW5ndGg7aT5oO2grKylnPXRoaXMuZ2V0X25vZGUoYltoXSksZyYmZy5pZCYmZy5pZCE9PWEuanN0cmVlLnJvb3QmJmMucHVzaChnKTtyZXR1cm4gYy5sZW5ndGg/KGQ9YyxmPXRoaXMsZT1cImNvcHlfbm9kZVwiLHZvaWQgdGhpcy50cmlnZ2VyKFwiY29weVwiLHtub2RlOmJ9KSk6ITF9LGdldF9idWZmZXI6ZnVuY3Rpb24oKXtyZXR1cm57bW9kZTplLG5vZGU6ZCxpbnN0OmZ9fSxjYW5fcGFzdGU6ZnVuY3Rpb24oKXtyZXR1cm4gZSE9PSExJiZkIT09ITF9LHBhc3RlOmZ1bmN0aW9uKGEsYil7cmV0dXJuIGE9dGhpcy5nZXRfbm9kZShhKSxhJiZlJiZlLm1hdGNoKC9eKGNvcHlfbm9kZXxtb3ZlX25vZGUpJC8pJiZkPyh0aGlzW2VdKGQsYSxiLCExLCExLCExLGYpJiZ0aGlzLnRyaWdnZXIoXCJwYXN0ZVwiLHtwYXJlbnQ6YS5pZCxub2RlOmQsbW9kZTplfSksZD0hMSxlPSExLHZvaWQoZj0hMSkpOiExfSxjbGVhcl9idWZmZXI6ZnVuY3Rpb24oKXtkPSExLGU9ITEsZj0hMSx0aGlzLnRyaWdnZXIoXCJjbGVhcl9idWZmZXJcIil9LGVkaXQ6ZnVuY3Rpb24oYixjLGQpe3ZhciBlLGYsZyxoLGosayxsLG0sbixvPSExO3JldHVybihiPXRoaXMuZ2V0X25vZGUoYikpP3RoaXMuc2V0dGluZ3MuY29yZS5jaGVja19jYWxsYmFjaz09PSExPyh0aGlzLl9kYXRhLmNvcmUubGFzdF9lcnJvcj17ZXJyb3I6XCJjaGVja1wiLHBsdWdpbjpcImNvcmVcIixpZDpcImNvcmVfMDdcIixyZWFzb246XCJDb3VsZCBub3QgZWRpdCBub2RlIGJlY2F1c2Ugb2YgY2hlY2tfY2FsbGJhY2tcIn0sdGhpcy5zZXR0aW5ncy5jb3JlLmVycm9yLmNhbGwodGhpcyx0aGlzLl9kYXRhLmNvcmUubGFzdF9lcnJvciksITEpOihuPWIsYz1cInN0cmluZ1wiPT10eXBlb2YgYz9jOmIudGV4dCx0aGlzLnNldF90ZXh0KGIsXCJcIiksYj10aGlzLl9vcGVuX3RvKGIpLG4udGV4dD1jLGU9dGhpcy5fZGF0YS5jb3JlLnJ0bCxmPXRoaXMuZWxlbWVudC53aWR0aCgpLHRoaXMuX2RhdGEuY29yZS5mb2N1c2VkPW4uaWQsZz1iLmNoaWxkcmVuKFwiLmpzdHJlZS1hbmNob3JcIikuZm9jdXMoKSxoPWEoXCI8c3Bhbj5cIiksaj1jLGs9YShcIjxkaXYgLz5cIix7Y3NzOntwb3NpdGlvbjpcImFic29sdXRlXCIsdG9wOlwiLTIwMHB4XCIsbGVmdDplP1wiMHB4XCI6XCItMTAwMHB4XCIsdmlzaWJpbGl0eTpcImhpZGRlblwifX0pLmFwcGVuZFRvKFwiYm9keVwiKSxsPWEoXCI8aW5wdXQgLz5cIix7dmFsdWU6aixcImNsYXNzXCI6XCJqc3RyZWUtcmVuYW1lLWlucHV0XCIsY3NzOntwYWRkaW5nOlwiMFwiLGJvcmRlcjpcIjFweCBzb2xpZCBzaWx2ZXJcIixcImJveC1zaXppbmdcIjpcImJvcmRlci1ib3hcIixkaXNwbGF5OlwiaW5saW5lLWJsb2NrXCIsaGVpZ2h0OnRoaXMuX2RhdGEuY29yZS5saV9oZWlnaHQrXCJweFwiLGxpbmVIZWlnaHQ6dGhpcy5fZGF0YS5jb3JlLmxpX2hlaWdodCtcInB4XCIsd2lkdGg6XCIxNTBweFwifSxibHVyOmEucHJveHkoZnVuY3Rpb24oYyl7Yy5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24oKSxjLnByZXZlbnREZWZhdWx0KCk7dmFyIGU9aC5jaGlsZHJlbihcIi5qc3RyZWUtcmVuYW1lLWlucHV0XCIpLGY9ZS52YWwoKSxpPXRoaXMuc2V0dGluZ3MuY29yZS5mb3JjZV90ZXh0LG07XCJcIj09PWYmJihmPWopLGsucmVtb3ZlKCksaC5yZXBsYWNlV2l0aChnKSxoLnJlbW92ZSgpLGo9aT9qOmEoXCI8ZGl2PjwvZGl2PlwiKS5hcHBlbmQoYS5wYXJzZUhUTUwoaikpLmh0bWwoKSx0aGlzLnNldF90ZXh0KGIsaiksbT0hIXRoaXMucmVuYW1lX25vZGUoYixpP2EoXCI8ZGl2PjwvZGl2PlwiKS50ZXh0KGYpLnRleHQoKTphKFwiPGRpdj48L2Rpdj5cIikuYXBwZW5kKGEucGFyc2VIVE1MKGYpKS5odG1sKCkpLG18fHRoaXMuc2V0X3RleHQoYixqKSx0aGlzLl9kYXRhLmNvcmUuZm9jdXNlZD1uLmlkLHNldFRpbWVvdXQoYS5wcm94eShmdW5jdGlvbigpe3ZhciBhPXRoaXMuZ2V0X25vZGUobi5pZCwhMCk7YS5sZW5ndGgmJih0aGlzLl9kYXRhLmNvcmUuZm9jdXNlZD1uLmlkLGEuY2hpbGRyZW4oXCIuanN0cmVlLWFuY2hvclwiKS5mb2N1cygpKX0sdGhpcyksMCksZCYmZC5jYWxsKHRoaXMsbixtLG8pLGw9bnVsbH0sdGhpcyksa2V5ZG93bjpmdW5jdGlvbihhKXt2YXIgYj1hLndoaWNoOzI3PT09YiYmKG89ITAsdGhpcy52YWx1ZT1qKSwyNyE9PWImJjEzIT09YiYmMzchPT1iJiYzOCE9PWImJjM5IT09YiYmNDAhPT1iJiYzMiE9PWJ8fGEuc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKCksMjchPT1iJiYxMyE9PWJ8fChhLnByZXZlbnREZWZhdWx0KCksdGhpcy5ibHVyKCkpfSxjbGljazpmdW5jdGlvbihhKXthLnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbigpfSxtb3VzZWRvd246ZnVuY3Rpb24oYSl7YS5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24oKX0sa2V5dXA6ZnVuY3Rpb24oYSl7bC53aWR0aChNYXRoLm1pbihrLnRleHQoXCJwV1wiK3RoaXMudmFsdWUpLndpZHRoKCksZikpfSxrZXlwcmVzczpmdW5jdGlvbihhKXtyZXR1cm4gMTM9PT1hLndoaWNoPyExOnZvaWQgMH19KSxtPXtmb250RmFtaWx5OmcuY3NzKFwiZm9udEZhbWlseVwiKXx8XCJcIixmb250U2l6ZTpnLmNzcyhcImZvbnRTaXplXCIpfHxcIlwiLGZvbnRXZWlnaHQ6Zy5jc3MoXCJmb250V2VpZ2h0XCIpfHxcIlwiLGZvbnRTdHlsZTpnLmNzcyhcImZvbnRTdHlsZVwiKXx8XCJcIixmb250U3RyZXRjaDpnLmNzcyhcImZvbnRTdHJldGNoXCIpfHxcIlwiLGZvbnRWYXJpYW50OmcuY3NzKFwiZm9udFZhcmlhbnRcIil8fFwiXCIsbGV0dGVyU3BhY2luZzpnLmNzcyhcImxldHRlclNwYWNpbmdcIil8fFwiXCIsd29yZFNwYWNpbmc6Zy5jc3MoXCJ3b3JkU3BhY2luZ1wiKXx8XCJcIn0saC5hdHRyKFwiY2xhc3NcIixnLmF0dHIoXCJjbGFzc1wiKSkuYXBwZW5kKGcuY29udGVudHMoKS5jbG9uZSgpKS5hcHBlbmQobCksZy5yZXBsYWNlV2l0aChoKSxrLmNzcyhtKSxsLmNzcyhtKS53aWR0aChNYXRoLm1pbihrLnRleHQoXCJwV1wiK2xbMF0udmFsdWUpLndpZHRoKCksZikpWzBdLnNlbGVjdCgpLHZvaWQgYShpKS5vbmUoXCJtb3VzZWRvd24uanN0cmVlIHRvdWNoc3RhcnQuanN0cmVlIGRuZF9zdGFydC52YWthdGFcIixmdW5jdGlvbihiKXtcbmwmJmIudGFyZ2V0IT09bCYmYShsKS5ibHVyKCl9KSk6ITF9LHNldF90aGVtZTpmdW5jdGlvbihiLGMpe2lmKCFiKXJldHVybiExO2lmKGM9PT0hMCl7dmFyIGQ9dGhpcy5zZXR0aW5ncy5jb3JlLnRoZW1lcy5kaXI7ZHx8KGQ9YS5qc3RyZWUucGF0aCtcIi90aGVtZXNcIiksYz1kK1wiL1wiK2IrXCIvc3R5bGUuY3NzXCJ9YyYmLTE9PT1hLmluQXJyYXkoYyxnKSYmKGEoXCJoZWFkXCIpLmFwcGVuZCgnPGxpbmsgcmVsPVwic3R5bGVzaGVldFwiIGhyZWY9XCInK2MrJ1wiIHR5cGU9XCJ0ZXh0L2Nzc1wiIC8+JyksZy5wdXNoKGMpKSx0aGlzLl9kYXRhLmNvcmUudGhlbWVzLm5hbWUmJnRoaXMuZWxlbWVudC5yZW1vdmVDbGFzcyhcImpzdHJlZS1cIit0aGlzLl9kYXRhLmNvcmUudGhlbWVzLm5hbWUpLHRoaXMuX2RhdGEuY29yZS50aGVtZXMubmFtZT1iLHRoaXMuZWxlbWVudC5hZGRDbGFzcyhcImpzdHJlZS1cIitiKSx0aGlzLmVsZW1lbnRbdGhpcy5zZXR0aW5ncy5jb3JlLnRoZW1lcy5yZXNwb25zaXZlP1wiYWRkQ2xhc3NcIjpcInJlbW92ZUNsYXNzXCJdKFwianN0cmVlLVwiK2IrXCItcmVzcG9uc2l2ZVwiKSx0aGlzLnRyaWdnZXIoXCJzZXRfdGhlbWVcIix7dGhlbWU6Yn0pfSxnZXRfdGhlbWU6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fZGF0YS5jb3JlLnRoZW1lcy5uYW1lfSxzZXRfdGhlbWVfdmFyaWFudDpmdW5jdGlvbihhKXt0aGlzLl9kYXRhLmNvcmUudGhlbWVzLnZhcmlhbnQmJnRoaXMuZWxlbWVudC5yZW1vdmVDbGFzcyhcImpzdHJlZS1cIit0aGlzLl9kYXRhLmNvcmUudGhlbWVzLm5hbWUrXCItXCIrdGhpcy5fZGF0YS5jb3JlLnRoZW1lcy52YXJpYW50KSx0aGlzLl9kYXRhLmNvcmUudGhlbWVzLnZhcmlhbnQ9YSxhJiZ0aGlzLmVsZW1lbnQuYWRkQ2xhc3MoXCJqc3RyZWUtXCIrdGhpcy5fZGF0YS5jb3JlLnRoZW1lcy5uYW1lK1wiLVwiK3RoaXMuX2RhdGEuY29yZS50aGVtZXMudmFyaWFudCl9LGdldF90aGVtZV92YXJpYW50OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX2RhdGEuY29yZS50aGVtZXMudmFyaWFudH0sc2hvd19zdHJpcGVzOmZ1bmN0aW9uKCl7dGhpcy5fZGF0YS5jb3JlLnRoZW1lcy5zdHJpcGVzPSEwLHRoaXMuZ2V0X2NvbnRhaW5lcl91bCgpLmFkZENsYXNzKFwianN0cmVlLXN0cmlwZWRcIil9LGhpZGVfc3RyaXBlczpmdW5jdGlvbigpe3RoaXMuX2RhdGEuY29yZS50aGVtZXMuc3RyaXBlcz0hMSx0aGlzLmdldF9jb250YWluZXJfdWwoKS5yZW1vdmVDbGFzcyhcImpzdHJlZS1zdHJpcGVkXCIpfSx0b2dnbGVfc3RyaXBlczpmdW5jdGlvbigpe3RoaXMuX2RhdGEuY29yZS50aGVtZXMuc3RyaXBlcz90aGlzLmhpZGVfc3RyaXBlcygpOnRoaXMuc2hvd19zdHJpcGVzKCl9LHNob3dfZG90czpmdW5jdGlvbigpe3RoaXMuX2RhdGEuY29yZS50aGVtZXMuZG90cz0hMCx0aGlzLmdldF9jb250YWluZXJfdWwoKS5yZW1vdmVDbGFzcyhcImpzdHJlZS1uby1kb3RzXCIpfSxoaWRlX2RvdHM6ZnVuY3Rpb24oKXt0aGlzLl9kYXRhLmNvcmUudGhlbWVzLmRvdHM9ITEsdGhpcy5nZXRfY29udGFpbmVyX3VsKCkuYWRkQ2xhc3MoXCJqc3RyZWUtbm8tZG90c1wiKX0sdG9nZ2xlX2RvdHM6ZnVuY3Rpb24oKXt0aGlzLl9kYXRhLmNvcmUudGhlbWVzLmRvdHM/dGhpcy5oaWRlX2RvdHMoKTp0aGlzLnNob3dfZG90cygpfSxzaG93X2ljb25zOmZ1bmN0aW9uKCl7dGhpcy5fZGF0YS5jb3JlLnRoZW1lcy5pY29ucz0hMCx0aGlzLmdldF9jb250YWluZXJfdWwoKS5yZW1vdmVDbGFzcyhcImpzdHJlZS1uby1pY29uc1wiKX0saGlkZV9pY29uczpmdW5jdGlvbigpe3RoaXMuX2RhdGEuY29yZS50aGVtZXMuaWNvbnM9ITEsdGhpcy5nZXRfY29udGFpbmVyX3VsKCkuYWRkQ2xhc3MoXCJqc3RyZWUtbm8taWNvbnNcIil9LHRvZ2dsZV9pY29uczpmdW5jdGlvbigpe3RoaXMuX2RhdGEuY29yZS50aGVtZXMuaWNvbnM/dGhpcy5oaWRlX2ljb25zKCk6dGhpcy5zaG93X2ljb25zKCl9LHNldF9pY29uOmZ1bmN0aW9uKGMsZCl7dmFyIGUsZixnLGg7aWYoYS5pc0FycmF5KGMpKXtmb3IoYz1jLnNsaWNlKCksZT0wLGY9Yy5sZW5ndGg7Zj5lO2UrKyl0aGlzLnNldF9pY29uKGNbZV0sZCk7cmV0dXJuITB9cmV0dXJuIGM9dGhpcy5nZXRfbm9kZShjKSxjJiZjLmlkIT09YS5qc3RyZWUucm9vdD8oaD1jLmljb24sYy5pY29uPWQ9PT0hMHx8bnVsbD09PWR8fGQ9PT1ifHxcIlwiPT09ZD8hMDpkLGc9dGhpcy5nZXRfbm9kZShjLCEwKS5jaGlsZHJlbihcIi5qc3RyZWUtYW5jaG9yXCIpLmNoaWxkcmVuKFwiLmpzdHJlZS10aGVtZWljb25cIiksZD09PSExP3RoaXMuaGlkZV9pY29uKGMpOmQ9PT0hMHx8bnVsbD09PWR8fGQ9PT1ifHxcIlwiPT09ZD8oZy5yZW1vdmVDbGFzcyhcImpzdHJlZS10aGVtZWljb24tY3VzdG9tIFwiK2gpLmNzcyhcImJhY2tncm91bmRcIixcIlwiKS5yZW1vdmVBdHRyKFwicmVsXCIpLGg9PT0hMSYmdGhpcy5zaG93X2ljb24oYykpOi0xPT09ZC5pbmRleE9mKFwiL1wiKSYmLTE9PT1kLmluZGV4T2YoXCIuXCIpPyhnLnJlbW92ZUNsYXNzKGgpLmNzcyhcImJhY2tncm91bmRcIixcIlwiKSxnLmFkZENsYXNzKGQrXCIganN0cmVlLXRoZW1laWNvbi1jdXN0b21cIikuYXR0cihcInJlbFwiLGQpLGg9PT0hMSYmdGhpcy5zaG93X2ljb24oYykpOihnLnJlbW92ZUNsYXNzKGgpLmNzcyhcImJhY2tncm91bmRcIixcIlwiKSxnLmFkZENsYXNzKFwianN0cmVlLXRoZW1laWNvbi1jdXN0b21cIikuY3NzKFwiYmFja2dyb3VuZFwiLFwidXJsKCdcIitkK1wiJykgY2VudGVyIGNlbnRlciBuby1yZXBlYXRcIikuYXR0cihcInJlbFwiLGQpLGg9PT0hMSYmdGhpcy5zaG93X2ljb24oYykpLCEwKTohMX0sZ2V0X2ljb246ZnVuY3Rpb24oYil7cmV0dXJuIGI9dGhpcy5nZXRfbm9kZShiKSxiJiZiLmlkIT09YS5qc3RyZWUucm9vdD9iLmljb246ITF9LGhpZGVfaWNvbjpmdW5jdGlvbihiKXt2YXIgYyxkO2lmKGEuaXNBcnJheShiKSl7Zm9yKGI9Yi5zbGljZSgpLGM9MCxkPWIubGVuZ3RoO2Q+YztjKyspdGhpcy5oaWRlX2ljb24oYltjXSk7cmV0dXJuITB9cmV0dXJuIGI9dGhpcy5nZXRfbm9kZShiKSxiJiZiIT09YS5qc3RyZWUucm9vdD8oYi5pY29uPSExLHRoaXMuZ2V0X25vZGUoYiwhMCkuY2hpbGRyZW4oXCIuanN0cmVlLWFuY2hvclwiKS5jaGlsZHJlbihcIi5qc3RyZWUtdGhlbWVpY29uXCIpLmFkZENsYXNzKFwianN0cmVlLXRoZW1laWNvbi1oaWRkZW5cIiksITApOiExfSxzaG93X2ljb246ZnVuY3Rpb24oYil7dmFyIGMsZCxlO2lmKGEuaXNBcnJheShiKSl7Zm9yKGI9Yi5zbGljZSgpLGM9MCxkPWIubGVuZ3RoO2Q+YztjKyspdGhpcy5zaG93X2ljb24oYltjXSk7cmV0dXJuITB9cmV0dXJuIGI9dGhpcy5nZXRfbm9kZShiKSxiJiZiIT09YS5qc3RyZWUucm9vdD8oZT10aGlzLmdldF9ub2RlKGIsITApLGIuaWNvbj1lLmxlbmd0aD9lLmNoaWxkcmVuKFwiLmpzdHJlZS1hbmNob3JcIikuY2hpbGRyZW4oXCIuanN0cmVlLXRoZW1laWNvblwiKS5hdHRyKFwicmVsXCIpOiEwLGIuaWNvbnx8KGIuaWNvbj0hMCksZS5jaGlsZHJlbihcIi5qc3RyZWUtYW5jaG9yXCIpLmNoaWxkcmVuKFwiLmpzdHJlZS10aGVtZWljb25cIikucmVtb3ZlQ2xhc3MoXCJqc3RyZWUtdGhlbWVpY29uLWhpZGRlblwiKSwhMCk6ITF9fSxhLnZha2F0YT17fSxhLnZha2F0YS5hdHRyaWJ1dGVzPWZ1bmN0aW9uKGIsYyl7Yj1hKGIpWzBdO3ZhciBkPWM/e306W107cmV0dXJuIGImJmIuYXR0cmlidXRlcyYmYS5lYWNoKGIuYXR0cmlidXRlcyxmdW5jdGlvbihiLGUpey0xPT09YS5pbkFycmF5KGUubmFtZS50b0xvd2VyQ2FzZSgpLFtcInN0eWxlXCIsXCJjb250ZW50ZWRpdGFibGVcIixcImhhc2ZvY3VzXCIsXCJ0YWJpbmRleFwiXSkmJm51bGwhPT1lLnZhbHVlJiZcIlwiIT09YS50cmltKGUudmFsdWUpJiYoYz9kW2UubmFtZV09ZS52YWx1ZTpkLnB1c2goZS5uYW1lKSl9KSxkfSxhLnZha2F0YS5hcnJheV91bmlxdWU9ZnVuY3Rpb24oYSl7dmFyIGM9W10sZCxlLGYsZz17fTtmb3IoZD0wLGY9YS5sZW5ndGg7Zj5kO2QrKylnW2FbZF1dPT09YiYmKGMucHVzaChhW2RdKSxnW2FbZF1dPSEwKTtyZXR1cm4gY30sYS52YWthdGEuYXJyYXlfcmVtb3ZlPWZ1bmN0aW9uKGEsYil7cmV0dXJuIGEuc3BsaWNlKGIsMSksYX0sYS52YWthdGEuYXJyYXlfcmVtb3ZlX2l0ZW09ZnVuY3Rpb24oYixjKXt2YXIgZD1hLmluQXJyYXkoYyxiKTtyZXR1cm4tMSE9PWQ/YS52YWthdGEuYXJyYXlfcmVtb3ZlKGIsZCk6Yn0sYS52YWthdGEuYXJyYXlfZmlsdGVyPWZ1bmN0aW9uKGEsYixjLGQsZSl7aWYoYS5maWx0ZXIpcmV0dXJuIGEuZmlsdGVyKGIsYyk7ZD1bXTtmb3IoZSBpbiBhKX5+ZStcIlwiPT1lK1wiXCImJmU+PTAmJmIuY2FsbChjLGFbZV0sK2UsYSkmJmQucHVzaChhW2VdKTtyZXR1cm4gZH0sYS5qc3RyZWUucGx1Z2lucy5jaGFuZ2VkPWZ1bmN0aW9uKGEsYil7dmFyIGM9W107dGhpcy50cmlnZ2VyPWZ1bmN0aW9uKGEsZCl7dmFyIGUsZjtpZihkfHwoZD17fSksXCJjaGFuZ2VkXCI9PT1hLnJlcGxhY2UoXCIuanN0cmVlXCIsXCJcIikpe2QuY2hhbmdlZD17c2VsZWN0ZWQ6W10sZGVzZWxlY3RlZDpbXX07dmFyIGc9e307Zm9yKGU9MCxmPWMubGVuZ3RoO2Y+ZTtlKyspZ1tjW2VdXT0xO2ZvcihlPTAsZj1kLnNlbGVjdGVkLmxlbmd0aDtmPmU7ZSsrKWdbZC5zZWxlY3RlZFtlXV0/Z1tkLnNlbGVjdGVkW2VdXT0yOmQuY2hhbmdlZC5zZWxlY3RlZC5wdXNoKGQuc2VsZWN0ZWRbZV0pO2ZvcihlPTAsZj1jLmxlbmd0aDtmPmU7ZSsrKTE9PT1nW2NbZV1dJiZkLmNoYW5nZWQuZGVzZWxlY3RlZC5wdXNoKGNbZV0pO2M9ZC5zZWxlY3RlZC5zbGljZSgpfWIudHJpZ2dlci5jYWxsKHRoaXMsYSxkKX0sdGhpcy5yZWZyZXNoPWZ1bmN0aW9uKGEsZCl7cmV0dXJuIGM9W10sYi5yZWZyZXNoLmFwcGx5KHRoaXMsYXJndW1lbnRzKX19O3ZhciBtPWkuY3JlYXRlRWxlbWVudChcIklcIik7bS5jbGFzc05hbWU9XCJqc3RyZWUtaWNvbiBqc3RyZWUtY2hlY2tib3hcIixtLnNldEF0dHJpYnV0ZShcInJvbGVcIixcInByZXNlbnRhdGlvblwiKSxhLmpzdHJlZS5kZWZhdWx0cy5jaGVja2JveD17dmlzaWJsZTohMCx0aHJlZV9zdGF0ZTohMCx3aG9sZV9ub2RlOiEwLGtlZXBfc2VsZWN0ZWRfc3R5bGU6ITAsY2FzY2FkZTpcIlwiLHRpZV9zZWxlY3Rpb246ITB9LGEuanN0cmVlLnBsdWdpbnMuY2hlY2tib3g9ZnVuY3Rpb24oYyxkKXt0aGlzLmJpbmQ9ZnVuY3Rpb24oKXtkLmJpbmQuY2FsbCh0aGlzKSx0aGlzLl9kYXRhLmNoZWNrYm94LnV0bz0hMSx0aGlzLl9kYXRhLmNoZWNrYm94LnNlbGVjdGVkPVtdLHRoaXMuc2V0dGluZ3MuY2hlY2tib3gudGhyZWVfc3RhdGUmJih0aGlzLnNldHRpbmdzLmNoZWNrYm94LmNhc2NhZGU9XCJ1cCtkb3duK3VuZGV0ZXJtaW5lZFwiKSx0aGlzLmVsZW1lbnQub24oXCJpbml0LmpzdHJlZVwiLGEucHJveHkoZnVuY3Rpb24oKXt0aGlzLl9kYXRhLmNoZWNrYm94LnZpc2libGU9dGhpcy5zZXR0aW5ncy5jaGVja2JveC52aXNpYmxlLHRoaXMuc2V0dGluZ3MuY2hlY2tib3gua2VlcF9zZWxlY3RlZF9zdHlsZXx8dGhpcy5lbGVtZW50LmFkZENsYXNzKFwianN0cmVlLWNoZWNrYm94LW5vLWNsaWNrZWRcIiksdGhpcy5zZXR0aW5ncy5jaGVja2JveC50aWVfc2VsZWN0aW9uJiZ0aGlzLmVsZW1lbnQuYWRkQ2xhc3MoXCJqc3RyZWUtY2hlY2tib3gtc2VsZWN0aW9uXCIpfSx0aGlzKSkub24oXCJsb2FkaW5nLmpzdHJlZVwiLGEucHJveHkoZnVuY3Rpb24oKXt0aGlzW3RoaXMuX2RhdGEuY2hlY2tib3gudmlzaWJsZT9cInNob3dfY2hlY2tib3hlc1wiOlwiaGlkZV9jaGVja2JveGVzXCJdKCl9LHRoaXMpKSwtMSE9PXRoaXMuc2V0dGluZ3MuY2hlY2tib3guY2FzY2FkZS5pbmRleE9mKFwidW5kZXRlcm1pbmVkXCIpJiZ0aGlzLmVsZW1lbnQub24oXCJjaGFuZ2VkLmpzdHJlZSB1bmNoZWNrX25vZGUuanN0cmVlIGNoZWNrX25vZGUuanN0cmVlIHVuY2hlY2tfYWxsLmpzdHJlZSBjaGVja19hbGwuanN0cmVlIG1vdmVfbm9kZS5qc3RyZWUgY29weV9ub2RlLmpzdHJlZSByZWRyYXcuanN0cmVlIG9wZW5fbm9kZS5qc3RyZWVcIixhLnByb3h5KGZ1bmN0aW9uKCl7dGhpcy5fZGF0YS5jaGVja2JveC51dG8mJmNsZWFyVGltZW91dCh0aGlzLl9kYXRhLmNoZWNrYm94LnV0byksdGhpcy5fZGF0YS5jaGVja2JveC51dG89c2V0VGltZW91dChhLnByb3h5KHRoaXMuX3VuZGV0ZXJtaW5lZCx0aGlzKSw1MCl9LHRoaXMpKSx0aGlzLnNldHRpbmdzLmNoZWNrYm94LnRpZV9zZWxlY3Rpb258fHRoaXMuZWxlbWVudC5vbihcIm1vZGVsLmpzdHJlZVwiLGEucHJveHkoZnVuY3Rpb24oYSxiKXt2YXIgYz10aGlzLl9tb2RlbC5kYXRhLGQ9Y1tiLnBhcmVudF0sZT1iLm5vZGVzLGYsZztmb3IoZj0wLGc9ZS5sZW5ndGg7Zz5mO2YrKyljW2VbZl1dLnN0YXRlLmNoZWNrZWQ9Y1tlW2ZdXS5zdGF0ZS5jaGVja2VkfHxjW2VbZl1dLm9yaWdpbmFsJiZjW2VbZl1dLm9yaWdpbmFsLnN0YXRlJiZjW2VbZl1dLm9yaWdpbmFsLnN0YXRlLmNoZWNrZWQsY1tlW2ZdXS5zdGF0ZS5jaGVja2VkJiZ0aGlzLl9kYXRhLmNoZWNrYm94LnNlbGVjdGVkLnB1c2goZVtmXSl9LHRoaXMpKSwtMT09PXRoaXMuc2V0dGluZ3MuY2hlY2tib3guY2FzY2FkZS5pbmRleE9mKFwidXBcIikmJi0xPT09dGhpcy5zZXR0aW5ncy5jaGVja2JveC5jYXNjYWRlLmluZGV4T2YoXCJkb3duXCIpfHx0aGlzLmVsZW1lbnQub24oXCJtb2RlbC5qc3RyZWVcIixhLnByb3h5KGZ1bmN0aW9uKGIsYyl7dmFyIGQ9dGhpcy5fbW9kZWwuZGF0YSxlPWRbYy5wYXJlbnRdLGY9Yy5ub2RlcyxnPVtdLGgsaSxqLGssbCxtLG49dGhpcy5zZXR0aW5ncy5jaGVja2JveC5jYXNjYWRlLG89dGhpcy5zZXR0aW5ncy5jaGVja2JveC50aWVfc2VsZWN0aW9uO2lmKC0xIT09bi5pbmRleE9mKFwiZG93blwiKSlpZihlLnN0YXRlW28/XCJzZWxlY3RlZFwiOlwiY2hlY2tlZFwiXSl7Zm9yKGk9MCxqPWYubGVuZ3RoO2o+aTtpKyspZFtmW2ldXS5zdGF0ZVtvP1wic2VsZWN0ZWRcIjpcImNoZWNrZWRcIl09ITA7dGhpcy5fZGF0YVtvP1wiY29yZVwiOlwiY2hlY2tib3hcIl0uc2VsZWN0ZWQ9dGhpcy5fZGF0YVtvP1wiY29yZVwiOlwiY2hlY2tib3hcIl0uc2VsZWN0ZWQuY29uY2F0KGYpfWVsc2UgZm9yKGk9MCxqPWYubGVuZ3RoO2o+aTtpKyspaWYoZFtmW2ldXS5zdGF0ZVtvP1wic2VsZWN0ZWRcIjpcImNoZWNrZWRcIl0pe2ZvcihrPTAsbD1kW2ZbaV1dLmNoaWxkcmVuX2QubGVuZ3RoO2w+aztrKyspZFtkW2ZbaV1dLmNoaWxkcmVuX2Rba11dLnN0YXRlW28/XCJzZWxlY3RlZFwiOlwiY2hlY2tlZFwiXT0hMDt0aGlzLl9kYXRhW28/XCJjb3JlXCI6XCJjaGVja2JveFwiXS5zZWxlY3RlZD10aGlzLl9kYXRhW28/XCJjb3JlXCI6XCJjaGVja2JveFwiXS5zZWxlY3RlZC5jb25jYXQoZFtmW2ldXS5jaGlsZHJlbl9kKX1pZigtMSE9PW4uaW5kZXhPZihcInVwXCIpKXtmb3IoaT0wLGo9ZS5jaGlsZHJlbl9kLmxlbmd0aDtqPmk7aSsrKWRbZS5jaGlsZHJlbl9kW2ldXS5jaGlsZHJlbi5sZW5ndGh8fGcucHVzaChkW2UuY2hpbGRyZW5fZFtpXV0ucGFyZW50KTtmb3IoZz1hLnZha2F0YS5hcnJheV91bmlxdWUoZyksaz0wLGw9Zy5sZW5ndGg7bD5rO2srKyl7ZT1kW2dba11dO3doaWxlKGUmJmUuaWQhPT1hLmpzdHJlZS5yb290KXtmb3IoaD0wLGk9MCxqPWUuY2hpbGRyZW4ubGVuZ3RoO2o+aTtpKyspaCs9ZFtlLmNoaWxkcmVuW2ldXS5zdGF0ZVtvP1wic2VsZWN0ZWRcIjpcImNoZWNrZWRcIl07aWYoaCE9PWopYnJlYWs7ZS5zdGF0ZVtvP1wic2VsZWN0ZWRcIjpcImNoZWNrZWRcIl09ITAsdGhpcy5fZGF0YVtvP1wiY29yZVwiOlwiY2hlY2tib3hcIl0uc2VsZWN0ZWQucHVzaChlLmlkKSxtPXRoaXMuZ2V0X25vZGUoZSwhMCksbSYmbS5sZW5ndGgmJm0uYXR0cihcImFyaWEtc2VsZWN0ZWRcIiwhMCkuY2hpbGRyZW4oXCIuanN0cmVlLWFuY2hvclwiKS5hZGRDbGFzcyhvP1wianN0cmVlLWNsaWNrZWRcIjpcImpzdHJlZS1jaGVja2VkXCIpLGU9dGhpcy5nZXRfbm9kZShlLnBhcmVudCl9fX10aGlzLl9kYXRhW28/XCJjb3JlXCI6XCJjaGVja2JveFwiXS5zZWxlY3RlZD1hLnZha2F0YS5hcnJheV91bmlxdWUodGhpcy5fZGF0YVtvP1wiY29yZVwiOlwiY2hlY2tib3hcIl0uc2VsZWN0ZWQpfSx0aGlzKSkub24odGhpcy5zZXR0aW5ncy5jaGVja2JveC50aWVfc2VsZWN0aW9uP1wic2VsZWN0X25vZGUuanN0cmVlXCI6XCJjaGVja19ub2RlLmpzdHJlZVwiLGEucHJveHkoZnVuY3Rpb24oYixjKXt2YXIgZD1jLm5vZGUsZT10aGlzLl9tb2RlbC5kYXRhLGY9dGhpcy5nZXRfbm9kZShkLnBhcmVudCksZz10aGlzLmdldF9ub2RlKGQsITApLGgsaSxqLGssbD10aGlzLnNldHRpbmdzLmNoZWNrYm94LmNhc2NhZGUsbT10aGlzLnNldHRpbmdzLmNoZWNrYm94LnRpZV9zZWxlY3Rpb24sbj17fSxvPXRoaXMuX2RhdGFbbT9cImNvcmVcIjpcImNoZWNrYm94XCJdLnNlbGVjdGVkO2ZvcihoPTAsaT1vLmxlbmd0aDtpPmg7aCsrKW5bb1toXV09ITA7aWYoLTEhPT1sLmluZGV4T2YoXCJkb3duXCIpKWZvcihoPTAsaT1kLmNoaWxkcmVuX2QubGVuZ3RoO2k+aDtoKyspbltkLmNoaWxkcmVuX2RbaF1dPSEwLGs9ZVtkLmNoaWxkcmVuX2RbaF1dLGsuc3RhdGVbbT9cInNlbGVjdGVkXCI6XCJjaGVja2VkXCJdPSEwLGsmJmsub3JpZ2luYWwmJmsub3JpZ2luYWwuc3RhdGUmJmsub3JpZ2luYWwuc3RhdGUudW5kZXRlcm1pbmVkJiYoay5vcmlnaW5hbC5zdGF0ZS51bmRldGVybWluZWQ9ITEpO2lmKC0xIT09bC5pbmRleE9mKFwidXBcIikpd2hpbGUoZiYmZi5pZCE9PWEuanN0cmVlLnJvb3Qpe2ZvcihqPTAsaD0wLGk9Zi5jaGlsZHJlbi5sZW5ndGg7aT5oO2grKylqKz1lW2YuY2hpbGRyZW5baF1dLnN0YXRlW20/XCJzZWxlY3RlZFwiOlwiY2hlY2tlZFwiXTtpZihqIT09aSlicmVhaztmLnN0YXRlW20/XCJzZWxlY3RlZFwiOlwiY2hlY2tlZFwiXT0hMCxuW2YuaWRdPSEwLGs9dGhpcy5nZXRfbm9kZShmLCEwKSxrJiZrLmxlbmd0aCYmay5hdHRyKFwiYXJpYS1zZWxlY3RlZFwiLCEwKS5jaGlsZHJlbihcIi5qc3RyZWUtYW5jaG9yXCIpLmFkZENsYXNzKG0/XCJqc3RyZWUtY2xpY2tlZFwiOlwianN0cmVlLWNoZWNrZWRcIiksZj10aGlzLmdldF9ub2RlKGYucGFyZW50KX1vPVtdO2ZvcihoIGluIG4pbi5oYXNPd25Qcm9wZXJ0eShoKSYmby5wdXNoKGgpO3RoaXMuX2RhdGFbbT9cImNvcmVcIjpcImNoZWNrYm94XCJdLnNlbGVjdGVkPW8sLTEhPT1sLmluZGV4T2YoXCJkb3duXCIpJiZnLmxlbmd0aCYmZy5maW5kKFwiLmpzdHJlZS1hbmNob3JcIikuYWRkQ2xhc3MobT9cImpzdHJlZS1jbGlja2VkXCI6XCJqc3RyZWUtY2hlY2tlZFwiKS5wYXJlbnQoKS5hdHRyKFwiYXJpYS1zZWxlY3RlZFwiLCEwKX0sdGhpcykpLm9uKHRoaXMuc2V0dGluZ3MuY2hlY2tib3gudGllX3NlbGVjdGlvbj9cImRlc2VsZWN0X2FsbC5qc3RyZWVcIjpcInVuY2hlY2tfYWxsLmpzdHJlZVwiLGEucHJveHkoZnVuY3Rpb24oYixjKXt2YXIgZD10aGlzLmdldF9ub2RlKGEuanN0cmVlLnJvb3QpLGU9dGhpcy5fbW9kZWwuZGF0YSxmLGcsaDtmb3IoZj0wLGc9ZC5jaGlsZHJlbl9kLmxlbmd0aDtnPmY7ZisrKWg9ZVtkLmNoaWxkcmVuX2RbZl1dLGgmJmgub3JpZ2luYWwmJmgub3JpZ2luYWwuc3RhdGUmJmgub3JpZ2luYWwuc3RhdGUudW5kZXRlcm1pbmVkJiYoaC5vcmlnaW5hbC5zdGF0ZS51bmRldGVybWluZWQ9ITEpfSx0aGlzKSkub24odGhpcy5zZXR0aW5ncy5jaGVja2JveC50aWVfc2VsZWN0aW9uP1wiZGVzZWxlY3Rfbm9kZS5qc3RyZWVcIjpcInVuY2hlY2tfbm9kZS5qc3RyZWVcIixhLnByb3h5KGZ1bmN0aW9uKGIsYyl7dmFyIGQ9Yy5ub2RlLGU9dGhpcy5nZXRfbm9kZShkLCEwKSxmLGcsaCxpPXRoaXMuc2V0dGluZ3MuY2hlY2tib3guY2FzY2FkZSxqPXRoaXMuc2V0dGluZ3MuY2hlY2tib3gudGllX3NlbGVjdGlvbixrPXRoaXMuX2RhdGFbaj9cImNvcmVcIjpcImNoZWNrYm94XCJdLnNlbGVjdGVkLGw9e307aWYoZCYmZC5vcmlnaW5hbCYmZC5vcmlnaW5hbC5zdGF0ZSYmZC5vcmlnaW5hbC5zdGF0ZS51bmRldGVybWluZWQmJihkLm9yaWdpbmFsLnN0YXRlLnVuZGV0ZXJtaW5lZD0hMSksLTEhPT1pLmluZGV4T2YoXCJkb3duXCIpKWZvcihmPTAsZz1kLmNoaWxkcmVuX2QubGVuZ3RoO2c+ZjtmKyspaD10aGlzLl9tb2RlbC5kYXRhW2QuY2hpbGRyZW5fZFtmXV0saC5zdGF0ZVtqP1wic2VsZWN0ZWRcIjpcImNoZWNrZWRcIl09ITEsaCYmaC5vcmlnaW5hbCYmaC5vcmlnaW5hbC5zdGF0ZSYmaC5vcmlnaW5hbC5zdGF0ZS51bmRldGVybWluZWQmJihoLm9yaWdpbmFsLnN0YXRlLnVuZGV0ZXJtaW5lZD0hMSk7aWYoLTEhPT1pLmluZGV4T2YoXCJ1cFwiKSlmb3IoZj0wLGc9ZC5wYXJlbnRzLmxlbmd0aDtnPmY7ZisrKWg9dGhpcy5fbW9kZWwuZGF0YVtkLnBhcmVudHNbZl1dLGguc3RhdGVbaj9cInNlbGVjdGVkXCI6XCJjaGVja2VkXCJdPSExLGgmJmgub3JpZ2luYWwmJmgub3JpZ2luYWwuc3RhdGUmJmgub3JpZ2luYWwuc3RhdGUudW5kZXRlcm1pbmVkJiYoaC5vcmlnaW5hbC5zdGF0ZS51bmRldGVybWluZWQ9ITEpLGg9dGhpcy5nZXRfbm9kZShkLnBhcmVudHNbZl0sITApLGgmJmgubGVuZ3RoJiZoLmF0dHIoXCJhcmlhLXNlbGVjdGVkXCIsITEpLmNoaWxkcmVuKFwiLmpzdHJlZS1hbmNob3JcIikucmVtb3ZlQ2xhc3Moaj9cImpzdHJlZS1jbGlja2VkXCI6XCJqc3RyZWUtY2hlY2tlZFwiKTtmb3IobD17fSxmPTAsZz1rLmxlbmd0aDtnPmY7ZisrKS0xIT09aS5pbmRleE9mKFwiZG93blwiKSYmLTEhPT1hLmluQXJyYXkoa1tmXSxkLmNoaWxkcmVuX2QpfHwtMSE9PWkuaW5kZXhPZihcInVwXCIpJiYtMSE9PWEuaW5BcnJheShrW2ZdLGQucGFyZW50cyl8fChsW2tbZl1dPSEwKTtrPVtdO2ZvcihmIGluIGwpbC5oYXNPd25Qcm9wZXJ0eShmKSYmay5wdXNoKGYpO3RoaXMuX2RhdGFbaj9cImNvcmVcIjpcImNoZWNrYm94XCJdLnNlbGVjdGVkPWssLTEhPT1pLmluZGV4T2YoXCJkb3duXCIpJiZlLmxlbmd0aCYmZS5maW5kKFwiLmpzdHJlZS1hbmNob3JcIikucmVtb3ZlQ2xhc3Moaj9cImpzdHJlZS1jbGlja2VkXCI6XCJqc3RyZWUtY2hlY2tlZFwiKS5wYXJlbnQoKS5hdHRyKFwiYXJpYS1zZWxlY3RlZFwiLCExKX0sdGhpcykpLC0xIT09dGhpcy5zZXR0aW5ncy5jaGVja2JveC5jYXNjYWRlLmluZGV4T2YoXCJ1cFwiKSYmdGhpcy5lbGVtZW50Lm9uKFwiZGVsZXRlX25vZGUuanN0cmVlXCIsYS5wcm94eShmdW5jdGlvbihiLGMpe3ZhciBkPXRoaXMuZ2V0X25vZGUoYy5wYXJlbnQpLGU9dGhpcy5fbW9kZWwuZGF0YSxmLGcsaCxpLGo9dGhpcy5zZXR0aW5ncy5jaGVja2JveC50aWVfc2VsZWN0aW9uO3doaWxlKGQmJmQuaWQhPT1hLmpzdHJlZS5yb290JiYhZC5zdGF0ZVtqP1wic2VsZWN0ZWRcIjpcImNoZWNrZWRcIl0pe2ZvcihoPTAsZj0wLGc9ZC5jaGlsZHJlbi5sZW5ndGg7Zz5mO2YrKyloKz1lW2QuY2hpbGRyZW5bZl1dLnN0YXRlW2o/XCJzZWxlY3RlZFwiOlwiY2hlY2tlZFwiXTtpZighKGc+MCYmaD09PWcpKWJyZWFrO2Quc3RhdGVbaj9cInNlbGVjdGVkXCI6XCJjaGVja2VkXCJdPSEwLHRoaXMuX2RhdGFbaj9cImNvcmVcIjpcImNoZWNrYm94XCJdLnNlbGVjdGVkLnB1c2goZC5pZCksaT10aGlzLmdldF9ub2RlKGQsITApLGkmJmkubGVuZ3RoJiZpLmF0dHIoXCJhcmlhLXNlbGVjdGVkXCIsITApLmNoaWxkcmVuKFwiLmpzdHJlZS1hbmNob3JcIikuYWRkQ2xhc3Moaj9cImpzdHJlZS1jbGlja2VkXCI6XCJqc3RyZWUtY2hlY2tlZFwiKSxkPXRoaXMuZ2V0X25vZGUoZC5wYXJlbnQpfX0sdGhpcykpLm9uKFwibW92ZV9ub2RlLmpzdHJlZVwiLGEucHJveHkoZnVuY3Rpb24oYixjKXt2YXIgZD1jLmlzX211bHRpLGU9Yy5vbGRfcGFyZW50LGY9dGhpcy5nZXRfbm9kZShjLnBhcmVudCksZz10aGlzLl9tb2RlbC5kYXRhLGgsaSxqLGssbCxtPXRoaXMuc2V0dGluZ3MuY2hlY2tib3gudGllX3NlbGVjdGlvbjtpZighZCl7aD10aGlzLmdldF9ub2RlKGUpO3doaWxlKGgmJmguaWQhPT1hLmpzdHJlZS5yb290JiYhaC5zdGF0ZVttP1wic2VsZWN0ZWRcIjpcImNoZWNrZWRcIl0pe2ZvcihpPTAsaj0wLGs9aC5jaGlsZHJlbi5sZW5ndGg7az5qO2orKylpKz1nW2guY2hpbGRyZW5bal1dLnN0YXRlW20/XCJzZWxlY3RlZFwiOlwiY2hlY2tlZFwiXTtpZighKGs+MCYmaT09PWspKWJyZWFrO2guc3RhdGVbbT9cInNlbGVjdGVkXCI6XCJjaGVja2VkXCJdPSEwLHRoaXMuX2RhdGFbbT9cImNvcmVcIjpcImNoZWNrYm94XCJdLnNlbGVjdGVkLnB1c2goaC5pZCksbD10aGlzLmdldF9ub2RlKGgsITApLGwmJmwubGVuZ3RoJiZsLmF0dHIoXCJhcmlhLXNlbGVjdGVkXCIsITApLmNoaWxkcmVuKFwiLmpzdHJlZS1hbmNob3JcIikuYWRkQ2xhc3MobT9cImpzdHJlZS1jbGlja2VkXCI6XCJqc3RyZWUtY2hlY2tlZFwiKSxoPXRoaXMuZ2V0X25vZGUoaC5wYXJlbnQpfX1oPWY7d2hpbGUoaCYmaC5pZCE9PWEuanN0cmVlLnJvb3Qpe2ZvcihpPTAsaj0wLGs9aC5jaGlsZHJlbi5sZW5ndGg7az5qO2orKylpKz1nW2guY2hpbGRyZW5bal1dLnN0YXRlW20/XCJzZWxlY3RlZFwiOlwiY2hlY2tlZFwiXTtpZihpPT09ayloLnN0YXRlW20/XCJzZWxlY3RlZFwiOlwiY2hlY2tlZFwiXXx8KGguc3RhdGVbbT9cInNlbGVjdGVkXCI6XCJjaGVja2VkXCJdPSEwLHRoaXMuX2RhdGFbbT9cImNvcmVcIjpcImNoZWNrYm94XCJdLnNlbGVjdGVkLnB1c2goaC5pZCksbD10aGlzLmdldF9ub2RlKGgsITApLGwmJmwubGVuZ3RoJiZsLmF0dHIoXCJhcmlhLXNlbGVjdGVkXCIsITApLmNoaWxkcmVuKFwiLmpzdHJlZS1hbmNob3JcIikuYWRkQ2xhc3MobT9cImpzdHJlZS1jbGlja2VkXCI6XCJqc3RyZWUtY2hlY2tlZFwiKSk7ZWxzZXtpZighaC5zdGF0ZVttP1wic2VsZWN0ZWRcIjpcImNoZWNrZWRcIl0pYnJlYWs7aC5zdGF0ZVttP1wic2VsZWN0ZWRcIjpcImNoZWNrZWRcIl09ITEsdGhpcy5fZGF0YVttP1wiY29yZVwiOlwiY2hlY2tib3hcIl0uc2VsZWN0ZWQ9YS52YWthdGEuYXJyYXlfcmVtb3ZlX2l0ZW0odGhpcy5fZGF0YVttP1wiY29yZVwiOlwiY2hlY2tib3hcIl0uc2VsZWN0ZWQsaC5pZCksbD10aGlzLmdldF9ub2RlKGgsITApLGwmJmwubGVuZ3RoJiZsLmF0dHIoXCJhcmlhLXNlbGVjdGVkXCIsITEpLmNoaWxkcmVuKFwiLmpzdHJlZS1hbmNob3JcIikucmVtb3ZlQ2xhc3MobT9cImpzdHJlZS1jbGlja2VkXCI6XCJqc3RyZWUtY2hlY2tlZFwiKX1oPXRoaXMuZ2V0X25vZGUoaC5wYXJlbnQpfX0sdGhpcykpfSx0aGlzLl91bmRldGVybWluZWQ9ZnVuY3Rpb24oKXtpZihudWxsIT09dGhpcy5lbGVtZW50KXt2YXIgYyxkLGUsZixnPXt9LGg9dGhpcy5fbW9kZWwuZGF0YSxpPXRoaXMuc2V0dGluZ3MuY2hlY2tib3gudGllX3NlbGVjdGlvbixqPXRoaXMuX2RhdGFbaT9cImNvcmVcIjpcImNoZWNrYm94XCJdLnNlbGVjdGVkLGs9W10sbD10aGlzO2ZvcihjPTAsZD1qLmxlbmd0aDtkPmM7YysrKWlmKGhbaltjXV0mJmhbaltjXV0ucGFyZW50cylmb3IoZT0wLGY9aFtqW2NdXS5wYXJlbnRzLmxlbmd0aDtmPmU7ZSsrKXtpZihnW2hbaltjXV0ucGFyZW50c1tlXV0hPT1iKWJyZWFrO2hbaltjXV0ucGFyZW50c1tlXSE9PWEuanN0cmVlLnJvb3QmJihnW2hbaltjXV0ucGFyZW50c1tlXV09ITAsay5wdXNoKGhbaltjXV0ucGFyZW50c1tlXSkpfWZvcih0aGlzLmVsZW1lbnQuZmluZChcIi5qc3RyZWUtY2xvc2VkXCIpLm5vdChcIjpoYXMoLmpzdHJlZS1jaGlsZHJlbilcIikuZWFjaChmdW5jdGlvbigpe3ZhciBpPWwuZ2V0X25vZGUodGhpcyksajtpZihpLnN0YXRlLmxvYWRlZCl7Zm9yKGM9MCxkPWkuY2hpbGRyZW5fZC5sZW5ndGg7ZD5jO2MrKylpZihqPWhbaS5jaGlsZHJlbl9kW2NdXSwhai5zdGF0ZS5sb2FkZWQmJmoub3JpZ2luYWwmJmoub3JpZ2luYWwuc3RhdGUmJmoub3JpZ2luYWwuc3RhdGUudW5kZXRlcm1pbmVkJiZqLm9yaWdpbmFsLnN0YXRlLnVuZGV0ZXJtaW5lZD09PSEwKWZvcihnW2ouaWRdPT09YiYmai5pZCE9PWEuanN0cmVlLnJvb3QmJihnW2ouaWRdPSEwLGsucHVzaChqLmlkKSksZT0wLGY9ai5wYXJlbnRzLmxlbmd0aDtmPmU7ZSsrKWdbai5wYXJlbnRzW2VdXT09PWImJmoucGFyZW50c1tlXSE9PWEuanN0cmVlLnJvb3QmJihnW2oucGFyZW50c1tlXV09ITAsay5wdXNoKGoucGFyZW50c1tlXSkpfWVsc2UgaWYoaS5vcmlnaW5hbCYmaS5vcmlnaW5hbC5zdGF0ZSYmaS5vcmlnaW5hbC5zdGF0ZS51bmRldGVybWluZWQmJmkub3JpZ2luYWwuc3RhdGUudW5kZXRlcm1pbmVkPT09ITApZm9yKGdbaS5pZF09PT1iJiZpLmlkIT09YS5qc3RyZWUucm9vdCYmKGdbaS5pZF09ITAsay5wdXNoKGkuaWQpKSxlPTAsZj1pLnBhcmVudHMubGVuZ3RoO2Y+ZTtlKyspZ1tpLnBhcmVudHNbZV1dPT09YiYmaS5wYXJlbnRzW2VdIT09YS5qc3RyZWUucm9vdCYmKGdbaS5wYXJlbnRzW2VdXT0hMCxrLnB1c2goaS5wYXJlbnRzW2VdKSl9KSx0aGlzLmVsZW1lbnQuZmluZChcIi5qc3RyZWUtdW5kZXRlcm1pbmVkXCIpLnJlbW92ZUNsYXNzKFwianN0cmVlLXVuZGV0ZXJtaW5lZFwiKSxjPTAsZD1rLmxlbmd0aDtkPmM7YysrKWhba1tjXV0uc3RhdGVbaT9cInNlbGVjdGVkXCI6XCJjaGVja2VkXCJdfHwoaj10aGlzLmdldF9ub2RlKGtbY10sITApLGomJmoubGVuZ3RoJiZqLmNoaWxkcmVuKFwiLmpzdHJlZS1hbmNob3JcIikuY2hpbGRyZW4oXCIuanN0cmVlLWNoZWNrYm94XCIpLmFkZENsYXNzKFwianN0cmVlLXVuZGV0ZXJtaW5lZFwiKSl9fSx0aGlzLnJlZHJhd19ub2RlPWZ1bmN0aW9uKGIsYyxlLGYpe2lmKGI9ZC5yZWRyYXdfbm9kZS5hcHBseSh0aGlzLGFyZ3VtZW50cykpe3ZhciBnLGgsaT1udWxsLGo9bnVsbDtmb3IoZz0wLGg9Yi5jaGlsZE5vZGVzLmxlbmd0aDtoPmc7ZysrKWlmKGIuY2hpbGROb2Rlc1tnXSYmYi5jaGlsZE5vZGVzW2ddLmNsYXNzTmFtZSYmLTEhPT1iLmNoaWxkTm9kZXNbZ10uY2xhc3NOYW1lLmluZGV4T2YoXCJqc3RyZWUtYW5jaG9yXCIpKXtpPWIuY2hpbGROb2Rlc1tnXTticmVha31pJiYoIXRoaXMuc2V0dGluZ3MuY2hlY2tib3gudGllX3NlbGVjdGlvbiYmdGhpcy5fbW9kZWwuZGF0YVtiLmlkXS5zdGF0ZS5jaGVja2VkJiYoaS5jbGFzc05hbWUrPVwiIGpzdHJlZS1jaGVja2VkXCIpLGo9bS5jbG9uZU5vZGUoITEpLHRoaXMuX21vZGVsLmRhdGFbYi5pZF0uc3RhdGUuY2hlY2tib3hfZGlzYWJsZWQmJihqLmNsYXNzTmFtZSs9XCIganN0cmVlLWNoZWNrYm94LWRpc2FibGVkXCIpLGkuaW5zZXJ0QmVmb3JlKGosaS5jaGlsZE5vZGVzWzBdKSl9cmV0dXJuIGV8fC0xPT09dGhpcy5zZXR0aW5ncy5jaGVja2JveC5jYXNjYWRlLmluZGV4T2YoXCJ1bmRldGVybWluZWRcIil8fCh0aGlzLl9kYXRhLmNoZWNrYm94LnV0byYmY2xlYXJUaW1lb3V0KHRoaXMuX2RhdGEuY2hlY2tib3gudXRvKSx0aGlzLl9kYXRhLmNoZWNrYm94LnV0bz1zZXRUaW1lb3V0KGEucHJveHkodGhpcy5fdW5kZXRlcm1pbmVkLHRoaXMpLDUwKSksYn0sdGhpcy5zaG93X2NoZWNrYm94ZXM9ZnVuY3Rpb24oKXt0aGlzLl9kYXRhLmNvcmUudGhlbWVzLmNoZWNrYm94ZXM9ITAsdGhpcy5nZXRfY29udGFpbmVyX3VsKCkucmVtb3ZlQ2xhc3MoXCJqc3RyZWUtbm8tY2hlY2tib3hlc1wiKX0sdGhpcy5oaWRlX2NoZWNrYm94ZXM9ZnVuY3Rpb24oKXt0aGlzLl9kYXRhLmNvcmUudGhlbWVzLmNoZWNrYm94ZXM9ITEsdGhpcy5nZXRfY29udGFpbmVyX3VsKCkuYWRkQ2xhc3MoXCJqc3RyZWUtbm8tY2hlY2tib3hlc1wiKX0sdGhpcy50b2dnbGVfY2hlY2tib3hlcz1mdW5jdGlvbigpe3RoaXMuX2RhdGEuY29yZS50aGVtZXMuY2hlY2tib3hlcz90aGlzLmhpZGVfY2hlY2tib3hlcygpOnRoaXMuc2hvd19jaGVja2JveGVzKCl9LHRoaXMuaXNfdW5kZXRlcm1pbmVkPWZ1bmN0aW9uKGIpe2I9dGhpcy5nZXRfbm9kZShiKTt2YXIgYz10aGlzLnNldHRpbmdzLmNoZWNrYm94LmNhc2NhZGUsZCxlLGY9dGhpcy5zZXR0aW5ncy5jaGVja2JveC50aWVfc2VsZWN0aW9uLGc9dGhpcy5fZGF0YVtmP1wiY29yZVwiOlwiY2hlY2tib3hcIl0uc2VsZWN0ZWQsaD10aGlzLl9tb2RlbC5kYXRhO2lmKCFifHxiLnN0YXRlW2Y/XCJzZWxlY3RlZFwiOlwiY2hlY2tlZFwiXT09PSEwfHwtMT09PWMuaW5kZXhPZihcInVuZGV0ZXJtaW5lZFwiKXx8LTE9PT1jLmluZGV4T2YoXCJkb3duXCIpJiYtMT09PWMuaW5kZXhPZihcInVwXCIpKXJldHVybiExO2lmKCFiLnN0YXRlLmxvYWRlZCYmYi5vcmlnaW5hbC5zdGF0ZS51bmRldGVybWluZWQ9PT0hMClyZXR1cm4hMDtmb3IoZD0wLGU9Yi5jaGlsZHJlbl9kLmxlbmd0aDtlPmQ7ZCsrKWlmKC0xIT09YS5pbkFycmF5KGIuY2hpbGRyZW5fZFtkXSxnKXx8IWhbYi5jaGlsZHJlbl9kW2RdXS5zdGF0ZS5sb2FkZWQmJmhbYi5jaGlsZHJlbl9kW2RdXS5vcmlnaW5hbC5zdGF0ZS51bmRldGVybWluZWQpcmV0dXJuITA7cmV0dXJuITF9LHRoaXMuZGlzYWJsZV9jaGVja2JveD1mdW5jdGlvbihiKXt2YXIgYyxkLGU7aWYoYS5pc0FycmF5KGIpKXtmb3IoYj1iLnNsaWNlKCksYz0wLGQ9Yi5sZW5ndGg7ZD5jO2MrKyl0aGlzLmRpc2FibGVfY2hlY2tib3goYltjXSk7cmV0dXJuITB9cmV0dXJuIGI9dGhpcy5nZXRfbm9kZShiKSxiJiZiLmlkIT09YS5qc3RyZWUucm9vdD8oZT10aGlzLmdldF9ub2RlKGIsITApLHZvaWQoYi5zdGF0ZS5jaGVja2JveF9kaXNhYmxlZHx8KGIuc3RhdGUuY2hlY2tib3hfZGlzYWJsZWQ9ITAsZSYmZS5sZW5ndGgmJmUuY2hpbGRyZW4oXCIuanN0cmVlLWFuY2hvclwiKS5jaGlsZHJlbihcIi5qc3RyZWUtY2hlY2tib3hcIikuYWRkQ2xhc3MoXCJqc3RyZWUtY2hlY2tib3gtZGlzYWJsZWRcIiksdGhpcy50cmlnZ2VyKFwiZGlzYWJsZV9jaGVja2JveFwiLHtub2RlOmJ9KSkpKTohMX0sdGhpcy5lbmFibGVfY2hlY2tib3g9ZnVuY3Rpb24oYil7dmFyIGMsZCxlO2lmKGEuaXNBcnJheShiKSl7Zm9yKGI9Yi5zbGljZSgpLGM9MCxkPWIubGVuZ3RoO2Q+YztjKyspdGhpcy5lbmFibGVfY2hlY2tib3goYltjXSk7cmV0dXJuITB9cmV0dXJuIGI9dGhpcy5nZXRfbm9kZShiKSxiJiZiLmlkIT09YS5qc3RyZWUucm9vdD8oZT10aGlzLmdldF9ub2RlKGIsITApLHZvaWQoYi5zdGF0ZS5jaGVja2JveF9kaXNhYmxlZCYmKGIuc3RhdGUuY2hlY2tib3hfZGlzYWJsZWQ9ITEsZSYmZS5sZW5ndGgmJmUuY2hpbGRyZW4oXCIuanN0cmVlLWFuY2hvclwiKS5jaGlsZHJlbihcIi5qc3RyZWUtY2hlY2tib3hcIikucmVtb3ZlQ2xhc3MoXCJqc3RyZWUtY2hlY2tib3gtZGlzYWJsZWRcIiksdGhpcy50cmlnZ2VyKFwiZW5hYmxlX2NoZWNrYm94XCIse25vZGU6Yn0pKSkpOiExfSx0aGlzLmFjdGl2YXRlX25vZGU9ZnVuY3Rpb24oYixjKXtyZXR1cm4gYShjLnRhcmdldCkuaGFzQ2xhc3MoXCJqc3RyZWUtY2hlY2tib3gtZGlzYWJsZWRcIik/ITE6KHRoaXMuc2V0dGluZ3MuY2hlY2tib3gudGllX3NlbGVjdGlvbiYmKHRoaXMuc2V0dGluZ3MuY2hlY2tib3gud2hvbGVfbm9kZXx8YShjLnRhcmdldCkuaGFzQ2xhc3MoXCJqc3RyZWUtY2hlY2tib3hcIikpJiYoYy5jdHJsS2V5PSEwKSx0aGlzLnNldHRpbmdzLmNoZWNrYm94LnRpZV9zZWxlY3Rpb258fCF0aGlzLnNldHRpbmdzLmNoZWNrYm94Lndob2xlX25vZGUmJiFhKGMudGFyZ2V0KS5oYXNDbGFzcyhcImpzdHJlZS1jaGVja2JveFwiKT9kLmFjdGl2YXRlX25vZGUuY2FsbCh0aGlzLGIsYyk6dGhpcy5pc19kaXNhYmxlZChiKT8hMToodGhpcy5pc19jaGVja2VkKGIpP3RoaXMudW5jaGVja19ub2RlKGIsYyk6dGhpcy5jaGVja19ub2RlKGIsYyksdm9pZCB0aGlzLnRyaWdnZXIoXCJhY3RpdmF0ZV9ub2RlXCIse25vZGU6dGhpcy5nZXRfbm9kZShiKX0pKSl9LHRoaXMuY2hlY2tfbm9kZT1mdW5jdGlvbihiLGMpe2lmKHRoaXMuc2V0dGluZ3MuY2hlY2tib3gudGllX3NlbGVjdGlvbilyZXR1cm4gdGhpcy5zZWxlY3Rfbm9kZShiLCExLCEwLGMpO3ZhciBkLGUsZixnO2lmKGEuaXNBcnJheShiKSl7Zm9yKGI9Yi5zbGljZSgpLGU9MCxmPWIubGVuZ3RoO2Y+ZTtlKyspdGhpcy5jaGVja19ub2RlKGJbZV0sYyk7cmV0dXJuITB9cmV0dXJuIGI9dGhpcy5nZXRfbm9kZShiKSxiJiZiLmlkIT09YS5qc3RyZWUucm9vdD8oZD10aGlzLmdldF9ub2RlKGIsITApLHZvaWQoYi5zdGF0ZS5jaGVja2VkfHwoYi5zdGF0ZS5jaGVja2VkPSEwLHRoaXMuX2RhdGEuY2hlY2tib3guc2VsZWN0ZWQucHVzaChiLmlkKSxkJiZkLmxlbmd0aCYmZC5jaGlsZHJlbihcIi5qc3RyZWUtYW5jaG9yXCIpLmFkZENsYXNzKFwianN0cmVlLWNoZWNrZWRcIiksdGhpcy50cmlnZ2VyKFwiY2hlY2tfbm9kZVwiLHtub2RlOmIsc2VsZWN0ZWQ6dGhpcy5fZGF0YS5jaGVja2JveC5zZWxlY3RlZCxldmVudDpjfSkpKSk6ITF9LHRoaXMudW5jaGVja19ub2RlPWZ1bmN0aW9uKGIsYyl7aWYodGhpcy5zZXR0aW5ncy5jaGVja2JveC50aWVfc2VsZWN0aW9uKXJldHVybiB0aGlzLmRlc2VsZWN0X25vZGUoYiwhMSxjKTt2YXIgZCxlLGY7aWYoYS5pc0FycmF5KGIpKXtmb3IoYj1iLnNsaWNlKCksZD0wLGU9Yi5sZW5ndGg7ZT5kO2QrKyl0aGlzLnVuY2hlY2tfbm9kZShiW2RdLGMpO3JldHVybiEwfXJldHVybiBiPXRoaXMuZ2V0X25vZGUoYiksYiYmYi5pZCE9PWEuanN0cmVlLnJvb3Q/KGY9dGhpcy5nZXRfbm9kZShiLCEwKSx2b2lkKGIuc3RhdGUuY2hlY2tlZCYmKGIuc3RhdGUuY2hlY2tlZD0hMSx0aGlzLl9kYXRhLmNoZWNrYm94LnNlbGVjdGVkPWEudmFrYXRhLmFycmF5X3JlbW92ZV9pdGVtKHRoaXMuX2RhdGEuY2hlY2tib3guc2VsZWN0ZWQsYi5pZCksZi5sZW5ndGgmJmYuY2hpbGRyZW4oXCIuanN0cmVlLWFuY2hvclwiKS5yZW1vdmVDbGFzcyhcImpzdHJlZS1jaGVja2VkXCIpLHRoaXMudHJpZ2dlcihcInVuY2hlY2tfbm9kZVwiLHtub2RlOmIsc2VsZWN0ZWQ6dGhpcy5fZGF0YS5jaGVja2JveC5zZWxlY3RlZCxldmVudDpjfSkpKSk6ITF9LHRoaXMuY2hlY2tfYWxsPWZ1bmN0aW9uKCl7aWYodGhpcy5zZXR0aW5ncy5jaGVja2JveC50aWVfc2VsZWN0aW9uKXJldHVybiB0aGlzLnNlbGVjdF9hbGwoKTt2YXIgYj10aGlzLl9kYXRhLmNoZWNrYm94LnNlbGVjdGVkLmNvbmNhdChbXSksYyxkO2Zvcih0aGlzLl9kYXRhLmNoZWNrYm94LnNlbGVjdGVkPXRoaXMuX21vZGVsLmRhdGFbYS5qc3RyZWUucm9vdF0uY2hpbGRyZW5fZC5jb25jYXQoKSxjPTAsZD10aGlzLl9kYXRhLmNoZWNrYm94LnNlbGVjdGVkLmxlbmd0aDtkPmM7YysrKXRoaXMuX21vZGVsLmRhdGFbdGhpcy5fZGF0YS5jaGVja2JveC5zZWxlY3RlZFtjXV0mJih0aGlzLl9tb2RlbC5kYXRhW3RoaXMuX2RhdGEuY2hlY2tib3guc2VsZWN0ZWRbY11dLnN0YXRlLmNoZWNrZWQ9ITApO3RoaXMucmVkcmF3KCEwKSx0aGlzLnRyaWdnZXIoXCJjaGVja19hbGxcIix7c2VsZWN0ZWQ6dGhpcy5fZGF0YS5jaGVja2JveC5zZWxlY3RlZH0pfSx0aGlzLnVuY2hlY2tfYWxsPWZ1bmN0aW9uKCl7aWYodGhpcy5zZXR0aW5ncy5jaGVja2JveC50aWVfc2VsZWN0aW9uKXJldHVybiB0aGlzLmRlc2VsZWN0X2FsbCgpO3ZhciBhPXRoaXMuX2RhdGEuY2hlY2tib3guc2VsZWN0ZWQuY29uY2F0KFtdKSxiLGM7Zm9yKGI9MCxjPXRoaXMuX2RhdGEuY2hlY2tib3guc2VsZWN0ZWQubGVuZ3RoO2M+YjtiKyspdGhpcy5fbW9kZWwuZGF0YVt0aGlzLl9kYXRhLmNoZWNrYm94LnNlbGVjdGVkW2JdXSYmKHRoaXMuX21vZGVsLmRhdGFbdGhpcy5fZGF0YS5jaGVja2JveC5zZWxlY3RlZFtiXV0uc3RhdGUuY2hlY2tlZD0hMSk7dGhpcy5fZGF0YS5jaGVja2JveC5zZWxlY3RlZD1bXSx0aGlzLmVsZW1lbnQuZmluZChcIi5qc3RyZWUtY2hlY2tlZFwiKS5yZW1vdmVDbGFzcyhcImpzdHJlZS1jaGVja2VkXCIpLHRoaXMudHJpZ2dlcihcInVuY2hlY2tfYWxsXCIse3NlbGVjdGVkOnRoaXMuX2RhdGEuY2hlY2tib3guc2VsZWN0ZWQsbm9kZTphfSl9LHRoaXMuaXNfY2hlY2tlZD1mdW5jdGlvbihiKXtyZXR1cm4gdGhpcy5zZXR0aW5ncy5jaGVja2JveC50aWVfc2VsZWN0aW9uP3RoaXMuaXNfc2VsZWN0ZWQoYik6KGI9dGhpcy5nZXRfbm9kZShiKSxiJiZiLmlkIT09YS5qc3RyZWUucm9vdD9iLnN0YXRlLmNoZWNrZWQ6ITEpfSx0aGlzLmdldF9jaGVja2VkPWZ1bmN0aW9uKGIpe3JldHVybiB0aGlzLnNldHRpbmdzLmNoZWNrYm94LnRpZV9zZWxlY3Rpb24/dGhpcy5nZXRfc2VsZWN0ZWQoYik6Yj9hLm1hcCh0aGlzLl9kYXRhLmNoZWNrYm94LnNlbGVjdGVkLGEucHJveHkoZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMuZ2V0X25vZGUoYSl9LHRoaXMpKTp0aGlzLl9kYXRhLmNoZWNrYm94LnNlbGVjdGVkfSx0aGlzLmdldF90b3BfY2hlY2tlZD1mdW5jdGlvbihiKXtpZih0aGlzLnNldHRpbmdzLmNoZWNrYm94LnRpZV9zZWxlY3Rpb24pcmV0dXJuIHRoaXMuZ2V0X3RvcF9zZWxlY3RlZChiKTt2YXIgYz10aGlzLmdldF9jaGVja2VkKCEwKSxkPXt9LGUsZixnLGg7Zm9yKGU9MCxmPWMubGVuZ3RoO2Y+ZTtlKyspZFtjW2VdLmlkXT1jW2VdO2ZvcihlPTAsZj1jLmxlbmd0aDtmPmU7ZSsrKWZvcihnPTAsaD1jW2VdLmNoaWxkcmVuX2QubGVuZ3RoO2g+ZztnKyspZFtjW2VdLmNoaWxkcmVuX2RbZ11dJiZkZWxldGUgZFtjW2VdLmNoaWxkcmVuX2RbZ11dO2M9W107Zm9yKGUgaW4gZClkLmhhc093blByb3BlcnR5KGUpJiZjLnB1c2goZSk7cmV0dXJuIGI/YS5tYXAoYyxhLnByb3h5KGZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLmdldF9ub2RlKGEpfSx0aGlzKSk6Y30sdGhpcy5nZXRfYm90dG9tX2NoZWNrZWQ9ZnVuY3Rpb24oYil7aWYodGhpcy5zZXR0aW5ncy5jaGVja2JveC50aWVfc2VsZWN0aW9uKXJldHVybiB0aGlzLmdldF9ib3R0b21fc2VsZWN0ZWQoYik7dmFyIGM9dGhpcy5nZXRfY2hlY2tlZCghMCksZD1bXSxlLGY7Zm9yKGU9MCxmPWMubGVuZ3RoO2Y+ZTtlKyspY1tlXS5jaGlsZHJlbi5sZW5ndGh8fGQucHVzaChjW2VdLmlkKTtyZXR1cm4gYj9hLm1hcChkLGEucHJveHkoZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMuZ2V0X25vZGUoYSl9LHRoaXMpKTpkfSx0aGlzLmxvYWRfbm9kZT1mdW5jdGlvbihiLGMpe3ZhciBlLGYsZyxoLGksajtpZighYS5pc0FycmF5KGIpJiYhdGhpcy5zZXR0aW5ncy5jaGVja2JveC50aWVfc2VsZWN0aW9uJiYoaj10aGlzLmdldF9ub2RlKGIpLGomJmouc3RhdGUubG9hZGVkKSlmb3IoZT0wLGY9ai5jaGlsZHJlbl9kLmxlbmd0aDtmPmU7ZSsrKXRoaXMuX21vZGVsLmRhdGFbai5jaGlsZHJlbl9kW2VdXS5zdGF0ZS5jaGVja2VkJiYoaT0hMCx0aGlzLl9kYXRhLmNoZWNrYm94LnNlbGVjdGVkPWEudmFrYXRhLmFycmF5X3JlbW92ZV9pdGVtKHRoaXMuX2RhdGEuY2hlY2tib3guc2VsZWN0ZWQsai5jaGlsZHJlbl9kW2VdKSk7cmV0dXJuIGQubG9hZF9ub2RlLmFwcGx5KHRoaXMsYXJndW1lbnRzKX0sdGhpcy5nZXRfc3RhdGU9ZnVuY3Rpb24oKXt2YXIgYT1kLmdldF9zdGF0ZS5hcHBseSh0aGlzLGFyZ3VtZW50cyk7cmV0dXJuIHRoaXMuc2V0dGluZ3MuY2hlY2tib3gudGllX3NlbGVjdGlvbj9hOihhLmNoZWNrYm94PXRoaXMuX2RhdGEuY2hlY2tib3guc2VsZWN0ZWQuc2xpY2UoKSxhKX0sdGhpcy5zZXRfc3RhdGU9ZnVuY3Rpb24oYixjKXt2YXIgZT1kLnNldF9zdGF0ZS5hcHBseSh0aGlzLGFyZ3VtZW50cyk7aWYoZSYmYi5jaGVja2JveCl7aWYoIXRoaXMuc2V0dGluZ3MuY2hlY2tib3gudGllX3NlbGVjdGlvbil7dGhpcy51bmNoZWNrX2FsbCgpO3ZhciBmPXRoaXM7YS5lYWNoKGIuY2hlY2tib3gsZnVuY3Rpb24oYSxiKXtmLmNoZWNrX25vZGUoYil9KX1yZXR1cm4gZGVsZXRlIGIuY2hlY2tib3gsdGhpcy5zZXRfc3RhdGUoYixjKSwhMX1yZXR1cm4gZX0sdGhpcy5yZWZyZXNoPWZ1bmN0aW9uKGEsYil7cmV0dXJuIHRoaXMuc2V0dGluZ3MuY2hlY2tib3gudGllX3NlbGVjdGlvbnx8KHRoaXMuX2RhdGEuY2hlY2tib3guc2VsZWN0ZWQ9W10pLGQucmVmcmVzaC5hcHBseSh0aGlzLGFyZ3VtZW50cyl9fSxhLmpzdHJlZS5kZWZhdWx0cy5jb25kaXRpb25hbHNlbGVjdD1mdW5jdGlvbigpe3JldHVybiEwfSxhLmpzdHJlZS5wbHVnaW5zLmNvbmRpdGlvbmFsc2VsZWN0PWZ1bmN0aW9uKGEsYil7dGhpcy5hY3RpdmF0ZV9ub2RlPWZ1bmN0aW9uKGEsYyl7dGhpcy5zZXR0aW5ncy5jb25kaXRpb25hbHNlbGVjdC5jYWxsKHRoaXMsdGhpcy5nZXRfbm9kZShhKSxjKSYmYi5hY3RpdmF0ZV9ub2RlLmNhbGwodGhpcyxhLGMpfX0sYS5qc3RyZWUuZGVmYXVsdHMuY29udGV4dG1lbnU9e3NlbGVjdF9ub2RlOiEwLHNob3dfYXRfbm9kZTohMCxpdGVtczpmdW5jdGlvbihiLGMpe3JldHVybntjcmVhdGU6e3NlcGFyYXRvcl9iZWZvcmU6ITEsc2VwYXJhdG9yX2FmdGVyOiEwLF9kaXNhYmxlZDohMSxsYWJlbDpcIkNyZWF0ZVwiLGFjdGlvbjpmdW5jdGlvbihiKXt2YXIgYz1hLmpzdHJlZS5yZWZlcmVuY2UoYi5yZWZlcmVuY2UpLGQ9Yy5nZXRfbm9kZShiLnJlZmVyZW5jZSk7Yy5jcmVhdGVfbm9kZShkLHt9LFwibGFzdFwiLGZ1bmN0aW9uKGEpe3NldFRpbWVvdXQoZnVuY3Rpb24oKXtjLmVkaXQoYSl9LDApfSl9fSxyZW5hbWU6e3NlcGFyYXRvcl9iZWZvcmU6ITEsc2VwYXJhdG9yX2FmdGVyOiExLF9kaXNhYmxlZDohMSxsYWJlbDpcIlJlbmFtZVwiLGFjdGlvbjpmdW5jdGlvbihiKXt2YXIgYz1hLmpzdHJlZS5yZWZlcmVuY2UoYi5yZWZlcmVuY2UpLGQ9Yy5nZXRfbm9kZShiLnJlZmVyZW5jZSk7Yy5lZGl0KGQpfX0scmVtb3ZlOntzZXBhcmF0b3JfYmVmb3JlOiExLGljb246ITEsc2VwYXJhdG9yX2FmdGVyOiExLF9kaXNhYmxlZDohMSxsYWJlbDpcIkRlbGV0ZVwiLGFjdGlvbjpmdW5jdGlvbihiKXt2YXIgYz1hLmpzdHJlZS5yZWZlcmVuY2UoYi5yZWZlcmVuY2UpLGQ9Yy5nZXRfbm9kZShiLnJlZmVyZW5jZSk7Yy5pc19zZWxlY3RlZChkKT9jLmRlbGV0ZV9ub2RlKGMuZ2V0X3NlbGVjdGVkKCkpOmMuZGVsZXRlX25vZGUoZCl9fSxjY3A6e3NlcGFyYXRvcl9iZWZvcmU6ITAsaWNvbjohMSxzZXBhcmF0b3JfYWZ0ZXI6ITEsbGFiZWw6XCJFZGl0XCIsYWN0aW9uOiExLHN1Ym1lbnU6e2N1dDp7c2VwYXJhdG9yX2JlZm9yZTohMSxzZXBhcmF0b3JfYWZ0ZXI6ITEsbGFiZWw6XCJDdXRcIixhY3Rpb246ZnVuY3Rpb24oYil7dmFyIGM9YS5qc3RyZWUucmVmZXJlbmNlKGIucmVmZXJlbmNlKSxkPWMuZ2V0X25vZGUoYi5yZWZlcmVuY2UpO2MuaXNfc2VsZWN0ZWQoZCk/Yy5jdXQoYy5nZXRfdG9wX3NlbGVjdGVkKCkpOmMuY3V0KGQpfX0sY29weTp7c2VwYXJhdG9yX2JlZm9yZTohMSxpY29uOiExLHNlcGFyYXRvcl9hZnRlcjohMSxsYWJlbDpcIkNvcHlcIixhY3Rpb246ZnVuY3Rpb24oYil7dmFyIGM9YS5qc3RyZWUucmVmZXJlbmNlKGIucmVmZXJlbmNlKSxkPWMuZ2V0X25vZGUoYi5yZWZlcmVuY2UpO2MuaXNfc2VsZWN0ZWQoZCk/Yy5jb3B5KGMuZ2V0X3RvcF9zZWxlY3RlZCgpKTpjLmNvcHkoZCl9fSxwYXN0ZTp7c2VwYXJhdG9yX2JlZm9yZTohMSxpY29uOiExLF9kaXNhYmxlZDpmdW5jdGlvbihiKXtyZXR1cm4hYS5qc3RyZWUucmVmZXJlbmNlKGIucmVmZXJlbmNlKS5jYW5fcGFzdGUoKX0sc2VwYXJhdG9yX2FmdGVyOiExLGxhYmVsOlwiUGFzdGVcIixhY3Rpb246ZnVuY3Rpb24oYil7dmFyIGM9YS5qc3RyZWUucmVmZXJlbmNlKGIucmVmZXJlbmNlKSxkPWMuZ2V0X25vZGUoYi5yZWZlcmVuY2UpO2MucGFzdGUoZCl9fX19fX19LGEuanN0cmVlLnBsdWdpbnMuY29udGV4dG1lbnU9ZnVuY3Rpb24oYyxkKXt0aGlzLmJpbmQ9ZnVuY3Rpb24oKXtkLmJpbmQuY2FsbCh0aGlzKTt2YXIgYj0wLGM9bnVsbCxlLGY7dGhpcy5lbGVtZW50Lm9uKFwiY29udGV4dG1lbnUuanN0cmVlXCIsXCIuanN0cmVlLWFuY2hvclwiLGEucHJveHkoZnVuY3Rpb24oYSxkKXthLnByZXZlbnREZWZhdWx0KCksYj1hLmN0cmxLZXk/K25ldyBEYXRlOjAsKGR8fGMpJiYoYj0rbmV3IERhdGUrMWU0KSxjJiZjbGVhclRpbWVvdXQoYyksdGhpcy5pc19sb2FkaW5nKGEuY3VycmVudFRhcmdldCl8fHRoaXMuc2hvd19jb250ZXh0bWVudShhLmN1cnJlbnRUYXJnZXQsYS5wYWdlWCxhLnBhZ2VZLGEpfSx0aGlzKSkub24oXCJjbGljay5qc3RyZWVcIixcIi5qc3RyZWUtYW5jaG9yXCIsYS5wcm94eShmdW5jdGlvbihjKXt0aGlzLl9kYXRhLmNvbnRleHRtZW51LnZpc2libGUmJighYnx8K25ldyBEYXRlLWI+MjUwKSYmYS52YWthdGEuY29udGV4dC5oaWRlKCksYj0wfSx0aGlzKSkub24oXCJ0b3VjaHN0YXJ0LmpzdHJlZVwiLFwiLmpzdHJlZS1hbmNob3JcIixmdW5jdGlvbihiKXtiLm9yaWdpbmFsRXZlbnQmJmIub3JpZ2luYWxFdmVudC5jaGFuZ2VkVG91Y2hlcyYmYi5vcmlnaW5hbEV2ZW50LmNoYW5nZWRUb3VjaGVzWzBdJiYoZT1iLnBhZ2VYLGY9Yi5wYWdlWSxjPXNldFRpbWVvdXQoZnVuY3Rpb24oKXthKGIuY3VycmVudFRhcmdldCkudHJpZ2dlcihcImNvbnRleHRtZW51XCIsITApfSw3NTApKX0pLm9uKFwidG91Y2htb3ZlLnZha2F0YS5qc3RyZWVcIixmdW5jdGlvbihhKXtjJiZhLm9yaWdpbmFsRXZlbnQmJmEub3JpZ2luYWxFdmVudC5jaGFuZ2VkVG91Y2hlcyYmYS5vcmlnaW5hbEV2ZW50LmNoYW5nZWRUb3VjaGVzWzBdJiYoTWF0aC5hYnMoZS1hLnBhZ2VYKT41MHx8TWF0aC5hYnMoZi1hLnBhZ2VZKT41MCkmJmNsZWFyVGltZW91dChjKX0pLm9uKFwidG91Y2hlbmQudmFrYXRhLmpzdHJlZVwiLGZ1bmN0aW9uKGEpe2MmJmNsZWFyVGltZW91dChjKX0pLGEoaSkub24oXCJjb250ZXh0X2hpZGUudmFrYXRhLmpzdHJlZVwiLGEucHJveHkoZnVuY3Rpb24oYSxiKXt0aGlzLl9kYXRhLmNvbnRleHRtZW51LnZpc2libGU9ITEsYi5yZWZlcmVuY2UucmVtb3ZlQ2xhc3MoXCJqc3RyZWUtY29udGV4dFwiKX0sdGhpcykpfSx0aGlzLnRlYXJkb3duPWZ1bmN0aW9uKCl7dGhpcy5fZGF0YS5jb250ZXh0bWVudS52aXNpYmxlJiZhLnZha2F0YS5jb250ZXh0LmhpZGUoKSxkLnRlYXJkb3duLmNhbGwodGhpcyl9LHRoaXMuc2hvd19jb250ZXh0bWVudT1mdW5jdGlvbihjLGQsZSxmKXtpZihjPXRoaXMuZ2V0X25vZGUoYyksIWN8fGMuaWQ9PT1hLmpzdHJlZS5yb290KXJldHVybiExO3ZhciBnPXRoaXMuc2V0dGluZ3MuY29udGV4dG1lbnUsaD10aGlzLmdldF9ub2RlKGMsITApLGk9aC5jaGlsZHJlbihcIi5qc3RyZWUtYW5jaG9yXCIpLGo9ITEsaz0hMTsoZy5zaG93X2F0X25vZGV8fGQ9PT1ifHxlPT09YikmJihqPWkub2Zmc2V0KCksZD1qLmxlZnQsZT1qLnRvcCt0aGlzLl9kYXRhLmNvcmUubGlfaGVpZ2h0KSx0aGlzLnNldHRpbmdzLmNvbnRleHRtZW51LnNlbGVjdF9ub2RlJiYhdGhpcy5pc19zZWxlY3RlZChjKSYmdGhpcy5hY3RpdmF0ZV9ub2RlKGMsZiksaz1nLml0ZW1zLGEuaXNGdW5jdGlvbihrKSYmKGs9ay5jYWxsKHRoaXMsYyxhLnByb3h5KGZ1bmN0aW9uKGEpe3RoaXMuX3Nob3dfY29udGV4dG1lbnUoYyxkLGUsYSl9LHRoaXMpKSksYS5pc1BsYWluT2JqZWN0KGspJiZ0aGlzLl9zaG93X2NvbnRleHRtZW51KGMsZCxlLGspfSx0aGlzLl9zaG93X2NvbnRleHRtZW51PWZ1bmN0aW9uKGIsYyxkLGUpe3ZhciBmPXRoaXMuZ2V0X25vZGUoYiwhMCksZz1mLmNoaWxkcmVuKFwiLmpzdHJlZS1hbmNob3JcIik7YShpKS5vbmUoXCJjb250ZXh0X3Nob3cudmFrYXRhLmpzdHJlZVwiLGEucHJveHkoZnVuY3Rpb24oYixjKXt2YXIgZD1cImpzdHJlZS1jb250ZXh0bWVudSBqc3RyZWUtXCIrdGhpcy5nZXRfdGhlbWUoKStcIi1jb250ZXh0bWVudVwiO2EoYy5lbGVtZW50KS5hZGRDbGFzcyhkKSxnLmFkZENsYXNzKFwianN0cmVlLWNvbnRleHRcIil9LHRoaXMpKSx0aGlzLl9kYXRhLmNvbnRleHRtZW51LnZpc2libGU9ITAsYS52YWthdGEuY29udGV4dC5zaG93KGcse3g6Yyx5OmR9LGUpLHRoaXMudHJpZ2dlcihcInNob3dfY29udGV4dG1lbnVcIix7bm9kZTpiLHg6Yyx5OmR9KX19LGZ1bmN0aW9uKGEpe3ZhciBiPSExLGM9e2VsZW1lbnQ6ITEscmVmZXJlbmNlOiExLHBvc2l0aW9uX3g6MCxwb3NpdGlvbl95OjAsaXRlbXM6W10saHRtbDpcIlwiLGlzX3Zpc2libGU6ITF9O2EudmFrYXRhLmNvbnRleHQ9e3NldHRpbmdzOntoaWRlX29ubW91c2VsZWF2ZTowLGljb25zOiEwfSxfdHJpZ2dlcjpmdW5jdGlvbihiKXthKGkpLnRyaWdnZXJIYW5kbGVyKFwiY29udGV4dF9cIitiK1wiLnZha2F0YVwiLHtyZWZlcmVuY2U6Yy5yZWZlcmVuY2UsZWxlbWVudDpjLmVsZW1lbnQscG9zaXRpb246e3g6Yy5wb3NpdGlvbl94LHk6Yy5wb3NpdGlvbl95fX0pfSxfZXhlY3V0ZTpmdW5jdGlvbihiKXtyZXR1cm4gYj1jLml0ZW1zW2JdLGImJighYi5fZGlzYWJsZWR8fGEuaXNGdW5jdGlvbihiLl9kaXNhYmxlZCkmJiFiLl9kaXNhYmxlZCh7aXRlbTpiLHJlZmVyZW5jZTpjLnJlZmVyZW5jZSxlbGVtZW50OmMuZWxlbWVudH0pKSYmYi5hY3Rpb24/Yi5hY3Rpb24uY2FsbChudWxsLHtpdGVtOmIscmVmZXJlbmNlOmMucmVmZXJlbmNlLGVsZW1lbnQ6Yy5lbGVtZW50LHBvc2l0aW9uOnt4OmMucG9zaXRpb25feCx5OmMucG9zaXRpb25feX19KTohMX0sX3BhcnNlOmZ1bmN0aW9uKGIsZCl7aWYoIWIpcmV0dXJuITE7ZHx8KGMuaHRtbD1cIlwiLGMuaXRlbXM9W10pO3ZhciBlPVwiXCIsZj0hMSxnO3JldHVybiBkJiYoZSs9XCI8dWw+XCIpLGEuZWFjaChiLGZ1bmN0aW9uKGIsZCl7cmV0dXJuIGQ/KGMuaXRlbXMucHVzaChkKSwhZiYmZC5zZXBhcmF0b3JfYmVmb3JlJiYoZSs9XCI8bGkgY2xhc3M9J3Zha2F0YS1jb250ZXh0LXNlcGFyYXRvcic+PGEgaHJlZj0nIycgXCIrKGEudmFrYXRhLmNvbnRleHQuc2V0dGluZ3MuaWNvbnM/XCJcIjonc3R5bGU9XCJtYXJnaW4tbGVmdDowcHg7XCInKStcIj4mIzE2MDs8L2E+PC9saT5cIiksZj0hMSxlKz1cIjxsaSBjbGFzcz0nXCIrKGQuX2NsYXNzfHxcIlwiKSsoZC5fZGlzYWJsZWQ9PT0hMHx8YS5pc0Z1bmN0aW9uKGQuX2Rpc2FibGVkKSYmZC5fZGlzYWJsZWQoe2l0ZW06ZCxyZWZlcmVuY2U6Yy5yZWZlcmVuY2UsZWxlbWVudDpjLmVsZW1lbnR9KT9cIiB2YWthdGEtY29udGV4dG1lbnUtZGlzYWJsZWQgXCI6XCJcIikrXCInIFwiKyhkLnNob3J0Y3V0P1wiIGRhdGEtc2hvcnRjdXQ9J1wiK2Quc2hvcnRjdXQrXCInIFwiOlwiXCIpK1wiPlwiLGUrPVwiPGEgaHJlZj0nIycgcmVsPSdcIisoYy5pdGVtcy5sZW5ndGgtMSkrXCInPlwiLGEudmFrYXRhLmNvbnRleHQuc2V0dGluZ3MuaWNvbnMmJihlKz1cIjxpIFwiLGQuaWNvbiYmKGUrPS0xIT09ZC5pY29uLmluZGV4T2YoXCIvXCIpfHwtMSE9PWQuaWNvbi5pbmRleE9mKFwiLlwiKT9cIiBzdHlsZT0nYmFja2dyb3VuZDp1cmwoXFxcIlwiK2QuaWNvbitcIlxcXCIpIGNlbnRlciBjZW50ZXIgbm8tcmVwZWF0JyBcIjpcIiBjbGFzcz0nXCIrZC5pY29uK1wiJyBcIiksZSs9XCI+PC9pPjxzcGFuIGNsYXNzPSd2YWthdGEtY29udGV4dG1lbnUtc2VwJz4mIzE2MDs8L3NwYW4+XCIpLGUrPShhLmlzRnVuY3Rpb24oZC5sYWJlbCk/ZC5sYWJlbCh7aXRlbTpiLHJlZmVyZW5jZTpjLnJlZmVyZW5jZSxlbGVtZW50OmMuZWxlbWVudH0pOmQubGFiZWwpKyhkLnNob3J0Y3V0PycgPHNwYW4gY2xhc3M9XCJ2YWthdGEtY29udGV4dG1lbnUtc2hvcnRjdXQgdmFrYXRhLWNvbnRleHRtZW51LXNob3J0Y3V0LScrZC5zaG9ydGN1dCsnXCI+JysoZC5zaG9ydGN1dF9sYWJlbHx8XCJcIikrXCI8L3NwYW4+XCI6XCJcIikrXCI8L2E+XCIsZC5zdWJtZW51JiYoZz1hLnZha2F0YS5jb250ZXh0Ll9wYXJzZShkLnN1Ym1lbnUsITApLGcmJihlKz1nKSksZSs9XCI8L2xpPlwiLHZvaWQoZC5zZXBhcmF0b3JfYWZ0ZXImJihlKz1cIjxsaSBjbGFzcz0ndmFrYXRhLWNvbnRleHQtc2VwYXJhdG9yJz48YSBocmVmPScjJyBcIisoYS52YWthdGEuY29udGV4dC5zZXR0aW5ncy5pY29ucz9cIlwiOidzdHlsZT1cIm1hcmdpbi1sZWZ0OjBweDtcIicpK1wiPiYjMTYwOzwvYT48L2xpPlwiLGY9ITApKSk6ITB9KSxlPWUucmVwbGFjZSgvPGxpIGNsYXNzXFw9J3Zha2F0YS1jb250ZXh0LXNlcGFyYXRvcidcXD48XFwvbGlcXD4kLyxcIlwiKSxkJiYoZSs9XCI8L3VsPlwiKSxkfHwoYy5odG1sPWUsYS52YWthdGEuY29udGV4dC5fdHJpZ2dlcihcInBhcnNlXCIpKSxlLmxlbmd0aD4xMD9lOiExfSxfc2hvd19zdWJtZW51OmZ1bmN0aW9uKGMpe2lmKGM9YShjKSxjLmxlbmd0aCYmYy5jaGlsZHJlbihcInVsXCIpLmxlbmd0aCl7dmFyIGQ9Yy5jaGlsZHJlbihcInVsXCIpLGU9Yy5vZmZzZXQoKS5sZWZ0LGY9ZStjLm91dGVyV2lkdGgoKSxnPWMub2Zmc2V0KCkudG9wLGg9ZC53aWR0aCgpLGk9ZC5oZWlnaHQoKSxqPWEod2luZG93KS53aWR0aCgpK2Eod2luZG93KS5zY3JvbGxMZWZ0KCksaz1hKHdpbmRvdykuaGVpZ2h0KCkrYSh3aW5kb3cpLnNjcm9sbFRvcCgpO2I/Y1tmLShoKzEwK2Mub3V0ZXJXaWR0aCgpKTwwP1wiYWRkQ2xhc3NcIjpcInJlbW92ZUNsYXNzXCJdKFwidmFrYXRhLWNvbnRleHQtbGVmdFwiKTpjW2YraD5qJiZlPmotZj9cImFkZENsYXNzXCI6XCJyZW1vdmVDbGFzc1wiXShcInZha2F0YS1jb250ZXh0LXJpZ2h0XCIpLGcraSsxMD5rJiZkLmNzcyhcImJvdHRvbVwiLFwiLTFweFwiKSxjLmhhc0NsYXNzKFwidmFrYXRhLWNvbnRleHQtcmlnaHRcIik/aD5lJiZkLmNzcyhcIm1hcmdpbi1yaWdodFwiLGUtaCk6aD5qLWYmJmQuY3NzKFwibWFyZ2luLWxlZnRcIixqLWYtaCksZC5zaG93KCl9fSxzaG93OmZ1bmN0aW9uKGQsZSxmKXt2YXIgZyxoLGksaixrLGwsbSxuLG89ITA7c3dpdGNoKGMuZWxlbWVudCYmYy5lbGVtZW50Lmxlbmd0aCYmYy5lbGVtZW50LndpZHRoKFwiXCIpLG8pe2Nhc2UhZSYmIWQ6cmV0dXJuITE7Y2FzZSEhZSYmISFkOmMucmVmZXJlbmNlPWQsYy5wb3NpdGlvbl94PWUueCxjLnBvc2l0aW9uX3k9ZS55O2JyZWFrO2Nhc2UhZSYmISFkOmMucmVmZXJlbmNlPWQsZz1kLm9mZnNldCgpLGMucG9zaXRpb25feD1nLmxlZnQrZC5vdXRlckhlaWdodCgpLGMucG9zaXRpb25feT1nLnRvcDticmVhaztjYXNlISFlJiYhZDpjLnBvc2l0aW9uX3g9ZS54LGMucG9zaXRpb25feT1lLnl9ZCYmIWYmJmEoZCkuZGF0YShcInZha2F0YV9jb250ZXh0bWVudVwiKSYmKGY9YShkKS5kYXRhKFwidmFrYXRhX2NvbnRleHRtZW51XCIpKSxhLnZha2F0YS5jb250ZXh0Ll9wYXJzZShmKSYmYy5lbGVtZW50Lmh0bWwoYy5odG1sKSxjLml0ZW1zLmxlbmd0aCYmKGMuZWxlbWVudC5hcHBlbmRUbyhcImJvZHlcIiksaD1jLmVsZW1lbnQsaT1jLnBvc2l0aW9uX3gsaj1jLnBvc2l0aW9uX3ksaz1oLndpZHRoKCksbD1oLmhlaWdodCgpLG09YSh3aW5kb3cpLndpZHRoKCkrYSh3aW5kb3cpLnNjcm9sbExlZnQoKSxuPWEod2luZG93KS5oZWlnaHQoKSthKHdpbmRvdykuc2Nyb2xsVG9wKCksYiYmKGktPWgub3V0ZXJXaWR0aCgpLWEoZCkub3V0ZXJXaWR0aCgpLGk8YSh3aW5kb3cpLnNjcm9sbExlZnQoKSsyMCYmKGk9YSh3aW5kb3cpLnNjcm9sbExlZnQoKSsyMCkpLGkraysyMD5tJiYoaT1tLShrKzIwKSksaitsKzIwPm4mJihqPW4tKGwrMjApKSxjLmVsZW1lbnQuY3NzKHtsZWZ0OmksdG9wOmp9KS5zaG93KCkuZmluZChcImFcIikuZmlyc3QoKS5mb2N1cygpLnBhcmVudCgpLmFkZENsYXNzKFwidmFrYXRhLWNvbnRleHQtaG92ZXJcIiksYy5pc192aXNpYmxlPSEwLGEudmFrYXRhLmNvbnRleHQuX3RyaWdnZXIoXCJzaG93XCIpKX0saGlkZTpmdW5jdGlvbigpe2MuaXNfdmlzaWJsZSYmKGMuZWxlbWVudC5oaWRlKCkuZmluZChcInVsXCIpLmhpZGUoKS5lbmQoKS5maW5kKFwiOmZvY3VzXCIpLmJsdXIoKS5lbmQoKS5kZXRhY2goKSxjLmlzX3Zpc2libGU9ITEsYS52YWthdGEuY29udGV4dC5fdHJpZ2dlcihcImhpZGVcIikpfX0sYShmdW5jdGlvbigpe2I9XCJydGxcIj09PWEoXCJib2R5XCIpLmNzcyhcImRpcmVjdGlvblwiKTt2YXIgZD0hMTtjLmVsZW1lbnQ9YShcIjx1bCBjbGFzcz0ndmFrYXRhLWNvbnRleHQnPjwvdWw+XCIpLGMuZWxlbWVudC5vbihcIm1vdXNlZW50ZXJcIixcImxpXCIsZnVuY3Rpb24oYil7Yi5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24oKSxhLmNvbnRhaW5zKHRoaXMsYi5yZWxhdGVkVGFyZ2V0KXx8KGQmJmNsZWFyVGltZW91dChkKSxjLmVsZW1lbnQuZmluZChcIi52YWthdGEtY29udGV4dC1ob3ZlclwiKS5yZW1vdmVDbGFzcyhcInZha2F0YS1jb250ZXh0LWhvdmVyXCIpLmVuZCgpLGEodGhpcykuc2libGluZ3MoKS5maW5kKFwidWxcIikuaGlkZSgpLmVuZCgpLmVuZCgpLnBhcmVudHNVbnRpbChcIi52YWthdGEtY29udGV4dFwiLFwibGlcIikuYWRkQmFjaygpLmFkZENsYXNzKFwidmFrYXRhLWNvbnRleHQtaG92ZXJcIiksYS52YWthdGEuY29udGV4dC5fc2hvd19zdWJtZW51KHRoaXMpKX0pLm9uKFwibW91c2VsZWF2ZVwiLFwibGlcIixmdW5jdGlvbihiKXthLmNvbnRhaW5zKHRoaXMsYi5yZWxhdGVkVGFyZ2V0KXx8YSh0aGlzKS5maW5kKFwiLnZha2F0YS1jb250ZXh0LWhvdmVyXCIpLmFkZEJhY2soKS5yZW1vdmVDbGFzcyhcInZha2F0YS1jb250ZXh0LWhvdmVyXCIpfSkub24oXCJtb3VzZWxlYXZlXCIsZnVuY3Rpb24oYil7YSh0aGlzKS5maW5kKFwiLnZha2F0YS1jb250ZXh0LWhvdmVyXCIpLnJlbW92ZUNsYXNzKFwidmFrYXRhLWNvbnRleHQtaG92ZXJcIiksYS52YWthdGEuY29udGV4dC5zZXR0aW5ncy5oaWRlX29ubW91c2VsZWF2ZSYmKGQ9c2V0VGltZW91dChmdW5jdGlvbihiKXtyZXR1cm4gZnVuY3Rpb24oKXthLnZha2F0YS5jb250ZXh0LmhpZGUoKX19KHRoaXMpLGEudmFrYXRhLmNvbnRleHQuc2V0dGluZ3MuaGlkZV9vbm1vdXNlbGVhdmUpKX0pLm9uKFwiY2xpY2tcIixcImFcIixmdW5jdGlvbihiKXtiLnByZXZlbnREZWZhdWx0KCksYSh0aGlzKS5ibHVyKCkucGFyZW50KCkuaGFzQ2xhc3MoXCJ2YWthdGEtY29udGV4dC1kaXNhYmxlZFwiKXx8YS52YWthdGEuY29udGV4dC5fZXhlY3V0ZShhKHRoaXMpLmF0dHIoXCJyZWxcIikpPT09ITF8fGEudmFrYXRhLmNvbnRleHQuaGlkZSgpfSkub24oXCJrZXlkb3duXCIsXCJhXCIsZnVuY3Rpb24oYil7dmFyIGQ9bnVsbDtzd2l0Y2goYi53aGljaCl7Y2FzZSAxMzpjYXNlIDMyOmIudHlwZT1cIm1vdXNldXBcIixiLnByZXZlbnREZWZhdWx0KCksYShiLmN1cnJlbnRUYXJnZXQpLnRyaWdnZXIoYik7YnJlYWs7Y2FzZSAzNzpjLmlzX3Zpc2libGUmJihjLmVsZW1lbnQuZmluZChcIi52YWthdGEtY29udGV4dC1ob3ZlclwiKS5sYXN0KCkuY2xvc2VzdChcImxpXCIpLmZpcnN0KCkuZmluZChcInVsXCIpLmhpZGUoKS5maW5kKFwiLnZha2F0YS1jb250ZXh0LWhvdmVyXCIpLnJlbW92ZUNsYXNzKFwidmFrYXRhLWNvbnRleHQtaG92ZXJcIikuZW5kKCkuZW5kKCkuY2hpbGRyZW4oXCJhXCIpLmZvY3VzKCksYi5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24oKSxiLnByZXZlbnREZWZhdWx0KCkpO2JyZWFrO2Nhc2UgMzg6Yy5pc192aXNpYmxlJiYoZD1jLmVsZW1lbnQuZmluZChcInVsOnZpc2libGVcIikuYWRkQmFjaygpLmxhc3QoKS5jaGlsZHJlbihcIi52YWthdGEtY29udGV4dC1ob3ZlclwiKS5yZW1vdmVDbGFzcyhcInZha2F0YS1jb250ZXh0LWhvdmVyXCIpLnByZXZBbGwoXCJsaTpub3QoLnZha2F0YS1jb250ZXh0LXNlcGFyYXRvcilcIikuZmlyc3QoKSxkLmxlbmd0aHx8KGQ9Yy5lbGVtZW50LmZpbmQoXCJ1bDp2aXNpYmxlXCIpLmFkZEJhY2soKS5sYXN0KCkuY2hpbGRyZW4oXCJsaTpub3QoLnZha2F0YS1jb250ZXh0LXNlcGFyYXRvcilcIikubGFzdCgpKSxkLmFkZENsYXNzKFwidmFrYXRhLWNvbnRleHQtaG92ZXJcIikuY2hpbGRyZW4oXCJhXCIpLmZvY3VzKCksYi5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24oKSxiLnByZXZlbnREZWZhdWx0KCkpO2JyZWFrO2Nhc2UgMzk6Yy5pc192aXNpYmxlJiYoYy5lbGVtZW50LmZpbmQoXCIudmFrYXRhLWNvbnRleHQtaG92ZXJcIikubGFzdCgpLmNoaWxkcmVuKFwidWxcIikuc2hvdygpLmNoaWxkcmVuKFwibGk6bm90KC52YWthdGEtY29udGV4dC1zZXBhcmF0b3IpXCIpLnJlbW92ZUNsYXNzKFwidmFrYXRhLWNvbnRleHQtaG92ZXJcIikuZmlyc3QoKS5hZGRDbGFzcyhcInZha2F0YS1jb250ZXh0LWhvdmVyXCIpLmNoaWxkcmVuKFwiYVwiKS5mb2N1cygpLGIuc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKCksYi5wcmV2ZW50RGVmYXVsdCgpKTticmVhaztjYXNlIDQwOmMuaXNfdmlzaWJsZSYmKGQ9Yy5lbGVtZW50LmZpbmQoXCJ1bDp2aXNpYmxlXCIpLmFkZEJhY2soKS5sYXN0KCkuY2hpbGRyZW4oXCIudmFrYXRhLWNvbnRleHQtaG92ZXJcIikucmVtb3ZlQ2xhc3MoXCJ2YWthdGEtY29udGV4dC1ob3ZlclwiKS5uZXh0QWxsKFwibGk6bm90KC52YWthdGEtY29udGV4dC1zZXBhcmF0b3IpXCIpLmZpcnN0KCksZC5sZW5ndGh8fChkPWMuZWxlbWVudC5maW5kKFwidWw6dmlzaWJsZVwiKS5hZGRCYWNrKCkubGFzdCgpLmNoaWxkcmVuKFwibGk6bm90KC52YWthdGEtY29udGV4dC1zZXBhcmF0b3IpXCIpLmZpcnN0KCkpLGQuYWRkQ2xhc3MoXCJ2YWthdGEtY29udGV4dC1ob3ZlclwiKS5jaGlsZHJlbihcImFcIikuZm9jdXMoKSxiLnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbigpLGIucHJldmVudERlZmF1bHQoKSk7YnJlYWs7Y2FzZSAyNzphLnZha2F0YS5jb250ZXh0LmhpZGUoKSxiLnByZXZlbnREZWZhdWx0KCl9fSkub24oXCJrZXlkb3duXCIsZnVuY3Rpb24oYSl7YS5wcmV2ZW50RGVmYXVsdCgpO3ZhciBiPWMuZWxlbWVudC5maW5kKFwiLnZha2F0YS1jb250ZXh0bWVudS1zaG9ydGN1dC1cIithLndoaWNoKS5wYXJlbnQoKTtiLnBhcmVudCgpLm5vdChcIi52YWthdGEtY29udGV4dC1kaXNhYmxlZFwiKSYmYi5jbGljaygpfSksYShpKS5vbihcIm1vdXNlZG93bi52YWthdGEuanN0cmVlXCIsZnVuY3Rpb24oYil7Yy5pc192aXNpYmxlJiYhYS5jb250YWlucyhjLmVsZW1lbnRbMF0sYi50YXJnZXQpJiZhLnZha2F0YS5jb250ZXh0LmhpZGUoKTtcbn0pLm9uKFwiY29udGV4dF9zaG93LnZha2F0YS5qc3RyZWVcIixmdW5jdGlvbihhLGQpe2MuZWxlbWVudC5maW5kKFwibGk6aGFzKHVsKVwiKS5jaGlsZHJlbihcImFcIikuYWRkQ2xhc3MoXCJ2YWthdGEtY29udGV4dC1wYXJlbnRcIiksYiYmYy5lbGVtZW50LmFkZENsYXNzKFwidmFrYXRhLWNvbnRleHQtcnRsXCIpLmNzcyhcImRpcmVjdGlvblwiLFwicnRsXCIpLGMuZWxlbWVudC5maW5kKFwidWxcIikuaGlkZSgpLmVuZCgpfSl9KX0oYSksYS5qc3RyZWUuZGVmYXVsdHMuZG5kPXtjb3B5OiEwLG9wZW5fdGltZW91dDo1MDAsaXNfZHJhZ2dhYmxlOiEwLGNoZWNrX3doaWxlX2RyYWdnaW5nOiEwLGFsd2F5c19jb3B5OiExLGluc2lkZV9wb3M6MCxkcmFnX3NlbGVjdGlvbjohMCx0b3VjaDohMCxsYXJnZV9kcm9wX3RhcmdldDohMSxsYXJnZV9kcmFnX3RhcmdldDohMSx1c2VfaHRtbDU6ITF9O3ZhciBuLG87YS5qc3RyZWUucGx1Z2lucy5kbmQ9ZnVuY3Rpb24oYixjKXt0aGlzLmluaXQ9ZnVuY3Rpb24oYSxiKXtjLmluaXQuY2FsbCh0aGlzLGEsYiksdGhpcy5zZXR0aW5ncy5kbmQudXNlX2h0bWw1PXRoaXMuc2V0dGluZ3MuZG5kLnVzZV9odG1sNSYmXCJkcmFnZ2FibGVcImluIGkuY3JlYXRlRWxlbWVudChcInNwYW5cIil9LHRoaXMuYmluZD1mdW5jdGlvbigpe2MuYmluZC5jYWxsKHRoaXMpLHRoaXMuZWxlbWVudC5vbih0aGlzLnNldHRpbmdzLmRuZC51c2VfaHRtbDU/XCJkcmFnc3RhcnQuanN0cmVlXCI6XCJtb3VzZWRvd24uanN0cmVlIHRvdWNoc3RhcnQuanN0cmVlXCIsdGhpcy5zZXR0aW5ncy5kbmQubGFyZ2VfZHJhZ190YXJnZXQ/XCIuanN0cmVlLW5vZGVcIjpcIi5qc3RyZWUtYW5jaG9yXCIsYS5wcm94eShmdW5jdGlvbihiKXtpZih0aGlzLnNldHRpbmdzLmRuZC5sYXJnZV9kcmFnX3RhcmdldCYmYShiLnRhcmdldCkuY2xvc2VzdChcIi5qc3RyZWUtbm9kZVwiKVswXSE9PWIuY3VycmVudFRhcmdldClyZXR1cm4hMDtpZihcInRvdWNoc3RhcnRcIj09PWIudHlwZSYmKCF0aGlzLnNldHRpbmdzLmRuZC50b3VjaHx8XCJzZWxlY3RlZFwiPT09dGhpcy5zZXR0aW5ncy5kbmQudG91Y2gmJiFhKGIuY3VycmVudFRhcmdldCkuY2xvc2VzdChcIi5qc3RyZWUtbm9kZVwiKS5jaGlsZHJlbihcIi5qc3RyZWUtYW5jaG9yXCIpLmhhc0NsYXNzKFwianN0cmVlLWNsaWNrZWRcIikpKXJldHVybiEwO3ZhciBjPXRoaXMuZ2V0X25vZGUoYi50YXJnZXQpLGQ9dGhpcy5pc19zZWxlY3RlZChjKSYmdGhpcy5zZXR0aW5ncy5kbmQuZHJhZ19zZWxlY3Rpb24/dGhpcy5nZXRfdG9wX3NlbGVjdGVkKCkubGVuZ3RoOjEsZT1kPjE/ZCtcIiBcIit0aGlzLmdldF9zdHJpbmcoXCJub2Rlc1wiKTp0aGlzLmdldF90ZXh0KGIuY3VycmVudFRhcmdldCk7aWYodGhpcy5zZXR0aW5ncy5jb3JlLmZvcmNlX3RleHQmJihlPWEudmFrYXRhLmh0bWwuZXNjYXBlKGUpKSxjJiZjLmlkJiZjLmlkIT09YS5qc3RyZWUucm9vdCYmKDE9PT1iLndoaWNofHxcInRvdWNoc3RhcnRcIj09PWIudHlwZXx8XCJkcmFnc3RhcnRcIj09PWIudHlwZSkmJih0aGlzLnNldHRpbmdzLmRuZC5pc19kcmFnZ2FibGU9PT0hMHx8YS5pc0Z1bmN0aW9uKHRoaXMuc2V0dGluZ3MuZG5kLmlzX2RyYWdnYWJsZSkmJnRoaXMuc2V0dGluZ3MuZG5kLmlzX2RyYWdnYWJsZS5jYWxsKHRoaXMsZD4xP3RoaXMuZ2V0X3RvcF9zZWxlY3RlZCghMCk6W2NdLGIpKSl7aWYobj17anN0cmVlOiEwLG9yaWdpbjp0aGlzLG9iajp0aGlzLmdldF9ub2RlKGMsITApLG5vZGVzOmQ+MT90aGlzLmdldF90b3Bfc2VsZWN0ZWQoKTpbYy5pZF19LG89Yi5jdXJyZW50VGFyZ2V0LCF0aGlzLnNldHRpbmdzLmRuZC51c2VfaHRtbDUpcmV0dXJuIHRoaXMuZWxlbWVudC50cmlnZ2VyKFwibW91c2Vkb3duLmpzdHJlZVwiKSxhLnZha2F0YS5kbmQuc3RhcnQoYixuLCc8ZGl2IGlkPVwianN0cmVlLWRuZFwiIGNsYXNzPVwianN0cmVlLScrdGhpcy5nZXRfdGhlbWUoKStcIiBqc3RyZWUtXCIrdGhpcy5nZXRfdGhlbWUoKStcIi1cIit0aGlzLmdldF90aGVtZV92YXJpYW50KCkrXCIgXCIrKHRoaXMuc2V0dGluZ3MuY29yZS50aGVtZXMucmVzcG9uc2l2ZT9cIiBqc3RyZWUtZG5kLXJlc3BvbnNpdmVcIjpcIlwiKSsnXCI+PGkgY2xhc3M9XCJqc3RyZWUtaWNvbiBqc3RyZWUtZXJcIj48L2k+JytlKyc8aW5zIGNsYXNzPVwianN0cmVlLWNvcHlcIiBzdHlsZT1cImRpc3BsYXk6bm9uZTtcIj4rPC9pbnM+PC9kaXY+Jyk7YS52YWthdGEuZG5kLl90cmlnZ2VyKFwic3RhcnRcIixiLHtoZWxwZXI6YSgpLGVsZW1lbnQ6byxkYXRhOm59KX19LHRoaXMpKSx0aGlzLnNldHRpbmdzLmRuZC51c2VfaHRtbDUmJnRoaXMuZWxlbWVudC5vbihcImRyYWdvdmVyLmpzdHJlZVwiLGZ1bmN0aW9uKGIpe3JldHVybiBiLnByZXZlbnREZWZhdWx0KCksYS52YWthdGEuZG5kLl90cmlnZ2VyKFwibW92ZVwiLGIse2hlbHBlcjphKCksZWxlbWVudDpvLGRhdGE6bn0pLCExfSkub24oXCJkcm9wLmpzdHJlZVwiLGEucHJveHkoZnVuY3Rpb24oYil7cmV0dXJuIGIucHJldmVudERlZmF1bHQoKSxhLnZha2F0YS5kbmQuX3RyaWdnZXIoXCJzdG9wXCIsYix7aGVscGVyOmEoKSxlbGVtZW50Om8sZGF0YTpufSksITF9LHRoaXMpKX0sdGhpcy5yZWRyYXdfbm9kZT1mdW5jdGlvbihhLGIsZCxlKXtpZihhPWMucmVkcmF3X25vZGUuYXBwbHkodGhpcyxhcmd1bWVudHMpLGEmJnRoaXMuc2V0dGluZ3MuZG5kLnVzZV9odG1sNSlpZih0aGlzLnNldHRpbmdzLmRuZC5sYXJnZV9kcmFnX3RhcmdldClhLnNldEF0dHJpYnV0ZShcImRyYWdnYWJsZVwiLCEwKTtlbHNle3ZhciBmLGcsaD1udWxsO2ZvcihmPTAsZz1hLmNoaWxkTm9kZXMubGVuZ3RoO2c+ZjtmKyspaWYoYS5jaGlsZE5vZGVzW2ZdJiZhLmNoaWxkTm9kZXNbZl0uY2xhc3NOYW1lJiYtMSE9PWEuY2hpbGROb2Rlc1tmXS5jbGFzc05hbWUuaW5kZXhPZihcImpzdHJlZS1hbmNob3JcIikpe2g9YS5jaGlsZE5vZGVzW2ZdO2JyZWFrfWgmJmguc2V0QXR0cmlidXRlKFwiZHJhZ2dhYmxlXCIsITApfXJldHVybiBhfX0sYShmdW5jdGlvbigpe3ZhciBjPSExLGQ9ITEsZT0hMSxmPSExLGc9YSgnPGRpdiBpZD1cImpzdHJlZS1tYXJrZXJcIj4mIzE2MDs8L2Rpdj4nKS5oaWRlKCk7YShpKS5vbihcImRuZF9zdGFydC52YWthdGEuanN0cmVlXCIsZnVuY3Rpb24oYSxiKXtjPSExLGU9ITEsYiYmYi5kYXRhJiZiLmRhdGEuanN0cmVlJiZnLmFwcGVuZFRvKFwiYm9keVwiKX0pLm9uKFwiZG5kX21vdmUudmFrYXRhLmpzdHJlZVwiLGZ1bmN0aW9uKGgsaSl7aWYoZiYmKGkuZXZlbnQmJlwiZHJhZ292ZXJcIj09PWkuZXZlbnQudHlwZSYmaS5ldmVudC50YXJnZXQ9PT1lLnRhcmdldHx8Y2xlYXJUaW1lb3V0KGYpKSxpJiZpLmRhdGEmJmkuZGF0YS5qc3RyZWUmJighaS5ldmVudC50YXJnZXQuaWR8fFwianN0cmVlLW1hcmtlclwiIT09aS5ldmVudC50YXJnZXQuaWQpKXtlPWkuZXZlbnQ7dmFyIGo9YS5qc3RyZWUucmVmZXJlbmNlKGkuZXZlbnQudGFyZ2V0KSxrPSExLGw9ITEsbT0hMSxuLG8scCxxLHIscyx0LHUsdix3LHgseSx6LEEsQixDO2lmKGomJmouX2RhdGEmJmouX2RhdGEuZG5kKWlmKGcuYXR0cihcImNsYXNzXCIsXCJqc3RyZWUtXCIrai5nZXRfdGhlbWUoKSsoai5zZXR0aW5ncy5jb3JlLnRoZW1lcy5yZXNwb25zaXZlP1wiIGpzdHJlZS1kbmQtcmVzcG9uc2l2ZVwiOlwiXCIpKSxDPWkuZGF0YS5vcmlnaW4mJihpLmRhdGEub3JpZ2luLnNldHRpbmdzLmRuZC5hbHdheXNfY29weXx8aS5kYXRhLm9yaWdpbi5zZXR0aW5ncy5kbmQuY29weSYmKGkuZXZlbnQubWV0YUtleXx8aS5ldmVudC5jdHJsS2V5KSksaS5oZWxwZXIuY2hpbGRyZW4oKS5hdHRyKFwiY2xhc3NcIixcImpzdHJlZS1cIitqLmdldF90aGVtZSgpK1wiIGpzdHJlZS1cIitqLmdldF90aGVtZSgpK1wiLVwiK2ouZ2V0X3RoZW1lX3ZhcmlhbnQoKStcIiBcIisoai5zZXR0aW5ncy5jb3JlLnRoZW1lcy5yZXNwb25zaXZlP1wiIGpzdHJlZS1kbmQtcmVzcG9uc2l2ZVwiOlwiXCIpKS5maW5kKFwiLmpzdHJlZS1jb3B5XCIpLmZpcnN0KClbQz9cInNob3dcIjpcImhpZGVcIl0oKSxpLmV2ZW50LnRhcmdldCE9PWouZWxlbWVudFswXSYmaS5ldmVudC50YXJnZXQhPT1qLmdldF9jb250YWluZXJfdWwoKVswXXx8MCE9PWouZ2V0X2NvbnRhaW5lcl91bCgpLmNoaWxkcmVuKCkubGVuZ3RoKXtpZihrPWouc2V0dGluZ3MuZG5kLmxhcmdlX2Ryb3BfdGFyZ2V0P2EoaS5ldmVudC50YXJnZXQpLmNsb3Nlc3QoXCIuanN0cmVlLW5vZGVcIikuY2hpbGRyZW4oXCIuanN0cmVlLWFuY2hvclwiKTphKGkuZXZlbnQudGFyZ2V0KS5jbG9zZXN0KFwiLmpzdHJlZS1hbmNob3JcIiksayYmay5sZW5ndGgmJmsucGFyZW50KCkuaXMoXCIuanN0cmVlLWNsb3NlZCwgLmpzdHJlZS1vcGVuLCAuanN0cmVlLWxlYWZcIikmJihsPWsub2Zmc2V0KCksbT0oaS5ldmVudC5wYWdlWSE9PWI/aS5ldmVudC5wYWdlWTppLmV2ZW50Lm9yaWdpbmFsRXZlbnQucGFnZVkpLWwudG9wLHE9ay5vdXRlckhlaWdodCgpLHQ9cS8zPm0/W1wiYlwiLFwiaVwiLFwiYVwiXTptPnEtcS8zP1tcImFcIixcImlcIixcImJcIl06bT5xLzI/W1wiaVwiLFwiYVwiLFwiYlwiXTpbXCJpXCIsXCJiXCIsXCJhXCJdLGEuZWFjaCh0LGZ1bmN0aW9uKGIsZSl7c3dpdGNoKGUpe2Nhc2VcImJcIjpvPWwubGVmdC02LHA9bC50b3Ascj1qLmdldF9wYXJlbnQoaykscz1rLnBhcmVudCgpLmluZGV4KCk7YnJlYWs7Y2FzZVwiaVwiOkE9ai5zZXR0aW5ncy5kbmQuaW5zaWRlX3BvcyxCPWouZ2V0X25vZGUoay5wYXJlbnQoKSksbz1sLmxlZnQtMixwPWwudG9wK3EvMisxLHI9Qi5pZCxzPVwiZmlyc3RcIj09PUE/MDpcImxhc3RcIj09PUE/Qi5jaGlsZHJlbi5sZW5ndGg6TWF0aC5taW4oQSxCLmNoaWxkcmVuLmxlbmd0aCk7YnJlYWs7Y2FzZVwiYVwiOm89bC5sZWZ0LTYscD1sLnRvcCtxLHI9ai5nZXRfcGFyZW50KGspLHM9ay5wYXJlbnQoKS5pbmRleCgpKzF9Zm9yKHU9ITAsdj0wLHc9aS5kYXRhLm5vZGVzLmxlbmd0aDt3PnY7disrKWlmKHg9aS5kYXRhLm9yaWdpbiYmKGkuZGF0YS5vcmlnaW4uc2V0dGluZ3MuZG5kLmFsd2F5c19jb3B5fHxpLmRhdGEub3JpZ2luLnNldHRpbmdzLmRuZC5jb3B5JiYoaS5ldmVudC5tZXRhS2V5fHxpLmV2ZW50LmN0cmxLZXkpKT9cImNvcHlfbm9kZVwiOlwibW92ZV9ub2RlXCIseT1zLFwibW92ZV9ub2RlXCI9PT14JiZcImFcIj09PWUmJmkuZGF0YS5vcmlnaW4mJmkuZGF0YS5vcmlnaW49PT1qJiZyPT09ai5nZXRfcGFyZW50KGkuZGF0YS5ub2Rlc1t2XSkmJih6PWouZ2V0X25vZGUocikseT5hLmluQXJyYXkoaS5kYXRhLm5vZGVzW3ZdLHouY2hpbGRyZW4pJiYoeS09MSkpLHU9dSYmKGomJmouc2V0dGluZ3MmJmouc2V0dGluZ3MuZG5kJiZqLnNldHRpbmdzLmRuZC5jaGVja193aGlsZV9kcmFnZ2luZz09PSExfHxqLmNoZWNrKHgsaS5kYXRhLm9yaWdpbiYmaS5kYXRhLm9yaWdpbiE9PWo/aS5kYXRhLm9yaWdpbi5nZXRfbm9kZShpLmRhdGEubm9kZXNbdl0pOmkuZGF0YS5ub2Rlc1t2XSxyLHkse2RuZDohMCxyZWY6ai5nZXRfbm9kZShrLnBhcmVudCgpKSxwb3M6ZSxvcmlnaW46aS5kYXRhLm9yaWdpbixpc19tdWx0aTppLmRhdGEub3JpZ2luJiZpLmRhdGEub3JpZ2luIT09aixpc19mb3JlaWduOiFpLmRhdGEub3JpZ2lufSkpLCF1KXtqJiZqLmxhc3RfZXJyb3ImJihkPWoubGFzdF9lcnJvcigpKTticmVha31yZXR1cm5cImlcIj09PWUmJmsucGFyZW50KCkuaXMoXCIuanN0cmVlLWNsb3NlZFwiKSYmai5zZXR0aW5ncy5kbmQub3Blbl90aW1lb3V0JiYoZj1zZXRUaW1lb3V0KGZ1bmN0aW9uKGEsYil7cmV0dXJuIGZ1bmN0aW9uKCl7YS5vcGVuX25vZGUoYil9fShqLGspLGouc2V0dGluZ3MuZG5kLm9wZW5fdGltZW91dCkpLHU/KGM9e2luczpqLHBhcjpyLHBvczpcImlcIiE9PWV8fFwibGFzdFwiIT09QXx8MCE9PXN8fGouaXNfbG9hZGVkKEIpP3M6XCJsYXN0XCJ9LGcuY3NzKHtsZWZ0Om8rXCJweFwiLHRvcDpwK1wicHhcIn0pLnNob3coKSxpLmhlbHBlci5maW5kKFwiLmpzdHJlZS1pY29uXCIpLmZpcnN0KCkucmVtb3ZlQ2xhc3MoXCJqc3RyZWUtZXJcIikuYWRkQ2xhc3MoXCJqc3RyZWUtb2tcIiksaS5ldmVudC5vcmlnaW5hbEV2ZW50JiZpLmV2ZW50Lm9yaWdpbmFsRXZlbnQuZGF0YVRyYW5zZmVyJiYoaS5ldmVudC5vcmlnaW5hbEV2ZW50LmRhdGFUcmFuc2Zlci5kcm9wRWZmZWN0PUM/XCJjb3B5XCI6XCJtb3ZlXCIpLGQ9e30sdD0hMCwhMSk6dm9pZCAwfSksdD09PSEwKSlyZXR1cm59ZWxzZXtmb3IodT0hMCx2PTAsdz1pLmRhdGEubm9kZXMubGVuZ3RoO3c+djt2KyspaWYodT11JiZqLmNoZWNrKGkuZGF0YS5vcmlnaW4mJihpLmRhdGEub3JpZ2luLnNldHRpbmdzLmRuZC5hbHdheXNfY29weXx8aS5kYXRhLm9yaWdpbi5zZXR0aW5ncy5kbmQuY29weSYmKGkuZXZlbnQubWV0YUtleXx8aS5ldmVudC5jdHJsS2V5KSk/XCJjb3B5X25vZGVcIjpcIm1vdmVfbm9kZVwiLGkuZGF0YS5vcmlnaW4mJmkuZGF0YS5vcmlnaW4hPT1qP2kuZGF0YS5vcmlnaW4uZ2V0X25vZGUoaS5kYXRhLm5vZGVzW3ZdKTppLmRhdGEubm9kZXNbdl0sYS5qc3RyZWUucm9vdCxcImxhc3RcIix7ZG5kOiEwLHJlZjpqLmdldF9ub2RlKGEuanN0cmVlLnJvb3QpLHBvczpcImlcIixvcmlnaW46aS5kYXRhLm9yaWdpbixpc19tdWx0aTppLmRhdGEub3JpZ2luJiZpLmRhdGEub3JpZ2luIT09aixpc19mb3JlaWduOiFpLmRhdGEub3JpZ2lufSksIXUpYnJlYWs7aWYodSlyZXR1cm4gYz17aW5zOmoscGFyOmEuanN0cmVlLnJvb3QscG9zOlwibGFzdFwifSxnLmhpZGUoKSxpLmhlbHBlci5maW5kKFwiLmpzdHJlZS1pY29uXCIpLmZpcnN0KCkucmVtb3ZlQ2xhc3MoXCJqc3RyZWUtZXJcIikuYWRkQ2xhc3MoXCJqc3RyZWUtb2tcIiksdm9pZChpLmV2ZW50Lm9yaWdpbmFsRXZlbnQmJmkuZXZlbnQub3JpZ2luYWxFdmVudC5kYXRhVHJhbnNmZXImJihpLmV2ZW50Lm9yaWdpbmFsRXZlbnQuZGF0YVRyYW5zZmVyLmRyb3BFZmZlY3Q9Qz9cImNvcHlcIjpcIm1vdmVcIikpfWM9ITEsaS5oZWxwZXIuZmluZChcIi5qc3RyZWUtaWNvblwiKS5yZW1vdmVDbGFzcyhcImpzdHJlZS1va1wiKS5hZGRDbGFzcyhcImpzdHJlZS1lclwiKSxpLmV2ZW50Lm9yaWdpbmFsRXZlbnQmJmkuZXZlbnQub3JpZ2luYWxFdmVudC5kYXRhVHJhbnNmZXImJihpLmV2ZW50Lm9yaWdpbmFsRXZlbnQuZGF0YVRyYW5zZmVyLmRyb3BFZmZlY3Q9XCJub25lXCIpLGcuaGlkZSgpfX0pLm9uKFwiZG5kX3Njcm9sbC52YWthdGEuanN0cmVlXCIsZnVuY3Rpb24oYSxiKXtiJiZiLmRhdGEmJmIuZGF0YS5qc3RyZWUmJihnLmhpZGUoKSxjPSExLGU9ITEsYi5oZWxwZXIuZmluZChcIi5qc3RyZWUtaWNvblwiKS5maXJzdCgpLnJlbW92ZUNsYXNzKFwianN0cmVlLW9rXCIpLmFkZENsYXNzKFwianN0cmVlLWVyXCIpKX0pLm9uKFwiZG5kX3N0b3AudmFrYXRhLmpzdHJlZVwiLGZ1bmN0aW9uKGIsaCl7aWYoZiYmY2xlYXJUaW1lb3V0KGYpLGgmJmguZGF0YSYmaC5kYXRhLmpzdHJlZSl7Zy5oaWRlKCkuZGV0YWNoKCk7dmFyIGksaixrPVtdO2lmKGMpe2ZvcihpPTAsaj1oLmRhdGEubm9kZXMubGVuZ3RoO2o+aTtpKyspa1tpXT1oLmRhdGEub3JpZ2luP2guZGF0YS5vcmlnaW4uZ2V0X25vZGUoaC5kYXRhLm5vZGVzW2ldKTpoLmRhdGEubm9kZXNbaV07Yy5pbnNbaC5kYXRhLm9yaWdpbiYmKGguZGF0YS5vcmlnaW4uc2V0dGluZ3MuZG5kLmFsd2F5c19jb3B5fHxoLmRhdGEub3JpZ2luLnNldHRpbmdzLmRuZC5jb3B5JiYoaC5ldmVudC5tZXRhS2V5fHxoLmV2ZW50LmN0cmxLZXkpKT9cImNvcHlfbm9kZVwiOlwibW92ZV9ub2RlXCJdKGssYy5wYXIsYy5wb3MsITEsITEsITEsaC5kYXRhLm9yaWdpbil9ZWxzZSBpPWEoaC5ldmVudC50YXJnZXQpLmNsb3Nlc3QoXCIuanN0cmVlXCIpLGkubGVuZ3RoJiZkJiZkLmVycm9yJiZcImNoZWNrXCI9PT1kLmVycm9yJiYoaT1pLmpzdHJlZSghMCksaSYmaS5zZXR0aW5ncy5jb3JlLmVycm9yLmNhbGwodGhpcyxkKSk7ZT0hMSxjPSExfX0pLm9uKFwia2V5dXAuanN0cmVlIGtleWRvd24uanN0cmVlXCIsZnVuY3Rpb24oYixoKXtoPWEudmFrYXRhLmRuZC5fZ2V0KCksaCYmaC5kYXRhJiZoLmRhdGEuanN0cmVlJiYoXCJrZXl1cFwiPT09Yi50eXBlJiYyNz09PWIud2hpY2g/KGYmJmNsZWFyVGltZW91dChmKSxjPSExLGQ9ITEsZT0hMSxmPSExLGcuaGlkZSgpLmRldGFjaCgpLGEudmFrYXRhLmRuZC5fY2xlYW4oKSk6KGguaGVscGVyLmZpbmQoXCIuanN0cmVlLWNvcHlcIikuZmlyc3QoKVtoLmRhdGEub3JpZ2luJiYoaC5kYXRhLm9yaWdpbi5zZXR0aW5ncy5kbmQuYWx3YXlzX2NvcHl8fGguZGF0YS5vcmlnaW4uc2V0dGluZ3MuZG5kLmNvcHkmJihiLm1ldGFLZXl8fGIuY3RybEtleSkpP1wic2hvd1wiOlwiaGlkZVwiXSgpLGUmJihlLm1ldGFLZXk9Yi5tZXRhS2V5LGUuY3RybEtleT1iLmN0cmxLZXksYS52YWthdGEuZG5kLl90cmlnZ2VyKFwibW92ZVwiLGUpKSkpfSl9KSxmdW5jdGlvbihhKXthLnZha2F0YS5odG1sPXtkaXY6YShcIjxkaXYgLz5cIiksZXNjYXBlOmZ1bmN0aW9uKGIpe3JldHVybiBhLnZha2F0YS5odG1sLmRpdi50ZXh0KGIpLmh0bWwoKX0sc3RyaXA6ZnVuY3Rpb24oYil7cmV0dXJuIGEudmFrYXRhLmh0bWwuZGl2LmVtcHR5KCkuYXBwZW5kKGEucGFyc2VIVE1MKGIpKS50ZXh0KCl9fTt2YXIgYz17ZWxlbWVudDohMSx0YXJnZXQ6ITEsaXNfZG93bjohMSxpc19kcmFnOiExLGhlbHBlcjohMSxoZWxwZXJfdzowLGRhdGE6ITEsaW5pdF94OjAsaW5pdF95OjAsc2Nyb2xsX2w6MCxzY3JvbGxfdDowLHNjcm9sbF9lOiExLHNjcm9sbF9pOiExLGlzX3RvdWNoOiExfTthLnZha2F0YS5kbmQ9e3NldHRpbmdzOntzY3JvbGxfc3BlZWQ6MTAsc2Nyb2xsX3Byb3hpbWl0eToyMCxoZWxwZXJfbGVmdDo1LGhlbHBlcl90b3A6MTAsdGhyZXNob2xkOjUsdGhyZXNob2xkX3RvdWNoOjUwfSxfdHJpZ2dlcjpmdW5jdGlvbihjLGQsZSl7ZT09PWImJihlPWEudmFrYXRhLmRuZC5fZ2V0KCkpLGUuZXZlbnQ9ZCxhKGkpLnRyaWdnZXJIYW5kbGVyKFwiZG5kX1wiK2MrXCIudmFrYXRhXCIsZSl9LF9nZXQ6ZnVuY3Rpb24oKXtyZXR1cm57ZGF0YTpjLmRhdGEsZWxlbWVudDpjLmVsZW1lbnQsaGVscGVyOmMuaGVscGVyfX0sX2NsZWFuOmZ1bmN0aW9uKCl7Yy5oZWxwZXImJmMuaGVscGVyLnJlbW92ZSgpLGMuc2Nyb2xsX2kmJihjbGVhckludGVydmFsKGMuc2Nyb2xsX2kpLGMuc2Nyb2xsX2k9ITEpLGM9e2VsZW1lbnQ6ITEsdGFyZ2V0OiExLGlzX2Rvd246ITEsaXNfZHJhZzohMSxoZWxwZXI6ITEsaGVscGVyX3c6MCxkYXRhOiExLGluaXRfeDowLGluaXRfeTowLHNjcm9sbF9sOjAsc2Nyb2xsX3Q6MCxzY3JvbGxfZTohMSxzY3JvbGxfaTohMSxpc190b3VjaDohMX0sYShpKS5vZmYoXCJtb3VzZW1vdmUudmFrYXRhLmpzdHJlZSB0b3VjaG1vdmUudmFrYXRhLmpzdHJlZVwiLGEudmFrYXRhLmRuZC5kcmFnKSxhKGkpLm9mZihcIm1vdXNldXAudmFrYXRhLmpzdHJlZSB0b3VjaGVuZC52YWthdGEuanN0cmVlXCIsYS52YWthdGEuZG5kLnN0b3ApfSxfc2Nyb2xsOmZ1bmN0aW9uKGIpe2lmKCFjLnNjcm9sbF9lfHwhYy5zY3JvbGxfbCYmIWMuc2Nyb2xsX3QpcmV0dXJuIGMuc2Nyb2xsX2kmJihjbGVhckludGVydmFsKGMuc2Nyb2xsX2kpLGMuc2Nyb2xsX2k9ITEpLCExO2lmKCFjLnNjcm9sbF9pKXJldHVybiBjLnNjcm9sbF9pPXNldEludGVydmFsKGEudmFrYXRhLmRuZC5fc2Nyb2xsLDEwMCksITE7aWYoYj09PSEwKXJldHVybiExO3ZhciBkPWMuc2Nyb2xsX2Uuc2Nyb2xsVG9wKCksZT1jLnNjcm9sbF9lLnNjcm9sbExlZnQoKTtjLnNjcm9sbF9lLnNjcm9sbFRvcChkK2Muc2Nyb2xsX3QqYS52YWthdGEuZG5kLnNldHRpbmdzLnNjcm9sbF9zcGVlZCksYy5zY3JvbGxfZS5zY3JvbGxMZWZ0KGUrYy5zY3JvbGxfbCphLnZha2F0YS5kbmQuc2V0dGluZ3Muc2Nyb2xsX3NwZWVkKSxkPT09Yy5zY3JvbGxfZS5zY3JvbGxUb3AoKSYmZT09PWMuc2Nyb2xsX2Uuc2Nyb2xsTGVmdCgpfHxhLnZha2F0YS5kbmQuX3RyaWdnZXIoXCJzY3JvbGxcIixjLnNjcm9sbF9lKX0sc3RhcnQ6ZnVuY3Rpb24oYixkLGUpe1widG91Y2hzdGFydFwiPT09Yi50eXBlJiZiLm9yaWdpbmFsRXZlbnQmJmIub3JpZ2luYWxFdmVudC5jaGFuZ2VkVG91Y2hlcyYmYi5vcmlnaW5hbEV2ZW50LmNoYW5nZWRUb3VjaGVzWzBdJiYoYi5wYWdlWD1iLm9yaWdpbmFsRXZlbnQuY2hhbmdlZFRvdWNoZXNbMF0ucGFnZVgsYi5wYWdlWT1iLm9yaWdpbmFsRXZlbnQuY2hhbmdlZFRvdWNoZXNbMF0ucGFnZVksYi50YXJnZXQ9aS5lbGVtZW50RnJvbVBvaW50KGIub3JpZ2luYWxFdmVudC5jaGFuZ2VkVG91Y2hlc1swXS5wYWdlWC13aW5kb3cucGFnZVhPZmZzZXQsYi5vcmlnaW5hbEV2ZW50LmNoYW5nZWRUb3VjaGVzWzBdLnBhZ2VZLXdpbmRvdy5wYWdlWU9mZnNldCkpLGMuaXNfZHJhZyYmYS52YWthdGEuZG5kLnN0b3Aoe30pO3RyeXtiLmN1cnJlbnRUYXJnZXQudW5zZWxlY3RhYmxlPVwib25cIixiLmN1cnJlbnRUYXJnZXQub25zZWxlY3RzdGFydD1mdW5jdGlvbigpe3JldHVybiExfSxiLmN1cnJlbnRUYXJnZXQuc3R5bGUmJihiLmN1cnJlbnRUYXJnZXQuc3R5bGUudG91Y2hBY3Rpb249XCJub25lXCIsYi5jdXJyZW50VGFyZ2V0LnN0eWxlLm1zVG91Y2hBY3Rpb249XCJub25lXCIsYi5jdXJyZW50VGFyZ2V0LnN0eWxlLk1velVzZXJTZWxlY3Q9XCJub25lXCIpfWNhdGNoKGYpe31yZXR1cm4gYy5pbml0X3g9Yi5wYWdlWCxjLmluaXRfeT1iLnBhZ2VZLGMuZGF0YT1kLGMuaXNfZG93bj0hMCxjLmVsZW1lbnQ9Yi5jdXJyZW50VGFyZ2V0LGMudGFyZ2V0PWIudGFyZ2V0LGMuaXNfdG91Y2g9XCJ0b3VjaHN0YXJ0XCI9PT1iLnR5cGUsZSE9PSExJiYoYy5oZWxwZXI9YShcIjxkaXYgaWQ9J3Zha2F0YS1kbmQnPjwvZGl2PlwiKS5odG1sKGUpLmNzcyh7ZGlzcGxheTpcImJsb2NrXCIsbWFyZ2luOlwiMFwiLHBhZGRpbmc6XCIwXCIscG9zaXRpb246XCJhYnNvbHV0ZVwiLHRvcDpcIi0yMDAwcHhcIixsaW5lSGVpZ2h0OlwiMTZweFwiLHpJbmRleDpcIjEwMDAwXCJ9KSksYShpKS5vbihcIm1vdXNlbW92ZS52YWthdGEuanN0cmVlIHRvdWNobW92ZS52YWthdGEuanN0cmVlXCIsYS52YWthdGEuZG5kLmRyYWcpLGEoaSkub24oXCJtb3VzZXVwLnZha2F0YS5qc3RyZWUgdG91Y2hlbmQudmFrYXRhLmpzdHJlZVwiLGEudmFrYXRhLmRuZC5zdG9wKSwhMX0sZHJhZzpmdW5jdGlvbihiKXtpZihcInRvdWNobW92ZVwiPT09Yi50eXBlJiZiLm9yaWdpbmFsRXZlbnQmJmIub3JpZ2luYWxFdmVudC5jaGFuZ2VkVG91Y2hlcyYmYi5vcmlnaW5hbEV2ZW50LmNoYW5nZWRUb3VjaGVzWzBdJiYoYi5wYWdlWD1iLm9yaWdpbmFsRXZlbnQuY2hhbmdlZFRvdWNoZXNbMF0ucGFnZVgsYi5wYWdlWT1iLm9yaWdpbmFsRXZlbnQuY2hhbmdlZFRvdWNoZXNbMF0ucGFnZVksYi50YXJnZXQ9aS5lbGVtZW50RnJvbVBvaW50KGIub3JpZ2luYWxFdmVudC5jaGFuZ2VkVG91Y2hlc1swXS5wYWdlWC13aW5kb3cucGFnZVhPZmZzZXQsYi5vcmlnaW5hbEV2ZW50LmNoYW5nZWRUb3VjaGVzWzBdLnBhZ2VZLXdpbmRvdy5wYWdlWU9mZnNldCkpLGMuaXNfZG93bil7aWYoIWMuaXNfZHJhZyl7aWYoIShNYXRoLmFicyhiLnBhZ2VYLWMuaW5pdF94KT4oYy5pc190b3VjaD9hLnZha2F0YS5kbmQuc2V0dGluZ3MudGhyZXNob2xkX3RvdWNoOmEudmFrYXRhLmRuZC5zZXR0aW5ncy50aHJlc2hvbGQpfHxNYXRoLmFicyhiLnBhZ2VZLWMuaW5pdF95KT4oYy5pc190b3VjaD9hLnZha2F0YS5kbmQuc2V0dGluZ3MudGhyZXNob2xkX3RvdWNoOmEudmFrYXRhLmRuZC5zZXR0aW5ncy50aHJlc2hvbGQpKSlyZXR1cm47Yy5oZWxwZXImJihjLmhlbHBlci5hcHBlbmRUbyhcImJvZHlcIiksYy5oZWxwZXJfdz1jLmhlbHBlci5vdXRlcldpZHRoKCkpLGMuaXNfZHJhZz0hMCxhLnZha2F0YS5kbmQuX3RyaWdnZXIoXCJzdGFydFwiLGIpfXZhciBkPSExLGU9ITEsZj0hMSxnPSExLGg9ITEsaj0hMSxrPSExLGw9ITEsbT0hMSxuPSExO3JldHVybiBjLnNjcm9sbF90PTAsYy5zY3JvbGxfbD0wLGMuc2Nyb2xsX2U9ITEsYShhKGIudGFyZ2V0KS5wYXJlbnRzVW50aWwoXCJib2R5XCIpLmFkZEJhY2soKS5nZXQoKS5yZXZlcnNlKCkpLmZpbHRlcihmdW5jdGlvbigpe3JldHVybi9eYXV0b3xzY3JvbGwkLy50ZXN0KGEodGhpcykuY3NzKFwib3ZlcmZsb3dcIikpJiYodGhpcy5zY3JvbGxIZWlnaHQ+dGhpcy5vZmZzZXRIZWlnaHR8fHRoaXMuc2Nyb2xsV2lkdGg+dGhpcy5vZmZzZXRXaWR0aCl9KS5lYWNoKGZ1bmN0aW9uKCl7dmFyIGQ9YSh0aGlzKSxlPWQub2Zmc2V0KCk7cmV0dXJuIHRoaXMuc2Nyb2xsSGVpZ2h0PnRoaXMub2Zmc2V0SGVpZ2h0JiYoZS50b3ArZC5oZWlnaHQoKS1iLnBhZ2VZPGEudmFrYXRhLmRuZC5zZXR0aW5ncy5zY3JvbGxfcHJveGltaXR5JiYoYy5zY3JvbGxfdD0xKSxiLnBhZ2VZLWUudG9wPGEudmFrYXRhLmRuZC5zZXR0aW5ncy5zY3JvbGxfcHJveGltaXR5JiYoYy5zY3JvbGxfdD0tMSkpLHRoaXMuc2Nyb2xsV2lkdGg+dGhpcy5vZmZzZXRXaWR0aCYmKGUubGVmdCtkLndpZHRoKCktYi5wYWdlWDxhLnZha2F0YS5kbmQuc2V0dGluZ3Muc2Nyb2xsX3Byb3hpbWl0eSYmKGMuc2Nyb2xsX2w9MSksYi5wYWdlWC1lLmxlZnQ8YS52YWthdGEuZG5kLnNldHRpbmdzLnNjcm9sbF9wcm94aW1pdHkmJihjLnNjcm9sbF9sPS0xKSksYy5zY3JvbGxfdHx8Yy5zY3JvbGxfbD8oYy5zY3JvbGxfZT1hKHRoaXMpLCExKTp2b2lkIDB9KSxjLnNjcm9sbF9lfHwoZD1hKGkpLGU9YSh3aW5kb3cpLGY9ZC5oZWlnaHQoKSxnPWUuaGVpZ2h0KCksaD1kLndpZHRoKCksaj1lLndpZHRoKCksaz1kLnNjcm9sbFRvcCgpLGw9ZC5zY3JvbGxMZWZ0KCksZj5nJiZiLnBhZ2VZLWs8YS52YWthdGEuZG5kLnNldHRpbmdzLnNjcm9sbF9wcm94aW1pdHkmJihjLnNjcm9sbF90PS0xKSxmPmcmJmctKGIucGFnZVktayk8YS52YWthdGEuZG5kLnNldHRpbmdzLnNjcm9sbF9wcm94aW1pdHkmJihjLnNjcm9sbF90PTEpLGg+aiYmYi5wYWdlWC1sPGEudmFrYXRhLmRuZC5zZXR0aW5ncy5zY3JvbGxfcHJveGltaXR5JiYoYy5zY3JvbGxfbD0tMSksaD5qJiZqLShiLnBhZ2VYLWwpPGEudmFrYXRhLmRuZC5zZXR0aW5ncy5zY3JvbGxfcHJveGltaXR5JiYoYy5zY3JvbGxfbD0xKSwoYy5zY3JvbGxfdHx8Yy5zY3JvbGxfbCkmJihjLnNjcm9sbF9lPWQpKSxjLnNjcm9sbF9lJiZhLnZha2F0YS5kbmQuX3Njcm9sbCghMCksYy5oZWxwZXImJihtPXBhcnNlSW50KGIucGFnZVkrYS52YWthdGEuZG5kLnNldHRpbmdzLmhlbHBlcl90b3AsMTApLG49cGFyc2VJbnQoYi5wYWdlWCthLnZha2F0YS5kbmQuc2V0dGluZ3MuaGVscGVyX2xlZnQsMTApLGYmJm0rMjU+ZiYmKG09Zi01MCksaCYmbitjLmhlbHBlcl93PmgmJihuPWgtKGMuaGVscGVyX3crMikpLGMuaGVscGVyLmNzcyh7bGVmdDpuK1wicHhcIix0b3A6bStcInB4XCJ9KSksYS52YWthdGEuZG5kLl90cmlnZ2VyKFwibW92ZVwiLGIpLCExfX0sc3RvcDpmdW5jdGlvbihiKXtpZihcInRvdWNoZW5kXCI9PT1iLnR5cGUmJmIub3JpZ2luYWxFdmVudCYmYi5vcmlnaW5hbEV2ZW50LmNoYW5nZWRUb3VjaGVzJiZiLm9yaWdpbmFsRXZlbnQuY2hhbmdlZFRvdWNoZXNbMF0mJihiLnBhZ2VYPWIub3JpZ2luYWxFdmVudC5jaGFuZ2VkVG91Y2hlc1swXS5wYWdlWCxiLnBhZ2VZPWIub3JpZ2luYWxFdmVudC5jaGFuZ2VkVG91Y2hlc1swXS5wYWdlWSxiLnRhcmdldD1pLmVsZW1lbnRGcm9tUG9pbnQoYi5vcmlnaW5hbEV2ZW50LmNoYW5nZWRUb3VjaGVzWzBdLnBhZ2VYLXdpbmRvdy5wYWdlWE9mZnNldCxiLm9yaWdpbmFsRXZlbnQuY2hhbmdlZFRvdWNoZXNbMF0ucGFnZVktd2luZG93LnBhZ2VZT2Zmc2V0KSksYy5pc19kcmFnKWEudmFrYXRhLmRuZC5fdHJpZ2dlcihcInN0b3BcIixiKTtlbHNlIGlmKFwidG91Y2hlbmRcIj09PWIudHlwZSYmYi50YXJnZXQ9PT1jLnRhcmdldCl7dmFyIGQ9c2V0VGltZW91dChmdW5jdGlvbigpe2EoYi50YXJnZXQpLmNsaWNrKCl9LDEwMCk7YShiLnRhcmdldCkub25lKFwiY2xpY2tcIixmdW5jdGlvbigpe2QmJmNsZWFyVGltZW91dChkKX0pfXJldHVybiBhLnZha2F0YS5kbmQuX2NsZWFuKCksITF9fX0oYSksYS5qc3RyZWUuZGVmYXVsdHMubWFzc2xvYWQ9bnVsbCxhLmpzdHJlZS5wbHVnaW5zLm1hc3Nsb2FkPWZ1bmN0aW9uKGIsYyl7dGhpcy5pbml0PWZ1bmN0aW9uKGEsYil7dGhpcy5fZGF0YS5tYXNzbG9hZD17fSxjLmluaXQuY2FsbCh0aGlzLGEsYil9LHRoaXMuX2xvYWRfbm9kZXM9ZnVuY3Rpb24oYixkLGUsZil7dmFyIGc9dGhpcy5zZXR0aW5ncy5tYXNzbG9hZCxoPUpTT04uc3RyaW5naWZ5KGIpLGk9W10saj10aGlzLl9tb2RlbC5kYXRhLGssbCxtO2lmKCFlKXtmb3Ioaz0wLGw9Yi5sZW5ndGg7bD5rO2srKylqW2Jba11dJiYoaltiW2tdXS5zdGF0ZS5sb2FkZWR8fGpbYltrXV0uc3RhdGUuZmFpbGVkKSYmIWZ8fChpLnB1c2goYltrXSksbT10aGlzLmdldF9ub2RlKGJba10sITApLG0mJm0ubGVuZ3RoJiZtLmFkZENsYXNzKFwianN0cmVlLWxvYWRpbmdcIikuYXR0cihcImFyaWEtYnVzeVwiLCEwKSk7aWYodGhpcy5fZGF0YS5tYXNzbG9hZD17fSxpLmxlbmd0aCl7aWYoYS5pc0Z1bmN0aW9uKGcpKXJldHVybiBnLmNhbGwodGhpcyxpLGEucHJveHkoZnVuY3Rpb24oYSl7dmFyIGcsaDtpZihhKWZvcihnIGluIGEpYS5oYXNPd25Qcm9wZXJ0eShnKSYmKHRoaXMuX2RhdGEubWFzc2xvYWRbZ109YVtnXSk7Zm9yKGc9MCxoPWIubGVuZ3RoO2g+ZztnKyspbT10aGlzLmdldF9ub2RlKGJbZ10sITApLG0mJm0ubGVuZ3RoJiZtLnJlbW92ZUNsYXNzKFwianN0cmVlLWxvYWRpbmdcIikuYXR0cihcImFyaWEtYnVzeVwiLCExKTtjLl9sb2FkX25vZGVzLmNhbGwodGhpcyxiLGQsZSxmKX0sdGhpcykpO2lmKFwib2JqZWN0XCI9PXR5cGVvZiBnJiZnJiZnLnVybClyZXR1cm4gZz1hLmV4dGVuZCghMCx7fSxnKSxhLmlzRnVuY3Rpb24oZy51cmwpJiYoZy51cmw9Zy51cmwuY2FsbCh0aGlzLGkpKSxhLmlzRnVuY3Rpb24oZy5kYXRhKSYmKGcuZGF0YT1nLmRhdGEuY2FsbCh0aGlzLGkpKSxhLmFqYXgoZykuZG9uZShhLnByb3h5KGZ1bmN0aW9uKGEsZyxoKXt2YXIgaSxqO2lmKGEpZm9yKGkgaW4gYSlhLmhhc093blByb3BlcnR5KGkpJiYodGhpcy5fZGF0YS5tYXNzbG9hZFtpXT1hW2ldKTtmb3IoaT0wLGo9Yi5sZW5ndGg7aj5pO2krKyltPXRoaXMuZ2V0X25vZGUoYltpXSwhMCksbSYmbS5sZW5ndGgmJm0ucmVtb3ZlQ2xhc3MoXCJqc3RyZWUtbG9hZGluZ1wiKS5hdHRyKFwiYXJpYS1idXN5XCIsITEpO2MuX2xvYWRfbm9kZXMuY2FsbCh0aGlzLGIsZCxlLGYpfSx0aGlzKSkuZmFpbChhLnByb3h5KGZ1bmN0aW9uKGEpe2MuX2xvYWRfbm9kZXMuY2FsbCh0aGlzLGIsZCxlLGYpfSx0aGlzKSl9fXJldHVybiBjLl9sb2FkX25vZGVzLmNhbGwodGhpcyxiLGQsZSxmKX0sdGhpcy5fbG9hZF9ub2RlPWZ1bmN0aW9uKGIsZCl7dmFyIGU9dGhpcy5fZGF0YS5tYXNzbG9hZFtiLmlkXSxmPW51bGwsZztyZXR1cm4gZT8oZj10aGlzW1wic3RyaW5nXCI9PXR5cGVvZiBlP1wiX2FwcGVuZF9odG1sX2RhdGFcIjpcIl9hcHBlbmRfanNvbl9kYXRhXCJdKGIsXCJzdHJpbmdcIj09dHlwZW9mIGU/YShhLnBhcnNlSFRNTChlKSkuZmlsdGVyKGZ1bmN0aW9uKCl7cmV0dXJuIDMhPT10aGlzLm5vZGVUeXBlfSk6ZSxmdW5jdGlvbihhKXtkLmNhbGwodGhpcyxhKX0pLGc9dGhpcy5nZXRfbm9kZShiLmlkLCEwKSxnJiZnLmxlbmd0aCYmZy5yZW1vdmVDbGFzcyhcImpzdHJlZS1sb2FkaW5nXCIpLmF0dHIoXCJhcmlhLWJ1c3lcIiwhMSksZGVsZXRlIHRoaXMuX2RhdGEubWFzc2xvYWRbYi5pZF0sZik6Yy5fbG9hZF9ub2RlLmNhbGwodGhpcyxiLGQpfX0sYS5qc3RyZWUuZGVmYXVsdHMuc2VhcmNoPXthamF4OiExLGZ1enp5OiExLGNhc2Vfc2Vuc2l0aXZlOiExLHNob3dfb25seV9tYXRjaGVzOiExLHNob3dfb25seV9tYXRjaGVzX2NoaWxkcmVuOiExLGNsb3NlX29wZW5lZF9vbmNsZWFyOiEwLHNlYXJjaF9sZWF2ZXNfb25seTohMSxzZWFyY2hfY2FsbGJhY2s6ITF9LGEuanN0cmVlLnBsdWdpbnMuc2VhcmNoPWZ1bmN0aW9uKGMsZCl7dGhpcy5iaW5kPWZ1bmN0aW9uKCl7ZC5iaW5kLmNhbGwodGhpcyksdGhpcy5fZGF0YS5zZWFyY2guc3RyPVwiXCIsdGhpcy5fZGF0YS5zZWFyY2guZG9tPWEoKSx0aGlzLl9kYXRhLnNlYXJjaC5yZXM9W10sdGhpcy5fZGF0YS5zZWFyY2gub3BuPVtdLHRoaXMuX2RhdGEuc2VhcmNoLnNvbT0hMSx0aGlzLl9kYXRhLnNlYXJjaC5zbWM9ITEsdGhpcy5fZGF0YS5zZWFyY2guaGRuPVtdLHRoaXMuZWxlbWVudC5vbihcInNlYXJjaC5qc3RyZWVcIixhLnByb3h5KGZ1bmN0aW9uKGIsYyl7aWYodGhpcy5fZGF0YS5zZWFyY2guc29tJiZjLnJlcy5sZW5ndGgpe3ZhciBkPXRoaXMuX21vZGVsLmRhdGEsZSxmLGc9W10saCxpO2ZvcihlPTAsZj1jLnJlcy5sZW5ndGg7Zj5lO2UrKylpZihkW2MucmVzW2VdXSYmIWRbYy5yZXNbZV1dLnN0YXRlLmhpZGRlbiYmKGcucHVzaChjLnJlc1tlXSksZz1nLmNvbmNhdChkW2MucmVzW2VdXS5wYXJlbnRzKSx0aGlzLl9kYXRhLnNlYXJjaC5zbWMpKWZvcihoPTAsaT1kW2MucmVzW2VdXS5jaGlsZHJlbl9kLmxlbmd0aDtpPmg7aCsrKWRbZFtjLnJlc1tlXV0uY2hpbGRyZW5fZFtoXV0mJiFkW2RbYy5yZXNbZV1dLmNoaWxkcmVuX2RbaF1dLnN0YXRlLmhpZGRlbiYmZy5wdXNoKGRbYy5yZXNbZV1dLmNoaWxkcmVuX2RbaF0pO2c9YS52YWthdGEuYXJyYXlfcmVtb3ZlX2l0ZW0oYS52YWthdGEuYXJyYXlfdW5pcXVlKGcpLGEuanN0cmVlLnJvb3QpLHRoaXMuX2RhdGEuc2VhcmNoLmhkbj10aGlzLmhpZGVfYWxsKCEwKSx0aGlzLnNob3dfbm9kZShnLCEwKSx0aGlzLnJlZHJhdyghMCl9fSx0aGlzKSkub24oXCJjbGVhcl9zZWFyY2guanN0cmVlXCIsYS5wcm94eShmdW5jdGlvbihhLGIpe3RoaXMuX2RhdGEuc2VhcmNoLnNvbSYmYi5yZXMubGVuZ3RoJiYodGhpcy5zaG93X25vZGUodGhpcy5fZGF0YS5zZWFyY2guaGRuLCEwKSx0aGlzLnJlZHJhdyghMCkpfSx0aGlzKSl9LHRoaXMuc2VhcmNoPWZ1bmN0aW9uKGMsZCxlLGYsZyxoKXtpZihjPT09ITF8fFwiXCI9PT1hLnRyaW0oYy50b1N0cmluZygpKSlyZXR1cm4gdGhpcy5jbGVhcl9zZWFyY2goKTtmPXRoaXMuZ2V0X25vZGUoZiksZj1mJiZmLmlkP2YuaWQ6bnVsbCxjPWMudG9TdHJpbmcoKTt2YXIgaT10aGlzLnNldHRpbmdzLnNlYXJjaCxqPWkuYWpheD9pLmFqYXg6ITEsaz10aGlzLl9tb2RlbC5kYXRhLGw9bnVsbCxtPVtdLG49W10sbyxwO2lmKHRoaXMuX2RhdGEuc2VhcmNoLnJlcy5sZW5ndGgmJiFnJiZ0aGlzLmNsZWFyX3NlYXJjaCgpLGU9PT1iJiYoZT1pLnNob3dfb25seV9tYXRjaGVzKSxoPT09YiYmKGg9aS5zaG93X29ubHlfbWF0Y2hlc19jaGlsZHJlbiksIWQmJmohPT0hMSlyZXR1cm4gYS5pc0Z1bmN0aW9uKGopP2ouY2FsbCh0aGlzLGMsYS5wcm94eShmdW5jdGlvbihiKXtiJiZiLmQmJihiPWIuZCksdGhpcy5fbG9hZF9ub2RlcyhhLmlzQXJyYXkoYik/YS52YWthdGEuYXJyYXlfdW5pcXVlKGIpOltdLGZ1bmN0aW9uKCl7dGhpcy5zZWFyY2goYywhMCxlLGYsZyl9KX0sdGhpcyksZik6KGo9YS5leHRlbmQoe30saiksai5kYXRhfHwoai5kYXRhPXt9KSxqLmRhdGEuc3RyPWMsZiYmKGouZGF0YS5pbnNpZGU9ZiksYS5hamF4KGopLmZhaWwoYS5wcm94eShmdW5jdGlvbigpe3RoaXMuX2RhdGEuY29yZS5sYXN0X2Vycm9yPXtlcnJvcjpcImFqYXhcIixwbHVnaW46XCJzZWFyY2hcIixpZDpcInNlYXJjaF8wMVwiLHJlYXNvbjpcIkNvdWxkIG5vdCBsb2FkIHNlYXJjaCBwYXJlbnRzXCIsZGF0YTpKU09OLnN0cmluZ2lmeShqKX0sdGhpcy5zZXR0aW5ncy5jb3JlLmVycm9yLmNhbGwodGhpcyx0aGlzLl9kYXRhLmNvcmUubGFzdF9lcnJvcil9LHRoaXMpKS5kb25lKGEucHJveHkoZnVuY3Rpb24oYil7YiYmYi5kJiYoYj1iLmQpLHRoaXMuX2xvYWRfbm9kZXMoYS5pc0FycmF5KGIpP2EudmFrYXRhLmFycmF5X3VuaXF1ZShiKTpbXSxmdW5jdGlvbigpe3RoaXMuc2VhcmNoKGMsITAsZSxmLGcpfSl9LHRoaXMpKSk7aWYoZ3x8KHRoaXMuX2RhdGEuc2VhcmNoLnN0cj1jLHRoaXMuX2RhdGEuc2VhcmNoLmRvbT1hKCksdGhpcy5fZGF0YS5zZWFyY2gucmVzPVtdLHRoaXMuX2RhdGEuc2VhcmNoLm9wbj1bXSx0aGlzLl9kYXRhLnNlYXJjaC5zb209ZSx0aGlzLl9kYXRhLnNlYXJjaC5zbWM9aCksbD1uZXcgYS52YWthdGEuc2VhcmNoKGMsITAse2Nhc2VTZW5zaXRpdmU6aS5jYXNlX3NlbnNpdGl2ZSxmdXp6eTppLmZ1enp5fSksYS5lYWNoKGtbZj9mOmEuanN0cmVlLnJvb3RdLmNoaWxkcmVuX2QsZnVuY3Rpb24oYSxiKXt2YXIgZD1rW2JdO2QudGV4dCYmIWQuc3RhdGUuaGlkZGVuJiYoIWkuc2VhcmNoX2xlYXZlc19vbmx5fHxkLnN0YXRlLmxvYWRlZCYmMD09PWQuY2hpbGRyZW4ubGVuZ3RoKSYmKGkuc2VhcmNoX2NhbGxiYWNrJiZpLnNlYXJjaF9jYWxsYmFjay5jYWxsKHRoaXMsYyxkKXx8IWkuc2VhcmNoX2NhbGxiYWNrJiZsLnNlYXJjaChkLnRleHQpLmlzTWF0Y2gpJiYobS5wdXNoKGIpLG49bi5jb25jYXQoZC5wYXJlbnRzKSl9KSxtLmxlbmd0aCl7Zm9yKG49YS52YWthdGEuYXJyYXlfdW5pcXVlKG4pLG89MCxwPW4ubGVuZ3RoO3A+bztvKyspbltvXSE9PWEuanN0cmVlLnJvb3QmJmtbbltvXV0mJnRoaXMub3Blbl9ub2RlKG5bb10sbnVsbCwwKT09PSEwJiZ0aGlzLl9kYXRhLnNlYXJjaC5vcG4ucHVzaChuW29dKTtnPyh0aGlzLl9kYXRhLnNlYXJjaC5kb209dGhpcy5fZGF0YS5zZWFyY2guZG9tLmFkZChhKHRoaXMuZWxlbWVudFswXS5xdWVyeVNlbGVjdG9yQWxsKFwiI1wiK2EubWFwKG0sZnVuY3Rpb24oYil7cmV0dXJuLTEhPT1cIjAxMjM0NTY3ODlcIi5pbmRleE9mKGJbMF0pP1wiXFxcXDNcIitiWzBdK1wiIFwiK2Iuc3Vic3RyKDEpLnJlcGxhY2UoYS5qc3RyZWUuaWRyZWdleCxcIlxcXFwkJlwiKTpiLnJlcGxhY2UoYS5qc3RyZWUuaWRyZWdleCxcIlxcXFwkJlwiKX0pLmpvaW4oXCIsICNcIikpKSksdGhpcy5fZGF0YS5zZWFyY2gucmVzPWEudmFrYXRhLmFycmF5X3VuaXF1ZSh0aGlzLl9kYXRhLnNlYXJjaC5yZXMuY29uY2F0KG0pKSk6KHRoaXMuX2RhdGEuc2VhcmNoLmRvbT1hKHRoaXMuZWxlbWVudFswXS5xdWVyeVNlbGVjdG9yQWxsKFwiI1wiK2EubWFwKG0sZnVuY3Rpb24oYil7cmV0dXJuLTEhPT1cIjAxMjM0NTY3ODlcIi5pbmRleE9mKGJbMF0pP1wiXFxcXDNcIitiWzBdK1wiIFwiK2Iuc3Vic3RyKDEpLnJlcGxhY2UoYS5qc3RyZWUuaWRyZWdleCxcIlxcXFwkJlwiKTpiLnJlcGxhY2UoYS5qc3RyZWUuaWRyZWdleCxcIlxcXFwkJlwiKX0pLmpvaW4oXCIsICNcIikpKSx0aGlzLl9kYXRhLnNlYXJjaC5yZXM9bSksdGhpcy5fZGF0YS5zZWFyY2guZG9tLmNoaWxkcmVuKFwiLmpzdHJlZS1hbmNob3JcIikuYWRkQ2xhc3MoXCJqc3RyZWUtc2VhcmNoXCIpfXRoaXMudHJpZ2dlcihcInNlYXJjaFwiLHtub2Rlczp0aGlzLl9kYXRhLnNlYXJjaC5kb20sc3RyOmMscmVzOnRoaXMuX2RhdGEuc2VhcmNoLnJlcyxzaG93X29ubHlfbWF0Y2hlczplfSl9LHRoaXMuY2xlYXJfc2VhcmNoPWZ1bmN0aW9uKCl7dGhpcy5zZXR0aW5ncy5zZWFyY2guY2xvc2Vfb3BlbmVkX29uY2xlYXImJnRoaXMuY2xvc2Vfbm9kZSh0aGlzLl9kYXRhLnNlYXJjaC5vcG4sMCksdGhpcy50cmlnZ2VyKFwiY2xlYXJfc2VhcmNoXCIse25vZGVzOnRoaXMuX2RhdGEuc2VhcmNoLmRvbSxzdHI6dGhpcy5fZGF0YS5zZWFyY2guc3RyLHJlczp0aGlzLl9kYXRhLnNlYXJjaC5yZXN9KSx0aGlzLl9kYXRhLnNlYXJjaC5yZXMubGVuZ3RoJiYodGhpcy5fZGF0YS5zZWFyY2guZG9tPWEodGhpcy5lbGVtZW50WzBdLnF1ZXJ5U2VsZWN0b3JBbGwoXCIjXCIrYS5tYXAodGhpcy5fZGF0YS5zZWFyY2gucmVzLGZ1bmN0aW9uKGIpe3JldHVybi0xIT09XCIwMTIzNDU2Nzg5XCIuaW5kZXhPZihiWzBdKT9cIlxcXFwzXCIrYlswXStcIiBcIitiLnN1YnN0cigxKS5yZXBsYWNlKGEuanN0cmVlLmlkcmVnZXgsXCJcXFxcJCZcIik6Yi5yZXBsYWNlKGEuanN0cmVlLmlkcmVnZXgsXCJcXFxcJCZcIil9KS5qb2luKFwiLCAjXCIpKSksdGhpcy5fZGF0YS5zZWFyY2guZG9tLmNoaWxkcmVuKFwiLmpzdHJlZS1hbmNob3JcIikucmVtb3ZlQ2xhc3MoXCJqc3RyZWUtc2VhcmNoXCIpKSx0aGlzLl9kYXRhLnNlYXJjaC5zdHI9XCJcIix0aGlzLl9kYXRhLnNlYXJjaC5yZXM9W10sdGhpcy5fZGF0YS5zZWFyY2gub3BuPVtdLHRoaXMuX2RhdGEuc2VhcmNoLmRvbT1hKCl9LHRoaXMucmVkcmF3X25vZGU9ZnVuY3Rpb24oYixjLGUsZil7aWYoYj1kLnJlZHJhd19ub2RlLmFwcGx5KHRoaXMsYXJndW1lbnRzKSxiJiYtMSE9PWEuaW5BcnJheShiLmlkLHRoaXMuX2RhdGEuc2VhcmNoLnJlcykpe3ZhciBnLGgsaT1udWxsO2ZvcihnPTAsaD1iLmNoaWxkTm9kZXMubGVuZ3RoO2g+ZztnKyspaWYoYi5jaGlsZE5vZGVzW2ddJiZiLmNoaWxkTm9kZXNbZ10uY2xhc3NOYW1lJiYtMSE9PWIuY2hpbGROb2Rlc1tnXS5jbGFzc05hbWUuaW5kZXhPZihcImpzdHJlZS1hbmNob3JcIikpe2k9Yi5jaGlsZE5vZGVzW2ddO2JyZWFrfWkmJihpLmNsYXNzTmFtZSs9XCIganN0cmVlLXNlYXJjaFwiKX1yZXR1cm4gYn19LGZ1bmN0aW9uKGEpe2EudmFrYXRhLnNlYXJjaD1mdW5jdGlvbihiLGMsZCl7ZD1kfHx7fSxkPWEuZXh0ZW5kKHt9LGEudmFrYXRhLnNlYXJjaC5kZWZhdWx0cyxkKSxkLmZ1enp5IT09ITEmJihkLmZ1enp5PSEwKSxiPWQuY2FzZVNlbnNpdGl2ZT9iOmIudG9Mb3dlckNhc2UoKTt2YXIgZT1kLmxvY2F0aW9uLGY9ZC5kaXN0YW5jZSxnPWQudGhyZXNob2xkLGg9Yi5sZW5ndGgsaSxqLGssbDtyZXR1cm4gaD4zMiYmKGQuZnV6enk9ITEpLGQuZnV6enkmJihpPTE8PGgtMSxqPWZ1bmN0aW9uKCl7dmFyIGE9e30sYz0wO2ZvcihjPTA7aD5jO2MrKylhW2IuY2hhckF0KGMpXT0wO2ZvcihjPTA7aD5jO2MrKylhW2IuY2hhckF0KGMpXXw9MTw8aC1jLTE7cmV0dXJuIGF9KCksaz1mdW5jdGlvbihhLGIpe3ZhciBjPWEvaCxkPU1hdGguYWJzKGUtYik7cmV0dXJuIGY/YytkL2Y6ZD8xOmN9KSxsPWZ1bmN0aW9uKGEpe2lmKGE9ZC5jYXNlU2Vuc2l0aXZlP2E6YS50b0xvd2VyQ2FzZSgpLGI9PT1hfHwtMSE9PWEuaW5kZXhPZihiKSlyZXR1cm57aXNNYXRjaDohMCxzY29yZTowfTtpZighZC5mdXp6eSlyZXR1cm57aXNNYXRjaDohMSxzY29yZToxfTt2YXIgYyxmLGw9YS5sZW5ndGgsbT1nLG49YS5pbmRleE9mKGIsZSksbyxwLHE9aCtsLHIscyx0LHUsdix3PTEseD1bXTtmb3IoLTEhPT1uJiYobT1NYXRoLm1pbihrKDAsbiksbSksbj1hLmxhc3RJbmRleE9mKGIsZStoKSwtMSE9PW4mJihtPU1hdGgubWluKGsoMCxuKSxtKSkpLG49LTEsYz0wO2g+YztjKyspe289MCxwPXE7d2hpbGUocD5vKWsoYyxlK3ApPD1tP289cDpxPXAscD1NYXRoLmZsb29yKChxLW8pLzIrbyk7Zm9yKHE9cCxzPU1hdGgubWF4KDEsZS1wKzEpLHQ9TWF0aC5taW4oZStwLGwpK2gsdT1uZXcgQXJyYXkodCsyKSx1W3QrMV09KDE8PGMpLTEsZj10O2Y+PXM7Zi0tKWlmKHY9althLmNoYXJBdChmLTEpXSwwPT09Yz91W2ZdPSh1W2YrMV08PDF8MSkmdjp1W2ZdPSh1W2YrMV08PDF8MSkmdnwoKHJbZisxXXxyW2ZdKTw8MXwxKXxyW2YrMV0sdVtmXSZpJiYodz1rKGMsZi0xKSxtPj13KSl7aWYobT13LG49Zi0xLHgucHVzaChuKSwhKG4+ZSkpYnJlYWs7cz1NYXRoLm1heCgxLDIqZS1uKX1pZihrKGMrMSxlKT5tKWJyZWFrO3I9dX1yZXR1cm57aXNNYXRjaDpuPj0wLHNjb3JlOnd9fSxjPT09ITA/e3NlYXJjaDpsfTpsKGMpfSxhLnZha2F0YS5zZWFyY2guZGVmYXVsdHM9e2xvY2F0aW9uOjAsZGlzdGFuY2U6MTAwLHRocmVzaG9sZDouNixmdXp6eTohMSxjYXNlU2Vuc2l0aXZlOiExfX0oYSksYS5qc3RyZWUuZGVmYXVsdHMuc29ydD1mdW5jdGlvbihhLGIpe3JldHVybiB0aGlzLmdldF90ZXh0KGEpPnRoaXMuZ2V0X3RleHQoYik/MTotMX0sYS5qc3RyZWUucGx1Z2lucy5zb3J0PWZ1bmN0aW9uKGIsYyl7dGhpcy5iaW5kPWZ1bmN0aW9uKCl7Yy5iaW5kLmNhbGwodGhpcyksdGhpcy5lbGVtZW50Lm9uKFwibW9kZWwuanN0cmVlXCIsYS5wcm94eShmdW5jdGlvbihhLGIpe3RoaXMuc29ydChiLnBhcmVudCwhMCl9LHRoaXMpKS5vbihcInJlbmFtZV9ub2RlLmpzdHJlZSBjcmVhdGVfbm9kZS5qc3RyZWVcIixhLnByb3h5KGZ1bmN0aW9uKGEsYil7dGhpcy5zb3J0KGIucGFyZW50fHxiLm5vZGUucGFyZW50LCExKSx0aGlzLnJlZHJhd19ub2RlKGIucGFyZW50fHxiLm5vZGUucGFyZW50LCEwKX0sdGhpcykpLm9uKFwibW92ZV9ub2RlLmpzdHJlZSBjb3B5X25vZGUuanN0cmVlXCIsYS5wcm94eShmdW5jdGlvbihhLGIpe3RoaXMuc29ydChiLnBhcmVudCwhMSksdGhpcy5yZWRyYXdfbm9kZShiLnBhcmVudCwhMCl9LHRoaXMpKX0sdGhpcy5zb3J0PWZ1bmN0aW9uKGIsYyl7dmFyIGQsZTtpZihiPXRoaXMuZ2V0X25vZGUoYiksYiYmYi5jaGlsZHJlbiYmYi5jaGlsZHJlbi5sZW5ndGgmJihiLmNoaWxkcmVuLnNvcnQoYS5wcm94eSh0aGlzLnNldHRpbmdzLnNvcnQsdGhpcykpLGMpKWZvcihkPTAsZT1iLmNoaWxkcmVuX2QubGVuZ3RoO2U+ZDtkKyspdGhpcy5zb3J0KGIuY2hpbGRyZW5fZFtkXSwhMSl9fTt2YXIgcD0hMTthLmpzdHJlZS5kZWZhdWx0cy5zdGF0ZT17a2V5OlwianN0cmVlXCIsZXZlbnRzOlwiY2hhbmdlZC5qc3RyZWUgb3Blbl9ub2RlLmpzdHJlZSBjbG9zZV9ub2RlLmpzdHJlZSBjaGVja19ub2RlLmpzdHJlZSB1bmNoZWNrX25vZGUuanN0cmVlXCIsdHRsOiExLGZpbHRlcjohMX0sYS5qc3RyZWUucGx1Z2lucy5zdGF0ZT1mdW5jdGlvbihiLGMpe3RoaXMuYmluZD1mdW5jdGlvbigpe2MuYmluZC5jYWxsKHRoaXMpO3ZhciBiPWEucHJveHkoZnVuY3Rpb24oKXt0aGlzLmVsZW1lbnQub24odGhpcy5zZXR0aW5ncy5zdGF0ZS5ldmVudHMsYS5wcm94eShmdW5jdGlvbigpe3AmJmNsZWFyVGltZW91dChwKSxwPXNldFRpbWVvdXQoYS5wcm94eShmdW5jdGlvbigpe3RoaXMuc2F2ZV9zdGF0ZSgpfSx0aGlzKSwxMDApfSx0aGlzKSksdGhpcy50cmlnZ2VyKFwic3RhdGVfcmVhZHlcIil9LHRoaXMpO3RoaXMuZWxlbWVudC5vbihcInJlYWR5LmpzdHJlZVwiLGEucHJveHkoZnVuY3Rpb24oYSxjKXt0aGlzLmVsZW1lbnQub25lKFwicmVzdG9yZV9zdGF0ZS5qc3RyZWVcIixiKSx0aGlzLnJlc3RvcmVfc3RhdGUoKXx8YigpfSx0aGlzKSl9LHRoaXMuc2F2ZV9zdGF0ZT1mdW5jdGlvbigpe3ZhciBiPXtzdGF0ZTp0aGlzLmdldF9zdGF0ZSgpLHR0bDp0aGlzLnNldHRpbmdzLnN0YXRlLnR0bCxzZWM6K25ldyBEYXRlfTthLnZha2F0YS5zdG9yYWdlLnNldCh0aGlzLnNldHRpbmdzLnN0YXRlLmtleSxKU09OLnN0cmluZ2lmeShiKSl9LHRoaXMucmVzdG9yZV9zdGF0ZT1mdW5jdGlvbigpe3ZhciBiPWEudmFrYXRhLnN0b3JhZ2UuZ2V0KHRoaXMuc2V0dGluZ3Muc3RhdGUua2V5KTtpZihiKXRyeXtiPUpTT04ucGFyc2UoYil9Y2F0Y2goYyl7cmV0dXJuITF9cmV0dXJuIGImJmIudHRsJiZiLnNlYyYmK25ldyBEYXRlLWIuc2VjPmIudHRsPyExOihiJiZiLnN0YXRlJiYoYj1iLnN0YXRlKSxiJiZhLmlzRnVuY3Rpb24odGhpcy5zZXR0aW5ncy5zdGF0ZS5maWx0ZXIpJiYoYj10aGlzLnNldHRpbmdzLnN0YXRlLmZpbHRlci5jYWxsKHRoaXMsYikpLGI/KHRoaXMuZWxlbWVudC5vbmUoXCJzZXRfc3RhdGUuanN0cmVlXCIsZnVuY3Rpb24oYyxkKXtkLmluc3RhbmNlLnRyaWdnZXIoXCJyZXN0b3JlX3N0YXRlXCIse3N0YXRlOmEuZXh0ZW5kKCEwLHt9LGIpfSl9KSx0aGlzLnNldF9zdGF0ZShiKSwhMCk6ITEpfSx0aGlzLmNsZWFyX3N0YXRlPWZ1bmN0aW9uKCl7cmV0dXJuIGEudmFrYXRhLnN0b3JhZ2UuZGVsKHRoaXMuc2V0dGluZ3Muc3RhdGUua2V5KX19LGZ1bmN0aW9uKGEsYil7YS52YWthdGEuc3RvcmFnZT17c2V0OmZ1bmN0aW9uKGEsYil7cmV0dXJuIHdpbmRvdy5sb2NhbFN0b3JhZ2Uuc2V0SXRlbShhLGIpfSxnZXQ6ZnVuY3Rpb24oYSl7cmV0dXJuIHdpbmRvdy5sb2NhbFN0b3JhZ2UuZ2V0SXRlbShhKX0sZGVsOmZ1bmN0aW9uKGEpe3JldHVybiB3aW5kb3cubG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oYSl9fX0oYSksYS5qc3RyZWUuZGVmYXVsdHMudHlwZXM9e1wiZGVmYXVsdFwiOnt9fSxhLmpzdHJlZS5kZWZhdWx0cy50eXBlc1thLmpzdHJlZS5yb290XT17fSxhLmpzdHJlZS5wbHVnaW5zLnR5cGVzPWZ1bmN0aW9uKGMsZCl7dGhpcy5pbml0PWZ1bmN0aW9uKGMsZSl7dmFyIGYsZztpZihlJiZlLnR5cGVzJiZlLnR5cGVzW1wiZGVmYXVsdFwiXSlmb3IoZiBpbiBlLnR5cGVzKWlmKFwiZGVmYXVsdFwiIT09ZiYmZiE9PWEuanN0cmVlLnJvb3QmJmUudHlwZXMuaGFzT3duUHJvcGVydHkoZikpZm9yKGcgaW4gZS50eXBlc1tcImRlZmF1bHRcIl0pZS50eXBlc1tcImRlZmF1bHRcIl0uaGFzT3duUHJvcGVydHkoZykmJmUudHlwZXNbZl1bZ109PT1iJiYoZS50eXBlc1tmXVtnXT1lLnR5cGVzW1wiZGVmYXVsdFwiXVtnXSk7ZC5pbml0LmNhbGwodGhpcyxjLGUpLHRoaXMuX21vZGVsLmRhdGFbYS5qc3RyZWUucm9vdF0udHlwZT1hLmpzdHJlZS5yb290fSx0aGlzLnJlZnJlc2g9ZnVuY3Rpb24oYixjKXtkLnJlZnJlc2guY2FsbCh0aGlzLGIsYyksdGhpcy5fbW9kZWwuZGF0YVthLmpzdHJlZS5yb290XS50eXBlPWEuanN0cmVlLnJvb3R9LHRoaXMuYmluZD1mdW5jdGlvbigpe3RoaXMuZWxlbWVudC5vbihcIm1vZGVsLmpzdHJlZVwiLGEucHJveHkoZnVuY3Rpb24oYyxkKXt2YXIgZT10aGlzLl9tb2RlbC5kYXRhLGY9ZC5ub2RlcyxnPXRoaXMuc2V0dGluZ3MudHlwZXMsaCxpLGo9XCJkZWZhdWx0XCIsaztmb3IoaD0wLGk9Zi5sZW5ndGg7aT5oO2grKyl7aWYoaj1cImRlZmF1bHRcIixlW2ZbaF1dLm9yaWdpbmFsJiZlW2ZbaF1dLm9yaWdpbmFsLnR5cGUmJmdbZVtmW2hdXS5vcmlnaW5hbC50eXBlXSYmKGo9ZVtmW2hdXS5vcmlnaW5hbC50eXBlKSxlW2ZbaF1dLmRhdGEmJmVbZltoXV0uZGF0YS5qc3RyZWUmJmVbZltoXV0uZGF0YS5qc3RyZWUudHlwZSYmZ1tlW2ZbaF1dLmRhdGEuanN0cmVlLnR5cGVdJiYoaj1lW2ZbaF1dLmRhdGEuanN0cmVlLnR5cGUpLGVbZltoXV0udHlwZT1qLGVbZltoXV0uaWNvbj09PSEwJiZnW2pdLmljb24hPT1iJiYoZVtmW2hdXS5pY29uPWdbal0uaWNvbiksZ1tqXS5saV9hdHRyIT09YiYmXCJvYmplY3RcIj09dHlwZW9mIGdbal0ubGlfYXR0cilmb3IoayBpbiBnW2pdLmxpX2F0dHIpaWYoZ1tqXS5saV9hdHRyLmhhc093blByb3BlcnR5KGspKXtpZihcImlkXCI9PT1rKWNvbnRpbnVlO2VbZltoXV0ubGlfYXR0cltrXT09PWI/ZVtmW2hdXS5saV9hdHRyW2tdPWdbal0ubGlfYXR0cltrXTpcImNsYXNzXCI9PT1rJiYoZVtmW2hdXS5saV9hdHRyW1wiY2xhc3NcIl09Z1tqXS5saV9hdHRyW1wiY2xhc3NcIl0rXCIgXCIrZVtmW2hdXS5saV9hdHRyW1wiY2xhc3NcIl0pfWlmKGdbal0uYV9hdHRyIT09YiYmXCJvYmplY3RcIj09dHlwZW9mIGdbal0uYV9hdHRyKWZvcihrIGluIGdbal0uYV9hdHRyKWlmKGdbal0uYV9hdHRyLmhhc093blByb3BlcnR5KGspKXtpZihcImlkXCI9PT1rKWNvbnRpbnVlO2VbZltoXV0uYV9hdHRyW2tdPT09Yj9lW2ZbaF1dLmFfYXR0cltrXT1nW2pdLmFfYXR0cltrXTpcImhyZWZcIj09PWsmJlwiI1wiPT09ZVtmW2hdXS5hX2F0dHJba10/ZVtmW2hdXS5hX2F0dHIuaHJlZj1nW2pdLmFfYXR0ci5ocmVmOlwiY2xhc3NcIj09PWsmJihlW2ZbaF1dLmFfYXR0cltcImNsYXNzXCJdPWdbal0uYV9hdHRyW1wiY2xhc3NcIl0rXCIgXCIrZVtmW2hdXS5hX2F0dHJbXCJjbGFzc1wiXSl9fWVbYS5qc3RyZWUucm9vdF0udHlwZT1hLmpzdHJlZS5yb290fSx0aGlzKSksZC5iaW5kLmNhbGwodGhpcyl9LHRoaXMuZ2V0X2pzb249ZnVuY3Rpb24oYixjLGUpe3ZhciBmLGcsaD10aGlzLl9tb2RlbC5kYXRhLGk9Yz9hLmV4dGVuZCghMCx7fSxjLHtub19pZDohMX0pOnt9LGo9ZC5nZXRfanNvbi5jYWxsKHRoaXMsYixpLGUpO2lmKGo9PT0hMSlyZXR1cm4hMTtpZihhLmlzQXJyYXkoaikpZm9yKGY9MCxnPWoubGVuZ3RoO2c+ZjtmKyspaltmXS50eXBlPWpbZl0uaWQmJmhbaltmXS5pZF0mJmhbaltmXS5pZF0udHlwZT9oW2pbZl0uaWRdLnR5cGU6XCJkZWZhdWx0XCIsYyYmYy5ub19pZCYmKGRlbGV0ZSBqW2ZdLmlkLGpbZl0ubGlfYXR0ciYmaltmXS5saV9hdHRyLmlkJiZkZWxldGUgaltmXS5saV9hdHRyLmlkLGpbZl0uYV9hdHRyJiZqW2ZdLmFfYXR0ci5pZCYmZGVsZXRlIGpbZl0uYV9hdHRyLmlkKTtlbHNlIGoudHlwZT1qLmlkJiZoW2ouaWRdJiZoW2ouaWRdLnR5cGU/aFtqLmlkXS50eXBlOlwiZGVmYXVsdFwiLGMmJmMubm9faWQmJihqPXRoaXMuX2RlbGV0ZV9pZHMoaikpO3JldHVybiBqfSx0aGlzLl9kZWxldGVfaWRzPWZ1bmN0aW9uKGIpe2lmKGEuaXNBcnJheShiKSl7Zm9yKHZhciBjPTAsZD1iLmxlbmd0aDtkPmM7YysrKWJbY109dGhpcy5fZGVsZXRlX2lkcyhiW2NdKTtyZXR1cm4gYn1yZXR1cm4gZGVsZXRlIGIuaWQsYi5saV9hdHRyJiZiLmxpX2F0dHIuaWQmJmRlbGV0ZSBiLmxpX2F0dHIuaWQsYi5hX2F0dHImJmIuYV9hdHRyLmlkJiZkZWxldGUgYi5hX2F0dHIuaWQsYi5jaGlsZHJlbiYmYS5pc0FycmF5KGIuY2hpbGRyZW4pJiYoYi5jaGlsZHJlbj10aGlzLl9kZWxldGVfaWRzKGIuY2hpbGRyZW4pKSxifSx0aGlzLmNoZWNrPWZ1bmN0aW9uKGMsZSxmLGcsaCl7aWYoZC5jaGVjay5jYWxsKHRoaXMsYyxlLGYsZyxoKT09PSExKXJldHVybiExO2U9ZSYmZS5pZD9lOnRoaXMuZ2V0X25vZGUoZSksZj1mJiZmLmlkP2Y6dGhpcy5nZXRfbm9kZShmKTt2YXIgaT1lJiZlLmlkP2gmJmgub3JpZ2luP2gub3JpZ2luOmEuanN0cmVlLnJlZmVyZW5jZShlLmlkKTpudWxsLGosayxsLG07c3dpdGNoKGk9aSYmaS5fbW9kZWwmJmkuX21vZGVsLmRhdGE/aS5fbW9kZWwuZGF0YTpudWxsLGMpe2Nhc2VcImNyZWF0ZV9ub2RlXCI6Y2FzZVwibW92ZV9ub2RlXCI6Y2FzZVwiY29weV9ub2RlXCI6aWYoXCJtb3ZlX25vZGVcIiE9PWN8fC0xPT09YS5pbkFycmF5KGUuaWQsZi5jaGlsZHJlbikpe2lmKGo9dGhpcy5nZXRfcnVsZXMoZiksai5tYXhfY2hpbGRyZW4hPT1iJiYtMSE9PWoubWF4X2NoaWxkcmVuJiZqLm1heF9jaGlsZHJlbj09PWYuY2hpbGRyZW4ubGVuZ3RoKXJldHVybiB0aGlzLl9kYXRhLmNvcmUubGFzdF9lcnJvcj17ZXJyb3I6XCJjaGVja1wiLHBsdWdpbjpcInR5cGVzXCIsaWQ6XCJ0eXBlc18wMVwiLHJlYXNvbjpcIm1heF9jaGlsZHJlbiBwcmV2ZW50cyBmdW5jdGlvbjogXCIrYyxkYXRhOkpTT04uc3RyaW5naWZ5KHtjaGs6Yyxwb3M6ZyxvYmo6ZSYmZS5pZD9lLmlkOiExLHBhcjpmJiZmLmlkP2YuaWQ6ITF9KX0sITE7aWYoai52YWxpZF9jaGlsZHJlbiE9PWImJi0xIT09ai52YWxpZF9jaGlsZHJlbiYmLTE9PT1hLmluQXJyYXkoZS50eXBlfHxcImRlZmF1bHRcIixqLnZhbGlkX2NoaWxkcmVuKSlyZXR1cm4gdGhpcy5fZGF0YS5jb3JlLmxhc3RfZXJyb3I9e2Vycm9yOlwiY2hlY2tcIixwbHVnaW46XCJ0eXBlc1wiLGlkOlwidHlwZXNfMDJcIixyZWFzb246XCJ2YWxpZF9jaGlsZHJlbiBwcmV2ZW50cyBmdW5jdGlvbjogXCIrYyxkYXRhOkpTT04uc3RyaW5naWZ5KHtjaGs6Yyxwb3M6ZyxvYmo6ZSYmZS5pZD9lLmlkOiExLHBhcjpmJiZmLmlkP2YuaWQ6ITF9KX0sITE7aWYoaSYmZS5jaGlsZHJlbl9kJiZlLnBhcmVudHMpe2ZvcihrPTAsbD0wLG09ZS5jaGlsZHJlbl9kLmxlbmd0aDttPmw7bCsrKWs9TWF0aC5tYXgoayxpW2UuY2hpbGRyZW5fZFtsXV0ucGFyZW50cy5sZW5ndGgpO2s9ay1lLnBhcmVudHMubGVuZ3RoKzF9KDA+PWt8fGs9PT1iKSYmKGs9MSk7ZG97aWYoai5tYXhfZGVwdGghPT1iJiYtMSE9PWoubWF4X2RlcHRoJiZqLm1heF9kZXB0aDxrKXJldHVybiB0aGlzLl9kYXRhLmNvcmUubGFzdF9lcnJvcj17ZXJyb3I6XCJjaGVja1wiLHBsdWdpbjpcInR5cGVzXCIsaWQ6XCJ0eXBlc18wM1wiLHJlYXNvbjpcIm1heF9kZXB0aCBwcmV2ZW50cyBmdW5jdGlvbjogXCIrYyxkYXRhOkpTT04uc3RyaW5naWZ5KHtjaGs6Yyxwb3M6ZyxvYmo6ZSYmZS5pZD9lLmlkOiExLHBhcjpmJiZmLmlkP2YuaWQ6ITF9KX0sITE7Zj10aGlzLmdldF9ub2RlKGYucGFyZW50KSxqPXRoaXMuZ2V0X3J1bGVzKGYpLGsrK313aGlsZShmKX19cmV0dXJuITB9LHRoaXMuZ2V0X3J1bGVzPWZ1bmN0aW9uKGEpe2lmKGE9dGhpcy5nZXRfbm9kZShhKSwhYSlyZXR1cm4hMTt2YXIgYz10aGlzLmdldF90eXBlKGEsITApO3JldHVybiBjLm1heF9kZXB0aD09PWImJihjLm1heF9kZXB0aD0tMSksYy5tYXhfY2hpbGRyZW49PT1iJiYoYy5tYXhfY2hpbGRyZW49LTEpLGMudmFsaWRfY2hpbGRyZW49PT1iJiYoYy52YWxpZF9jaGlsZHJlbj0tMSksY30sdGhpcy5nZXRfdHlwZT1mdW5jdGlvbihiLGMpe3JldHVybiBiPXRoaXMuZ2V0X25vZGUoYiksYj9jP2EuZXh0ZW5kKHt0eXBlOmIudHlwZX0sdGhpcy5zZXR0aW5ncy50eXBlc1tiLnR5cGVdKTpiLnR5cGU6ITF9LHRoaXMuc2V0X3R5cGU9ZnVuY3Rpb24oYyxkKXt2YXIgZT10aGlzLl9tb2RlbC5kYXRhLGYsZyxoLGksaixrLGwsbTtpZihhLmlzQXJyYXkoYykpe2ZvcihjPWMuc2xpY2UoKSxnPTAsaD1jLmxlbmd0aDtoPmc7ZysrKXRoaXMuc2V0X3R5cGUoY1tnXSxkKTtyZXR1cm4hMH1pZihmPXRoaXMuc2V0dGluZ3MudHlwZXMsYz10aGlzLmdldF9ub2RlKGMpLCFmW2RdfHwhYylyZXR1cm4hMTtpZihsPXRoaXMuZ2V0X25vZGUoYywhMCksbCYmbC5sZW5ndGgmJihtPWwuY2hpbGRyZW4oXCIuanN0cmVlLWFuY2hvclwiKSksaT1jLnR5cGUsaj10aGlzLmdldF9pY29uKGMpLGMudHlwZT1kLChqPT09ITB8fGZbaV0mJmZbaV0uaWNvbiE9PWImJmo9PT1mW2ldLmljb24pJiZ0aGlzLnNldF9pY29uKGMsZltkXS5pY29uIT09Yj9mW2RdLmljb246ITApLGZbaV0ubGlfYXR0ciE9PWImJlwib2JqZWN0XCI9PXR5cGVvZiBmW2ldLmxpX2F0dHIpZm9yKGsgaW4gZltpXS5saV9hdHRyKWlmKGZbaV0ubGlfYXR0ci5oYXNPd25Qcm9wZXJ0eShrKSl7aWYoXCJpZFwiPT09ayljb250aW51ZTtcImNsYXNzXCI9PT1rPyhlW2MuaWRdLmxpX2F0dHJbXCJjbGFzc1wiXT0oZVtjLmlkXS5saV9hdHRyW1wiY2xhc3NcIl18fFwiXCIpLnJlcGxhY2UoZltpXS5saV9hdHRyW2tdLFwiXCIpLGwmJmwucmVtb3ZlQ2xhc3MoZltpXS5saV9hdHRyW2tdKSk6ZVtjLmlkXS5saV9hdHRyW2tdPT09ZltpXS5saV9hdHRyW2tdJiYoZVtjLmlkXS5saV9hdHRyW2tdPW51bGwsbCYmbC5yZW1vdmVBdHRyKGspKX1pZihmW2ldLmFfYXR0ciE9PWImJlwib2JqZWN0XCI9PXR5cGVvZiBmW2ldLmFfYXR0cilmb3IoayBpbiBmW2ldLmFfYXR0cilpZihmW2ldLmFfYXR0ci5oYXNPd25Qcm9wZXJ0eShrKSl7aWYoXCJpZFwiPT09ayljb250aW51ZTtcImNsYXNzXCI9PT1rPyhlW2MuaWRdLmFfYXR0cltcImNsYXNzXCJdPShlW2MuaWRdLmFfYXR0cltcImNsYXNzXCJdfHxcIlwiKS5yZXBsYWNlKGZbaV0uYV9hdHRyW2tdLFwiXCIpLG0mJm0ucmVtb3ZlQ2xhc3MoZltpXS5hX2F0dHJba10pKTplW2MuaWRdLmFfYXR0cltrXT09PWZbaV0uYV9hdHRyW2tdJiYoXCJocmVmXCI9PT1rPyhlW2MuaWRdLmFfYXR0cltrXT1cIiNcIixtJiZtLmF0dHIoXCJocmVmXCIsXCIjXCIpKTooZGVsZXRlIGVbYy5pZF0uYV9hdHRyW2tdLG0mJm0ucmVtb3ZlQXR0cihrKSkpfWlmKGZbZF0ubGlfYXR0ciE9PWImJlwib2JqZWN0XCI9PXR5cGVvZiBmW2RdLmxpX2F0dHIpZm9yKGsgaW4gZltkXS5saV9hdHRyKWlmKGZbZF0ubGlfYXR0ci5oYXNPd25Qcm9wZXJ0eShrKSl7aWYoXCJpZFwiPT09ayljb250aW51ZTtlW2MuaWRdLmxpX2F0dHJba109PT1iPyhlW2MuaWRdLmxpX2F0dHJba109ZltkXS5saV9hdHRyW2tdLGwmJihcImNsYXNzXCI9PT1rP2wuYWRkQ2xhc3MoZltkXS5saV9hdHRyW2tdKTpsLmF0dHIoayxmW2RdLmxpX2F0dHJba10pKSk6XCJjbGFzc1wiPT09ayYmKGVbYy5pZF0ubGlfYXR0cltcImNsYXNzXCJdPWZbZF0ubGlfYXR0cltrXStcIiBcIitlW2MuaWRdLmxpX2F0dHJbXCJjbGFzc1wiXSxsJiZsLmFkZENsYXNzKGZbZF0ubGlfYXR0cltrXSkpfWlmKGZbZF0uYV9hdHRyIT09YiYmXCJvYmplY3RcIj09dHlwZW9mIGZbZF0uYV9hdHRyKWZvcihrIGluIGZbZF0uYV9hdHRyKWlmKGZbZF0uYV9hdHRyLmhhc093blByb3BlcnR5KGspKXtpZihcImlkXCI9PT1rKWNvbnRpbnVlO2VbYy5pZF0uYV9hdHRyW2tdPT09Yj8oZVtjLmlkXS5hX2F0dHJba109ZltkXS5hX2F0dHJba10sbSYmKFwiY2xhc3NcIj09PWs/bS5hZGRDbGFzcyhmW2RdLmFfYXR0cltrXSk6bS5hdHRyKGssZltkXS5hX2F0dHJba10pKSk6XCJocmVmXCI9PT1rJiZcIiNcIj09PWVbYy5pZF0uYV9hdHRyW2tdPyhlW2MuaWRdLmFfYXR0ci5ocmVmPWZbZF0uYV9hdHRyLmhyZWYsbSYmbS5hdHRyKFwiaHJlZlwiLGZbZF0uYV9hdHRyLmhyZWYpKTpcImNsYXNzXCI9PT1rJiYoZVtjLmlkXS5hX2F0dHJbXCJjbGFzc1wiXT1mW2RdLmFfYXR0cltcImNsYXNzXCJdK1wiIFwiK2VbYy5pZF0uYV9hdHRyW1wiY2xhc3NcIl0sbSYmbS5hZGRDbGFzcyhmW2RdLmFfYXR0cltrXSkpfXJldHVybiEwfX0sYS5qc3RyZWUuZGVmYXVsdHMudW5pcXVlPXtjYXNlX3NlbnNpdGl2ZTohMSxkdXBsaWNhdGU6ZnVuY3Rpb24oYSxiKXtyZXR1cm4gYStcIiAoXCIrYitcIilcIn19LGEuanN0cmVlLnBsdWdpbnMudW5pcXVlPWZ1bmN0aW9uKGMsZCl7dGhpcy5jaGVjaz1mdW5jdGlvbihiLGMsZSxmLGcpe2lmKGQuY2hlY2suY2FsbCh0aGlzLGIsYyxlLGYsZyk9PT0hMSlyZXR1cm4hMTtpZihjPWMmJmMuaWQ/Yzp0aGlzLmdldF9ub2RlKGMpLGU9ZSYmZS5pZD9lOnRoaXMuZ2V0X25vZGUoZSksIWV8fCFlLmNoaWxkcmVuKXJldHVybiEwO3ZhciBoPVwicmVuYW1lX25vZGVcIj09PWI/ZjpjLnRleHQsaT1bXSxqPXRoaXMuc2V0dGluZ3MudW5pcXVlLmNhc2Vfc2Vuc2l0aXZlLGs9dGhpcy5fbW9kZWwuZGF0YSxsLG07Zm9yKGw9MCxtPWUuY2hpbGRyZW4ubGVuZ3RoO20+bDtsKyspaS5wdXNoKGo/a1tlLmNoaWxkcmVuW2xdXS50ZXh0OmtbZS5jaGlsZHJlbltsXV0udGV4dC50b0xvd2VyQ2FzZSgpKTtzd2l0Y2goanx8KGg9aC50b0xvd2VyQ2FzZSgpKSxiKXtjYXNlXCJkZWxldGVfbm9kZVwiOnJldHVybiEwO2Nhc2VcInJlbmFtZV9ub2RlXCI6cmV0dXJuIGw9LTE9PT1hLmluQXJyYXkoaCxpKXx8Yy50ZXh0JiZjLnRleHRbaj9cInRvU3RyaW5nXCI6XCJ0b0xvd2VyQ2FzZVwiXSgpPT09aCxsfHwodGhpcy5fZGF0YS5jb3JlLmxhc3RfZXJyb3I9e2Vycm9yOlwiY2hlY2tcIixwbHVnaW46XCJ1bmlxdWVcIixpZDpcInVuaXF1ZV8wMVwiLHJlYXNvbjpcIkNoaWxkIHdpdGggbmFtZSBcIitoK1wiIGFscmVhZHkgZXhpc3RzLiBQcmV2ZW50aW5nOiBcIitiLGRhdGE6SlNPTi5zdHJpbmdpZnkoe2NoazpiLHBvczpmLG9iajpjJiZjLmlkP2MuaWQ6ITEscGFyOmUmJmUuaWQ/ZS5pZDohMX0pfSksbDtjYXNlXCJjcmVhdGVfbm9kZVwiOnJldHVybiBsPS0xPT09YS5pbkFycmF5KGgsaSksbHx8KHRoaXMuX2RhdGEuY29yZS5sYXN0X2Vycm9yPXtlcnJvcjpcImNoZWNrXCIscGx1Z2luOlwidW5pcXVlXCIsaWQ6XCJ1bmlxdWVfMDRcIixyZWFzb246XCJDaGlsZCB3aXRoIG5hbWUgXCIraCtcIiBhbHJlYWR5IGV4aXN0cy4gUHJldmVudGluZzogXCIrYixkYXRhOkpTT04uc3RyaW5naWZ5KHtjaGs6Yixwb3M6ZixvYmo6YyYmYy5pZD9jLmlkOiExLHBhcjplJiZlLmlkP2UuaWQ6ITF9KX0pLGw7Y2FzZVwiY29weV9ub2RlXCI6cmV0dXJuIGw9LTE9PT1hLmluQXJyYXkoaCxpKSxsfHwodGhpcy5fZGF0YS5jb3JlLmxhc3RfZXJyb3I9e2Vycm9yOlwiY2hlY2tcIixwbHVnaW46XCJ1bmlxdWVcIixpZDpcInVuaXF1ZV8wMlwiLHJlYXNvbjpcIkNoaWxkIHdpdGggbmFtZSBcIitoK1wiIGFscmVhZHkgZXhpc3RzLiBQcmV2ZW50aW5nOiBcIitiLGRhdGE6SlNPTi5zdHJpbmdpZnkoe2NoazpiLHBvczpmLG9iajpjJiZjLmlkP2MuaWQ6ITEscGFyOmUmJmUuaWQ/ZS5pZDohMX0pfSksbDtjYXNlXCJtb3ZlX25vZGVcIjpyZXR1cm4gbD1jLnBhcmVudD09PWUuaWQmJighZ3x8IWcuaXNfbXVsdGkpfHwtMT09PWEuaW5BcnJheShoLGkpLGx8fCh0aGlzLl9kYXRhLmNvcmUubGFzdF9lcnJvcj17ZXJyb3I6XCJjaGVja1wiLHBsdWdpbjpcInVuaXF1ZVwiLGlkOlwidW5pcXVlXzAzXCIscmVhc29uOlwiQ2hpbGQgd2l0aCBuYW1lIFwiK2grXCIgYWxyZWFkeSBleGlzdHMuIFByZXZlbnRpbmc6IFwiK2IsZGF0YTpKU09OLnN0cmluZ2lmeSh7Y2hrOmIscG9zOmYsb2JqOmMmJmMuaWQ/Yy5pZDohMSxwYXI6ZSYmZS5pZD9lLmlkOiExfSl9KSxsfXJldHVybiEwfSx0aGlzLmNyZWF0ZV9ub2RlPWZ1bmN0aW9uKGMsZSxmLGcsaCl7aWYoIWV8fGUudGV4dD09PWIpe2lmKG51bGw9PT1jJiYoYz1hLmpzdHJlZS5yb290KSxjPXRoaXMuZ2V0X25vZGUoYyksIWMpcmV0dXJuIGQuY3JlYXRlX25vZGUuY2FsbCh0aGlzLGMsZSxmLGcsaCk7aWYoZj1mPT09Yj9cImxhc3RcIjpmLCFmLnRvU3RyaW5nKCkubWF0Y2goL14oYmVmb3JlfGFmdGVyKSQvKSYmIWgmJiF0aGlzLmlzX2xvYWRlZChjKSlyZXR1cm4gZC5jcmVhdGVfbm9kZS5jYWxsKHRoaXMsYyxlLGYsZyxoKTtcbmV8fChlPXt9KTt2YXIgaSxqLGssbCxtLG49dGhpcy5fbW9kZWwuZGF0YSxvPXRoaXMuc2V0dGluZ3MudW5pcXVlLmNhc2Vfc2Vuc2l0aXZlLHA9dGhpcy5zZXR0aW5ncy51bmlxdWUuZHVwbGljYXRlO2ZvcihqPWk9dGhpcy5nZXRfc3RyaW5nKFwiTmV3IG5vZGVcIiksaz1bXSxsPTAsbT1jLmNoaWxkcmVuLmxlbmd0aDttPmw7bCsrKWsucHVzaChvP25bYy5jaGlsZHJlbltsXV0udGV4dDpuW2MuY2hpbGRyZW5bbF1dLnRleHQudG9Mb3dlckNhc2UoKSk7bD0xO3doaWxlKC0xIT09YS5pbkFycmF5KG8/ajpqLnRvTG93ZXJDYXNlKCksaykpaj1wLmNhbGwodGhpcyxpLCsrbCkudG9TdHJpbmcoKTtlLnRleHQ9an1yZXR1cm4gZC5jcmVhdGVfbm9kZS5jYWxsKHRoaXMsYyxlLGYsZyxoKX19O3ZhciBxPWkuY3JlYXRlRWxlbWVudChcIkRJVlwiKTtpZihxLnNldEF0dHJpYnV0ZShcInVuc2VsZWN0YWJsZVwiLFwib25cIikscS5zZXRBdHRyaWJ1dGUoXCJyb2xlXCIsXCJwcmVzZW50YXRpb25cIikscS5jbGFzc05hbWU9XCJqc3RyZWUtd2hvbGVyb3dcIixxLmlubmVySFRNTD1cIiYjMTYwO1wiLGEuanN0cmVlLnBsdWdpbnMud2hvbGVyb3c9ZnVuY3Rpb24oYixjKXt0aGlzLmJpbmQ9ZnVuY3Rpb24oKXtjLmJpbmQuY2FsbCh0aGlzKSx0aGlzLmVsZW1lbnQub24oXCJyZWFkeS5qc3RyZWUgc2V0X3N0YXRlLmpzdHJlZVwiLGEucHJveHkoZnVuY3Rpb24oKXt0aGlzLmhpZGVfZG90cygpfSx0aGlzKSkub24oXCJpbml0LmpzdHJlZSBsb2FkaW5nLmpzdHJlZSByZWFkeS5qc3RyZWVcIixhLnByb3h5KGZ1bmN0aW9uKCl7dGhpcy5nZXRfY29udGFpbmVyX3VsKCkuYWRkQ2xhc3MoXCJqc3RyZWUtd2hvbGVyb3ctdWxcIil9LHRoaXMpKS5vbihcImRlc2VsZWN0X2FsbC5qc3RyZWVcIixhLnByb3h5KGZ1bmN0aW9uKGEsYil7dGhpcy5lbGVtZW50LmZpbmQoXCIuanN0cmVlLXdob2xlcm93LWNsaWNrZWRcIikucmVtb3ZlQ2xhc3MoXCJqc3RyZWUtd2hvbGVyb3ctY2xpY2tlZFwiKX0sdGhpcykpLm9uKFwiY2hhbmdlZC5qc3RyZWVcIixhLnByb3h5KGZ1bmN0aW9uKGEsYil7dGhpcy5lbGVtZW50LmZpbmQoXCIuanN0cmVlLXdob2xlcm93LWNsaWNrZWRcIikucmVtb3ZlQ2xhc3MoXCJqc3RyZWUtd2hvbGVyb3ctY2xpY2tlZFwiKTt2YXIgYz0hMSxkLGU7Zm9yKGQ9MCxlPWIuc2VsZWN0ZWQubGVuZ3RoO2U+ZDtkKyspYz10aGlzLmdldF9ub2RlKGIuc2VsZWN0ZWRbZF0sITApLGMmJmMubGVuZ3RoJiZjLmNoaWxkcmVuKFwiLmpzdHJlZS13aG9sZXJvd1wiKS5hZGRDbGFzcyhcImpzdHJlZS13aG9sZXJvdy1jbGlja2VkXCIpfSx0aGlzKSkub24oXCJvcGVuX25vZGUuanN0cmVlXCIsYS5wcm94eShmdW5jdGlvbihhLGIpe3RoaXMuZ2V0X25vZGUoYi5ub2RlLCEwKS5maW5kKFwiLmpzdHJlZS1jbGlja2VkXCIpLnBhcmVudCgpLmNoaWxkcmVuKFwiLmpzdHJlZS13aG9sZXJvd1wiKS5hZGRDbGFzcyhcImpzdHJlZS13aG9sZXJvdy1jbGlja2VkXCIpfSx0aGlzKSkub24oXCJob3Zlcl9ub2RlLmpzdHJlZSBkZWhvdmVyX25vZGUuanN0cmVlXCIsYS5wcm94eShmdW5jdGlvbihhLGIpe1wiaG92ZXJfbm9kZVwiPT09YS50eXBlJiZ0aGlzLmlzX2Rpc2FibGVkKGIubm9kZSl8fHRoaXMuZ2V0X25vZGUoYi5ub2RlLCEwKS5jaGlsZHJlbihcIi5qc3RyZWUtd2hvbGVyb3dcIilbXCJob3Zlcl9ub2RlXCI9PT1hLnR5cGU/XCJhZGRDbGFzc1wiOlwicmVtb3ZlQ2xhc3NcIl0oXCJqc3RyZWUtd2hvbGVyb3ctaG92ZXJlZFwiKX0sdGhpcykpLm9uKFwiY29udGV4dG1lbnUuanN0cmVlXCIsXCIuanN0cmVlLXdob2xlcm93XCIsYS5wcm94eShmdW5jdGlvbihiKXtpZih0aGlzLl9kYXRhLmNvbnRleHRtZW51KXtiLnByZXZlbnREZWZhdWx0KCk7dmFyIGM9YS5FdmVudChcImNvbnRleHRtZW51XCIse21ldGFLZXk6Yi5tZXRhS2V5LGN0cmxLZXk6Yi5jdHJsS2V5LGFsdEtleTpiLmFsdEtleSxzaGlmdEtleTpiLnNoaWZ0S2V5LHBhZ2VYOmIucGFnZVgscGFnZVk6Yi5wYWdlWX0pO2EoYi5jdXJyZW50VGFyZ2V0KS5jbG9zZXN0KFwiLmpzdHJlZS1ub2RlXCIpLmNoaWxkcmVuKFwiLmpzdHJlZS1hbmNob3JcIikuZmlyc3QoKS50cmlnZ2VyKGMpfX0sdGhpcykpLm9uKFwiY2xpY2suanN0cmVlXCIsXCIuanN0cmVlLXdob2xlcm93XCIsZnVuY3Rpb24oYil7Yi5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24oKTt2YXIgYz1hLkV2ZW50KFwiY2xpY2tcIix7bWV0YUtleTpiLm1ldGFLZXksY3RybEtleTpiLmN0cmxLZXksYWx0S2V5OmIuYWx0S2V5LHNoaWZ0S2V5OmIuc2hpZnRLZXl9KTthKGIuY3VycmVudFRhcmdldCkuY2xvc2VzdChcIi5qc3RyZWUtbm9kZVwiKS5jaGlsZHJlbihcIi5qc3RyZWUtYW5jaG9yXCIpLmZpcnN0KCkudHJpZ2dlcihjKS5mb2N1cygpfSkub24oXCJjbGljay5qc3RyZWVcIixcIi5qc3RyZWUtbGVhZiA+IC5qc3RyZWUtb2NsXCIsYS5wcm94eShmdW5jdGlvbihiKXtiLnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbigpO3ZhciBjPWEuRXZlbnQoXCJjbGlja1wiLHttZXRhS2V5OmIubWV0YUtleSxjdHJsS2V5OmIuY3RybEtleSxhbHRLZXk6Yi5hbHRLZXksc2hpZnRLZXk6Yi5zaGlmdEtleX0pO2EoYi5jdXJyZW50VGFyZ2V0KS5jbG9zZXN0KFwiLmpzdHJlZS1ub2RlXCIpLmNoaWxkcmVuKFwiLmpzdHJlZS1hbmNob3JcIikuZmlyc3QoKS50cmlnZ2VyKGMpLmZvY3VzKCl9LHRoaXMpKS5vbihcIm1vdXNlb3Zlci5qc3RyZWVcIixcIi5qc3RyZWUtd2hvbGVyb3csIC5qc3RyZWUtaWNvblwiLGEucHJveHkoZnVuY3Rpb24oYSl7cmV0dXJuIGEuc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKCksdGhpcy5pc19kaXNhYmxlZChhLmN1cnJlbnRUYXJnZXQpfHx0aGlzLmhvdmVyX25vZGUoYS5jdXJyZW50VGFyZ2V0KSwhMX0sdGhpcykpLm9uKFwibW91c2VsZWF2ZS5qc3RyZWVcIixcIi5qc3RyZWUtbm9kZVwiLGEucHJveHkoZnVuY3Rpb24oYSl7dGhpcy5kZWhvdmVyX25vZGUoYS5jdXJyZW50VGFyZ2V0KX0sdGhpcykpfSx0aGlzLnRlYXJkb3duPWZ1bmN0aW9uKCl7dGhpcy5zZXR0aW5ncy53aG9sZXJvdyYmdGhpcy5lbGVtZW50LmZpbmQoXCIuanN0cmVlLXdob2xlcm93XCIpLnJlbW92ZSgpLGMudGVhcmRvd24uY2FsbCh0aGlzKX0sdGhpcy5yZWRyYXdfbm9kZT1mdW5jdGlvbihiLGQsZSxmKXtpZihiPWMucmVkcmF3X25vZGUuYXBwbHkodGhpcyxhcmd1bWVudHMpKXt2YXIgZz1xLmNsb25lTm9kZSghMCk7LTEhPT1hLmluQXJyYXkoYi5pZCx0aGlzLl9kYXRhLmNvcmUuc2VsZWN0ZWQpJiYoZy5jbGFzc05hbWUrPVwiIGpzdHJlZS13aG9sZXJvdy1jbGlja2VkXCIpLHRoaXMuX2RhdGEuY29yZS5mb2N1c2VkJiZ0aGlzLl9kYXRhLmNvcmUuZm9jdXNlZD09PWIuaWQmJihnLmNsYXNzTmFtZSs9XCIganN0cmVlLXdob2xlcm93LWhvdmVyZWRcIiksYi5pbnNlcnRCZWZvcmUoZyxiLmNoaWxkTm9kZXNbMF0pfXJldHVybiBifX0saS5yZWdpc3RlckVsZW1lbnQmJk9iamVjdCYmT2JqZWN0LmNyZWF0ZSl7dmFyIHI9T2JqZWN0LmNyZWF0ZShIVE1MRWxlbWVudC5wcm90b3R5cGUpO3IuY3JlYXRlZENhbGxiYWNrPWZ1bmN0aW9uKCl7dmFyIGI9e2NvcmU6e30scGx1Z2luczpbXX0sYztmb3IoYyBpbiBhLmpzdHJlZS5wbHVnaW5zKWEuanN0cmVlLnBsdWdpbnMuaGFzT3duUHJvcGVydHkoYykmJnRoaXMuYXR0cmlidXRlc1tjXSYmKGIucGx1Z2lucy5wdXNoKGMpLHRoaXMuZ2V0QXR0cmlidXRlKGMpJiZKU09OLnBhcnNlKHRoaXMuZ2V0QXR0cmlidXRlKGMpKSYmKGJbY109SlNPTi5wYXJzZSh0aGlzLmdldEF0dHJpYnV0ZShjKSkpKTtmb3IoYyBpbiBhLmpzdHJlZS5kZWZhdWx0cy5jb3JlKWEuanN0cmVlLmRlZmF1bHRzLmNvcmUuaGFzT3duUHJvcGVydHkoYykmJnRoaXMuYXR0cmlidXRlc1tjXSYmKGIuY29yZVtjXT1KU09OLnBhcnNlKHRoaXMuZ2V0QXR0cmlidXRlKGMpKXx8dGhpcy5nZXRBdHRyaWJ1dGUoYykpO2EodGhpcykuanN0cmVlKGIpfTt0cnl7aS5yZWdpc3RlckVsZW1lbnQoXCJ2YWthdGEtanN0cmVlXCIse3Byb3RvdHlwZTpyfSl9Y2F0Y2gocyl7fX19fSk7XG5cblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyAuL2Ntcy9zdGF0aWMvY21zL2pzL2xpYnMvanN0cmVlL2pzdHJlZS5taW4uanNcbi8vIG1vZHVsZSBpZCA9IDEzMFxuLy8gbW9kdWxlIGNodW5rcyA9IDEiXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///130\n");

/***/ }),

/***/ 193:
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("Object.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__polyfills_function_prototype_bind_js__ = __webpack_require__(56);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__polyfills_function_prototype_bind_js___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0__polyfills_function_prototype_bind_js__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__libs_pep__ = __webpack_require__(63);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__libs_pep___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1__libs_pep__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__modules_cms_pagetree__ = __webpack_require__(194);\n// polyfills\n\n\n\n\n\nwindow.CMS.PageTree = __WEBPACK_IMPORTED_MODULE_2__modules_cms_pagetree__[\"a\" /* default */];//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTkzLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vL2Ntcy9zdGF0aWMvY21zL2pzL2FkbWluLnBhZ2V0cmVlLmpzPzhiMWQiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gcG9seWZpbGxzXG5pbXBvcnQgJy4vcG9seWZpbGxzL2Z1bmN0aW9uLnByb3RvdHlwZS5iaW5kLmpzJztcbmltcG9ydCAnLi9saWJzL3BlcCc7XG5cbmltcG9ydCBQYWdlVHJlZSBmcm9tICcuL21vZHVsZXMvY21zLnBhZ2V0cmVlJztcblxud2luZG93LkNNUy5QYWdlVHJlZSA9IFBhZ2VUcmVlO1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIGNtcy9zdGF0aWMvY21zL2pzL2FkbWluLnBhZ2V0cmVlLmpzIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///193\n");

/***/ }),

/***/ 194:
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_toConsumableArray__ = __webpack_require__(106);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_toConsumableArray___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_toConsumableArray__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_jquery__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_jquery___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_jquery__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_classjs__ = __webpack_require__(10);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_classjs___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_classjs__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__cms_base__ = __webpack_require__(14);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__cms_pagetree_dropdown__ = __webpack_require__(195);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__cms_pagetree_stickyheader__ = __webpack_require__(196);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_lodash__ = __webpack_require__(15);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_lodash___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_6_lodash__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7_jstree__ = __webpack_require__(130);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7_jstree___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_7_jstree__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__libs_jstree_jstree_grid_min__ = __webpack_require__(197);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__libs_jstree_jstree_grid_min___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_8__libs_jstree_jstree_grid_min__);\n /*\n                                                                           * Copyright https://github.com/divio/django-cms\n                                                                           */\n\n\n\n\n\n\n\n\n\n\n\n\n/**\n                                          * The pagetree is loaded via `/admin/cms/page` and has a custom admin\n                                          * templates stored within `templates/admin/cms/page/tree`.\n                                          *\n                                          * @class PageTree\n                                          * @namespace CMS\n                                          */\nvar PageTree = new __WEBPACK_IMPORTED_MODULE_2_classjs___default.a({\n    options: {\n        pasteSelector: '.js-cms-tree-item-paste' },\n\n    initialize: function initialize(options) {\n        // options are loaded from the pagetree html node\n        var opts = __WEBPACK_IMPORTED_MODULE_1_jquery___default()('.js-cms-pagetree').data('json');\n\n        this.options = __WEBPACK_IMPORTED_MODULE_1_jquery___default.a.extend(true, {}, this.options, opts, options);\n\n        // states and events\n        this.click = 'click.cms.pagetree';\n        this.clipboard = {\n            id: null,\n            origin: null,\n            type: '' };\n\n        this.successTimer = 1000;\n\n        // elements\n        this._setupUI();\n        this._events();\n\n        __WEBPACK_IMPORTED_MODULE_3__cms_base__[\"c\" /* Helpers */].csrf(this.options.csrf);\n\n        // cancel if pagetree is not available\n        if (__WEBPACK_IMPORTED_MODULE_1_jquery___default.a.isEmptyObject(opts) || opts.empty) {\n            this._getClipboard();\n            // attach events to paste\n            var that = this;\n\n            this.ui.container.on(this.click, this.options.pasteSelector, function (e) {\n                e.preventDefault();\n                if (__WEBPACK_IMPORTED_MODULE_1_jquery___default()(this).hasClass('cms-pagetree-dropdown-item-disabled')) {\n                    return;\n                }\n                that._paste(e);\n            });\n        } else {\n            this._setup();\n        }\n    },\n\n    /**\n        * Stores all jQuery references within `this.ui`.\n        *\n        * @method _setupUI\n        * @private\n        */\n    _setupUI: function _setupUI() {\n        var pagetree = __WEBPACK_IMPORTED_MODULE_1_jquery___default()('.cms-pagetree');\n\n        this.ui = {\n            container: pagetree,\n            document: __WEBPACK_IMPORTED_MODULE_1_jquery___default()(document),\n            tree: pagetree.find('.js-cms-pagetree'),\n            dialog: __WEBPACK_IMPORTED_MODULE_1_jquery___default()('.js-cms-tree-dialog'),\n            siteForm: __WEBPACK_IMPORTED_MODULE_1_jquery___default()('.js-cms-pagetree-site-form') };\n\n    },\n\n    /**\n        * Setting up the jstree and the related columns.\n        *\n        * @method _setup\n        * @private\n        */\n    _setup: function _setup() {\n        var that = this;\n        var columns = [];\n        var obj = {\n            language: this.options.lang.code,\n            openNodes: [] };\n\n        var data = false;\n\n        // setup column headings\n        // eslint-disable-next-line no-shadow\n        __WEBPACK_IMPORTED_MODULE_1_jquery___default.a.each(this.options.columns, function (index, obj) {\n            if (obj.key === '') {\n                // the first row is already populated, to avoid overwrites\n                // just leave the \"key\" param empty\n                columns.push({\n                    wideValueClass: obj.wideValueClass,\n                    wideValueClassPrefix: obj.wideValueClassPrefix,\n                    header: obj.title,\n                    width: obj.width || '1%',\n                    wideCellClass: obj.cls });\n\n            } else {\n                columns.push({\n                    wideValueClass: obj.wideValueClass,\n                    wideValueClassPrefix: obj.wideValueClassPrefix,\n                    header: obj.title,\n                    value: function value(node) {\n                        // it needs to have the \"colde\" format and not \"col-de\"\n                        // as jstree will convert \"col-de\" to \"colde\"\n                        // also we strip dashes, in case language code contains it\n                        // e.g. zh-hans, zh-cn etc\n                        if (node.data) {\n                            return node.data['col' + obj.key.replace('-', '')];\n                        }\n\n                        return '';\n                    },\n                    width: obj.width || '1%',\n                    wideCellClass: obj.cls });\n\n            }\n        });\n\n        // prepare data\n        if (!this.options.filtered) {\n            data = {\n                url: this.options.urls.tree,\n                cache: false,\n                data: function data(node) {\n                    // '#' is rendered if its the root node, there we only\n                    // care about `obj.openNodes`, in the following case\n                    // we are requesting a specific node\n                    if (node.id === '#') {\n                        obj.nodeId = null;\n                    } else {\n                        obj.nodeId = that._storeNodeId(node.data.nodeId);\n                    }\n\n                    // we need to store the opened items inside the localstorage\n                    // as we have to load the pagetree with the previous opened\n                    // state\n                    obj.openNodes = that._getStoredNodeIds();\n\n                    // we need to set the site id to get the correct tree\n                    obj.site = that.options.site;\n\n                    return obj;\n                } };\n\n        }\n\n        // bind options to the jstree instance\n        this.ui.tree.jstree({\n            core: {\n                // disable open/close animations\n                animation: 0,\n                // core setting to allow actions\n                // eslint-disable-next-line max-params\n                check_callback: function check_callback(operation, node, node_parent, node_position, more) {\n                    if ((operation === 'move_node' || operation === 'copy_node') && more && more.pos) {\n                        if (more.pos === 'i') {\n                            __WEBPACK_IMPORTED_MODULE_1_jquery___default()('#jstree-marker').addClass('jstree-marker-child');\n                        } else {\n                            __WEBPACK_IMPORTED_MODULE_1_jquery___default()('#jstree-marker').removeClass('jstree-marker-child');\n                        }\n                    }\n\n                    return that._hasPermission(node_parent, 'add');\n                },\n                // https://www.jstree.com/api/#/?f=$.jstree.defaults.core.data\n                data: data,\n                // strings used within jstree that are called using `get_string`\n                strings: {\n                    'Loading ...': this.options.lang.loading,\n                    'New node': this.options.lang.newNode,\n                    nodes: this.options.lang.nodes },\n\n                error: function error(_error) {\n                    // ignore warnings about dragging parent into child\n                    var errorData = JSON.parse(_error.data);\n\n                    if (_error.error === 'check' && errorData && errorData.chk === 'move_node') {\n                        return;\n                    }\n                    that.showError(_error.reason);\n                },\n                themes: {\n                    name: 'django-cms' },\n\n                // disable the multi selection of nodes for now\n                multiple: false },\n\n            // activate drag and drop plugin\n            plugins: ['dnd', 'search', 'grid'],\n            // https://www.jstree.com/api/#/?f=$.jstree.defaults.dnd\n            dnd: {\n                inside_pos: 'last',\n                // disable the multi selection of nodes for now\n                drag_selection: false,\n                // disable dragging if filtered\n                is_draggable: function is_draggable(nodes) {\n                    return that._hasPermission(nodes[0], 'move') && !that.options.filtered;\n                },\n                large_drop_target: true,\n                copy: true,\n                touch: 'selected' },\n\n            // https://github.com/deitch/jstree-grid\n            grid: {\n                // columns are provided from base.html options\n                width: '100%',\n                columns: columns } });\n\n\n    },\n\n    /**\n        * Sets up all the event handlers, such as opening and moving.\n        *\n        * @method _events\n        * @private\n        */\n    _events: function _events() {var _this = this;\n        var that = this;\n\n        // set events for the nodeId updates\n        this.ui.tree.on('after_close.jstree', function (e, el) {\n            that._removeNodeId(el.node.data.nodeId);\n        });\n\n        this.ui.tree.on('after_open.jstree', function (e, el) {\n            that._storeNodeId(el.node.data.nodeId);\n\n            // `after_open` event can be triggered when pasting\n            // is in progress (meaning we are pasting into a leaf node\n            // in this case we do not need to update helpers state\n            if (this.clipboard && !this.clipboard.isPasting) {\n                that._updatePasteHelpersState();\n            }\n        });\n\n        this.ui.document.on('keydown.pagetree.alt-mode', function (e) {\n            if (e.keyCode === __WEBPACK_IMPORTED_MODULE_3__cms_base__[\"d\" /* KEYS */].SHIFT) {\n                that.ui.container.addClass('cms-pagetree-alt-mode');\n            }\n        });\n\n        this.ui.document.on('keyup.pagetree.alt-mode', function (e) {\n            if (e.keyCode === __WEBPACK_IMPORTED_MODULE_3__cms_base__[\"d\" /* KEYS */].SHIFT) {\n                that.ui.container.removeClass('cms-pagetree-alt-mode');\n            }\n        });\n\n        __WEBPACK_IMPORTED_MODULE_1_jquery___default()(window).\n        on(\n        'mousemove.pagetree.alt-mode',\n        Object(__WEBPACK_IMPORTED_MODULE_6_lodash__[\"debounce\"])(function (e) {\n            if (e.shiftKey) {\n                that.ui.container.addClass('cms-pagetree-alt-mode');\n            } else {\n                that.ui.container.removeClass('cms-pagetree-alt-mode');\n            }\n        }, 200) // eslint-disable-line no-magic-numbers\n        ).\n        on('blur.cms', function () {\n            that.ui.container.removeClass('cms-pagetree-alt-mode');\n        });\n\n        this.ui.document.on('dnd_start.vakata', function (e, data) {\n            var element = __WEBPACK_IMPORTED_MODULE_1_jquery___default()(data.element);\n            var node = element.parent();\n\n            that._dropdowns.closeAllDropdowns();\n\n            node.addClass('jstree-is-dragging');\n            data.data.nodes.forEach(function (nodeId) {\n                var descendantIds = that._getDescendantsIds(nodeId);\n\n                [nodeId].concat(descendantIds).forEach(function (id) {\n                    __WEBPACK_IMPORTED_MODULE_1_jquery___default()('.jsgrid_' + id + '_col').addClass('jstree-is-dragging');\n                });\n            });\n\n            if (!node.hasClass('jstree-leaf')) {\n                data.helper.addClass('is-stacked');\n            }\n        });\n\n        var isCopyClassAdded = false;\n\n        this.ui.document.on('dnd_move.vakata', function (e, data) {\n            var isMovingCopy =\n            data.data.origin && (\n            data.data.origin.settings.dnd.always_copy ||\n            data.data.origin.settings.dnd.copy && (data.event.metaKey || data.event.ctrlKey));\n\n            if (isMovingCopy) {\n                if (!isCopyClassAdded) {\n                    __WEBPACK_IMPORTED_MODULE_1_jquery___default()('.jstree-is-dragging').addClass('jstree-is-dragging-copy');\n                    isCopyClassAdded = true;\n                }\n            } else if (isCopyClassAdded) {\n                __WEBPACK_IMPORTED_MODULE_1_jquery___default()('.jstree-is-dragging').removeClass('jstree-is-dragging-copy');\n                isCopyClassAdded = false;\n            }\n        });\n\n        this.ui.document.on('dnd_stop.vakata', function (e, data) {\n            var element = __WEBPACK_IMPORTED_MODULE_1_jquery___default()(data.element);\n            var node = element.parent();\n\n            node.removeClass('jstree-is-dragging jstree-is-dragging-copy');\n            data.data.nodes.forEach(function (nodeId) {\n                var descendantIds = that._getDescendantsIds(nodeId);\n\n                [nodeId].concat(descendantIds).forEach(function (id) {\n                    __WEBPACK_IMPORTED_MODULE_1_jquery___default()('.jsgrid_' + id + '_col').removeClass('jstree-is-dragging jstree-is-dragging-copy');\n                });\n            });\n        });\n\n        // store moved position node\n        this.ui.tree.on('move_node.jstree copy_node.jstree', function (e, obj) {\n            if (!that.clipboard.type && e.type !== 'copy_node' || that.clipboard.type === 'cut') {\n                that._moveNode(that._getNodePosition(obj)).done(function () {\n                    var instance = that.ui.tree.jstree(true);\n\n                    instance._hide_grid(instance.get_node(obj.parent));\n                    if (obj.parent === '#' || obj.node && obj.node.data && obj.node.data.isHome) {\n                        instance.refresh();\n                    } else {\n                        // have to refresh parent, because refresh only\n                        // refreshes children of the node, never the node itself\n                        instance.refresh_node(obj.parent);\n                    }\n                });\n            } else {\n                that._copyNode(obj);\n            }\n            // we need to open the parent node if we trigger an element\n            // if not already opened\n            that.ui.tree.jstree('open_node', obj.parent);\n        });\n\n        // set event for cut and paste\n        this.ui.container.on(this.click, '.js-cms-tree-item-cut', function (e) {\n            e.preventDefault();\n            that._cutOrCopy({ type: 'cut', element: __WEBPACK_IMPORTED_MODULE_1_jquery___default()(this) });\n        });\n\n        // set event for cut and paste\n        this.ui.container.on(this.click, '.js-cms-tree-item-copy', function (e) {\n            e.preventDefault();\n            that._cutOrCopy({ type: 'copy', element: __WEBPACK_IMPORTED_MODULE_1_jquery___default()(this) });\n        });\n\n        // attach events to paste\n        this.ui.container.on(this.click, this.options.pasteSelector, function (e) {\n            e.preventDefault();\n            if (__WEBPACK_IMPORTED_MODULE_1_jquery___default()(this).hasClass('cms-pagetree-dropdown-item-disabled')) {\n                return;\n            }\n            that._paste(e);\n        });\n\n        // advanced settings link handling\n        this.ui.container.on(this.click, '.js-cms-tree-advanced-settings', function (e) {\n            if (e.shiftKey) {\n                e.preventDefault();\n                var link = __WEBPACK_IMPORTED_MODULE_1_jquery___default()(this);\n\n                if (link.data('url')) {\n                    window.location.href = link.data('url');\n                }\n            }\n        });\n\n        // when adding new pages - expand nodes as well\n        this.ui.container.on(this.click, '.js-cms-pagetree-add-page', function (e) {\n            var treeId = _this._getNodeId(__WEBPACK_IMPORTED_MODULE_1_jquery___default()(e.target));\n\n            var nodeData = _this.ui.tree.jstree('get_node', treeId);\n\n            _this._storeNodeId(nodeData.data.id);\n        });\n\n        // add events for error reload (messagelist)\n        this.ui.document.on(this.click, '.messagelist .cms-tree-reload', function (e) {\n            e.preventDefault();\n            that._reloadHelper();\n        });\n\n        // propagate the sites dropdown \"li > a\" entries to the hidden sites form\n        this.ui.container.find('.js-cms-pagetree-site-trigger').on(this.click, function (e) {\n            e.preventDefault();\n            var el = __WEBPACK_IMPORTED_MODULE_1_jquery___default()(this);\n\n            // prevent if parent is active\n            if (el.parent().hasClass('active')) {\n                return false;\n            }\n            that.ui.siteForm.find('select').val(el.data().id).end().submit();\n        });\n\n        // additional event handlers\n        this._setupDropdowns();\n        this._setupSearch();\n\n        // make sure ajax post requests are working\n        this._setAjaxPost('.js-cms-tree-item-menu a');\n        this._setAjaxPost('.js-cms-tree-lang-trigger');\n        this._setAjaxPost('.js-cms-tree-item-set-home a');\n\n        this._setupPageView();\n        this._setupStickyHeader();\n\n        this.ui.tree.on('ready.jstree', function () {return _this._getClipboard();});\n    },\n\n    _getClipboard: function _getClipboard() {\n        this.clipboard = CMS.settings.pageClipboard || this.clipboard;\n\n        if (this.clipboard.type && this.clipboard.origin) {\n            this._enablePaste();\n            this._updatePasteHelpersState();\n        }\n    },\n\n    /**\n        * Helper to process the cut and copy events.\n        *\n        * @method _cutOrCopy\n        * @param {Object} [obj]\n        * @param {Number} [obj.type] either 'cut' or 'copy'\n        * @param {Number} [obj.element] originated trigger element\n        * @private\n        * @returns {Boolean|void}\n        */\n    _cutOrCopy: function _cutOrCopy(obj) {\n        // prevent actions if you try to copy a page with an apphook\n        if (obj.type === 'copy' && obj.element.data().apphook) {\n            this.showError(this.options.lang.apphook);\n            return false;\n        }\n\n        var jsTreeId = this._getNodeId(obj.element.closest('.jstree-grid-cell'));\n\n        // resets if we click again\n        if (this.clipboard.type === obj.type && jsTreeId === this.clipboard.id) {\n            this.clipboard.type = null;\n            this.clipboard.id = null;\n            this.clipboard.origin = null;\n            this.clipboard.source_site = null;\n            this._disablePaste();\n        } else {\n            this.clipboard.origin = obj.element.data().id; // this._getNodeId(obj.element);\n            this.clipboard.type = obj.type;\n            this.clipboard.id = jsTreeId;\n            this.clipboard.source_site = this.options.site;\n            this._updatePasteHelpersState();\n        }\n        if (this.clipboard.type === 'copy' || !this.clipboard.type) {\n            CMS.settings.pageClipboard = this.clipboard;\n            __WEBPACK_IMPORTED_MODULE_3__cms_base__[\"c\" /* Helpers */].setSettings(CMS.settings);\n        }\n    },\n\n    /**\n        * Helper to process the paste event.\n        *\n        * @method _paste\n        * @param {$.Event} event click event\n        * @private\n        */\n    _paste: function _paste(event) {\n        // hide helpers after we picked one\n        this._disablePaste();\n\n        var copyFromId = this._getNodeId(\n        __WEBPACK_IMPORTED_MODULE_1_jquery___default()('.js-cms-pagetree-options[data-id=\"' + this.clipboard.origin + '\"]').closest('.jstree-grid-cell'));\n\n        var copyToId = this._getNodeId(__WEBPACK_IMPORTED_MODULE_1_jquery___default()(event.currentTarget));\n\n        if (this.clipboard.source_site === this.options.site) {\n            if (this.clipboard.type === 'cut') {\n                this.ui.tree.jstree('cut', copyFromId);\n            } else {\n                this.ui.tree.jstree('copy', copyFromId);\n            }\n\n            this.clipboard.isPasting = true;\n            this.ui.tree.jstree('paste', copyToId, 'last');\n        } else {\n            var dummyId = this.ui.tree.jstree('create_node', copyToId, 'Loading', 'last');\n\n            if (this.ui.tree.length) {\n                this.ui.tree.jstree('cut', dummyId);\n                this.clipboard.isPasting = true;\n                this.ui.tree.jstree('paste', copyToId, 'last');\n            } else {\n                if (this.clipboard.type === 'copy') {\n                    this._copyNode();\n                }\n                if (this.clipboard.type === 'cut') {\n                    this._moveNode();\n                }\n            }\n        }\n\n        this.clipboard.id = null;\n        this.clipboard.type = null;\n        this.clipboard.origin = null;\n        this.clipboard.isPasting = false;\n        CMS.settings.pageClipboard = this.clipboard;\n        __WEBPACK_IMPORTED_MODULE_3__cms_base__[\"c\" /* Helpers */].setSettings(CMS.settings);\n    },\n\n    /**\n        * Retreives a list of nodes from local storage.\n        *\n        * @method _getStoredNodeIds\n        * @private\n        * @returns {Array} list of ids\n        */\n    _getStoredNodeIds: function _getStoredNodeIds() {\n        return CMS.settings.pagetree || [];\n    },\n\n    /**\n        * Stores a node in local storage.\n        *\n        * @method _storeNodeId\n        * @private\n        * @param {String} id to be stored\n        * @returns {String} id that has been stored\n        */\n    _storeNodeId: function _storeNodeId(id) {\n        var number = id;\n        var storage = this._getStoredNodeIds();\n\n        // store value only if it isn't there yet\n        if (storage.indexOf(number) === -1) {\n            storage.push(number);\n        }\n\n        CMS.settings.pagetree = storage;\n        __WEBPACK_IMPORTED_MODULE_3__cms_base__[\"c\" /* Helpers */].setSettings(CMS.settings);\n\n        return number;\n    },\n\n    /**\n        * Removes a node in local storage.\n        *\n        * @method _removeNodeId\n        * @private\n        * @param {String} id to be stored\n        * @returns {String} id that has been removed\n        */\n    _removeNodeId: function _removeNodeId(id) {\n        var instance = this.ui.tree.jstree(true);\n        var childrenIds = instance.get_node({\n            id: CMS.$('[data-node-id=' + id + ']').attr('id') }).\n        children_d;\n\n        var idsToRemove = [id].concat(\n        childrenIds.map(function (childId) {\n            var node = instance.get_node({ id: childId });\n\n            if (!node || !node.data) {\n                return node;\n            }\n\n            return node.data.nodeId;\n        }));\n\n\n        var storage = __WEBPACK_IMPORTED_MODULE_6_lodash__[\"without\"].apply(undefined, [this._getStoredNodeIds()].concat(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_toConsumableArray___default()(idsToRemove)));\n\n        CMS.settings.pagetree = storage;\n        __WEBPACK_IMPORTED_MODULE_3__cms_base__[\"c\" /* Helpers */].setSettings(CMS.settings);\n\n        return id;\n    },\n\n    /**\n        * Moves a node after drag & drop.\n        *\n        * @method _moveNode\n        * @param {Object} [obj]\n        * @param {Number} [obj.id] current element id for url matching\n        * @param {Number} [obj.target] target sibling or parent\n        * @param {Number} [obj.position] either `left`, `right` or `last-child`\n        * @returns {$.Deferred} ajax request object\n        * @private\n        */\n    _moveNode: function _moveNode(obj) {\n        var that = this;\n\n        if (!obj.id && this.clipboard.type === 'cut' && this.clipboard.origin) {\n            obj.id = this.clipboard.origin;\n            obj.source_site = this.clipboard.source_site;\n        } else {\n            obj.site = that.options.site;\n        }\n\n        return __WEBPACK_IMPORTED_MODULE_1_jquery___default.a.ajax({\n            method: 'post',\n            url: that.options.urls.move.replace('{id}', obj.id),\n            data: obj }).\n\n        done(function (r) {\n            if (r.status && r.status === 400) {// eslint-disable-line\n                that.showError(r.content);\n            } else {\n                that._showSuccess(obj.id);\n            }\n        }).\n        fail(function (error) {\n            that.showError(error.statusText);\n        });\n    },\n\n    /**\n        * Copies a node into the selected node.\n        *\n        * @method _copyNode\n        * @param {Object} obj page obj\n        * @private\n        */\n    _copyNode: function _copyNode(obj) {\n        var that = this;\n        var node = { position: 0 };\n\n        if (obj) {\n            node = that._getNodePosition(obj);\n        }\n\n        var data = {\n            // obj.original.data.id is for drag copy\n            id: this.clipboard.origin || obj.original.data.id,\n            position: node.position };\n\n\n        if (this.clipboard.source_site) {\n            data.source_site = this.clipboard.source_site;\n        } else {\n            data.source_site = this.options.site;\n        }\n\n        // if there is no target provided, the node lands in root\n        if (node.target) {\n            data.target = node.target;\n        }\n\n        if (that.options.permission) {\n            // we need to load a dialog first, to check if permissions should\n            // be copied or not\n            __WEBPACK_IMPORTED_MODULE_1_jquery___default.a.ajax({\n                method: 'post',\n                url: that.options.urls.copyPermission.replace('{id}', data.id),\n                data: data\n                // the dialog is loaded via the ajax respons originating from\n                // `templates/admin/cms/page/tree/copy_premissions.html`\n            }).\n            done(function (dialog) {\n                that.ui.dialog.append(dialog);\n            }).\n            fail(function (error) {\n                that.showError(error.statusText);\n            });\n\n            // attach events to the permission dialog\n            this.ui.dialog.\n            off(this.click, '.cancel').\n            on(this.click, '.cancel', function (e) {\n                e.preventDefault();\n                // remove just copied node\n                that.ui.tree.jstree('delete_node', obj.node.id);\n                __WEBPACK_IMPORTED_MODULE_1_jquery___default()('.js-cms-dialog').remove();\n                __WEBPACK_IMPORTED_MODULE_1_jquery___default()('.js-cms-dialog-dimmer').remove();\n            }).\n            off(this.click, '.submit').\n            on(this.click, '.submit', function (e) {\n                e.preventDefault();\n                var submitButton = __WEBPACK_IMPORTED_MODULE_1_jquery___default()(this);\n                var formData = submitButton.closest('form').serialize().split('&');\n\n                submitButton.prop('disabled', true);\n\n                // loop through form data and attach to obj\n                for (var i = 0; i < formData.length; i++) {\n                    data[formData[i].split('=')[0]] = formData[i].split('=')[1];\n                }\n\n                that._saveCopiedNode(data);\n            });\n        } else {\n            this._saveCopiedNode(data);\n        }\n    },\n\n    /**\n        * Sends the request to copy a node.\n        *\n        * @method _saveCopiedNode\n        * @private\n        * @param {Object} data node position information\n        * @returns {$.Deferred}\n        */\n    _saveCopiedNode: function _saveCopiedNode(data) {\n        var that = this;\n\n        // send the real ajax request for copying the plugin\n        return __WEBPACK_IMPORTED_MODULE_1_jquery___default.a.ajax({\n            method: 'post',\n            url: that.options.urls.copy.replace('{id}', data.id),\n            data: data }).\n\n        done(function (r) {\n            if (r.status && r.status === 400) {// eslint-disable-line\n                that.showError(r.content);\n            } else {\n                that._reloadHelper();\n            }\n        }).\n        fail(function (error) {\n            that.showError(error.statusText);\n        });\n    },\n\n    /**\n        * Returns element from any sub nodes.\n        *\n        * @method _getElement\n        * @private\n        * @param {jQuery} el jQuery node form where to search\n        * @returns {String} jsTree node element id\n        */\n    _getNodeId: function _getNodeId(el) {\n        var cls = el.closest('.jstree-grid-cell').attr('class');\n\n        // if it's not a cell, assume it's the root node\n        return cls ? cls.replace(/.*jsgrid_(.+?)_col.*/, '$1') : '#';\n    },\n\n    /**\n        * Gets the new node position after moving.\n        *\n        * @method _getNodePosition\n        * @private\n        * @param {Object} obj jstree move object\n        * @returns {Object} evaluated object with params\n        */\n    _getNodePosition: function _getNodePosition(obj) {\n        var data = {};\n        var node = this.ui.tree.jstree('get_node', obj.node.parent);\n\n        data.position = obj.position;\n\n        // jstree indicates no parent with `#`, in this case we do not\n        // need to set the target attribute at all\n        if (obj.parent !== '#') {\n            data.target = node.data.id;\n        }\n\n        // some functions like copy create a new element with a new id,\n        // in this case we need to set `data.id` manually\n        if (obj.node && obj.node.data) {\n            data.id = obj.node.data.id;\n        }\n\n        return data;\n    },\n\n    /**\n        * Sets up general tooltips that can have a list of links or content.\n        *\n        * @method _setupDropdowns\n        * @private\n        */\n    _setupDropdowns: function _setupDropdowns() {\n        this._dropdowns = new __WEBPACK_IMPORTED_MODULE_4__cms_pagetree_dropdown__[\"a\" /* default */]({\n            container: this.ui.container });\n\n    },\n\n    /**\n        * Handles page view click. Usual use case is that after you click\n        * on view page in the pagetree - sideframe is no longer needed,\n        * so we close it.\n        *\n        * @method _setupPageView\n        * @private\n        */\n    _setupPageView: function _setupPageView() {\n        var win = __WEBPACK_IMPORTED_MODULE_3__cms_base__[\"c\" /* Helpers */]._getWindow();\n        var parent = win.parent ? win.parent : win;\n\n        this.ui.container.on(this.click, '.js-cms-pagetree-page-view', function () {\n            parent.CMS.API.Helpers.setSettings(\n            __WEBPACK_IMPORTED_MODULE_1_jquery___default.a.extend(true, {}, CMS.settings, {\n                sideframe: {\n                    url: null,\n                    hidden: true } }));\n\n\n\n        });\n    },\n\n    /**\n        * @method _setupStickyHeader\n        * @private\n        */\n    _setupStickyHeader: function _setupStickyHeader() {\n        var that = this;\n\n        that.ui.tree.on('ready.jstree', function () {\n            that.header = new __WEBPACK_IMPORTED_MODULE_5__cms_pagetree_stickyheader__[\"a\" /* default */]({\n                container: that.ui.container });\n\n        });\n    },\n\n    /**\n        * Triggers the links `href` as ajax post request.\n        *\n        * @method _setAjaxPost\n        * @private\n        * @param {jQuery} trigger jQuery link target\n        */\n    _setAjaxPost: function _setAjaxPost(trigger) {\n        var that = this;\n\n        this.ui.container.on(this.click, trigger, function (e) {\n            e.preventDefault();\n\n            var element = __WEBPACK_IMPORTED_MODULE_1_jquery___default()(this);\n\n            if (element.closest('.cms-pagetree-dropdown-item-disabled').length) {\n                return;\n            }\n\n            try {\n                window.top.CMS.API.Toolbar.showLoader();\n            } catch (err) {}\n\n            __WEBPACK_IMPORTED_MODULE_1_jquery___default.a.ajax({\n                method: 'post',\n                url: __WEBPACK_IMPORTED_MODULE_1_jquery___default()(this).attr('href') }).\n\n            done(function () {\n                try {\n                    window.top.CMS.API.Toolbar.hideLoader();\n                } catch (err) {}\n\n                if (window.self === window.top) {\n                    // simply reload the page\n                    that._reloadHelper();\n                } else {\n                    // if we're in the sideframe we have to actually\n                    // check if we are publishing a page we're currently in\n                    // because if the slug did change we would need to\n                    // redirect to that new slug\n                    // Problem here is that in case of the apphooked page\n                    // the model and pk are empty and reloadBrowser doesn't really\n                    // do anything - so here we specifically force the data\n                    // to be the data about the page and not the model\n                    var parent = window.parent ? window.parent : window;\n                    var data = {\n                        // this shouldn't be hardcoded, but there is no way around it\n                        model: 'cms.page',\n                        pk: parent.CMS.config.request.page_id };\n\n\n                    __WEBPACK_IMPORTED_MODULE_3__cms_base__[\"c\" /* Helpers */].reloadBrowser('REFRESH_PAGE', false, true, data);\n                }\n            }).\n            fail(function (error) {\n                that.showError(error.statusText);\n            });\n        });\n    },\n\n    /**\n        * Sets events for the search on the header.\n        *\n        * @method _setupSearch\n        * @private\n        */\n    _setupSearch: function _setupSearch() {\n        var that = this;\n        var click = this.click + '.search';\n\n        var filterActive = false;\n        var filterTrigger = this.ui.container.find('.js-cms-pagetree-header-filter-trigger');\n        var filterContainer = this.ui.container.find('.js-cms-pagetree-header-filter-container');\n        var filterClose = filterContainer.find('.js-cms-pagetree-header-search-close');\n        var filterClass = 'cms-pagetree-header-filter-active';\n        var pageTreeHeader = __WEBPACK_IMPORTED_MODULE_1_jquery___default()('.cms-pagetree-header');\n\n        var visibleForm = this.ui.container.find('.js-cms-pagetree-header-search');\n        var hiddenForm = this.ui.container.find('.js-cms-pagetree-header-search-copy form');\n\n        var searchContainer = this.ui.container.find('.cms-pagetree-header-filter');\n        var searchField = searchContainer.find('#field-searchbar');\n        var timeout = 200;\n\n        // add active class when focusing the search field\n        searchField.on('focus', function (e) {\n            e.stopImmediatePropagation();\n            pageTreeHeader.addClass(filterClass);\n        });\n        searchField.on('blur', function (e) {\n            e.stopImmediatePropagation();\n            // timeout is required to prevent the search field from jumping\n            // between enlarging and shrinking\n            setTimeout(function () {\n                if (!filterActive) {\n                    pageTreeHeader.removeClass(filterClass);\n                }\n            }, timeout);\n            that.ui.document.off(click);\n        });\n\n        // shows/hides filter box\n        filterTrigger.add(filterClose).on(click, function (e) {\n            e.preventDefault();\n            e.stopImmediatePropagation();\n            if (filterActive) {\n                filterContainer.hide();\n                pageTreeHeader.removeClass(filterClass);\n                that.ui.document.off(click);\n                filterActive = false;\n            } else {\n                filterContainer.show();\n                pageTreeHeader.addClass(filterClass);\n                that.ui.document.on(click, function () {\n                    filterActive = true;\n                    filterTrigger.trigger(click);\n                });\n                filterActive = true;\n            }\n        });\n\n        // prevent closing when on filter container\n        filterContainer.on('click', function (e) {\n            e.stopImmediatePropagation();\n        });\n\n        // add hidden fields to the form to maintain filter params\n        visibleForm.append(hiddenForm.find('input[type=\"hidden\"]'));\n    },\n\n    /**\n        * Shows paste helpers.\n        *\n        * @method _enablePaste\n        * @param {String} [selector=this.options.pasteSelector] jquery selector\n        * @private\n        */\n    _enablePaste: function _enablePaste(selector) {\n        var sel = typeof selector === 'undefined' ?\n        this.options.pasteSelector :\n        selector + ' ' + this.options.pasteSelector;\n        var dropdownSel = '.js-cms-pagetree-actions-dropdown';\n\n        if (typeof selector !== 'undefined') {\n            dropdownSel = selector + ' .js-cms-pagetree-actions-dropdown';\n        }\n\n        // helpers are generated on the fly, so we need to reference\n        // them every single time\n        __WEBPACK_IMPORTED_MODULE_1_jquery___default()(sel).removeClass('cms-pagetree-dropdown-item-disabled');\n\n        var data = {};\n\n        if (this.clipboard.type === 'cut') {\n            data.has_cut = true;\n        } else {\n            data.has_copy = true;\n        }\n        // not loaded actions dropdown have to be updated as well\n        __WEBPACK_IMPORTED_MODULE_1_jquery___default()(dropdownSel).data('lazyUrlData', data);\n    },\n\n    /**\n        * Hides paste helpers.\n        *\n        * @method _disablePaste\n        * @param {String} [selector=this.options.pasteSelector] jquery selector\n        * @private\n        */\n    _disablePaste: function _disablePaste(selector) {\n        var sel = typeof selector === 'undefined' ?\n        this.options.pasteSelector :\n        selector + ' ' + this.options.pasteSelector;\n        var dropdownSel = '.js-cms-pagetree-actions-dropdown';\n\n        if (typeof selector !== 'undefined') {\n            dropdownSel = selector + ' .js-cms-pagetree-actions-dropdown';\n        }\n\n        // helpers are generated on the fly, so we need to reference\n        // them every single time\n        __WEBPACK_IMPORTED_MODULE_1_jquery___default()(sel).addClass('cms-pagetree-dropdown-item-disabled');\n\n        // not loaded actions dropdown have to be updated as well\n        __WEBPACK_IMPORTED_MODULE_1_jquery___default()(dropdownSel).removeData('lazyUrlData');\n    },\n\n    /**\n        * Updates the current state of the helpers after `after_open.jstree`\n        * or `_cutOrCopy` is triggered.\n        *\n        * @method _updatePasteHelpersState\n        * @private\n        */\n    _updatePasteHelpersState: function _updatePasteHelpersState() {\n        var that = this;\n\n        if (this.clipboard.type && this.clipboard.id) {\n            this._enablePaste();\n        }\n\n        // hide cut element and it's descendants' paste helpers if it is visible\n        if (\n        this.clipboard.type === 'cut' &&\n        this.clipboard.origin &&\n        this.options.site === this.clipboard.source_site)\n        {\n            var descendantIds = this._getDescendantsIds(this.clipboard.id);\n            var nodes = [this.clipboard.id];\n\n            if (descendantIds && descendantIds.length) {\n                nodes = nodes.concat(descendantIds);\n            }\n\n            nodes.forEach(function (id) {\n                that._disablePaste('.jsgrid_' + id + '_col');\n            });\n        }\n    },\n\n    /**\n        * Shows success message on node after successful action.\n        *\n        * @method _showSuccess\n        * @param {Number} id id of the element to add the success class\n        * @private\n        */\n    _showSuccess: function _showSuccess(id) {\n        var element = this.ui.tree.find('li[data-id=\"' + id + '\"]');\n\n        element.addClass('cms-tree-node-success');\n        setTimeout(function () {\n            element.removeClass('cms-tree-node-success');\n        }, this.successTimer);\n        // hide elements\n        this._disablePaste();\n        this.clipboard.id = null;\n    },\n\n    /**\n        * Checks if we should reload the iframe or entire window. For this we\n        * need to skip `CMS.API.Helpers.reloadBrowser();`.\n        *\n        * @method _reloadHelper\n        * @private\n        */\n    _reloadHelper: function _reloadHelper() {\n        if (window.self === window.top) {\n            __WEBPACK_IMPORTED_MODULE_3__cms_base__[\"c\" /* Helpers */].reloadBrowser();\n        } else {\n            window.location.reload();\n        }\n    },\n\n    /**\n        * Displays an error within the django UI.\n        *\n        * @method showError\n        * @param {String} message string message to display\n        */\n    showError: function showError(message) {\n        var messages = __WEBPACK_IMPORTED_MODULE_1_jquery___default()('.messagelist');\n        var breadcrumb = __WEBPACK_IMPORTED_MODULE_1_jquery___default()('.breadcrumbs');\n        var reload = this.options.lang.reload;\n        var tpl =\n        '' +\n        '<ul class=\"messagelist\">' +\n        '   <li class=\"error\">' +\n        '       {msg} ' +\n        '       <a href=\"#reload\" class=\"cms-tree-reload\"> ' +\n        reload +\n        ' </a>' +\n        '   </li>' +\n        '</ul>';\n        var msg = tpl.replace('{msg}', '<strong>' + this.options.lang.error + '</strong> ' + message);\n\n        if (messages.length) {\n            messages.replaceWith(msg);\n        } else {\n            breadcrumb.after(msg);\n        }\n    },\n\n    /**\n        * @method _getDescendantsIds\n        * @private\n        * @param {String} nodeId jstree id of the node, e.g. j1_3\n        * @returns {String[]} array of ids\n        */\n    _getDescendantsIds: function _getDescendantsIds(nodeId) {\n        return this.ui.tree.jstree(true).get_node(nodeId).children_d;\n    },\n\n    /**\n        * @method _hasPermision\n        * @private\n        * @param {Object} node jstree node\n        * @param {String} permission move / add\n        * @returns {Boolean}\n        */\n    _hasPermission: function _hasPermision(node, permission) {\n        if (node.id === '#' && permission === 'add') {\n            return this.options.hasAddRootPermission;\n        } else if (node.id === '#') {\n            return false;\n        }\n\n        return node.li_attr['data-' + permission + '-permission'] === 'true';\n    } });\n\n\nPageTree._init = function () {\n    new PageTree();\n};\n\n// shorthand for jQuery(document).ready();\n__WEBPACK_IMPORTED_MODULE_1_jquery___default()(function () {\n    // load cms settings beforehand\n    // have to set toolbar to \"expanded\" by default\n    // otherwise initialization will be incorrect when you\n    // go first to pages and then to normal page\n    window.CMS.config = {\n        isPageTree: true,\n        settings: {\n            toolbar: 'expanded',\n            version: \"3.5.0\" },\n\n        urls: {\n            settings: __WEBPACK_IMPORTED_MODULE_1_jquery___default()('.js-cms-pagetree').data('settings-url') } };\n\n\n    window.CMS.settings = __WEBPACK_IMPORTED_MODULE_3__cms_base__[\"c\" /* Helpers */].getSettings();\n    // autoload the pagetree\n    CMS.PageTree._init();\n});\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (PageTree);//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTk0LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vL2Ntcy9zdGF0aWMvY21zL2pzL21vZHVsZXMvY21zLnBhZ2V0cmVlLmpzPzgwODEiXSwic291cmNlc0NvbnRlbnQiOlsiLypcbiAqIENvcHlyaWdodCBodHRwczovL2dpdGh1Yi5jb20vZGl2aW8vZGphbmdvLWNtc1xuICovXG5cbmltcG9ydCAkIGZyb20gJ2pxdWVyeSc7XG5cbmltcG9ydCBDbGFzcyBmcm9tICdjbGFzc2pzJztcbmltcG9ydCB7IEhlbHBlcnMsIEtFWVMgfSBmcm9tICcuL2Ntcy5iYXNlJztcbmltcG9ydCBQYWdlVHJlZURyb3Bkb3ducyBmcm9tICcuL2Ntcy5wYWdldHJlZS5kcm9wZG93bic7XG5pbXBvcnQgUGFnZVRyZWVTdGlja3lIZWFkZXIgZnJvbSAnLi9jbXMucGFnZXRyZWUuc3RpY2t5aGVhZGVyJztcbmltcG9ydCB7IGRlYm91bmNlLCB3aXRob3V0IH0gZnJvbSAnbG9kYXNoJztcblxuaW1wb3J0ICdqc3RyZWUnO1xuaW1wb3J0ICcuLi9saWJzL2pzdHJlZS9qc3RyZWUuZ3JpZC5taW4nO1xuXG4vKipcbiAqIFRoZSBwYWdldHJlZSBpcyBsb2FkZWQgdmlhIGAvYWRtaW4vY21zL3BhZ2VgIGFuZCBoYXMgYSBjdXN0b20gYWRtaW5cbiAqIHRlbXBsYXRlcyBzdG9yZWQgd2l0aGluIGB0ZW1wbGF0ZXMvYWRtaW4vY21zL3BhZ2UvdHJlZWAuXG4gKlxuICogQGNsYXNzIFBhZ2VUcmVlXG4gKiBAbmFtZXNwYWNlIENNU1xuICovXG52YXIgUGFnZVRyZWUgPSBuZXcgQ2xhc3Moe1xuICAgIG9wdGlvbnM6IHtcbiAgICAgICAgcGFzdGVTZWxlY3RvcjogJy5qcy1jbXMtdHJlZS1pdGVtLXBhc3RlJ1xuICAgIH0sXG4gICAgaW5pdGlhbGl6ZTogZnVuY3Rpb24gaW5pdGlhbGl6ZShvcHRpb25zKSB7XG4gICAgICAgIC8vIG9wdGlvbnMgYXJlIGxvYWRlZCBmcm9tIHRoZSBwYWdldHJlZSBodG1sIG5vZGVcbiAgICAgICAgdmFyIG9wdHMgPSAkKCcuanMtY21zLXBhZ2V0cmVlJykuZGF0YSgnanNvbicpO1xuXG4gICAgICAgIHRoaXMub3B0aW9ucyA9ICQuZXh0ZW5kKHRydWUsIHt9LCB0aGlzLm9wdGlvbnMsIG9wdHMsIG9wdGlvbnMpO1xuXG4gICAgICAgIC8vIHN0YXRlcyBhbmQgZXZlbnRzXG4gICAgICAgIHRoaXMuY2xpY2sgPSAnY2xpY2suY21zLnBhZ2V0cmVlJztcbiAgICAgICAgdGhpcy5jbGlwYm9hcmQgPSB7XG4gICAgICAgICAgICBpZDogbnVsbCxcbiAgICAgICAgICAgIG9yaWdpbjogbnVsbCxcbiAgICAgICAgICAgIHR5cGU6ICcnXG4gICAgICAgIH07XG4gICAgICAgIHRoaXMuc3VjY2Vzc1RpbWVyID0gMTAwMDtcblxuICAgICAgICAvLyBlbGVtZW50c1xuICAgICAgICB0aGlzLl9zZXR1cFVJKCk7XG4gICAgICAgIHRoaXMuX2V2ZW50cygpO1xuXG4gICAgICAgIEhlbHBlcnMuY3NyZih0aGlzLm9wdGlvbnMuY3NyZik7XG5cbiAgICAgICAgLy8gY2FuY2VsIGlmIHBhZ2V0cmVlIGlzIG5vdCBhdmFpbGFibGVcbiAgICAgICAgaWYgKCQuaXNFbXB0eU9iamVjdChvcHRzKSB8fCBvcHRzLmVtcHR5KSB7XG4gICAgICAgICAgICB0aGlzLl9nZXRDbGlwYm9hcmQoKTtcbiAgICAgICAgICAgIC8vIGF0dGFjaCBldmVudHMgdG8gcGFzdGVcbiAgICAgICAgICAgIHZhciB0aGF0ID0gdGhpcztcblxuICAgICAgICAgICAgdGhpcy51aS5jb250YWluZXIub24odGhpcy5jbGljaywgdGhpcy5vcHRpb25zLnBhc3RlU2VsZWN0b3IsIGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgaWYgKCQodGhpcykuaGFzQ2xhc3MoJ2Ntcy1wYWdldHJlZS1kcm9wZG93bi1pdGVtLWRpc2FibGVkJykpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGF0Ll9wYXN0ZShlKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5fc2V0dXAoKTtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBTdG9yZXMgYWxsIGpRdWVyeSByZWZlcmVuY2VzIHdpdGhpbiBgdGhpcy51aWAuXG4gICAgICpcbiAgICAgKiBAbWV0aG9kIF9zZXR1cFVJXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBfc2V0dXBVSTogZnVuY3Rpb24gX3NldHVwVUkoKSB7XG4gICAgICAgIHZhciBwYWdldHJlZSA9ICQoJy5jbXMtcGFnZXRyZWUnKTtcblxuICAgICAgICB0aGlzLnVpID0ge1xuICAgICAgICAgICAgY29udGFpbmVyOiBwYWdldHJlZSxcbiAgICAgICAgICAgIGRvY3VtZW50OiAkKGRvY3VtZW50KSxcbiAgICAgICAgICAgIHRyZWU6IHBhZ2V0cmVlLmZpbmQoJy5qcy1jbXMtcGFnZXRyZWUnKSxcbiAgICAgICAgICAgIGRpYWxvZzogJCgnLmpzLWNtcy10cmVlLWRpYWxvZycpLFxuICAgICAgICAgICAgc2l0ZUZvcm06ICQoJy5qcy1jbXMtcGFnZXRyZWUtc2l0ZS1mb3JtJylcbiAgICAgICAgfTtcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogU2V0dGluZyB1cCB0aGUganN0cmVlIGFuZCB0aGUgcmVsYXRlZCBjb2x1bW5zLlxuICAgICAqXG4gICAgICogQG1ldGhvZCBfc2V0dXBcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIF9zZXR1cDogZnVuY3Rpb24gX3NldHVwKCkge1xuICAgICAgICB2YXIgdGhhdCA9IHRoaXM7XG4gICAgICAgIHZhciBjb2x1bW5zID0gW107XG4gICAgICAgIHZhciBvYmogPSB7XG4gICAgICAgICAgICBsYW5ndWFnZTogdGhpcy5vcHRpb25zLmxhbmcuY29kZSxcbiAgICAgICAgICAgIG9wZW5Ob2RlczogW11cbiAgICAgICAgfTtcbiAgICAgICAgdmFyIGRhdGEgPSBmYWxzZTtcblxuICAgICAgICAvLyBzZXR1cCBjb2x1bW4gaGVhZGluZ3NcbiAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXNoYWRvd1xuICAgICAgICAkLmVhY2godGhpcy5vcHRpb25zLmNvbHVtbnMsIGZ1bmN0aW9uKGluZGV4LCBvYmopIHtcbiAgICAgICAgICAgIGlmIChvYmoua2V5ID09PSAnJykge1xuICAgICAgICAgICAgICAgIC8vIHRoZSBmaXJzdCByb3cgaXMgYWxyZWFkeSBwb3B1bGF0ZWQsIHRvIGF2b2lkIG92ZXJ3cml0ZXNcbiAgICAgICAgICAgICAgICAvLyBqdXN0IGxlYXZlIHRoZSBcImtleVwiIHBhcmFtIGVtcHR5XG4gICAgICAgICAgICAgICAgY29sdW1ucy5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgd2lkZVZhbHVlQ2xhc3M6IG9iai53aWRlVmFsdWVDbGFzcyxcbiAgICAgICAgICAgICAgICAgICAgd2lkZVZhbHVlQ2xhc3NQcmVmaXg6IG9iai53aWRlVmFsdWVDbGFzc1ByZWZpeCxcbiAgICAgICAgICAgICAgICAgICAgaGVhZGVyOiBvYmoudGl0bGUsXG4gICAgICAgICAgICAgICAgICAgIHdpZHRoOiBvYmoud2lkdGggfHwgJzElJyxcbiAgICAgICAgICAgICAgICAgICAgd2lkZUNlbGxDbGFzczogb2JqLmNsc1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBjb2x1bW5zLnB1c2goe1xuICAgICAgICAgICAgICAgICAgICB3aWRlVmFsdWVDbGFzczogb2JqLndpZGVWYWx1ZUNsYXNzLFxuICAgICAgICAgICAgICAgICAgICB3aWRlVmFsdWVDbGFzc1ByZWZpeDogb2JqLndpZGVWYWx1ZUNsYXNzUHJlZml4LFxuICAgICAgICAgICAgICAgICAgICBoZWFkZXI6IG9iai50aXRsZSxcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uKG5vZGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGl0IG5lZWRzIHRvIGhhdmUgdGhlIFwiY29sZGVcIiBmb3JtYXQgYW5kIG5vdCBcImNvbC1kZVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBhcyBqc3RyZWUgd2lsbCBjb252ZXJ0IFwiY29sLWRlXCIgdG8gXCJjb2xkZVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBhbHNvIHdlIHN0cmlwIGRhc2hlcywgaW4gY2FzZSBsYW5ndWFnZSBjb2RlIGNvbnRhaW5zIGl0XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBlLmcuIHpoLWhhbnMsIHpoLWNuIGV0Y1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG5vZGUuZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBub2RlLmRhdGFbJ2NvbCcgKyBvYmoua2V5LnJlcGxhY2UoJy0nLCAnJyldO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gJyc7XG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHdpZHRoOiBvYmoud2lkdGggfHwgJzElJyxcbiAgICAgICAgICAgICAgICAgICAgd2lkZUNlbGxDbGFzczogb2JqLmNsc1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICAvLyBwcmVwYXJlIGRhdGFcbiAgICAgICAgaWYgKCF0aGlzLm9wdGlvbnMuZmlsdGVyZWQpIHtcbiAgICAgICAgICAgIGRhdGEgPSB7XG4gICAgICAgICAgICAgICAgdXJsOiB0aGlzLm9wdGlvbnMudXJscy50cmVlLFxuICAgICAgICAgICAgICAgIGNhY2hlOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBkYXRhOiBmdW5jdGlvbihub2RlKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vICcjJyBpcyByZW5kZXJlZCBpZiBpdHMgdGhlIHJvb3Qgbm9kZSwgdGhlcmUgd2Ugb25seVxuICAgICAgICAgICAgICAgICAgICAvLyBjYXJlIGFib3V0IGBvYmoub3Blbk5vZGVzYCwgaW4gdGhlIGZvbGxvd2luZyBjYXNlXG4gICAgICAgICAgICAgICAgICAgIC8vIHdlIGFyZSByZXF1ZXN0aW5nIGEgc3BlY2lmaWMgbm9kZVxuICAgICAgICAgICAgICAgICAgICBpZiAobm9kZS5pZCA9PT0gJyMnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBvYmoubm9kZUlkID0gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG9iai5ub2RlSWQgPSB0aGF0Ll9zdG9yZU5vZGVJZChub2RlLmRhdGEubm9kZUlkKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIC8vIHdlIG5lZWQgdG8gc3RvcmUgdGhlIG9wZW5lZCBpdGVtcyBpbnNpZGUgdGhlIGxvY2Fsc3RvcmFnZVxuICAgICAgICAgICAgICAgICAgICAvLyBhcyB3ZSBoYXZlIHRvIGxvYWQgdGhlIHBhZ2V0cmVlIHdpdGggdGhlIHByZXZpb3VzIG9wZW5lZFxuICAgICAgICAgICAgICAgICAgICAvLyBzdGF0ZVxuICAgICAgICAgICAgICAgICAgICBvYmoub3Blbk5vZGVzID0gdGhhdC5fZ2V0U3RvcmVkTm9kZUlkcygpO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIHdlIG5lZWQgdG8gc2V0IHRoZSBzaXRlIGlkIHRvIGdldCB0aGUgY29ycmVjdCB0cmVlXG4gICAgICAgICAgICAgICAgICAgIG9iai5zaXRlID0gdGhhdC5vcHRpb25zLnNpdGU7XG5cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG9iajtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gYmluZCBvcHRpb25zIHRvIHRoZSBqc3RyZWUgaW5zdGFuY2VcbiAgICAgICAgdGhpcy51aS50cmVlLmpzdHJlZSh7XG4gICAgICAgICAgICBjb3JlOiB7XG4gICAgICAgICAgICAgICAgLy8gZGlzYWJsZSBvcGVuL2Nsb3NlIGFuaW1hdGlvbnNcbiAgICAgICAgICAgICAgICBhbmltYXRpb246IDAsXG4gICAgICAgICAgICAgICAgLy8gY29yZSBzZXR0aW5nIHRvIGFsbG93IGFjdGlvbnNcbiAgICAgICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbWF4LXBhcmFtc1xuICAgICAgICAgICAgICAgIGNoZWNrX2NhbGxiYWNrOiBmdW5jdGlvbihvcGVyYXRpb24sIG5vZGUsIG5vZGVfcGFyZW50LCBub2RlX3Bvc2l0aW9uLCBtb3JlKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICgob3BlcmF0aW9uID09PSAnbW92ZV9ub2RlJyB8fCBvcGVyYXRpb24gPT09ICdjb3B5X25vZGUnKSAmJiBtb3JlICYmIG1vcmUucG9zKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobW9yZS5wb3MgPT09ICdpJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICQoJyNqc3RyZWUtbWFya2VyJykuYWRkQ2xhc3MoJ2pzdHJlZS1tYXJrZXItY2hpbGQnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJCgnI2pzdHJlZS1tYXJrZXInKS5yZW1vdmVDbGFzcygnanN0cmVlLW1hcmtlci1jaGlsZCcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoYXQuX2hhc1Blcm1pc3Npb24obm9kZV9wYXJlbnQsICdhZGQnKTtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIC8vIGh0dHBzOi8vd3d3LmpzdHJlZS5jb20vYXBpLyMvP2Y9JC5qc3RyZWUuZGVmYXVsdHMuY29yZS5kYXRhXG4gICAgICAgICAgICAgICAgZGF0YTogZGF0YSxcbiAgICAgICAgICAgICAgICAvLyBzdHJpbmdzIHVzZWQgd2l0aGluIGpzdHJlZSB0aGF0IGFyZSBjYWxsZWQgdXNpbmcgYGdldF9zdHJpbmdgXG4gICAgICAgICAgICAgICAgc3RyaW5nczoge1xuICAgICAgICAgICAgICAgICAgICAnTG9hZGluZyAuLi4nOiB0aGlzLm9wdGlvbnMubGFuZy5sb2FkaW5nLFxuICAgICAgICAgICAgICAgICAgICAnTmV3IG5vZGUnOiB0aGlzLm9wdGlvbnMubGFuZy5uZXdOb2RlLFxuICAgICAgICAgICAgICAgICAgICBub2RlczogdGhpcy5vcHRpb25zLmxhbmcubm9kZXNcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGVycm9yOiBmdW5jdGlvbihlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICAvLyBpZ25vcmUgd2FybmluZ3MgYWJvdXQgZHJhZ2dpbmcgcGFyZW50IGludG8gY2hpbGRcbiAgICAgICAgICAgICAgICAgICAgdmFyIGVycm9yRGF0YSA9IEpTT04ucGFyc2UoZXJyb3IuZGF0YSk7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKGVycm9yLmVycm9yID09PSAnY2hlY2snICYmIGVycm9yRGF0YSAmJiBlcnJvckRhdGEuY2hrID09PSAnbW92ZV9ub2RlJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHRoYXQuc2hvd0Vycm9yKGVycm9yLnJlYXNvbik7XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB0aGVtZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogJ2RqYW5nby1jbXMnXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAvLyBkaXNhYmxlIHRoZSBtdWx0aSBzZWxlY3Rpb24gb2Ygbm9kZXMgZm9yIG5vd1xuICAgICAgICAgICAgICAgIG11bHRpcGxlOiBmYWxzZVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIC8vIGFjdGl2YXRlIGRyYWcgYW5kIGRyb3AgcGx1Z2luXG4gICAgICAgICAgICBwbHVnaW5zOiBbJ2RuZCcsICdzZWFyY2gnLCAnZ3JpZCddLFxuICAgICAgICAgICAgLy8gaHR0cHM6Ly93d3cuanN0cmVlLmNvbS9hcGkvIy8/Zj0kLmpzdHJlZS5kZWZhdWx0cy5kbmRcbiAgICAgICAgICAgIGRuZDoge1xuICAgICAgICAgICAgICAgIGluc2lkZV9wb3M6ICdsYXN0JyxcbiAgICAgICAgICAgICAgICAvLyBkaXNhYmxlIHRoZSBtdWx0aSBzZWxlY3Rpb24gb2Ygbm9kZXMgZm9yIG5vd1xuICAgICAgICAgICAgICAgIGRyYWdfc2VsZWN0aW9uOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAvLyBkaXNhYmxlIGRyYWdnaW5nIGlmIGZpbHRlcmVkXG4gICAgICAgICAgICAgICAgaXNfZHJhZ2dhYmxlOiBmdW5jdGlvbihub2Rlcykge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhhdC5faGFzUGVybWlzc2lvbihub2Rlc1swXSwgJ21vdmUnKSAmJiAhdGhhdC5vcHRpb25zLmZpbHRlcmVkO1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgbGFyZ2VfZHJvcF90YXJnZXQ6IHRydWUsXG4gICAgICAgICAgICAgICAgY29weTogdHJ1ZSxcbiAgICAgICAgICAgICAgICB0b3VjaDogJ3NlbGVjdGVkJ1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIC8vIGh0dHBzOi8vZ2l0aHViLmNvbS9kZWl0Y2gvanN0cmVlLWdyaWRcbiAgICAgICAgICAgIGdyaWQ6IHtcbiAgICAgICAgICAgICAgICAvLyBjb2x1bW5zIGFyZSBwcm92aWRlZCBmcm9tIGJhc2UuaHRtbCBvcHRpb25zXG4gICAgICAgICAgICAgICAgd2lkdGg6ICcxMDAlJyxcbiAgICAgICAgICAgICAgICBjb2x1bW5zOiBjb2x1bW5zXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBTZXRzIHVwIGFsbCB0aGUgZXZlbnQgaGFuZGxlcnMsIHN1Y2ggYXMgb3BlbmluZyBhbmQgbW92aW5nLlxuICAgICAqXG4gICAgICogQG1ldGhvZCBfZXZlbnRzXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBfZXZlbnRzOiBmdW5jdGlvbiBfZXZlbnRzKCkge1xuICAgICAgICB2YXIgdGhhdCA9IHRoaXM7XG5cbiAgICAgICAgLy8gc2V0IGV2ZW50cyBmb3IgdGhlIG5vZGVJZCB1cGRhdGVzXG4gICAgICAgIHRoaXMudWkudHJlZS5vbignYWZ0ZXJfY2xvc2UuanN0cmVlJywgZnVuY3Rpb24oZSwgZWwpIHtcbiAgICAgICAgICAgIHRoYXQuX3JlbW92ZU5vZGVJZChlbC5ub2RlLmRhdGEubm9kZUlkKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy51aS50cmVlLm9uKCdhZnRlcl9vcGVuLmpzdHJlZScsIGZ1bmN0aW9uKGUsIGVsKSB7XG4gICAgICAgICAgICB0aGF0Ll9zdG9yZU5vZGVJZChlbC5ub2RlLmRhdGEubm9kZUlkKTtcblxuICAgICAgICAgICAgLy8gYGFmdGVyX29wZW5gIGV2ZW50IGNhbiBiZSB0cmlnZ2VyZWQgd2hlbiBwYXN0aW5nXG4gICAgICAgICAgICAvLyBpcyBpbiBwcm9ncmVzcyAobWVhbmluZyB3ZSBhcmUgcGFzdGluZyBpbnRvIGEgbGVhZiBub2RlXG4gICAgICAgICAgICAvLyBpbiB0aGlzIGNhc2Ugd2UgZG8gbm90IG5lZWQgdG8gdXBkYXRlIGhlbHBlcnMgc3RhdGVcbiAgICAgICAgICAgIGlmICh0aGlzLmNsaXBib2FyZCAmJiAhdGhpcy5jbGlwYm9hcmQuaXNQYXN0aW5nKSB7XG4gICAgICAgICAgICAgICAgdGhhdC5fdXBkYXRlUGFzdGVIZWxwZXJzU3RhdGUoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy51aS5kb2N1bWVudC5vbigna2V5ZG93bi5wYWdldHJlZS5hbHQtbW9kZScsIGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgICAgIGlmIChlLmtleUNvZGUgPT09IEtFWVMuU0hJRlQpIHtcbiAgICAgICAgICAgICAgICB0aGF0LnVpLmNvbnRhaW5lci5hZGRDbGFzcygnY21zLXBhZ2V0cmVlLWFsdC1tb2RlJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMudWkuZG9jdW1lbnQub24oJ2tleXVwLnBhZ2V0cmVlLmFsdC1tb2RlJywgZnVuY3Rpb24oZSkge1xuICAgICAgICAgICAgaWYgKGUua2V5Q29kZSA9PT0gS0VZUy5TSElGVCkge1xuICAgICAgICAgICAgICAgIHRoYXQudWkuY29udGFpbmVyLnJlbW92ZUNsYXNzKCdjbXMtcGFnZXRyZWUtYWx0LW1vZGUnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgJCh3aW5kb3cpXG4gICAgICAgICAgICAub24oXG4gICAgICAgICAgICAgICAgJ21vdXNlbW92ZS5wYWdldHJlZS5hbHQtbW9kZScsXG4gICAgICAgICAgICAgICAgZGVib3VuY2UoZnVuY3Rpb24oZSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZS5zaGlmdEtleSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhhdC51aS5jb250YWluZXIuYWRkQ2xhc3MoJ2Ntcy1wYWdldHJlZS1hbHQtbW9kZScpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhhdC51aS5jb250YWluZXIucmVtb3ZlQ2xhc3MoJ2Ntcy1wYWdldHJlZS1hbHQtbW9kZScpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSwgMjAwKSAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLW1hZ2ljLW51bWJlcnNcbiAgICAgICAgICAgIClcbiAgICAgICAgICAgIC5vbignYmx1ci5jbXMnLCAoKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhhdC51aS5jb250YWluZXIucmVtb3ZlQ2xhc3MoJ2Ntcy1wYWdldHJlZS1hbHQtbW9kZScpO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy51aS5kb2N1bWVudC5vbignZG5kX3N0YXJ0LnZha2F0YScsIGZ1bmN0aW9uKGUsIGRhdGEpIHtcbiAgICAgICAgICAgIHZhciBlbGVtZW50ID0gJChkYXRhLmVsZW1lbnQpO1xuICAgICAgICAgICAgdmFyIG5vZGUgPSBlbGVtZW50LnBhcmVudCgpO1xuXG4gICAgICAgICAgICB0aGF0Ll9kcm9wZG93bnMuY2xvc2VBbGxEcm9wZG93bnMoKTtcblxuICAgICAgICAgICAgbm9kZS5hZGRDbGFzcygnanN0cmVlLWlzLWRyYWdnaW5nJyk7XG4gICAgICAgICAgICBkYXRhLmRhdGEubm9kZXMuZm9yRWFjaChmdW5jdGlvbihub2RlSWQpIHtcbiAgICAgICAgICAgICAgICB2YXIgZGVzY2VuZGFudElkcyA9IHRoYXQuX2dldERlc2NlbmRhbnRzSWRzKG5vZGVJZCk7XG5cbiAgICAgICAgICAgICAgICBbbm9kZUlkXS5jb25jYXQoZGVzY2VuZGFudElkcykuZm9yRWFjaChmdW5jdGlvbihpZCkge1xuICAgICAgICAgICAgICAgICAgICAkKCcuanNncmlkXycgKyBpZCArICdfY29sJykuYWRkQ2xhc3MoJ2pzdHJlZS1pcy1kcmFnZ2luZycpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGlmICghbm9kZS5oYXNDbGFzcygnanN0cmVlLWxlYWYnKSkge1xuICAgICAgICAgICAgICAgIGRhdGEuaGVscGVyLmFkZENsYXNzKCdpcy1zdGFja2VkJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHZhciBpc0NvcHlDbGFzc0FkZGVkID0gZmFsc2U7XG5cbiAgICAgICAgdGhpcy51aS5kb2N1bWVudC5vbignZG5kX21vdmUudmFrYXRhJywgZnVuY3Rpb24oZSwgZGF0YSkge1xuICAgICAgICAgICAgdmFyIGlzTW92aW5nQ29weSA9XG4gICAgICAgICAgICAgICAgZGF0YS5kYXRhLm9yaWdpbiAmJlxuICAgICAgICAgICAgICAgIChkYXRhLmRhdGEub3JpZ2luLnNldHRpbmdzLmRuZC5hbHdheXNfY29weSB8fFxuICAgICAgICAgICAgICAgICAgICAoZGF0YS5kYXRhLm9yaWdpbi5zZXR0aW5ncy5kbmQuY29weSAmJiAoZGF0YS5ldmVudC5tZXRhS2V5IHx8IGRhdGEuZXZlbnQuY3RybEtleSkpKTtcblxuICAgICAgICAgICAgaWYgKGlzTW92aW5nQ29weSkge1xuICAgICAgICAgICAgICAgIGlmICghaXNDb3B5Q2xhc3NBZGRlZCkge1xuICAgICAgICAgICAgICAgICAgICAkKCcuanN0cmVlLWlzLWRyYWdnaW5nJykuYWRkQ2xhc3MoJ2pzdHJlZS1pcy1kcmFnZ2luZy1jb3B5Jyk7XG4gICAgICAgICAgICAgICAgICAgIGlzQ29weUNsYXNzQWRkZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSBpZiAoaXNDb3B5Q2xhc3NBZGRlZCkge1xuICAgICAgICAgICAgICAgICQoJy5qc3RyZWUtaXMtZHJhZ2dpbmcnKS5yZW1vdmVDbGFzcygnanN0cmVlLWlzLWRyYWdnaW5nLWNvcHknKTtcbiAgICAgICAgICAgICAgICBpc0NvcHlDbGFzc0FkZGVkID0gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMudWkuZG9jdW1lbnQub24oJ2RuZF9zdG9wLnZha2F0YScsIGZ1bmN0aW9uKGUsIGRhdGEpIHtcbiAgICAgICAgICAgIHZhciBlbGVtZW50ID0gJChkYXRhLmVsZW1lbnQpO1xuICAgICAgICAgICAgdmFyIG5vZGUgPSBlbGVtZW50LnBhcmVudCgpO1xuXG4gICAgICAgICAgICBub2RlLnJlbW92ZUNsYXNzKCdqc3RyZWUtaXMtZHJhZ2dpbmcganN0cmVlLWlzLWRyYWdnaW5nLWNvcHknKTtcbiAgICAgICAgICAgIGRhdGEuZGF0YS5ub2Rlcy5mb3JFYWNoKGZ1bmN0aW9uKG5vZGVJZCkge1xuICAgICAgICAgICAgICAgIHZhciBkZXNjZW5kYW50SWRzID0gdGhhdC5fZ2V0RGVzY2VuZGFudHNJZHMobm9kZUlkKTtcblxuICAgICAgICAgICAgICAgIFtub2RlSWRdLmNvbmNhdChkZXNjZW5kYW50SWRzKS5mb3JFYWNoKGZ1bmN0aW9uKGlkKSB7XG4gICAgICAgICAgICAgICAgICAgICQoJy5qc2dyaWRfJyArIGlkICsgJ19jb2wnKS5yZW1vdmVDbGFzcygnanN0cmVlLWlzLWRyYWdnaW5nIGpzdHJlZS1pcy1kcmFnZ2luZy1jb3B5Jyk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gc3RvcmUgbW92ZWQgcG9zaXRpb24gbm9kZVxuICAgICAgICB0aGlzLnVpLnRyZWUub24oJ21vdmVfbm9kZS5qc3RyZWUgY29weV9ub2RlLmpzdHJlZScsIGZ1bmN0aW9uKGUsIG9iaikge1xuICAgICAgICAgICAgaWYgKCghdGhhdC5jbGlwYm9hcmQudHlwZSAmJiBlLnR5cGUgIT09ICdjb3B5X25vZGUnKSB8fCB0aGF0LmNsaXBib2FyZC50eXBlID09PSAnY3V0Jykge1xuICAgICAgICAgICAgICAgIHRoYXQuX21vdmVOb2RlKHRoYXQuX2dldE5vZGVQb3NpdGlvbihvYmopKS5kb25lKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgaW5zdGFuY2UgPSB0aGF0LnVpLnRyZWUuanN0cmVlKHRydWUpO1xuXG4gICAgICAgICAgICAgICAgICAgIGluc3RhbmNlLl9oaWRlX2dyaWQoaW5zdGFuY2UuZ2V0X25vZGUob2JqLnBhcmVudCkpO1xuICAgICAgICAgICAgICAgICAgICBpZiAob2JqLnBhcmVudCA9PT0gJyMnIHx8IChvYmoubm9kZSAmJiBvYmoubm9kZS5kYXRhICYmIG9iai5ub2RlLmRhdGEuaXNIb21lKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaW5zdGFuY2UucmVmcmVzaCgpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gaGF2ZSB0byByZWZyZXNoIHBhcmVudCwgYmVjYXVzZSByZWZyZXNoIG9ubHlcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHJlZnJlc2hlcyBjaGlsZHJlbiBvZiB0aGUgbm9kZSwgbmV2ZXIgdGhlIG5vZGUgaXRzZWxmXG4gICAgICAgICAgICAgICAgICAgICAgICBpbnN0YW5jZS5yZWZyZXNoX25vZGUob2JqLnBhcmVudCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhhdC5fY29weU5vZGUob2JqKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIHdlIG5lZWQgdG8gb3BlbiB0aGUgcGFyZW50IG5vZGUgaWYgd2UgdHJpZ2dlciBhbiBlbGVtZW50XG4gICAgICAgICAgICAvLyBpZiBub3QgYWxyZWFkeSBvcGVuZWRcbiAgICAgICAgICAgIHRoYXQudWkudHJlZS5qc3RyZWUoJ29wZW5fbm9kZScsIG9iai5wYXJlbnQpO1xuICAgICAgICB9KTtcblxuICAgICAgICAvLyBzZXQgZXZlbnQgZm9yIGN1dCBhbmQgcGFzdGVcbiAgICAgICAgdGhpcy51aS5jb250YWluZXIub24odGhpcy5jbGljaywgJy5qcy1jbXMtdHJlZS1pdGVtLWN1dCcsIGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgIHRoYXQuX2N1dE9yQ29weSh7IHR5cGU6ICdjdXQnLCBlbGVtZW50OiAkKHRoaXMpIH0pO1xuICAgICAgICB9KTtcblxuICAgICAgICAvLyBzZXQgZXZlbnQgZm9yIGN1dCBhbmQgcGFzdGVcbiAgICAgICAgdGhpcy51aS5jb250YWluZXIub24odGhpcy5jbGljaywgJy5qcy1jbXMtdHJlZS1pdGVtLWNvcHknLCBmdW5jdGlvbihlKSB7XG4gICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICB0aGF0Ll9jdXRPckNvcHkoeyB0eXBlOiAnY29weScsIGVsZW1lbnQ6ICQodGhpcykgfSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIGF0dGFjaCBldmVudHMgdG8gcGFzdGVcbiAgICAgICAgdGhpcy51aS5jb250YWluZXIub24odGhpcy5jbGljaywgdGhpcy5vcHRpb25zLnBhc3RlU2VsZWN0b3IsIGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgIGlmICgkKHRoaXMpLmhhc0NsYXNzKCdjbXMtcGFnZXRyZWUtZHJvcGRvd24taXRlbS1kaXNhYmxlZCcpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhhdC5fcGFzdGUoZSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIGFkdmFuY2VkIHNldHRpbmdzIGxpbmsgaGFuZGxpbmdcbiAgICAgICAgdGhpcy51aS5jb250YWluZXIub24odGhpcy5jbGljaywgJy5qcy1jbXMtdHJlZS1hZHZhbmNlZC1zZXR0aW5ncycsIGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgICAgIGlmIChlLnNoaWZ0S2V5KSB7XG4gICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgIHZhciBsaW5rID0gJCh0aGlzKTtcblxuICAgICAgICAgICAgICAgIGlmIChsaW5rLmRhdGEoJ3VybCcpKSB7XG4gICAgICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gbGluay5kYXRhKCd1cmwnKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIHdoZW4gYWRkaW5nIG5ldyBwYWdlcyAtIGV4cGFuZCBub2RlcyBhcyB3ZWxsXG4gICAgICAgIHRoaXMudWkuY29udGFpbmVyLm9uKHRoaXMuY2xpY2ssICcuanMtY21zLXBhZ2V0cmVlLWFkZC1wYWdlJywgZSA9PiB7XG4gICAgICAgICAgICBjb25zdCB0cmVlSWQgPSB0aGlzLl9nZXROb2RlSWQoJChlLnRhcmdldCkpO1xuXG4gICAgICAgICAgICBjb25zdCBub2RlRGF0YSA9IHRoaXMudWkudHJlZS5qc3RyZWUoJ2dldF9ub2RlJywgdHJlZUlkKTtcblxuICAgICAgICAgICAgdGhpcy5fc3RvcmVOb2RlSWQobm9kZURhdGEuZGF0YS5pZCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIGFkZCBldmVudHMgZm9yIGVycm9yIHJlbG9hZCAobWVzc2FnZWxpc3QpXG4gICAgICAgIHRoaXMudWkuZG9jdW1lbnQub24odGhpcy5jbGljaywgJy5tZXNzYWdlbGlzdCAuY21zLXRyZWUtcmVsb2FkJywgZnVuY3Rpb24oZSkge1xuICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgdGhhdC5fcmVsb2FkSGVscGVyKCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIHByb3BhZ2F0ZSB0aGUgc2l0ZXMgZHJvcGRvd24gXCJsaSA+IGFcIiBlbnRyaWVzIHRvIHRoZSBoaWRkZW4gc2l0ZXMgZm9ybVxuICAgICAgICB0aGlzLnVpLmNvbnRhaW5lci5maW5kKCcuanMtY21zLXBhZ2V0cmVlLXNpdGUtdHJpZ2dlcicpLm9uKHRoaXMuY2xpY2ssIGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgIHZhciBlbCA9ICQodGhpcyk7XG5cbiAgICAgICAgICAgIC8vIHByZXZlbnQgaWYgcGFyZW50IGlzIGFjdGl2ZVxuICAgICAgICAgICAgaWYgKGVsLnBhcmVudCgpLmhhc0NsYXNzKCdhY3RpdmUnKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoYXQudWkuc2l0ZUZvcm0uZmluZCgnc2VsZWN0JykudmFsKGVsLmRhdGEoKS5pZCkuZW5kKCkuc3VibWl0KCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIGFkZGl0aW9uYWwgZXZlbnQgaGFuZGxlcnNcbiAgICAgICAgdGhpcy5fc2V0dXBEcm9wZG93bnMoKTtcbiAgICAgICAgdGhpcy5fc2V0dXBTZWFyY2goKTtcblxuICAgICAgICAvLyBtYWtlIHN1cmUgYWpheCBwb3N0IHJlcXVlc3RzIGFyZSB3b3JraW5nXG4gICAgICAgIHRoaXMuX3NldEFqYXhQb3N0KCcuanMtY21zLXRyZWUtaXRlbS1tZW51IGEnKTtcbiAgICAgICAgdGhpcy5fc2V0QWpheFBvc3QoJy5qcy1jbXMtdHJlZS1sYW5nLXRyaWdnZXInKTtcbiAgICAgICAgdGhpcy5fc2V0QWpheFBvc3QoJy5qcy1jbXMtdHJlZS1pdGVtLXNldC1ob21lIGEnKTtcblxuICAgICAgICB0aGlzLl9zZXR1cFBhZ2VWaWV3KCk7XG4gICAgICAgIHRoaXMuX3NldHVwU3RpY2t5SGVhZGVyKCk7XG5cbiAgICAgICAgdGhpcy51aS50cmVlLm9uKCdyZWFkeS5qc3RyZWUnLCAoKSA9PiB0aGlzLl9nZXRDbGlwYm9hcmQoKSk7XG4gICAgfSxcblxuICAgIF9nZXRDbGlwYm9hcmQ6IGZ1bmN0aW9uIF9nZXRDbGlwYm9hcmQoKSB7XG4gICAgICAgIHRoaXMuY2xpcGJvYXJkID0gQ01TLnNldHRpbmdzLnBhZ2VDbGlwYm9hcmQgfHwgdGhpcy5jbGlwYm9hcmQ7XG5cbiAgICAgICAgaWYgKHRoaXMuY2xpcGJvYXJkLnR5cGUgJiYgdGhpcy5jbGlwYm9hcmQub3JpZ2luKSB7XG4gICAgICAgICAgICB0aGlzLl9lbmFibGVQYXN0ZSgpO1xuICAgICAgICAgICAgdGhpcy5fdXBkYXRlUGFzdGVIZWxwZXJzU3RhdGUoKTtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBIZWxwZXIgdG8gcHJvY2VzcyB0aGUgY3V0IGFuZCBjb3B5IGV2ZW50cy5cbiAgICAgKlxuICAgICAqIEBtZXRob2QgX2N1dE9yQ29weVxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBbb2JqXVxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBbb2JqLnR5cGVdIGVpdGhlciAnY3V0JyBvciAnY29weSdcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW29iai5lbGVtZW50XSBvcmlnaW5hdGVkIHRyaWdnZXIgZWxlbWVudFxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHJldHVybnMge0Jvb2xlYW58dm9pZH1cbiAgICAgKi9cbiAgICBfY3V0T3JDb3B5OiBmdW5jdGlvbiBfY3V0T3JDb3B5KG9iaikge1xuICAgICAgICAvLyBwcmV2ZW50IGFjdGlvbnMgaWYgeW91IHRyeSB0byBjb3B5IGEgcGFnZSB3aXRoIGFuIGFwcGhvb2tcbiAgICAgICAgaWYgKG9iai50eXBlID09PSAnY29weScgJiYgb2JqLmVsZW1lbnQuZGF0YSgpLmFwcGhvb2spIHtcbiAgICAgICAgICAgIHRoaXMuc2hvd0Vycm9yKHRoaXMub3B0aW9ucy5sYW5nLmFwcGhvb2spO1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG5cbiAgICAgICAgdmFyIGpzVHJlZUlkID0gdGhpcy5fZ2V0Tm9kZUlkKG9iai5lbGVtZW50LmNsb3Nlc3QoJy5qc3RyZWUtZ3JpZC1jZWxsJykpO1xuXG4gICAgICAgIC8vIHJlc2V0cyBpZiB3ZSBjbGljayBhZ2FpblxuICAgICAgICBpZiAodGhpcy5jbGlwYm9hcmQudHlwZSA9PT0gb2JqLnR5cGUgJiYganNUcmVlSWQgPT09IHRoaXMuY2xpcGJvYXJkLmlkKSB7XG4gICAgICAgICAgICB0aGlzLmNsaXBib2FyZC50eXBlID0gbnVsbDtcbiAgICAgICAgICAgIHRoaXMuY2xpcGJvYXJkLmlkID0gbnVsbDtcbiAgICAgICAgICAgIHRoaXMuY2xpcGJvYXJkLm9yaWdpbiA9IG51bGw7XG4gICAgICAgICAgICB0aGlzLmNsaXBib2FyZC5zb3VyY2Vfc2l0ZSA9IG51bGw7XG4gICAgICAgICAgICB0aGlzLl9kaXNhYmxlUGFzdGUoKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuY2xpcGJvYXJkLm9yaWdpbiA9IG9iai5lbGVtZW50LmRhdGEoKS5pZDsgLy8gdGhpcy5fZ2V0Tm9kZUlkKG9iai5lbGVtZW50KTtcbiAgICAgICAgICAgIHRoaXMuY2xpcGJvYXJkLnR5cGUgPSBvYmoudHlwZTtcbiAgICAgICAgICAgIHRoaXMuY2xpcGJvYXJkLmlkID0ganNUcmVlSWQ7XG4gICAgICAgICAgICB0aGlzLmNsaXBib2FyZC5zb3VyY2Vfc2l0ZSA9IHRoaXMub3B0aW9ucy5zaXRlO1xuICAgICAgICAgICAgdGhpcy5fdXBkYXRlUGFzdGVIZWxwZXJzU3RhdGUoKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5jbGlwYm9hcmQudHlwZSA9PT0gJ2NvcHknIHx8ICF0aGlzLmNsaXBib2FyZC50eXBlKSB7XG4gICAgICAgICAgICBDTVMuc2V0dGluZ3MucGFnZUNsaXBib2FyZCA9IHRoaXMuY2xpcGJvYXJkO1xuICAgICAgICAgICAgSGVscGVycy5zZXRTZXR0aW5ncyhDTVMuc2V0dGluZ3MpO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIEhlbHBlciB0byBwcm9jZXNzIHRoZSBwYXN0ZSBldmVudC5cbiAgICAgKlxuICAgICAqIEBtZXRob2QgX3Bhc3RlXG4gICAgICogQHBhcmFtIHskLkV2ZW50fSBldmVudCBjbGljayBldmVudFxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgX3Bhc3RlOiBmdW5jdGlvbiBfcGFzdGUoZXZlbnQpIHtcbiAgICAgICAgLy8gaGlkZSBoZWxwZXJzIGFmdGVyIHdlIHBpY2tlZCBvbmVcbiAgICAgICAgdGhpcy5fZGlzYWJsZVBhc3RlKCk7XG5cbiAgICAgICAgdmFyIGNvcHlGcm9tSWQgPSB0aGlzLl9nZXROb2RlSWQoXG4gICAgICAgICAgICAkKGAuanMtY21zLXBhZ2V0cmVlLW9wdGlvbnNbZGF0YS1pZD1cIiR7dGhpcy5jbGlwYm9hcmQub3JpZ2lufVwiXWApLmNsb3Nlc3QoJy5qc3RyZWUtZ3JpZC1jZWxsJylcbiAgICAgICAgKTtcbiAgICAgICAgdmFyIGNvcHlUb0lkID0gdGhpcy5fZ2V0Tm9kZUlkKCQoZXZlbnQuY3VycmVudFRhcmdldCkpO1xuXG4gICAgICAgIGlmICh0aGlzLmNsaXBib2FyZC5zb3VyY2Vfc2l0ZSA9PT0gdGhpcy5vcHRpb25zLnNpdGUpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLmNsaXBib2FyZC50eXBlID09PSAnY3V0Jykge1xuICAgICAgICAgICAgICAgIHRoaXMudWkudHJlZS5qc3RyZWUoJ2N1dCcsIGNvcHlGcm9tSWQpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLnVpLnRyZWUuanN0cmVlKCdjb3B5JywgY29weUZyb21JZCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRoaXMuY2xpcGJvYXJkLmlzUGFzdGluZyA9IHRydWU7XG4gICAgICAgICAgICB0aGlzLnVpLnRyZWUuanN0cmVlKCdwYXN0ZScsIGNvcHlUb0lkLCAnbGFzdCcpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29uc3QgZHVtbXlJZCA9IHRoaXMudWkudHJlZS5qc3RyZWUoJ2NyZWF0ZV9ub2RlJywgY29weVRvSWQsICdMb2FkaW5nJywgJ2xhc3QnKTtcblxuICAgICAgICAgICAgaWYgKHRoaXMudWkudHJlZS5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnVpLnRyZWUuanN0cmVlKCdjdXQnLCBkdW1teUlkKTtcbiAgICAgICAgICAgICAgICB0aGlzLmNsaXBib2FyZC5pc1Bhc3RpbmcgPSB0cnVlO1xuICAgICAgICAgICAgICAgIHRoaXMudWkudHJlZS5qc3RyZWUoJ3Bhc3RlJywgY29weVRvSWQsICdsYXN0Jyk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmNsaXBib2FyZC50eXBlID09PSAnY29weScpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fY29weU5vZGUoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuY2xpcGJvYXJkLnR5cGUgPT09ICdjdXQnKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX21vdmVOb2RlKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5jbGlwYm9hcmQuaWQgPSBudWxsO1xuICAgICAgICB0aGlzLmNsaXBib2FyZC50eXBlID0gbnVsbDtcbiAgICAgICAgdGhpcy5jbGlwYm9hcmQub3JpZ2luID0gbnVsbDtcbiAgICAgICAgdGhpcy5jbGlwYm9hcmQuaXNQYXN0aW5nID0gZmFsc2U7XG4gICAgICAgIENNUy5zZXR0aW5ncy5wYWdlQ2xpcGJvYXJkID0gdGhpcy5jbGlwYm9hcmQ7XG4gICAgICAgIEhlbHBlcnMuc2V0U2V0dGluZ3MoQ01TLnNldHRpbmdzKTtcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogUmV0cmVpdmVzIGEgbGlzdCBvZiBub2RlcyBmcm9tIGxvY2FsIHN0b3JhZ2UuXG4gICAgICpcbiAgICAgKiBAbWV0aG9kIF9nZXRTdG9yZWROb2RlSWRzXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcmV0dXJucyB7QXJyYXl9IGxpc3Qgb2YgaWRzXG4gICAgICovXG4gICAgX2dldFN0b3JlZE5vZGVJZHM6IGZ1bmN0aW9uIF9nZXRTdG9yZWROb2RlSWRzKCkge1xuICAgICAgICByZXR1cm4gQ01TLnNldHRpbmdzLnBhZ2V0cmVlIHx8IFtdO1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBTdG9yZXMgYSBub2RlIGluIGxvY2FsIHN0b3JhZ2UuXG4gICAgICpcbiAgICAgKiBAbWV0aG9kIF9zdG9yZU5vZGVJZFxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IGlkIHRvIGJlIHN0b3JlZFxuICAgICAqIEByZXR1cm5zIHtTdHJpbmd9IGlkIHRoYXQgaGFzIGJlZW4gc3RvcmVkXG4gICAgICovXG4gICAgX3N0b3JlTm9kZUlkOiBmdW5jdGlvbiBfc3RvcmVOb2RlSWQoaWQpIHtcbiAgICAgICAgdmFyIG51bWJlciA9IGlkO1xuICAgICAgICB2YXIgc3RvcmFnZSA9IHRoaXMuX2dldFN0b3JlZE5vZGVJZHMoKTtcblxuICAgICAgICAvLyBzdG9yZSB2YWx1ZSBvbmx5IGlmIGl0IGlzbid0IHRoZXJlIHlldFxuICAgICAgICBpZiAoc3RvcmFnZS5pbmRleE9mKG51bWJlcikgPT09IC0xKSB7XG4gICAgICAgICAgICBzdG9yYWdlLnB1c2gobnVtYmVyKTtcbiAgICAgICAgfVxuXG4gICAgICAgIENNUy5zZXR0aW5ncy5wYWdldHJlZSA9IHN0b3JhZ2U7XG4gICAgICAgIEhlbHBlcnMuc2V0U2V0dGluZ3MoQ01TLnNldHRpbmdzKTtcblxuICAgICAgICByZXR1cm4gbnVtYmVyO1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBSZW1vdmVzIGEgbm9kZSBpbiBsb2NhbCBzdG9yYWdlLlxuICAgICAqXG4gICAgICogQG1ldGhvZCBfcmVtb3ZlTm9kZUlkXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gaWQgdG8gYmUgc3RvcmVkXG4gICAgICogQHJldHVybnMge1N0cmluZ30gaWQgdGhhdCBoYXMgYmVlbiByZW1vdmVkXG4gICAgICovXG4gICAgX3JlbW92ZU5vZGVJZDogZnVuY3Rpb24gX3JlbW92ZU5vZGVJZChpZCkge1xuICAgICAgICBjb25zdCBpbnN0YW5jZSA9IHRoaXMudWkudHJlZS5qc3RyZWUodHJ1ZSk7XG4gICAgICAgIGNvbnN0IGNoaWxkcmVuSWRzID0gaW5zdGFuY2UuZ2V0X25vZGUoe1xuICAgICAgICAgICAgaWQ6IENNUy4kKGBbZGF0YS1ub2RlLWlkPSR7aWR9XWApLmF0dHIoJ2lkJylcbiAgICAgICAgfSkuY2hpbGRyZW5fZDtcblxuICAgICAgICBjb25zdCBpZHNUb1JlbW92ZSA9IFtpZF0uY29uY2F0KFxuICAgICAgICAgICAgY2hpbGRyZW5JZHMubWFwKGNoaWxkSWQgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IG5vZGUgPSBpbnN0YW5jZS5nZXRfbm9kZSh7IGlkOiBjaGlsZElkIH0pO1xuXG4gICAgICAgICAgICAgICAgaWYgKCFub2RlIHx8ICFub2RlLmRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5vZGU7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5vZGUuZGF0YS5ub2RlSWQ7XG4gICAgICAgICAgICB9KVxuICAgICAgICApO1xuXG4gICAgICAgIGNvbnN0IHN0b3JhZ2UgPSB3aXRob3V0KHRoaXMuX2dldFN0b3JlZE5vZGVJZHMoKSwgLi4uaWRzVG9SZW1vdmUpO1xuXG4gICAgICAgIENNUy5zZXR0aW5ncy5wYWdldHJlZSA9IHN0b3JhZ2U7XG4gICAgICAgIEhlbHBlcnMuc2V0U2V0dGluZ3MoQ01TLnNldHRpbmdzKTtcblxuICAgICAgICByZXR1cm4gaWQ7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIE1vdmVzIGEgbm9kZSBhZnRlciBkcmFnICYgZHJvcC5cbiAgICAgKlxuICAgICAqIEBtZXRob2QgX21vdmVOb2RlXG4gICAgICogQHBhcmFtIHtPYmplY3R9IFtvYmpdXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtvYmouaWRdIGN1cnJlbnQgZWxlbWVudCBpZCBmb3IgdXJsIG1hdGNoaW5nXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtvYmoudGFyZ2V0XSB0YXJnZXQgc2libGluZyBvciBwYXJlbnRcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW29iai5wb3NpdGlvbl0gZWl0aGVyIGBsZWZ0YCwgYHJpZ2h0YCBvciBgbGFzdC1jaGlsZGBcbiAgICAgKiBAcmV0dXJucyB7JC5EZWZlcnJlZH0gYWpheCByZXF1ZXN0IG9iamVjdFxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgX21vdmVOb2RlOiBmdW5jdGlvbiBfbW92ZU5vZGUob2JqKSB7XG4gICAgICAgIHZhciB0aGF0ID0gdGhpcztcblxuICAgICAgICBpZiAoIW9iai5pZCAmJiB0aGlzLmNsaXBib2FyZC50eXBlID09PSAnY3V0JyAmJiB0aGlzLmNsaXBib2FyZC5vcmlnaW4pIHtcbiAgICAgICAgICAgIG9iai5pZCA9IHRoaXMuY2xpcGJvYXJkLm9yaWdpbjtcbiAgICAgICAgICAgIG9iai5zb3VyY2Vfc2l0ZSA9IHRoaXMuY2xpcGJvYXJkLnNvdXJjZV9zaXRlO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgb2JqLnNpdGUgPSB0aGF0Lm9wdGlvbnMuc2l0ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiAkLmFqYXgoe1xuICAgICAgICAgICAgbWV0aG9kOiAncG9zdCcsXG4gICAgICAgICAgICB1cmw6IHRoYXQub3B0aW9ucy51cmxzLm1vdmUucmVwbGFjZSgne2lkfScsIG9iai5pZCksXG4gICAgICAgICAgICBkYXRhOiBvYmpcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC5kb25lKGZ1bmN0aW9uKHIpIHtcbiAgICAgICAgICAgICAgICBpZiAoci5zdGF0dXMgJiYgci5zdGF0dXMgPT09IDQwMCkgeyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lXG4gICAgICAgICAgICAgICAgICAgIHRoYXQuc2hvd0Vycm9yKHIuY29udGVudCk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdGhhdC5fc2hvd1N1Y2Nlc3Mob2JqLmlkKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLmZhaWwoZnVuY3Rpb24oZXJyb3IpIHtcbiAgICAgICAgICAgICAgICB0aGF0LnNob3dFcnJvcihlcnJvci5zdGF0dXNUZXh0KTtcbiAgICAgICAgICAgIH0pO1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBDb3BpZXMgYSBub2RlIGludG8gdGhlIHNlbGVjdGVkIG5vZGUuXG4gICAgICpcbiAgICAgKiBAbWV0aG9kIF9jb3B5Tm9kZVxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBvYmogcGFnZSBvYmpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIF9jb3B5Tm9kZTogZnVuY3Rpb24gX2NvcHlOb2RlKG9iaikge1xuICAgICAgICB2YXIgdGhhdCA9IHRoaXM7XG4gICAgICAgIHZhciBub2RlID0geyBwb3NpdGlvbjogMCB9O1xuXG4gICAgICAgIGlmIChvYmopIHtcbiAgICAgICAgICAgIG5vZGUgPSB0aGF0Ll9nZXROb2RlUG9zaXRpb24ob2JqKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHZhciBkYXRhID0ge1xuICAgICAgICAgICAgLy8gb2JqLm9yaWdpbmFsLmRhdGEuaWQgaXMgZm9yIGRyYWcgY29weVxuICAgICAgICAgICAgaWQ6IHRoaXMuY2xpcGJvYXJkLm9yaWdpbiB8fCBvYmoub3JpZ2luYWwuZGF0YS5pZCxcbiAgICAgICAgICAgIHBvc2l0aW9uOiBub2RlLnBvc2l0aW9uXG4gICAgICAgIH07XG5cbiAgICAgICAgaWYgKHRoaXMuY2xpcGJvYXJkLnNvdXJjZV9zaXRlKSB7XG4gICAgICAgICAgICBkYXRhLnNvdXJjZV9zaXRlID0gdGhpcy5jbGlwYm9hcmQuc291cmNlX3NpdGU7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBkYXRhLnNvdXJjZV9zaXRlID0gdGhpcy5vcHRpb25zLnNpdGU7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBpZiB0aGVyZSBpcyBubyB0YXJnZXQgcHJvdmlkZWQsIHRoZSBub2RlIGxhbmRzIGluIHJvb3RcbiAgICAgICAgaWYgKG5vZGUudGFyZ2V0KSB7XG4gICAgICAgICAgICBkYXRhLnRhcmdldCA9IG5vZGUudGFyZ2V0O1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHRoYXQub3B0aW9ucy5wZXJtaXNzaW9uKSB7XG4gICAgICAgICAgICAvLyB3ZSBuZWVkIHRvIGxvYWQgYSBkaWFsb2cgZmlyc3QsIHRvIGNoZWNrIGlmIHBlcm1pc3Npb25zIHNob3VsZFxuICAgICAgICAgICAgLy8gYmUgY29waWVkIG9yIG5vdFxuICAgICAgICAgICAgJC5hamF4KHtcbiAgICAgICAgICAgICAgICBtZXRob2Q6ICdwb3N0JyxcbiAgICAgICAgICAgICAgICB1cmw6IHRoYXQub3B0aW9ucy51cmxzLmNvcHlQZXJtaXNzaW9uLnJlcGxhY2UoJ3tpZH0nLCBkYXRhLmlkKSxcbiAgICAgICAgICAgICAgICBkYXRhOiBkYXRhXG4gICAgICAgICAgICAgICAgLy8gdGhlIGRpYWxvZyBpcyBsb2FkZWQgdmlhIHRoZSBhamF4IHJlc3BvbnMgb3JpZ2luYXRpbmcgZnJvbVxuICAgICAgICAgICAgICAgIC8vIGB0ZW1wbGF0ZXMvYWRtaW4vY21zL3BhZ2UvdHJlZS9jb3B5X3ByZW1pc3Npb25zLmh0bWxgXG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIC5kb25lKGZ1bmN0aW9uKGRpYWxvZykge1xuICAgICAgICAgICAgICAgICAgICB0aGF0LnVpLmRpYWxvZy5hcHBlbmQoZGlhbG9nKTtcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIC5mYWlsKGZ1bmN0aW9uKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoYXQuc2hvd0Vycm9yKGVycm9yLnN0YXR1c1RleHQpO1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAvLyBhdHRhY2ggZXZlbnRzIHRvIHRoZSBwZXJtaXNzaW9uIGRpYWxvZ1xuICAgICAgICAgICAgdGhpcy51aS5kaWFsb2dcbiAgICAgICAgICAgICAgICAub2ZmKHRoaXMuY2xpY2ssICcuY2FuY2VsJylcbiAgICAgICAgICAgICAgICAub24odGhpcy5jbGljaywgJy5jYW5jZWwnLCBmdW5jdGlvbihlKSB7XG4gICAgICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICAgICAgLy8gcmVtb3ZlIGp1c3QgY29waWVkIG5vZGVcbiAgICAgICAgICAgICAgICAgICAgdGhhdC51aS50cmVlLmpzdHJlZSgnZGVsZXRlX25vZGUnLCBvYmoubm9kZS5pZCk7XG4gICAgICAgICAgICAgICAgICAgICQoJy5qcy1jbXMtZGlhbG9nJykucmVtb3ZlKCk7XG4gICAgICAgICAgICAgICAgICAgICQoJy5qcy1jbXMtZGlhbG9nLWRpbW1lcicpLnJlbW92ZSgpO1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgLm9mZih0aGlzLmNsaWNrLCAnLnN1Ym1pdCcpXG4gICAgICAgICAgICAgICAgLm9uKHRoaXMuY2xpY2ssICcuc3VibWl0JywgZnVuY3Rpb24oZSkge1xuICAgICAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBzdWJtaXRCdXR0b24gPSAkKHRoaXMpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgZm9ybURhdGEgPSBzdWJtaXRCdXR0b24uY2xvc2VzdCgnZm9ybScpLnNlcmlhbGl6ZSgpLnNwbGl0KCcmJyk7XG5cbiAgICAgICAgICAgICAgICAgICAgc3VibWl0QnV0dG9uLnByb3AoJ2Rpc2FibGVkJywgdHJ1ZSk7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gbG9vcCB0aHJvdWdoIGZvcm0gZGF0YSBhbmQgYXR0YWNoIHRvIG9ialxuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGZvcm1EYXRhLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhW2Zvcm1EYXRhW2ldLnNwbGl0KCc9JylbMF1dID0gZm9ybURhdGFbaV0uc3BsaXQoJz0nKVsxXTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIHRoYXQuX3NhdmVDb3BpZWROb2RlKGRhdGEpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5fc2F2ZUNvcGllZE5vZGUoZGF0YSk7XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogU2VuZHMgdGhlIHJlcXVlc3QgdG8gY29weSBhIG5vZGUuXG4gICAgICpcbiAgICAgKiBAbWV0aG9kIF9zYXZlQ29waWVkTm9kZVxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHBhcmFtIHtPYmplY3R9IGRhdGEgbm9kZSBwb3NpdGlvbiBpbmZvcm1hdGlvblxuICAgICAqIEByZXR1cm5zIHskLkRlZmVycmVkfVxuICAgICAqL1xuICAgIF9zYXZlQ29waWVkTm9kZTogZnVuY3Rpb24gX3NhdmVDb3BpZWROb2RlKGRhdGEpIHtcbiAgICAgICAgdmFyIHRoYXQgPSB0aGlzO1xuXG4gICAgICAgIC8vIHNlbmQgdGhlIHJlYWwgYWpheCByZXF1ZXN0IGZvciBjb3B5aW5nIHRoZSBwbHVnaW5cbiAgICAgICAgcmV0dXJuICQuYWpheCh7XG4gICAgICAgICAgICBtZXRob2Q6ICdwb3N0JyxcbiAgICAgICAgICAgIHVybDogdGhhdC5vcHRpb25zLnVybHMuY29weS5yZXBsYWNlKCd7aWR9JywgZGF0YS5pZCksXG4gICAgICAgICAgICBkYXRhOiBkYXRhXG4gICAgICAgIH0pXG4gICAgICAgICAgICAuZG9uZShmdW5jdGlvbihyKSB7XG4gICAgICAgICAgICAgICAgaWYgKHIuc3RhdHVzICYmIHIuc3RhdHVzID09PSA0MDApIHsgLy8gZXNsaW50LWRpc2FibGUtbGluZVxuICAgICAgICAgICAgICAgICAgICB0aGF0LnNob3dFcnJvcihyLmNvbnRlbnQpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRoYXQuX3JlbG9hZEhlbHBlcigpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAuZmFpbChmdW5jdGlvbihlcnJvcikge1xuICAgICAgICAgICAgICAgIHRoYXQuc2hvd0Vycm9yKGVycm9yLnN0YXR1c1RleHQpO1xuICAgICAgICAgICAgfSk7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgZWxlbWVudCBmcm9tIGFueSBzdWIgbm9kZXMuXG4gICAgICpcbiAgICAgKiBAbWV0aG9kIF9nZXRFbGVtZW50XG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcGFyYW0ge2pRdWVyeX0gZWwgalF1ZXJ5IG5vZGUgZm9ybSB3aGVyZSB0byBzZWFyY2hcbiAgICAgKiBAcmV0dXJucyB7U3RyaW5nfSBqc1RyZWUgbm9kZSBlbGVtZW50IGlkXG4gICAgICovXG4gICAgX2dldE5vZGVJZDogZnVuY3Rpb24gX2dldE5vZGVJZChlbCkge1xuICAgICAgICB2YXIgY2xzID0gZWwuY2xvc2VzdCgnLmpzdHJlZS1ncmlkLWNlbGwnKS5hdHRyKCdjbGFzcycpO1xuXG4gICAgICAgIC8vIGlmIGl0J3Mgbm90IGEgY2VsbCwgYXNzdW1lIGl0J3MgdGhlIHJvb3Qgbm9kZVxuICAgICAgICByZXR1cm4gY2xzID8gY2xzLnJlcGxhY2UoLy4qanNncmlkXyguKz8pX2NvbC4qLywgJyQxJykgOiAnIyc7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIEdldHMgdGhlIG5ldyBub2RlIHBvc2l0aW9uIGFmdGVyIG1vdmluZy5cbiAgICAgKlxuICAgICAqIEBtZXRob2QgX2dldE5vZGVQb3NpdGlvblxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHBhcmFtIHtPYmplY3R9IG9iaiBqc3RyZWUgbW92ZSBvYmplY3RcbiAgICAgKiBAcmV0dXJucyB7T2JqZWN0fSBldmFsdWF0ZWQgb2JqZWN0IHdpdGggcGFyYW1zXG4gICAgICovXG4gICAgX2dldE5vZGVQb3NpdGlvbjogZnVuY3Rpb24gX2dldE5vZGVQb3NpdGlvbihvYmopIHtcbiAgICAgICAgdmFyIGRhdGEgPSB7fTtcbiAgICAgICAgdmFyIG5vZGUgPSB0aGlzLnVpLnRyZWUuanN0cmVlKCdnZXRfbm9kZScsIG9iai5ub2RlLnBhcmVudCk7XG5cbiAgICAgICAgZGF0YS5wb3NpdGlvbiA9IG9iai5wb3NpdGlvbjtcblxuICAgICAgICAvLyBqc3RyZWUgaW5kaWNhdGVzIG5vIHBhcmVudCB3aXRoIGAjYCwgaW4gdGhpcyBjYXNlIHdlIGRvIG5vdFxuICAgICAgICAvLyBuZWVkIHRvIHNldCB0aGUgdGFyZ2V0IGF0dHJpYnV0ZSBhdCBhbGxcbiAgICAgICAgaWYgKG9iai5wYXJlbnQgIT09ICcjJykge1xuICAgICAgICAgICAgZGF0YS50YXJnZXQgPSBub2RlLmRhdGEuaWQ7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBzb21lIGZ1bmN0aW9ucyBsaWtlIGNvcHkgY3JlYXRlIGEgbmV3IGVsZW1lbnQgd2l0aCBhIG5ldyBpZCxcbiAgICAgICAgLy8gaW4gdGhpcyBjYXNlIHdlIG5lZWQgdG8gc2V0IGBkYXRhLmlkYCBtYW51YWxseVxuICAgICAgICBpZiAob2JqLm5vZGUgJiYgb2JqLm5vZGUuZGF0YSkge1xuICAgICAgICAgICAgZGF0YS5pZCA9IG9iai5ub2RlLmRhdGEuaWQ7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gZGF0YTtcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogU2V0cyB1cCBnZW5lcmFsIHRvb2x0aXBzIHRoYXQgY2FuIGhhdmUgYSBsaXN0IG9mIGxpbmtzIG9yIGNvbnRlbnQuXG4gICAgICpcbiAgICAgKiBAbWV0aG9kIF9zZXR1cERyb3Bkb3duc1xuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgX3NldHVwRHJvcGRvd25zOiBmdW5jdGlvbiBfc2V0dXBEcm9wZG93bnMoKSB7XG4gICAgICAgIHRoaXMuX2Ryb3Bkb3ducyA9IG5ldyBQYWdlVHJlZURyb3Bkb3ducyh7XG4gICAgICAgICAgICBjb250YWluZXI6IHRoaXMudWkuY29udGFpbmVyXG4gICAgICAgIH0pO1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBIYW5kbGVzIHBhZ2UgdmlldyBjbGljay4gVXN1YWwgdXNlIGNhc2UgaXMgdGhhdCBhZnRlciB5b3UgY2xpY2tcbiAgICAgKiBvbiB2aWV3IHBhZ2UgaW4gdGhlIHBhZ2V0cmVlIC0gc2lkZWZyYW1lIGlzIG5vIGxvbmdlciBuZWVkZWQsXG4gICAgICogc28gd2UgY2xvc2UgaXQuXG4gICAgICpcbiAgICAgKiBAbWV0aG9kIF9zZXR1cFBhZ2VWaWV3XG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBfc2V0dXBQYWdlVmlldzogZnVuY3Rpb24gX3NldHVwUGFnZVZpZXcoKSB7XG4gICAgICAgIHZhciB3aW4gPSBIZWxwZXJzLl9nZXRXaW5kb3coKTtcbiAgICAgICAgdmFyIHBhcmVudCA9IHdpbi5wYXJlbnQgPyB3aW4ucGFyZW50IDogd2luO1xuXG4gICAgICAgIHRoaXMudWkuY29udGFpbmVyLm9uKHRoaXMuY2xpY2ssICcuanMtY21zLXBhZ2V0cmVlLXBhZ2UtdmlldycsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcGFyZW50LkNNUy5BUEkuSGVscGVycy5zZXRTZXR0aW5ncyhcbiAgICAgICAgICAgICAgICAkLmV4dGVuZCh0cnVlLCB7fSwgQ01TLnNldHRpbmdzLCB7XG4gICAgICAgICAgICAgICAgICAgIHNpZGVmcmFtZToge1xuICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiBudWxsLFxuICAgICAgICAgICAgICAgICAgICAgICAgaGlkZGVuOiB0cnVlXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgKTtcbiAgICAgICAgfSk7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIEBtZXRob2QgX3NldHVwU3RpY2t5SGVhZGVyXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBfc2V0dXBTdGlja3lIZWFkZXI6IGZ1bmN0aW9uIF9zZXR1cFN0aWNreUhlYWRlcigpIHtcbiAgICAgICAgdmFyIHRoYXQgPSB0aGlzO1xuXG4gICAgICAgIHRoYXQudWkudHJlZS5vbigncmVhZHkuanN0cmVlJywgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB0aGF0LmhlYWRlciA9IG5ldyBQYWdlVHJlZVN0aWNreUhlYWRlcih7XG4gICAgICAgICAgICAgICAgY29udGFpbmVyOiB0aGF0LnVpLmNvbnRhaW5lclxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBUcmlnZ2VycyB0aGUgbGlua3MgYGhyZWZgIGFzIGFqYXggcG9zdCByZXF1ZXN0LlxuICAgICAqXG4gICAgICogQG1ldGhvZCBfc2V0QWpheFBvc3RcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBwYXJhbSB7alF1ZXJ5fSB0cmlnZ2VyIGpRdWVyeSBsaW5rIHRhcmdldFxuICAgICAqL1xuICAgIF9zZXRBamF4UG9zdDogZnVuY3Rpb24gX3NldEFqYXhQb3N0KHRyaWdnZXIpIHtcbiAgICAgICAgdmFyIHRoYXQgPSB0aGlzO1xuXG4gICAgICAgIHRoaXMudWkuY29udGFpbmVyLm9uKHRoaXMuY2xpY2ssIHRyaWdnZXIsIGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcblxuICAgICAgICAgICAgdmFyIGVsZW1lbnQgPSAkKHRoaXMpO1xuXG4gICAgICAgICAgICBpZiAoZWxlbWVudC5jbG9zZXN0KCcuY21zLXBhZ2V0cmVlLWRyb3Bkb3duLWl0ZW0tZGlzYWJsZWQnKS5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgd2luZG93LnRvcC5DTVMuQVBJLlRvb2xiYXIuc2hvd0xvYWRlcigpO1xuICAgICAgICAgICAgfSBjYXRjaCAoZXJyKSB7fVxuXG4gICAgICAgICAgICAkLmFqYXgoe1xuICAgICAgICAgICAgICAgIG1ldGhvZDogJ3Bvc3QnLFxuICAgICAgICAgICAgICAgIHVybDogJCh0aGlzKS5hdHRyKCdocmVmJylcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgLmRvbmUoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cudG9wLkNNUy5BUEkuVG9vbGJhci5oaWRlTG9hZGVyKCk7XG4gICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGVycikge31cblxuICAgICAgICAgICAgICAgICAgICBpZiAod2luZG93LnNlbGYgPT09IHdpbmRvdy50b3ApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHNpbXBseSByZWxvYWQgdGhlIHBhZ2VcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoYXQuX3JlbG9hZEhlbHBlcigpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gaWYgd2UncmUgaW4gdGhlIHNpZGVmcmFtZSB3ZSBoYXZlIHRvIGFjdHVhbGx5XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBjaGVjayBpZiB3ZSBhcmUgcHVibGlzaGluZyBhIHBhZ2Ugd2UncmUgY3VycmVudGx5IGluXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBiZWNhdXNlIGlmIHRoZSBzbHVnIGRpZCBjaGFuZ2Ugd2Ugd291bGQgbmVlZCB0b1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gcmVkaXJlY3QgdG8gdGhhdCBuZXcgc2x1Z1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gUHJvYmxlbSBoZXJlIGlzIHRoYXQgaW4gY2FzZSBvZiB0aGUgYXBwaG9va2VkIHBhZ2VcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRoZSBtb2RlbCBhbmQgcGsgYXJlIGVtcHR5IGFuZCByZWxvYWRCcm93c2VyIGRvZXNuJ3QgcmVhbGx5XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBkbyBhbnl0aGluZyAtIHNvIGhlcmUgd2Ugc3BlY2lmaWNhbGx5IGZvcmNlIHRoZSBkYXRhXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyB0byBiZSB0aGUgZGF0YSBhYm91dCB0aGUgcGFnZSBhbmQgbm90IHRoZSBtb2RlbFxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBhcmVudCA9IHdpbmRvdy5wYXJlbnQgPyB3aW5kb3cucGFyZW50IDogd2luZG93O1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGRhdGEgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gdGhpcyBzaG91bGRuJ3QgYmUgaGFyZGNvZGVkLCBidXQgdGhlcmUgaXMgbm8gd2F5IGFyb3VuZCBpdFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1vZGVsOiAnY21zLnBhZ2UnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBrOiBwYXJlbnQuQ01TLmNvbmZpZy5yZXF1ZXN0LnBhZ2VfaWRcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIEhlbHBlcnMucmVsb2FkQnJvd3NlcignUkVGUkVTSF9QQUdFJywgZmFsc2UsIHRydWUsIGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAuZmFpbChmdW5jdGlvbihlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICB0aGF0LnNob3dFcnJvcihlcnJvci5zdGF0dXNUZXh0KTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIFNldHMgZXZlbnRzIGZvciB0aGUgc2VhcmNoIG9uIHRoZSBoZWFkZXIuXG4gICAgICpcbiAgICAgKiBAbWV0aG9kIF9zZXR1cFNlYXJjaFxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgX3NldHVwU2VhcmNoOiBmdW5jdGlvbiBfc2V0dXBTZWFyY2goKSB7XG4gICAgICAgIHZhciB0aGF0ID0gdGhpcztcbiAgICAgICAgdmFyIGNsaWNrID0gdGhpcy5jbGljayArICcuc2VhcmNoJztcblxuICAgICAgICB2YXIgZmlsdGVyQWN0aXZlID0gZmFsc2U7XG4gICAgICAgIHZhciBmaWx0ZXJUcmlnZ2VyID0gdGhpcy51aS5jb250YWluZXIuZmluZCgnLmpzLWNtcy1wYWdldHJlZS1oZWFkZXItZmlsdGVyLXRyaWdnZXInKTtcbiAgICAgICAgdmFyIGZpbHRlckNvbnRhaW5lciA9IHRoaXMudWkuY29udGFpbmVyLmZpbmQoJy5qcy1jbXMtcGFnZXRyZWUtaGVhZGVyLWZpbHRlci1jb250YWluZXInKTtcbiAgICAgICAgdmFyIGZpbHRlckNsb3NlID0gZmlsdGVyQ29udGFpbmVyLmZpbmQoJy5qcy1jbXMtcGFnZXRyZWUtaGVhZGVyLXNlYXJjaC1jbG9zZScpO1xuICAgICAgICB2YXIgZmlsdGVyQ2xhc3MgPSAnY21zLXBhZ2V0cmVlLWhlYWRlci1maWx0ZXItYWN0aXZlJztcbiAgICAgICAgdmFyIHBhZ2VUcmVlSGVhZGVyID0gJCgnLmNtcy1wYWdldHJlZS1oZWFkZXInKTtcblxuICAgICAgICB2YXIgdmlzaWJsZUZvcm0gPSB0aGlzLnVpLmNvbnRhaW5lci5maW5kKCcuanMtY21zLXBhZ2V0cmVlLWhlYWRlci1zZWFyY2gnKTtcbiAgICAgICAgdmFyIGhpZGRlbkZvcm0gPSB0aGlzLnVpLmNvbnRhaW5lci5maW5kKCcuanMtY21zLXBhZ2V0cmVlLWhlYWRlci1zZWFyY2gtY29weSBmb3JtJyk7XG5cbiAgICAgICAgdmFyIHNlYXJjaENvbnRhaW5lciA9IHRoaXMudWkuY29udGFpbmVyLmZpbmQoJy5jbXMtcGFnZXRyZWUtaGVhZGVyLWZpbHRlcicpO1xuICAgICAgICB2YXIgc2VhcmNoRmllbGQgPSBzZWFyY2hDb250YWluZXIuZmluZCgnI2ZpZWxkLXNlYXJjaGJhcicpO1xuICAgICAgICB2YXIgdGltZW91dCA9IDIwMDtcblxuICAgICAgICAvLyBhZGQgYWN0aXZlIGNsYXNzIHdoZW4gZm9jdXNpbmcgdGhlIHNlYXJjaCBmaWVsZFxuICAgICAgICBzZWFyY2hGaWVsZC5vbignZm9jdXMnLCBmdW5jdGlvbihlKSB7XG4gICAgICAgICAgICBlLnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbigpO1xuICAgICAgICAgICAgcGFnZVRyZWVIZWFkZXIuYWRkQ2xhc3MoZmlsdGVyQ2xhc3MpO1xuICAgICAgICB9KTtcbiAgICAgICAgc2VhcmNoRmllbGQub24oJ2JsdXInLCBmdW5jdGlvbihlKSB7XG4gICAgICAgICAgICBlLnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbigpO1xuICAgICAgICAgICAgLy8gdGltZW91dCBpcyByZXF1aXJlZCB0byBwcmV2ZW50IHRoZSBzZWFyY2ggZmllbGQgZnJvbSBqdW1waW5nXG4gICAgICAgICAgICAvLyBiZXR3ZWVuIGVubGFyZ2luZyBhbmQgc2hyaW5raW5nXG4gICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIGlmICghZmlsdGVyQWN0aXZlKSB7XG4gICAgICAgICAgICAgICAgICAgIHBhZ2VUcmVlSGVhZGVyLnJlbW92ZUNsYXNzKGZpbHRlckNsYXNzKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB0aW1lb3V0KTtcbiAgICAgICAgICAgIHRoYXQudWkuZG9jdW1lbnQub2ZmKGNsaWNrKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gc2hvd3MvaGlkZXMgZmlsdGVyIGJveFxuICAgICAgICBmaWx0ZXJUcmlnZ2VyLmFkZChmaWx0ZXJDbG9zZSkub24oY2xpY2ssIGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgIGUuc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKCk7XG4gICAgICAgICAgICBpZiAoZmlsdGVyQWN0aXZlKSB7XG4gICAgICAgICAgICAgICAgZmlsdGVyQ29udGFpbmVyLmhpZGUoKTtcbiAgICAgICAgICAgICAgICBwYWdlVHJlZUhlYWRlci5yZW1vdmVDbGFzcyhmaWx0ZXJDbGFzcyk7XG4gICAgICAgICAgICAgICAgdGhhdC51aS5kb2N1bWVudC5vZmYoY2xpY2spO1xuICAgICAgICAgICAgICAgIGZpbHRlckFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBmaWx0ZXJDb250YWluZXIuc2hvdygpO1xuICAgICAgICAgICAgICAgIHBhZ2VUcmVlSGVhZGVyLmFkZENsYXNzKGZpbHRlckNsYXNzKTtcbiAgICAgICAgICAgICAgICB0aGF0LnVpLmRvY3VtZW50Lm9uKGNsaWNrLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgZmlsdGVyQWN0aXZlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgZmlsdGVyVHJpZ2dlci50cmlnZ2VyKGNsaWNrKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBmaWx0ZXJBY3RpdmUgPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICAvLyBwcmV2ZW50IGNsb3Npbmcgd2hlbiBvbiBmaWx0ZXIgY29udGFpbmVyXG4gICAgICAgIGZpbHRlckNvbnRhaW5lci5vbignY2xpY2snLCBmdW5jdGlvbihlKSB7XG4gICAgICAgICAgICBlLnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbigpO1xuICAgICAgICB9KTtcblxuICAgICAgICAvLyBhZGQgaGlkZGVuIGZpZWxkcyB0byB0aGUgZm9ybSB0byBtYWludGFpbiBmaWx0ZXIgcGFyYW1zXG4gICAgICAgIHZpc2libGVGb3JtLmFwcGVuZChoaWRkZW5Gb3JtLmZpbmQoJ2lucHV0W3R5cGU9XCJoaWRkZW5cIl0nKSk7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIFNob3dzIHBhc3RlIGhlbHBlcnMuXG4gICAgICpcbiAgICAgKiBAbWV0aG9kIF9lbmFibGVQYXN0ZVxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBbc2VsZWN0b3I9dGhpcy5vcHRpb25zLnBhc3RlU2VsZWN0b3JdIGpxdWVyeSBzZWxlY3RvclxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgX2VuYWJsZVBhc3RlOiBmdW5jdGlvbiBfZW5hYmxlUGFzdGUoc2VsZWN0b3IpIHtcbiAgICAgICAgdmFyIHNlbCA9IHR5cGVvZiBzZWxlY3RvciA9PT0gJ3VuZGVmaW5lZCdcbiAgICAgICAgICAgID8gdGhpcy5vcHRpb25zLnBhc3RlU2VsZWN0b3JcbiAgICAgICAgICAgIDogc2VsZWN0b3IgKyAnICcgKyB0aGlzLm9wdGlvbnMucGFzdGVTZWxlY3RvcjtcbiAgICAgICAgdmFyIGRyb3Bkb3duU2VsID0gJy5qcy1jbXMtcGFnZXRyZWUtYWN0aW9ucy1kcm9wZG93bic7XG5cbiAgICAgICAgaWYgKHR5cGVvZiBzZWxlY3RvciAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgIGRyb3Bkb3duU2VsID0gc2VsZWN0b3IgKyAnIC5qcy1jbXMtcGFnZXRyZWUtYWN0aW9ucy1kcm9wZG93bic7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBoZWxwZXJzIGFyZSBnZW5lcmF0ZWQgb24gdGhlIGZseSwgc28gd2UgbmVlZCB0byByZWZlcmVuY2VcbiAgICAgICAgLy8gdGhlbSBldmVyeSBzaW5nbGUgdGltZVxuICAgICAgICAkKHNlbCkucmVtb3ZlQ2xhc3MoJ2Ntcy1wYWdldHJlZS1kcm9wZG93bi1pdGVtLWRpc2FibGVkJyk7XG5cbiAgICAgICAgdmFyIGRhdGEgPSB7fTtcblxuICAgICAgICBpZiAodGhpcy5jbGlwYm9hcmQudHlwZSA9PT0gJ2N1dCcpIHtcbiAgICAgICAgICAgIGRhdGEuaGFzX2N1dCA9IHRydWU7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBkYXRhLmhhc19jb3B5ID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICAvLyBub3QgbG9hZGVkIGFjdGlvbnMgZHJvcGRvd24gaGF2ZSB0byBiZSB1cGRhdGVkIGFzIHdlbGxcbiAgICAgICAgJChkcm9wZG93blNlbCkuZGF0YSgnbGF6eVVybERhdGEnLCBkYXRhKTtcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogSGlkZXMgcGFzdGUgaGVscGVycy5cbiAgICAgKlxuICAgICAqIEBtZXRob2QgX2Rpc2FibGVQYXN0ZVxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBbc2VsZWN0b3I9dGhpcy5vcHRpb25zLnBhc3RlU2VsZWN0b3JdIGpxdWVyeSBzZWxlY3RvclxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgX2Rpc2FibGVQYXN0ZTogZnVuY3Rpb24gX2Rpc2FibGVQYXN0ZShzZWxlY3Rvcikge1xuICAgICAgICB2YXIgc2VsID0gdHlwZW9mIHNlbGVjdG9yID09PSAndW5kZWZpbmVkJ1xuICAgICAgICAgICAgPyB0aGlzLm9wdGlvbnMucGFzdGVTZWxlY3RvclxuICAgICAgICAgICAgOiBzZWxlY3RvciArICcgJyArIHRoaXMub3B0aW9ucy5wYXN0ZVNlbGVjdG9yO1xuICAgICAgICB2YXIgZHJvcGRvd25TZWwgPSAnLmpzLWNtcy1wYWdldHJlZS1hY3Rpb25zLWRyb3Bkb3duJztcblxuICAgICAgICBpZiAodHlwZW9mIHNlbGVjdG9yICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICAgICAgZHJvcGRvd25TZWwgPSBzZWxlY3RvciArICcgLmpzLWNtcy1wYWdldHJlZS1hY3Rpb25zLWRyb3Bkb3duJztcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIGhlbHBlcnMgYXJlIGdlbmVyYXRlZCBvbiB0aGUgZmx5LCBzbyB3ZSBuZWVkIHRvIHJlZmVyZW5jZVxuICAgICAgICAvLyB0aGVtIGV2ZXJ5IHNpbmdsZSB0aW1lXG4gICAgICAgICQoc2VsKS5hZGRDbGFzcygnY21zLXBhZ2V0cmVlLWRyb3Bkb3duLWl0ZW0tZGlzYWJsZWQnKTtcblxuICAgICAgICAvLyBub3QgbG9hZGVkIGFjdGlvbnMgZHJvcGRvd24gaGF2ZSB0byBiZSB1cGRhdGVkIGFzIHdlbGxcbiAgICAgICAgJChkcm9wZG93blNlbCkucmVtb3ZlRGF0YSgnbGF6eVVybERhdGEnKTtcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogVXBkYXRlcyB0aGUgY3VycmVudCBzdGF0ZSBvZiB0aGUgaGVscGVycyBhZnRlciBgYWZ0ZXJfb3Blbi5qc3RyZWVgXG4gICAgICogb3IgYF9jdXRPckNvcHlgIGlzIHRyaWdnZXJlZC5cbiAgICAgKlxuICAgICAqIEBtZXRob2QgX3VwZGF0ZVBhc3RlSGVscGVyc1N0YXRlXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBfdXBkYXRlUGFzdGVIZWxwZXJzU3RhdGU6IGZ1bmN0aW9uIF91cGRhdGVQYXN0ZUhlbHBlcnNTdGF0ZSgpIHtcbiAgICAgICAgdmFyIHRoYXQgPSB0aGlzO1xuXG4gICAgICAgIGlmICh0aGlzLmNsaXBib2FyZC50eXBlICYmIHRoaXMuY2xpcGJvYXJkLmlkKSB7XG4gICAgICAgICAgICB0aGlzLl9lbmFibGVQYXN0ZSgpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gaGlkZSBjdXQgZWxlbWVudCBhbmQgaXQncyBkZXNjZW5kYW50cycgcGFzdGUgaGVscGVycyBpZiBpdCBpcyB2aXNpYmxlXG4gICAgICAgIGlmIChcbiAgICAgICAgICAgIHRoaXMuY2xpcGJvYXJkLnR5cGUgPT09ICdjdXQnICYmXG4gICAgICAgICAgICB0aGlzLmNsaXBib2FyZC5vcmlnaW4gJiZcbiAgICAgICAgICAgIHRoaXMub3B0aW9ucy5zaXRlID09PSB0aGlzLmNsaXBib2FyZC5zb3VyY2Vfc2l0ZVxuICAgICAgICApIHtcbiAgICAgICAgICAgIHZhciBkZXNjZW5kYW50SWRzID0gdGhpcy5fZ2V0RGVzY2VuZGFudHNJZHModGhpcy5jbGlwYm9hcmQuaWQpO1xuICAgICAgICAgICAgdmFyIG5vZGVzID0gW3RoaXMuY2xpcGJvYXJkLmlkXTtcblxuICAgICAgICAgICAgaWYgKGRlc2NlbmRhbnRJZHMgJiYgZGVzY2VuZGFudElkcy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICBub2RlcyA9IG5vZGVzLmNvbmNhdChkZXNjZW5kYW50SWRzKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgbm9kZXMuZm9yRWFjaChmdW5jdGlvbihpZCkge1xuICAgICAgICAgICAgICAgIHRoYXQuX2Rpc2FibGVQYXN0ZSgnLmpzZ3JpZF8nICsgaWQgKyAnX2NvbCcpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogU2hvd3Mgc3VjY2VzcyBtZXNzYWdlIG9uIG5vZGUgYWZ0ZXIgc3VjY2Vzc2Z1bCBhY3Rpb24uXG4gICAgICpcbiAgICAgKiBAbWV0aG9kIF9zaG93U3VjY2Vzc1xuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBpZCBpZCBvZiB0aGUgZWxlbWVudCB0byBhZGQgdGhlIHN1Y2Nlc3MgY2xhc3NcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIF9zaG93U3VjY2VzczogZnVuY3Rpb24gX3Nob3dTdWNjZXNzKGlkKSB7XG4gICAgICAgIHZhciBlbGVtZW50ID0gdGhpcy51aS50cmVlLmZpbmQoJ2xpW2RhdGEtaWQ9XCInICsgaWQgKyAnXCJdJyk7XG5cbiAgICAgICAgZWxlbWVudC5hZGRDbGFzcygnY21zLXRyZWUtbm9kZS1zdWNjZXNzJyk7XG4gICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBlbGVtZW50LnJlbW92ZUNsYXNzKCdjbXMtdHJlZS1ub2RlLXN1Y2Nlc3MnKTtcbiAgICAgICAgfSwgdGhpcy5zdWNjZXNzVGltZXIpO1xuICAgICAgICAvLyBoaWRlIGVsZW1lbnRzXG4gICAgICAgIHRoaXMuX2Rpc2FibGVQYXN0ZSgpO1xuICAgICAgICB0aGlzLmNsaXBib2FyZC5pZCA9IG51bGw7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIENoZWNrcyBpZiB3ZSBzaG91bGQgcmVsb2FkIHRoZSBpZnJhbWUgb3IgZW50aXJlIHdpbmRvdy4gRm9yIHRoaXMgd2VcbiAgICAgKiBuZWVkIHRvIHNraXAgYENNUy5BUEkuSGVscGVycy5yZWxvYWRCcm93c2VyKCk7YC5cbiAgICAgKlxuICAgICAqIEBtZXRob2QgX3JlbG9hZEhlbHBlclxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgX3JlbG9hZEhlbHBlcjogZnVuY3Rpb24gX3JlbG9hZEhlbHBlcigpIHtcbiAgICAgICAgaWYgKHdpbmRvdy5zZWxmID09PSB3aW5kb3cudG9wKSB7XG4gICAgICAgICAgICBIZWxwZXJzLnJlbG9hZEJyb3dzZXIoKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5yZWxvYWQoKTtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBEaXNwbGF5cyBhbiBlcnJvciB3aXRoaW4gdGhlIGRqYW5nbyBVSS5cbiAgICAgKlxuICAgICAqIEBtZXRob2Qgc2hvd0Vycm9yXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IG1lc3NhZ2Ugc3RyaW5nIG1lc3NhZ2UgdG8gZGlzcGxheVxuICAgICAqL1xuICAgIHNob3dFcnJvcjogZnVuY3Rpb24gc2hvd0Vycm9yKG1lc3NhZ2UpIHtcbiAgICAgICAgdmFyIG1lc3NhZ2VzID0gJCgnLm1lc3NhZ2VsaXN0Jyk7XG4gICAgICAgIHZhciBicmVhZGNydW1iID0gJCgnLmJyZWFkY3J1bWJzJyk7XG4gICAgICAgIHZhciByZWxvYWQgPSB0aGlzLm9wdGlvbnMubGFuZy5yZWxvYWQ7XG4gICAgICAgIHZhciB0cGwgPVxuICAgICAgICAgICAgJycgK1xuICAgICAgICAgICAgJzx1bCBjbGFzcz1cIm1lc3NhZ2VsaXN0XCI+JyArXG4gICAgICAgICAgICAnICAgPGxpIGNsYXNzPVwiZXJyb3JcIj4nICtcbiAgICAgICAgICAgICcgICAgICAge21zZ30gJyArXG4gICAgICAgICAgICAnICAgICAgIDxhIGhyZWY9XCIjcmVsb2FkXCIgY2xhc3M9XCJjbXMtdHJlZS1yZWxvYWRcIj4gJyArXG4gICAgICAgICAgICByZWxvYWQgK1xuICAgICAgICAgICAgJyA8L2E+JyArXG4gICAgICAgICAgICAnICAgPC9saT4nICtcbiAgICAgICAgICAgICc8L3VsPic7XG4gICAgICAgIHZhciBtc2cgPSB0cGwucmVwbGFjZSgne21zZ30nLCAnPHN0cm9uZz4nICsgdGhpcy5vcHRpb25zLmxhbmcuZXJyb3IgKyAnPC9zdHJvbmc+ICcgKyBtZXNzYWdlKTtcblxuICAgICAgICBpZiAobWVzc2FnZXMubGVuZ3RoKSB7XG4gICAgICAgICAgICBtZXNzYWdlcy5yZXBsYWNlV2l0aChtc2cpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgYnJlYWRjcnVtYi5hZnRlcihtc2cpO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIEBtZXRob2QgX2dldERlc2NlbmRhbnRzSWRzXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gbm9kZUlkIGpzdHJlZSBpZCBvZiB0aGUgbm9kZSwgZS5nLiBqMV8zXG4gICAgICogQHJldHVybnMge1N0cmluZ1tdfSBhcnJheSBvZiBpZHNcbiAgICAgKi9cbiAgICBfZ2V0RGVzY2VuZGFudHNJZHM6IGZ1bmN0aW9uIF9nZXREZXNjZW5kYW50c0lkcyhub2RlSWQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMudWkudHJlZS5qc3RyZWUodHJ1ZSkuZ2V0X25vZGUobm9kZUlkKS5jaGlsZHJlbl9kO1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBAbWV0aG9kIF9oYXNQZXJtaXNpb25cbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBub2RlIGpzdHJlZSBub2RlXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IHBlcm1pc3Npb24gbW92ZSAvIGFkZFxuICAgICAqIEByZXR1cm5zIHtCb29sZWFufVxuICAgICAqL1xuICAgIF9oYXNQZXJtaXNzaW9uOiBmdW5jdGlvbiBfaGFzUGVybWlzaW9uKG5vZGUsIHBlcm1pc3Npb24pIHtcbiAgICAgICAgaWYgKG5vZGUuaWQgPT09ICcjJyAmJiBwZXJtaXNzaW9uID09PSAnYWRkJykge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMub3B0aW9ucy5oYXNBZGRSb290UGVybWlzc2lvbjtcbiAgICAgICAgfSBlbHNlIGlmIChub2RlLmlkID09PSAnIycpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBub2RlLmxpX2F0dHJbJ2RhdGEtJyArIHBlcm1pc3Npb24gKyAnLXBlcm1pc3Npb24nXSA9PT0gJ3RydWUnO1xuICAgIH1cbn0pO1xuXG5QYWdlVHJlZS5faW5pdCA9IGZ1bmN0aW9uKCkge1xuICAgIG5ldyBQYWdlVHJlZSgpO1xufTtcblxuLy8gc2hvcnRoYW5kIGZvciBqUXVlcnkoZG9jdW1lbnQpLnJlYWR5KCk7XG4kKGZ1bmN0aW9uKCkge1xuICAgIC8vIGxvYWQgY21zIHNldHRpbmdzIGJlZm9yZWhhbmRcbiAgICAvLyBoYXZlIHRvIHNldCB0b29sYmFyIHRvIFwiZXhwYW5kZWRcIiBieSBkZWZhdWx0XG4gICAgLy8gb3RoZXJ3aXNlIGluaXRpYWxpemF0aW9uIHdpbGwgYmUgaW5jb3JyZWN0IHdoZW4geW91XG4gICAgLy8gZ28gZmlyc3QgdG8gcGFnZXMgYW5kIHRoZW4gdG8gbm9ybWFsIHBhZ2VcbiAgICB3aW5kb3cuQ01TLmNvbmZpZyA9IHtcbiAgICAgICAgaXNQYWdlVHJlZTogdHJ1ZSxcbiAgICAgICAgc2V0dGluZ3M6IHtcbiAgICAgICAgICAgIHRvb2xiYXI6ICdleHBhbmRlZCcsXG4gICAgICAgICAgICB2ZXJzaW9uOiBfX0NNU19WRVJTSU9OX19cbiAgICAgICAgfSxcbiAgICAgICAgdXJsczoge1xuICAgICAgICAgICAgc2V0dGluZ3M6ICQoJy5qcy1jbXMtcGFnZXRyZWUnKS5kYXRhKCdzZXR0aW5ncy11cmwnKVxuICAgICAgICB9XG4gICAgfTtcbiAgICB3aW5kb3cuQ01TLnNldHRpbmdzID0gSGVscGVycy5nZXRTZXR0aW5ncygpO1xuICAgIC8vIGF1dG9sb2FkIHRoZSBwYWdldHJlZVxuICAgIENNUy5QYWdlVHJlZS5faW5pdCgpO1xufSk7XG5cbmV4cG9ydCBkZWZhdWx0IFBhZ2VUcmVlO1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIGNtcy9zdGF0aWMvY21zL2pzL21vZHVsZXMvY21zLnBhZ2V0cmVlLmpzIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTs7OztBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7OztBQU9BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7OztBQU1BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7QUFNQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7OztBQU1BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFUQTtBQVdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7OztBQVVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7OztBQU9BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7QUFPQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7OztBQVFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7OztBQVFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7QUFXQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7OztBQU9BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBTEE7QUFPQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7OztBQVFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7OztBQVFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7O0FBUUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7OztBQU1BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7OztBQVFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7O0FBT0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7QUFNQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7O0FBT0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7OztBQU9BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7O0FBT0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7O0FBT0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7QUFPQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7OztBQU1BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7O0FBTUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7OztBQU9BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///194\n");

/***/ }),

/***/ 195:
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_jquery__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_jquery___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_jquery__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_classjs__ = __webpack_require__(10);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_classjs___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_classjs__);\n\n\n\n/**\n                              * Dropdowns in the pagetree.\n                              * Have to be delegated, since pagetree nodes can be\n                              * lazy loaded.\n                              *\n                              * @class PageTreeDropdowns\n                              * @namespace CMS\n                              */\nvar PageTreeDropdowns = new __WEBPACK_IMPORTED_MODULE_1_classjs___default.a({\n    options: {\n        dropdownSelector: '.js-cms-pagetree-dropdown',\n        triggerSelector: '.js-cms-pagetree-dropdown-trigger',\n        menuSelector: '.js-cms-pagetree-dropdown-menu',\n        openCls: 'cms-pagetree-dropdown-menu-open' },\n\n\n    initialize: function initialize(options) {\n        this.options = __WEBPACK_IMPORTED_MODULE_0_jquery___default.a.extend(true, {}, this.options, options);\n        this.click = 'click.cms.pagetree.dropdown';\n\n        this._setupUI();\n        this._events();\n    },\n\n    /**\n        * @method _setupUI\n        * @private\n        */\n    _setupUI: function _setupUI() {\n        this.ui = {\n            container: this.options.container,\n            document: __WEBPACK_IMPORTED_MODULE_0_jquery___default()(document) };\n\n    },\n\n    /**\n        * Event handlers.\n        *\n        * @method _events\n        * @private\n        */\n    _events: function _events() {\n        var that = this;\n\n        // attach event to the trigger\n        this.ui.container.on(this.click, this.options.triggerSelector, function (e) {\n            e.preventDefault();\n            e.stopImmediatePropagation();\n\n            that._toggleDropdown(this);\n        });\n\n        // stop propagation on the element\n        this.ui.container.on(this.click, that.options.menuSelector, function (e) {\n            e.stopImmediatePropagation();\n        });\n\n        this.ui.container.on(this.click, that.options.menuSelector + ' a', function () {\n            that.closeAllDropdowns();\n        });\n\n        this.ui.document.on(this.click, function () {\n            that.closeAllDropdowns();\n        });\n    },\n\n    /**\n        * @method _toggleDropdown\n        * @param {jQuery} trigger trigger clicked\n        * @private\n        * @returns {Boolean|void}\n        */\n    _toggleDropdown: function _toggleDropdown(trigger) {\n        var dropdowns = __WEBPACK_IMPORTED_MODULE_0_jquery___default()(this.options.dropdownSelector);\n        var dropdown = __WEBPACK_IMPORTED_MODULE_0_jquery___default()(trigger).closest(this.options.dropdownSelector);\n\n        // cancel if opened tooltip is triggered again\n        if (dropdown.hasClass(this.options.openCls)) {\n            dropdowns.removeClass(this.options.openCls);\n            return false;\n        }\n\n        // otherwise show the dropdown\n        dropdowns.removeClass(this.options.openCls);\n        dropdown.addClass(this.options.openCls);\n\n        this._loadContent(dropdown);\n    },\n\n    /**\n        * @method _loadContent\n        * @private\n        * @param {jQuery} dropdown\n        * @returns {Boolean|$.Deferred} false if not lazy or already loaded or promise\n        */\n    _loadContent: function _loadContent(dropdown) {\n        var data = dropdown.data();\n        var LOADER_SHOW_TIMEOUT = 200;\n\n        if (!data.lazyUrl || data.loaded) {\n            return false;\n        }\n\n        var loaderTimeout = setTimeout(function () {\n            dropdown.find('.js-cms-pagetree-dropdown-loader').addClass('cms-loader');\n        }, LOADER_SHOW_TIMEOUT);\n\n        __WEBPACK_IMPORTED_MODULE_0_jquery___default.a.ajax({\n            url: data.lazyUrl,\n            data: data.lazyUrlData }).\n        done(function (response) {\n            dropdown.find('.js-cms-pagetree-dropdown-menu').html(response);\n            dropdown.data('loaded', true);\n            clearTimeout(loaderTimeout);\n        });\n    },\n\n    /**\n        * @method closeAllDropdowns\n        * @public\n        */\n    closeAllDropdowns: function closeAllDropdowns() {\n        __WEBPACK_IMPORTED_MODULE_0_jquery___default()(this.options.dropdownSelector).removeClass(this.options.openCls);\n    } });\n\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (PageTreeDropdowns);//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTk1LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vL2Ntcy9zdGF0aWMvY21zL2pzL21vZHVsZXMvY21zLnBhZ2V0cmVlLmRyb3Bkb3duLmpzPzI1ODAiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0ICQgZnJvbSAnanF1ZXJ5JztcbmltcG9ydCBDbGFzcyBmcm9tICdjbGFzc2pzJztcblxuLyoqXG4gKiBEcm9wZG93bnMgaW4gdGhlIHBhZ2V0cmVlLlxuICogSGF2ZSB0byBiZSBkZWxlZ2F0ZWQsIHNpbmNlIHBhZ2V0cmVlIG5vZGVzIGNhbiBiZVxuICogbGF6eSBsb2FkZWQuXG4gKlxuICogQGNsYXNzIFBhZ2VUcmVlRHJvcGRvd25zXG4gKiBAbmFtZXNwYWNlIENNU1xuICovXG52YXIgUGFnZVRyZWVEcm9wZG93bnMgPSBuZXcgQ2xhc3Moe1xuICAgIG9wdGlvbnM6IHtcbiAgICAgICAgZHJvcGRvd25TZWxlY3RvcjogJy5qcy1jbXMtcGFnZXRyZWUtZHJvcGRvd24nLFxuICAgICAgICB0cmlnZ2VyU2VsZWN0b3I6ICcuanMtY21zLXBhZ2V0cmVlLWRyb3Bkb3duLXRyaWdnZXInLFxuICAgICAgICBtZW51U2VsZWN0b3I6ICcuanMtY21zLXBhZ2V0cmVlLWRyb3Bkb3duLW1lbnUnLFxuICAgICAgICBvcGVuQ2xzOiAnY21zLXBhZ2V0cmVlLWRyb3Bkb3duLW1lbnUtb3BlbidcbiAgICB9LFxuXG4gICAgaW5pdGlhbGl6ZTogZnVuY3Rpb24gaW5pdGlhbGl6ZShvcHRpb25zKSB7XG4gICAgICAgIHRoaXMub3B0aW9ucyA9ICQuZXh0ZW5kKHRydWUsIHt9LCB0aGlzLm9wdGlvbnMsIG9wdGlvbnMpO1xuICAgICAgICB0aGlzLmNsaWNrID0gJ2NsaWNrLmNtcy5wYWdldHJlZS5kcm9wZG93bic7XG5cbiAgICAgICAgdGhpcy5fc2V0dXBVSSgpO1xuICAgICAgICB0aGlzLl9ldmVudHMoKTtcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogQG1ldGhvZCBfc2V0dXBVSVxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgX3NldHVwVUk6IGZ1bmN0aW9uIF9zZXR1cFVJKCkge1xuICAgICAgICB0aGlzLnVpID0ge1xuICAgICAgICAgICAgY29udGFpbmVyOiB0aGlzLm9wdGlvbnMuY29udGFpbmVyLFxuICAgICAgICAgICAgZG9jdW1lbnQ6ICQoZG9jdW1lbnQpXG4gICAgICAgIH07XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIEV2ZW50IGhhbmRsZXJzLlxuICAgICAqXG4gICAgICogQG1ldGhvZCBfZXZlbnRzXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBfZXZlbnRzOiBmdW5jdGlvbiBfZXZlbnRzKCkge1xuICAgICAgICB2YXIgdGhhdCA9IHRoaXM7XG5cbiAgICAgICAgLy8gYXR0YWNoIGV2ZW50IHRvIHRoZSB0cmlnZ2VyXG4gICAgICAgIHRoaXMudWkuY29udGFpbmVyLm9uKHRoaXMuY2xpY2ssIHRoaXMub3B0aW9ucy50cmlnZ2VyU2VsZWN0b3IsIGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgIGUuc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKCk7XG5cbiAgICAgICAgICAgIHRoYXQuX3RvZ2dsZURyb3Bkb3duKHRoaXMpO1xuICAgICAgICB9KTtcblxuICAgICAgICAvLyBzdG9wIHByb3BhZ2F0aW9uIG9uIHRoZSBlbGVtZW50XG4gICAgICAgIHRoaXMudWkuY29udGFpbmVyLm9uKHRoaXMuY2xpY2ssIHRoYXQub3B0aW9ucy5tZW51U2VsZWN0b3IsIGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgICAgIGUuc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMudWkuY29udGFpbmVyLm9uKHRoaXMuY2xpY2ssIHRoYXQub3B0aW9ucy5tZW51U2VsZWN0b3IgKyAnIGEnLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHRoYXQuY2xvc2VBbGxEcm9wZG93bnMoKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy51aS5kb2N1bWVudC5vbih0aGlzLmNsaWNrLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHRoYXQuY2xvc2VBbGxEcm9wZG93bnMoKTtcbiAgICAgICAgfSk7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIEBtZXRob2QgX3RvZ2dsZURyb3Bkb3duXG4gICAgICogQHBhcmFtIHtqUXVlcnl9IHRyaWdnZXIgdHJpZ2dlciBjbGlja2VkXG4gICAgICogQHByaXZhdGVcbiAgICAgKiBAcmV0dXJucyB7Qm9vbGVhbnx2b2lkfVxuICAgICAqL1xuICAgIF90b2dnbGVEcm9wZG93bjogZnVuY3Rpb24gX3RvZ2dsZURyb3Bkb3duKHRyaWdnZXIpIHtcbiAgICAgICAgdmFyIGRyb3Bkb3ducyA9ICQodGhpcy5vcHRpb25zLmRyb3Bkb3duU2VsZWN0b3IpO1xuICAgICAgICB2YXIgZHJvcGRvd24gPSAkKHRyaWdnZXIpLmNsb3Nlc3QodGhpcy5vcHRpb25zLmRyb3Bkb3duU2VsZWN0b3IpO1xuXG4gICAgICAgIC8vIGNhbmNlbCBpZiBvcGVuZWQgdG9vbHRpcCBpcyB0cmlnZ2VyZWQgYWdhaW5cbiAgICAgICAgaWYgKGRyb3Bkb3duLmhhc0NsYXNzKHRoaXMub3B0aW9ucy5vcGVuQ2xzKSkge1xuICAgICAgICAgICAgZHJvcGRvd25zLnJlbW92ZUNsYXNzKHRoaXMub3B0aW9ucy5vcGVuQ2xzKTtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIG90aGVyd2lzZSBzaG93IHRoZSBkcm9wZG93blxuICAgICAgICBkcm9wZG93bnMucmVtb3ZlQ2xhc3ModGhpcy5vcHRpb25zLm9wZW5DbHMpO1xuICAgICAgICBkcm9wZG93bi5hZGRDbGFzcyh0aGlzLm9wdGlvbnMub3BlbkNscyk7XG5cbiAgICAgICAgdGhpcy5fbG9hZENvbnRlbnQoZHJvcGRvd24pO1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBAbWV0aG9kIF9sb2FkQ29udGVudFxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHBhcmFtIHtqUXVlcnl9IGRyb3Bkb3duXG4gICAgICogQHJldHVybnMge0Jvb2xlYW58JC5EZWZlcnJlZH0gZmFsc2UgaWYgbm90IGxhenkgb3IgYWxyZWFkeSBsb2FkZWQgb3IgcHJvbWlzZVxuICAgICAqL1xuICAgIF9sb2FkQ29udGVudDogZnVuY3Rpb24gX2xvYWRDb250ZW50KGRyb3Bkb3duKSB7XG4gICAgICAgIHZhciBkYXRhID0gZHJvcGRvd24uZGF0YSgpO1xuICAgICAgICB2YXIgTE9BREVSX1NIT1dfVElNRU9VVCA9IDIwMDtcblxuICAgICAgICBpZiAoIWRhdGEubGF6eVVybCB8fCBkYXRhLmxvYWRlZCkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG5cbiAgICAgICAgdmFyIGxvYWRlclRpbWVvdXQgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgZHJvcGRvd24uZmluZCgnLmpzLWNtcy1wYWdldHJlZS1kcm9wZG93bi1sb2FkZXInKS5hZGRDbGFzcygnY21zLWxvYWRlcicpO1xuICAgICAgICB9LCBMT0FERVJfU0hPV19USU1FT1VUKTtcblxuICAgICAgICAkLmFqYXgoe1xuICAgICAgICAgICAgdXJsOiBkYXRhLmxhenlVcmwsXG4gICAgICAgICAgICBkYXRhOiBkYXRhLmxhenlVcmxEYXRhXG4gICAgICAgIH0pLmRvbmUoZnVuY3Rpb24ocmVzcG9uc2UpIHtcbiAgICAgICAgICAgIGRyb3Bkb3duLmZpbmQoJy5qcy1jbXMtcGFnZXRyZWUtZHJvcGRvd24tbWVudScpLmh0bWwocmVzcG9uc2UpO1xuICAgICAgICAgICAgZHJvcGRvd24uZGF0YSgnbG9hZGVkJywgdHJ1ZSk7XG4gICAgICAgICAgICBjbGVhclRpbWVvdXQobG9hZGVyVGltZW91dCk7XG4gICAgICAgIH0pO1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBAbWV0aG9kIGNsb3NlQWxsRHJvcGRvd25zXG4gICAgICogQHB1YmxpY1xuICAgICAqL1xuICAgIGNsb3NlQWxsRHJvcGRvd25zOiBmdW5jdGlvbiBjbG9zZUFsbERyb3Bkb3ducygpIHtcbiAgICAgICAgJCh0aGlzLm9wdGlvbnMuZHJvcGRvd25TZWxlY3RvcikucmVtb3ZlQ2xhc3ModGhpcy5vcHRpb25zLm9wZW5DbHMpO1xuICAgIH1cbn0pO1xuXG5leHBvcnQgZGVmYXVsdCBQYWdlVHJlZURyb3Bkb3ducztcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyBjbXMvc3RhdGljL2Ntcy9qcy9tb2R1bGVzL2Ntcy5wYWdldHJlZS5kcm9wZG93bi5qcyJdLCJtYXBwaW5ncyI6IkFBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7QUFRQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7O0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7O0FBTUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7O0FBTUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7QUFNQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7O0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///195\n");

/***/ }),

/***/ 196:
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_jquery__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_jquery___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_jquery__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_classjs__ = __webpack_require__(10);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_classjs___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_classjs__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__cms_base__ = __webpack_require__(14);\n/*\n * Copyright https://github.com/divio/django-cms\n */\n\n\n\n\n\n/**\n                                       * Sticky language headers in pagetree\n                                       *\n                                       * @class PageTreeStickyHeader\n                                       * @namespace CMS\n                                       */\nvar PageTreeStickyHeader = new __WEBPACK_IMPORTED_MODULE_1_classjs___default.a({\n    initialize: function initialize(options) {\n        var that = this;\n\n        that.options = __WEBPACK_IMPORTED_MODULE_0_jquery___default.a.extend(true, {}, that.options, options);\n        that.resize = 'resize.cms.pagetree.header';\n        that.scroll = 'scroll.cms.pagetree.header';\n        that.areClonesInDOM = false;\n\n        that._setupUI();\n        that._saveSizes();\n        that._events();\n    },\n\n    /**\n        * @method _setupUI\n        * @private\n        */\n    _setupUI: function _setupUI() {\n        var container = this.options.container;\n        var headers = container.find('.jstree-grid-header');\n\n        this.ui = {\n            container: container,\n            window: __WEBPACK_IMPORTED_MODULE_0_jquery___default()(window),\n            headers: headers,\n            columns: container.find('.jstree-grid-column').toArray().map(function (el) {\n                return __WEBPACK_IMPORTED_MODULE_0_jquery___default()(el);\n            }),\n            clones: headers.clone().toArray().map(function (el) {\n                return __WEBPACK_IMPORTED_MODULE_0_jquery___default()(el);\n            }) };\n\n    },\n\n    /**\n        * Determines positions/sizes of elements\n        *\n        * @method _saveSizes\n        * @private\n        */\n    _saveSizes: function _saveSizes() {\n        this.headersTopOffset = this.ui.headers.offset().top;\n        this.toolbarHeight = 0;\n        if (this._isInSideframe()) {\n            this.toolbarHeight = CMS.API.Helpers._getWindow().parent.CMS.$('.cms-toolbar').height();\n        } else {\n            this.toolbarHeight = __WEBPACK_IMPORTED_MODULE_0_jquery___default()('#branding').height();\n        }\n    },\n\n    /**\n        * @method _isInSideframe\n        * @returns {Boolean} are we in sideframe?\n        * @private\n        */\n    _isInSideframe: function _isInSideframe() {\n        var win = __WEBPACK_IMPORTED_MODULE_2__cms_base__[\"c\" /* Helpers */]._getWindow();\n\n        if (win && win.parent && win.parent !== win) {\n            return true;\n        }\n\n        return false;\n    },\n\n    /**\n        * Event handlers.\n        *\n        * @method _events\n        * @private\n        */\n    _events: function _events() {\n        this.ui.window.on([this.resize, this.scroll].join(' '), this._handleResizeOrScroll.bind(this));\n    },\n\n    /**\n        * @method _handleResizeOrScroll\n        * @private\n        */\n    _handleResizeOrScroll: function _handleResizeOrScroll() {\n        var that = this;\n        var scrollTop = that.ui.window.scrollTop();\n        var scrollLeft = that.ui.window.scrollLeft();\n\n        if (that._shouldStick(scrollTop)) {\n            that._stickHeader(scrollTop, scrollLeft);\n        } else {\n            that._unstickHeader();\n        }\n    },\n\n    /**\n        * @method _shouldStick\n        * @param {Number} scrollTop position in pixels\n        * @returns {Boolean} should headers stick\n        * @private\n        */\n    _shouldStick: function _shouldStick(scrollTop) {\n        return scrollTop + this.toolbarHeight >= this.headersTopOffset;\n    },\n\n    /**\n        * @method _stickHeader\n        * @param {Number} scrollTop top\n        * @param {Number} scrollLeft left\n        * @private\n        */\n    _stickHeader: function _stickHeader(scrollTop, scrollLeft) {\n        var that = this;\n\n        that._insertClones();\n\n        that.ui.headers.each(function (index) {\n            var el = __WEBPACK_IMPORTED_MODULE_0_jquery___default()(this);\n\n            var width = that.ui.clones[index].css('width');\n            var offset = that.ui.clones[index].offset().left;\n\n            el.css({\n                width: width,\n                left: offset - scrollLeft });\n\n        });\n\n        that.ui.headers.addClass('jstree-grid-header-fixed').css({\n            top: that.toolbarHeight });\n\n    },\n\n    /**\n        * @method _unstickHeader\n        * @private\n        */\n    _unstickHeader: function _unstickHeader() {\n        var that = this;\n\n        that._detachClones();\n\n        that.ui.headers.removeClass('jstree-grid-header-fixed').css({\n            top: 0,\n            width: 'auto',\n            left: 'auto' });\n\n    },\n\n    /**\n        * Inserts clones of headers so when header becomes sticky the\n        * pagetree doesn't jump. Only does it once and sets the flag.\n        *\n        * @method _insertClones\n        * @private\n        */\n    _insertClones: function _insertClones() {\n        var that = this;\n\n        if (!that.areClonesInDOM) {\n            that.ui.columns.forEach(function (el, index) {\n                el.prepend(that.ui.clones[index]);\n            });\n            that.areClonesInDOM = true;\n        }\n    },\n\n    /**\n        * Detaches the clones of headers so then headers \"unsticks\"\n        * the pagetree doesn't jump. Relies on the flag.\n        *\n        * @method _detachClones\n        * @private\n        */\n    _detachClones: function _detachClones() {\n        var that = this;\n\n        if (that.areClonesInDOM) {\n            that.ui.clones.forEach(function (el) {\n                el.detach();\n            });\n            that.areClonesInDOM = false;\n        }\n    } });\n\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (PageTreeStickyHeader);//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTk2LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vL2Ntcy9zdGF0aWMvY21zL2pzL21vZHVsZXMvY21zLnBhZ2V0cmVlLnN0aWNreWhlYWRlci5qcz85YTI3Il0sInNvdXJjZXNDb250ZW50IjpbIi8qXG4gKiBDb3B5cmlnaHQgaHR0cHM6Ly9naXRodWIuY29tL2RpdmlvL2RqYW5nby1jbXNcbiAqL1xuXG5pbXBvcnQgJCBmcm9tICdqcXVlcnknO1xuaW1wb3J0IENsYXNzIGZyb20gJ2NsYXNzanMnO1xuaW1wb3J0IHsgSGVscGVycyB9IGZyb20gJy4vY21zLmJhc2UnO1xuXG4vKipcbiAqIFN0aWNreSBsYW5ndWFnZSBoZWFkZXJzIGluIHBhZ2V0cmVlXG4gKlxuICogQGNsYXNzIFBhZ2VUcmVlU3RpY2t5SGVhZGVyXG4gKiBAbmFtZXNwYWNlIENNU1xuICovXG52YXIgUGFnZVRyZWVTdGlja3lIZWFkZXIgPSBuZXcgQ2xhc3Moe1xuICAgIGluaXRpYWxpemU6IGZ1bmN0aW9uIGluaXRpYWxpemUob3B0aW9ucykge1xuICAgICAgICB2YXIgdGhhdCA9IHRoaXM7XG5cbiAgICAgICAgdGhhdC5vcHRpb25zID0gJC5leHRlbmQodHJ1ZSwge30sIHRoYXQub3B0aW9ucywgb3B0aW9ucyk7XG4gICAgICAgIHRoYXQucmVzaXplID0gJ3Jlc2l6ZS5jbXMucGFnZXRyZWUuaGVhZGVyJztcbiAgICAgICAgdGhhdC5zY3JvbGwgPSAnc2Nyb2xsLmNtcy5wYWdldHJlZS5oZWFkZXInO1xuICAgICAgICB0aGF0LmFyZUNsb25lc0luRE9NID0gZmFsc2U7XG5cbiAgICAgICAgdGhhdC5fc2V0dXBVSSgpO1xuICAgICAgICB0aGF0Ll9zYXZlU2l6ZXMoKTtcbiAgICAgICAgdGhhdC5fZXZlbnRzKCk7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIEBtZXRob2QgX3NldHVwVUlcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIF9zZXR1cFVJOiBmdW5jdGlvbiBfc2V0dXBVSSgpIHtcbiAgICAgICAgdmFyIGNvbnRhaW5lciA9IHRoaXMub3B0aW9ucy5jb250YWluZXI7XG4gICAgICAgIHZhciBoZWFkZXJzID0gY29udGFpbmVyLmZpbmQoJy5qc3RyZWUtZ3JpZC1oZWFkZXInKTtcblxuICAgICAgICB0aGlzLnVpID0ge1xuICAgICAgICAgICAgY29udGFpbmVyOiBjb250YWluZXIsXG4gICAgICAgICAgICB3aW5kb3c6ICQod2luZG93KSxcbiAgICAgICAgICAgIGhlYWRlcnM6IGhlYWRlcnMsXG4gICAgICAgICAgICBjb2x1bW5zOiBjb250YWluZXIuZmluZCgnLmpzdHJlZS1ncmlkLWNvbHVtbicpLnRvQXJyYXkoKS5tYXAoZnVuY3Rpb24oZWwpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gJChlbCk7XG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICAgIGNsb25lczogaGVhZGVycy5jbG9uZSgpLnRvQXJyYXkoKS5tYXAoZnVuY3Rpb24oZWwpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gJChlbCk7XG4gICAgICAgICAgICB9KVxuICAgICAgICB9O1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBEZXRlcm1pbmVzIHBvc2l0aW9ucy9zaXplcyBvZiBlbGVtZW50c1xuICAgICAqXG4gICAgICogQG1ldGhvZCBfc2F2ZVNpemVzXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBfc2F2ZVNpemVzOiBmdW5jdGlvbiBfc2F2ZVNpemVzKCkge1xuICAgICAgICB0aGlzLmhlYWRlcnNUb3BPZmZzZXQgPSB0aGlzLnVpLmhlYWRlcnMub2Zmc2V0KCkudG9wO1xuICAgICAgICB0aGlzLnRvb2xiYXJIZWlnaHQgPSAwO1xuICAgICAgICBpZiAodGhpcy5faXNJblNpZGVmcmFtZSgpKSB7XG4gICAgICAgICAgICB0aGlzLnRvb2xiYXJIZWlnaHQgPSBDTVMuQVBJLkhlbHBlcnMuX2dldFdpbmRvdygpLnBhcmVudC5DTVMuJCgnLmNtcy10b29sYmFyJykuaGVpZ2h0KCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLnRvb2xiYXJIZWlnaHQgPSAkKCcjYnJhbmRpbmcnKS5oZWlnaHQoKTtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBAbWV0aG9kIF9pc0luU2lkZWZyYW1lXG4gICAgICogQHJldHVybnMge0Jvb2xlYW59IGFyZSB3ZSBpbiBzaWRlZnJhbWU/XG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBfaXNJblNpZGVmcmFtZTogZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciB3aW4gPSBIZWxwZXJzLl9nZXRXaW5kb3coKTtcblxuICAgICAgICBpZiAod2luICYmIHdpbi5wYXJlbnQgJiYgd2luLnBhcmVudCAhPT0gd2luKSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogRXZlbnQgaGFuZGxlcnMuXG4gICAgICpcbiAgICAgKiBAbWV0aG9kIF9ldmVudHNcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIF9ldmVudHM6IGZ1bmN0aW9uIF9ldmVudHMoKSB7XG4gICAgICAgIHRoaXMudWkud2luZG93Lm9uKFt0aGlzLnJlc2l6ZSwgdGhpcy5zY3JvbGxdLmpvaW4oJyAnKSwgdGhpcy5faGFuZGxlUmVzaXplT3JTY3JvbGwuYmluZCh0aGlzKSk7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIEBtZXRob2QgX2hhbmRsZVJlc2l6ZU9yU2Nyb2xsXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBfaGFuZGxlUmVzaXplT3JTY3JvbGw6IGZ1bmN0aW9uIF9oYW5kbGVSZXNpemVPclNjcm9sbCgpIHtcbiAgICAgICAgdmFyIHRoYXQgPSB0aGlzO1xuICAgICAgICB2YXIgc2Nyb2xsVG9wID0gdGhhdC51aS53aW5kb3cuc2Nyb2xsVG9wKCk7XG4gICAgICAgIHZhciBzY3JvbGxMZWZ0ID0gdGhhdC51aS53aW5kb3cuc2Nyb2xsTGVmdCgpO1xuXG4gICAgICAgIGlmICh0aGF0Ll9zaG91bGRTdGljayhzY3JvbGxUb3ApKSB7XG4gICAgICAgICAgICB0aGF0Ll9zdGlja0hlYWRlcihzY3JvbGxUb3AsIHNjcm9sbExlZnQpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhhdC5fdW5zdGlja0hlYWRlcigpO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIEBtZXRob2QgX3Nob3VsZFN0aWNrXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IHNjcm9sbFRvcCBwb3NpdGlvbiBpbiBwaXhlbHNcbiAgICAgKiBAcmV0dXJucyB7Qm9vbGVhbn0gc2hvdWxkIGhlYWRlcnMgc3RpY2tcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIF9zaG91bGRTdGljazogZnVuY3Rpb24oc2Nyb2xsVG9wKSB7XG4gICAgICAgIHJldHVybiBzY3JvbGxUb3AgKyB0aGlzLnRvb2xiYXJIZWlnaHQgPj0gdGhpcy5oZWFkZXJzVG9wT2Zmc2V0O1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBAbWV0aG9kIF9zdGlja0hlYWRlclxuICAgICAqIEBwYXJhbSB7TnVtYmVyfSBzY3JvbGxUb3AgdG9wXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IHNjcm9sbExlZnQgbGVmdFxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgX3N0aWNrSGVhZGVyOiBmdW5jdGlvbiBfc3RpY2tIZWFkZXIoc2Nyb2xsVG9wLCBzY3JvbGxMZWZ0KSB7XG4gICAgICAgIHZhciB0aGF0ID0gdGhpcztcblxuICAgICAgICB0aGF0Ll9pbnNlcnRDbG9uZXMoKTtcblxuICAgICAgICB0aGF0LnVpLmhlYWRlcnMuZWFjaChmdW5jdGlvbihpbmRleCkge1xuICAgICAgICAgICAgdmFyIGVsID0gJCh0aGlzKTtcblxuICAgICAgICAgICAgdmFyIHdpZHRoID0gdGhhdC51aS5jbG9uZXNbaW5kZXhdLmNzcygnd2lkdGgnKTtcbiAgICAgICAgICAgIHZhciBvZmZzZXQgPSB0aGF0LnVpLmNsb25lc1tpbmRleF0ub2Zmc2V0KCkubGVmdDtcblxuICAgICAgICAgICAgZWwuY3NzKHtcbiAgICAgICAgICAgICAgICB3aWR0aDogd2lkdGgsXG4gICAgICAgICAgICAgICAgbGVmdDogb2Zmc2V0IC0gc2Nyb2xsTGVmdFxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoYXQudWkuaGVhZGVycy5hZGRDbGFzcygnanN0cmVlLWdyaWQtaGVhZGVyLWZpeGVkJykuY3NzKHtcbiAgICAgICAgICAgIHRvcDogdGhhdC50b29sYmFySGVpZ2h0XG4gICAgICAgIH0pO1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBAbWV0aG9kIF91bnN0aWNrSGVhZGVyXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBfdW5zdGlja0hlYWRlcjogZnVuY3Rpb24gX3Vuc3RpY2tIZWFkZXIoKSB7XG4gICAgICAgIHZhciB0aGF0ID0gdGhpcztcblxuICAgICAgICB0aGF0Ll9kZXRhY2hDbG9uZXMoKTtcblxuICAgICAgICB0aGF0LnVpLmhlYWRlcnMucmVtb3ZlQ2xhc3MoJ2pzdHJlZS1ncmlkLWhlYWRlci1maXhlZCcpLmNzcyh7XG4gICAgICAgICAgICB0b3A6IDAsXG4gICAgICAgICAgICB3aWR0aDogJ2F1dG8nLFxuICAgICAgICAgICAgbGVmdDogJ2F1dG8nXG4gICAgICAgIH0pO1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBJbnNlcnRzIGNsb25lcyBvZiBoZWFkZXJzIHNvIHdoZW4gaGVhZGVyIGJlY29tZXMgc3RpY2t5IHRoZVxuICAgICAqIHBhZ2V0cmVlIGRvZXNuJ3QganVtcC4gT25seSBkb2VzIGl0IG9uY2UgYW5kIHNldHMgdGhlIGZsYWcuXG4gICAgICpcbiAgICAgKiBAbWV0aG9kIF9pbnNlcnRDbG9uZXNcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIF9pbnNlcnRDbG9uZXM6IGZ1bmN0aW9uIF9pbnNlcnRDbG9uZXMoKSB7XG4gICAgICAgIHZhciB0aGF0ID0gdGhpcztcblxuICAgICAgICBpZiAoIXRoYXQuYXJlQ2xvbmVzSW5ET00pIHtcbiAgICAgICAgICAgIHRoYXQudWkuY29sdW1ucy5mb3JFYWNoKGZ1bmN0aW9uKGVsLCBpbmRleCkge1xuICAgICAgICAgICAgICAgIGVsLnByZXBlbmQodGhhdC51aS5jbG9uZXNbaW5kZXhdKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdGhhdC5hcmVDbG9uZXNJbkRPTSA9IHRydWU7XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogRGV0YWNoZXMgdGhlIGNsb25lcyBvZiBoZWFkZXJzIHNvIHRoZW4gaGVhZGVycyBcInVuc3RpY2tzXCJcbiAgICAgKiB0aGUgcGFnZXRyZWUgZG9lc24ndCBqdW1wLiBSZWxpZXMgb24gdGhlIGZsYWcuXG4gICAgICpcbiAgICAgKiBAbWV0aG9kIF9kZXRhY2hDbG9uZXNcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqL1xuICAgIF9kZXRhY2hDbG9uZXM6IGZ1bmN0aW9uIF9kZXRhY2hDbG9uZXMoKSB7XG4gICAgICAgIHZhciB0aGF0ID0gdGhpcztcblxuICAgICAgICBpZiAodGhhdC5hcmVDbG9uZXNJbkRPTSkge1xuICAgICAgICAgICAgdGhhdC51aS5jbG9uZXMuZm9yRWFjaChmdW5jdGlvbihlbCkge1xuICAgICAgICAgICAgICAgIGVsLmRldGFjaCgpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB0aGF0LmFyZUNsb25lc0luRE9NID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICB9XG59KTtcblxuZXhwb3J0IGRlZmF1bHQgUGFnZVRyZWVTdGlja3lIZWFkZXI7XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gY21zL3N0YXRpYy9jbXMvanMvbW9kdWxlcy9jbXMucGFnZXRyZWUuc3RpY2t5aGVhZGVyLmpzIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7Ozs7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7QUFNQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7OztBQU1BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7O0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7O0FBTUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7OztBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7QUFNQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7QUFNQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7O0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7QUFPQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7QUFPQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///196\n");

/***/ }),

/***/ 197:
/***/ (function(module, exports, __webpack_require__) {

eval("var __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;/*\n * https://github.com/deitch/jstree-grid\n *\n * This plugin handles adding a grid to a tree to display additional data\n *\n * Licensed under the MIT license:\n *   http://www.opensource.org/licenses/mit-license.php\n *\n * Works only with jstree version >= 3.0.0\n *\n * $Date: 2015-11-29 $\n * $Revision:  3.4.2 $\n *\n * !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\n * !!!                                                                         !!!\n * !!!   IMPORTANT it says 3.4.2 but it's actually 3.4.4, and it's modified!   !!!\n * !!!   line 646, same as: https://github.com/deitch/jstree-grid/pull/165     !!!\n * !!!                                                                         !!!\n * !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\n */\n\n/*jslint nomen:true */\n/*jshint unused:vars */\n/*global navigator, document, jQuery, define */\n\n/* AMD support added by jochenberger per https://github.com/deitch/jstree-grid/pull/49\n *\n */\n(function (factory) {\n    if (true) {\n        // AMD. Register as an anonymous module.\n        !(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(0), __webpack_require__(130)], __WEBPACK_AMD_DEFINE_FACTORY__ = (factory),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ?\n\t\t\t\t(__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n    } else {\n        // Browser globals\n        factory(jQuery);\n    }\n}(function ($) {\n    var renderAWidth, renderATitle, getIndent, htmlstripre, findLastClosedNode, BLANKRE = /^\\s*$/g,\n        IDREGEX = /[\\\\:&!^|()\\[\\]<>@*'+~#\";,= \\/${}%]/g, escapeId = function (id) {\n            return (id||\"\").replace(IDREGEX,'\\\\$&');\n        }, NODE_DATA_ATTR = \"data-jstreegrid\",\n    SPECIAL_TITLE = \"_DATA_\", LEVELINDENT = 24, styled = false, GRIDCELLID_PREFIX = \"jsgrid_\",GRIDCELLID_POSTFIX = \"_col\",\n        findDataCell = function (from,id) {\n            return from.find(\"div[\"+NODE_DATA_ATTR+\"='\"+id+\"']\");\n        },\n        isClickedSep = false, toResize = null, oldMouseX = 0, newMouseX = 0;\n\n    /*jslint regexp:true */\n    htmlstripre = /<\\/?[^>]+>/gi;\n    /*jslint regexp:false */\n\n    getIndent = function(node,tree) {\n        var div, i, li, width;\n\n        // did we already save it for this tree?\n        tree._gridSettings = tree._gridSettings || {};\n        if (tree._gridSettings.indent > 0) {\n            width = tree._gridSettings.indent;\n        } else {\n            // create a new div on the DOM but not visible on the page\n            div = $(\"<div></div>\");\n            i = node.prev(\"i\");\n            li = i.parent();\n            // add to that div all of the classes on the tree root\n            div.addClass(tree.get_node(\"#\",true).attr(\"class\"));\n\n            // move the li to the temporary div root\n            li.appendTo(div);\n\n            // attach to the body quickly\n            div.appendTo($(\"body\"));\n\n            // get the width\n            width = i.width() || LEVELINDENT;\n\n            // detach the li from the new div and destroy the new div\n            li.detach();\n            div.remove();\n\n            // save it for the future\n            tree._gridSettings.indent = width;\n        }\n\n\n        return(width);\n\n    };\n\n    findLastClosedNode = function (tree,id) {\n        // first get our node\n        var ret, node = tree.get_node(id), children = node.children;\n        // is it closed?\n        if (!children || children.length <= 0 || !node.state.opened) {\n            ret = id;\n        } else {\n            ret = findLastClosedNode(tree,children[children.length-1]);\n        }\n        return(ret);\n    };\n\n    renderAWidth = function(node,tree) {\n        var depth, width,\n        fullWidth = parseInt(tree.settings.grid.columns[0].width,10) + parseInt(tree._gridSettings.treeWidthDiff,10);\n        // need to use a selector in jquery 1.4.4+\n        depth = tree.get_node(node).parents.length;\n        width = fullWidth - depth*getIndent(node,tree);\n        // the following line is no longer needed, since we are doing this inside a <td>\n        //a.css({\"vertical-align\": \"top\", \"overflow\":\"hidden\"});\n        return(fullWidth);\n    };\n    renderATitle = function(node,t,tree) {\n        var a = node.get(0).tagName.toLowerCase() === \"a\" ? node : node.children(\"a\"), title, col = tree.settings.grid.columns[0];\n        // get the title\n        title = \"\";\n        if (col.title) {\n            if (col.title === SPECIAL_TITLE) {\n                title = tree.get_text(t);\n            } else if (t.attr(col.title)) {\n                title = t.attr(col.title);\n            }\n        }\n        // strip out HTML\n        title = title.replace(htmlstripre, '');\n        if (title) {\n            a.attr(\"title\",title);\n        }\n    };\n\n    $.jstree.defaults.grid = {\n        width: 'auto'\n    };\n\n    $.jstree.plugins.grid = function(options,parent) {\n        this._initialize = function () {\n            if (!this._initialized) {\n                var s = this.settings.grid || {}, styles,    container = this.element, gridparent = container.parent(), i,\n                gs = this._gridSettings = {\n                    columns : s.columns || [],\n                    treeClass : \"jstree-grid-col-0\",\n                    context: s.contextmenu || false,\n                    columnWidth : s.columnWidth,\n                    defaultConf : {\"*display\":\"inline\",\"*+display\":\"inline\"},\n                    isThemeroller : !!this._data.themeroller,\n                    treeWidthDiff : 0,\n                    resizable : s.resizable,\n                    indent: 0\n                }, cols = gs.columns, treecol = 0;\n                // find which column our tree shuld go in\n                for (i=0;i<s.columns.length;i++) {\n                    if (s.columns[i].tree) {\n                        // save which column it was\n                        treecol = i;\n                        // do not check any others\n                        break;\n                    }\n                }\n                // set a unique ID for this table\n                this.uniq = Math.ceil(Math.random()*1000);\n                this.treecol = treecol;\n                this.rootid = container.attr(\"id\");\n\n                var msie = /msie/.test(navigator.userAgent.toLowerCase());\n                if (msie) {\n                    var version = parseFloat(navigator.appVersion.split(\"MSIE\")[1]);\n                    if (version < 8) {\n                        gs.defaultConf.display = \"inline\";\n                        gs.defaultConf.zoom = \"1\";\n                    }\n                }\n\n                // set up the classes we need\n                if (!styled) {\n                    styled = true;\n                    styles = [\n                        '.jstree-grid-cell {vertical-align: top; overflow:hidden;margin-left:0;position:relative;width: 100%;padding-left:7px;white-space: nowrap;}',\n                        '.jstree-grid-cell span {margin-right:0px;margin-right:0px;*display:inline;*+display:inline;white-space: nowrap;}',\n                        '.jstree-grid-separator {position:relative; height:24px; float:right;margin-left: -2px; border-width: 0 2px 0 0; *display:inline; *+display:inline; margin-right:0px;width:0px;}',\n              '.jstree-grid-header-cell {overflow: hidden; white-space: nowrap;padding: 1px 3px 2px 5px;}',\n                        '.jstree-grid-header-themeroller {border: 0; padding: 1px 3px;}',\n                        '.jstree-grid-header-regular {background-color: #EBF3FD;}',\n                        '.jstree-grid-resizable-separator {cursor: col-resize; width: 2px;}',\n                        '.jstree-grid-separator-regular {border-color: #d0d0d0; border-style: solid;}',\n                        '.jstree-grid-cell-themeroller {border: none !important; background: transparent !important;}',\n                        '.jstree-grid-wrapper {width: 100%; overflow-x: auto;}',\n                        '.jstree-grid-midwrapper {display: table-row; overflow: visible;}',\n                        '.jstree-grid-width-auto {width:auto;display:block;}',\n                        '.jstree-grid-column {display: table-cell; overflow: hidden;}',\n                        '.jstree-grid-col-0 {width: 100%;}'\n                    ];\n\n                    $('<style type=\"text/css\">'+styles.join(\"\\n\")+'</style>').appendTo(\"head\");\n                }\n                this.gridWrapper = $(\"<div></div>\").addClass(\"jstree-grid-wrapper\").appendTo(gridparent);\n                this.midWrapper = $(\"<div></div>\").addClass(\"jstree-grid-midwrapper\").appendTo(this.gridWrapper);\n                // set the wrapper width\n                if (s.width) {\n                    this.gridWrapper.width(s.width);\n                }\n                // create the data columns\n                for (i=0;i<cols.length;i++) {\n                    // create the column\n                    $(\"<div></div>\").addClass(\"jstree-grid-column jstree-grid-column-\"+i+\" jstree-grid-column-root-\"+this.rootid).appendTo(this.midWrapper);\n                }\n                this.midWrapper.children(\"div:eq(\"+treecol+\")\").append(container);\n                container.addClass(\"jstree-grid-cell\");\n\n                this._initialized = true;\n            }\n        };\n        this.init = function (el,options) {\n            parent.init.call(this,el,options);\n            this._initialize();\n        };\n        this.bind = function () {\n            parent.bind.call(this);\n            this._initialize();\n            this.element\n            .on(\"move_node.jstree create_node.jstree clean_node.jstree change_node.jstree\", $.proxy(function (e, data) {\n                var target = this.get_node(data || \"#\",true);\n                this._prepare_grid(target);\n            }, this))\n            .on(\"delete_node.jstree\",$.proxy(function (e,data) {\n                if (data.node.id !== undefined) {\n                    var grid = this.gridWrapper, removeNodes = [data.node.id], i;\n                    // add children to remove list\n                    if (data.node && data.node.children_d) {\n                        removeNodes = removeNodes.concat(data.node.children_d);\n                    }\n                    for (i=0;i<removeNodes.length;i++) {\n                        findDataCell(grid,removeNodes[i]).remove();\n                    }\n                }\n            }, this))\n            .on(\"close_node.jstree\",$.proxy(function (e,data) {\n                this._hide_grid(data.node);\n            }, this))\n            .on(\"open_node.jstree\",$.proxy(function (e,data) {\n            }, this))\n            .on(\"load_node.jstree\",$.proxy(function (e,data) {\n            }, this))\n            .on(\"loaded.jstree\", $.proxy(function (e) {\n                this._prepare_headers();\n                this.element.trigger(\"loaded_grid.jstree\");\n                }, this))\n            .on(\"ready.jstree\",$.proxy(function (e,data) {\n                // find the line-height of the first known node\n                var anchorHeight = this.element.find(\"li a:first\").outerHeight();\n                $('<style type=\"text/css\">div.jstree-grid-cell-root-'+this.rootid+' {line-height: '+anchorHeight+'px}</style>').appendTo(\"head\");\n\n                // add container classes to the wrapper\n                this.gridWrapper.addClass(this.element.attr(\"class\"));\n\n            },this))\n            .on(\"move_node.jstree\",$.proxy(function(e,data){\n                var node = data.new_instance.element;\n                //renderAWidth(node,this);\n                // check all the children, because we could drag a tree over\n                node.find(\"li > a\").each($.proxy(function(i,elm){\n                    //renderAWidth($(elm),this);\n                },this));\n\n            },this))\n            .on(\"hover_node.jstree\",$.proxy(function(node,selected,event){\n                var id = selected.node.id;\n                if (this._hover_node !== null && this._hover_node !== undefined) {\n                    findDataCell(this.gridWrapper,this._hover_node).removeClass(\"jstree-hovered\");\n                }\n                this._hover_node = id;\n                findDataCell(this.gridWrapper,id).addClass(\"jstree-hovered\");\n            },this))\n            .on(\"dehover_node.jstree\",$.proxy(function(node,selected,event){\n                var id = selected.node.id;\n                this._hover_node = null;\n                findDataCell(this.gridWrapper,id).removeClass(\"jstree-hovered\");\n            },this))\n            .on(\"select_node.jstree\",$.proxy(function(node,selected,event){\n                var id = selected.node.id;\n                findDataCell(this.gridWrapper,id).addClass(\"jstree-clicked\");\n                this.get_node(selected.node.id,true).children(\"div.jstree-grid-cell\").addClass(\"jstree-clicked\");\n            },this))\n            .on(\"deselect_node.jstree\",$.proxy(function(node,selected,event){\n                var id = selected.node.id;\n                findDataCell(this.gridWrapper,id).removeClass(\"jstree-hovered\");\n            },this))\n            .on(\"deselect_all.jstree\",$.proxy(function(node,selected,event){\n                // get all of the ids that were unselected\n                var ids = selected.node || [], i;\n                for (i=0;i<ids.length;i++) {\n                    findDataCell(this.gridWrapper,ids[i]).removeClass(\"jstree-clicked\");\n                }\n            },this))\n            .on(\"search.jstree\", $.proxy(function (e, data) {\n                // search sometimes filters, so we need to hide all of the appropriate grid cells as well, and show only the matches\n                var grid = this.gridWrapper;\n                if(this._data.search.som) {\n                    if(data.nodes.length) {\n                        // hide all of the grid cells\n                        grid.find('div.jstree-grid-cell:not(:first)').hide();\n                        // show only those that match\n                        data.nodes.add(data.nodes.parentsUntil(\".jstree\")).filter(\".jstree-node\").each(function (i,node) {\n                            var id = node.id;\n                            if (id) {\n                                findDataCell(grid,id).show();\n                            }\n                        });\n                    }\n                }\n                return true;\n            }, this))\n            .on(\"clear_search.jstree\", $.proxy(function (e, data) {\n                // search has been cleared, so we need to show all rows\n                this.gridWrapper.find('div.jstree-grid-cell').show();\n                return true;\n            }, this))\n            ;\n            if (this._gridSettings.isThemeroller) {\n                this.element\n                    .on(\"select_node.jstree\",$.proxy(function(e,data){\n                        data.rslt.obj.children(\"a\").nextAll(\"div\").addClass(\"ui-state-active\");\n                    },this))\n                    .on(\"deselect_node.jstree deselect_all.jstree\",$.proxy(function(e,data){\n                        data.rslt.obj.children(\"a\").nextAll(\"div\").removeClass(\"ui-state-active\");\n                    },this))\n                    .on(\"hover_node.jstree\",$.proxy(function(e,data){\n                        data.rslt.obj.children(\"a\").nextAll(\"div\").addClass(\"ui-state-hover\");\n                    },this))\n                    .on(\"dehover_node.jstree\",$.proxy(function(e,data){\n                        data.rslt.obj.children(\"a\").nextAll(\"div\").removeClass(\"ui-state-hover\");\n                    },this));\n            }\n        };\n        // tear down the tree entirely\n        this.teardown = function() {\n            var gw = this.gridWrapper, container = this.element, gridparent = gw.parent();\n            container.detach();\n            gw.remove();\n            gridparent.append(container);\n            parent.teardown.call(this);\n        };\n        // clean the grid in case of redraw or refresh entire tree\n        this._clean_grid = function (target,id) {\n            var grid = this.gridWrapper;\n            if (target) {\n                findDataCell(grid,id).remove();\n            } else {\n                // get all of the `div` children in all of the `td` in dataRow except for :first (that is the tree itself) and remove\n                grid.find(\"div.jstree-grid-cell:not(:first)\").remove();\n            }\n        };\n        // prepare the headers\n        this._prepare_headers = function() {\n            var header, i, col, gs = this._gridSettings,cols = gs.columns || [], width, defaultWidth = gs.columnWidth, resizable = gs.resizable || false,\n            cl, ccl, val, margin, last, tr = gs.isThemeroller, classAdd = (tr?\"themeroller\":\"regular\"), puller,\n            hasHeaders = false, gridparent = this.gridparent,\n            conf = gs.defaultConf,\n            colNum = 0, borPadWidth = 0, totalWidth = 0;\n            // save the original parent so we can reparent on destroy\n            this.parent = gridparent;\n\n\n            // create the headers\n            for (i=0;i<cols.length;i++) {\n                //col = $(\"<col/>\");\n                //col.appendTo(colgroup);\n                cl = cols[i].headerClass || \"\";\n                ccl = cols[i].columnClass || \"\";\n                val = cols[i].header || \"\";\n                if (val) {hasHeaders = true;}\n                width = cols[i].width || defaultWidth;\n\n                // we only deal with borders if width is not auto and not percentages\n                borPadWidth = tr ? 1+6 : 2+8; // account for the borders and padding\n                if (width !== 'auto' && typeof(width) !== \"string\") {\n                    width -= borPadWidth;\n                }\n                margin = i === 0 ? 3 : 0;\n                col = this.midWrapper.children(\"div.jstree-grid-column-\"+i);\n                last = $(\"<div></div>\").css(conf).css({\"margin-left\": margin}).addClass(\"jstree-grid-div-\"+this.uniq+\"-\"+i+\" \"+(tr?\"ui-widget-header \":\"\")+\" jstree-grid-header jstree-grid-header-cell jstree-grid-header-\"+classAdd+\" \"+cl+\" \"+ccl).html(val);\n                last.addClass((tr?\"ui-widget-header \":\"\")+\"jstree-grid-header jstree-grid-header-\"+classAdd);\n                last.prependTo(col);\n                totalWidth += last.outerWidth();\n                puller = $(\"<div class='jstree-grid-separator jstree-grid-separator-\"+classAdd+(tr ? \" ui-widget-header\" : \"\")+(resizable? \" jstree-grid-resizable-separator\":\"\")+\"'>&nbsp;</div>\").appendTo(last);\n                col.width(width);\n                col.css(\"min-width\",width);\n                col.css(\"max-width\",width);\n            }\n\n            last.addClass((tr?\"ui-widget-header \":\"\")+\"jstree-grid-header jstree-grid-header-last jstree-grid-header-\"+classAdd);\n            // if there is no width given for the last column, do it via automatic\n            if (cols[cols.length-1].width === undefined) {\n                totalWidth -= width;\n                col.css({width:\"auto\"});\n                last.addClass(\"jstree-grid-width-auto\").next(\".jstree-grid-separator\").remove();\n            }\n            if (hasHeaders) {\n                // save the offset of the div from the body\n                //gs.divOffset = header.parent().offset().left;\n                gs.header = header;\n            } else {\n                $(\"div.jstree-grid-header\").hide();\n            }\n\n            if (!this.bound && resizable) {\n                this.bound = true;\n                $(document).mouseup(function () {\n                    var  i, ref, cols, widths, headers, w, currentTree;\n                    if (isClickedSep) {\n                        currentTree = toResize.closest(\".jstree-grid-wrapper\").find(\".jstree\");\n                        ref = $.jstree.reference(currentTree);\n                        cols = ref.settings.grid.columns;\n                        headers = toResize.parent().children(\"div.jstree-grid-column\");\n                        widths = [];\n                        if (isNaN(colNum) || colNum < 0) { ref._gridSettings.treeWidthDiff = currentTree.find(\"ins:eq(0)\").width() + currentTree.find(\"a:eq(0)\").width() - ref._gridSettings.columns[0].width; }\n                        isClickedSep = false;\n                        toResize = null;\n                        for (i=0;i<cols.length;i++) {\n                            w = parseFloat(headers[i].style.width);\n                            widths[i] = {w: w, r: i===colNum };\n                            ref._gridSettings.columns[i].width = w;\n                        }\n\n                        currentTree.trigger(\"resize_column.jstree-grid\", widths);\n                    }\n                }).mousemove(function (e) {\n                        if (isClickedSep) {\n                            newMouseX = e.pageX;\n                            var diff = newMouseX - oldMouseX,\n                            oldPrevHeaderInner,\n                            oldPrevColWidth, newPrevColWidth;\n\n                            if (diff !== 0){\n                                oldPrevHeaderInner = toResize.width();\n                                oldPrevColWidth = parseFloat(toResize.css(\"width\"));\n\n                                // handle a Chrome issue with columns set to auto\n                                // thanks to Brabus https://github.com/side-by-side\n                                if (!oldPrevColWidth) {oldPrevColWidth = toResize.innerWidth();}\n\n                                // make sure that diff cannot be beyond the left/right limits\n                                diff = diff < 0 ? Math.max(diff,-oldPrevHeaderInner) : diff;\n                                newPrevColWidth = (oldPrevColWidth+diff)+\"px\";\n\n                                // only do this if we are not shrinking past 0 on left - and limit it to that amount\n                                if (diff > 0 || oldPrevHeaderInner > 0) {\n                                    toResize.width(newPrevColWidth);\n                                    toResize.css(\"min-width\",newPrevColWidth);\n                                    toResize.css(\"max-width\",newPrevColWidth);\n                                    oldMouseX = newMouseX;\n                                }\n                            }\n                        }\n                    });\n                this.gridWrapper.on(\"selectstart\", \".jstree-grid-resizable-separator\", function () {\n                    return false;\n                }).on(\"mousedown\", \".jstree-grid-resizable-separator\", function (e) {\n                    isClickedSep = true;\n                    oldMouseX = e.pageX;\n                    toResize = $(this).closest(\"div.jstree-grid-column\");\n                    // the max rightmost position we will allow is the right-most of the wrapper minus a buffer (10)\n                    return false;\n                })\n                .on(\"dblclick\", \".jstree-grid-resizable-separator\", function (e) {\n                    var clickedSep = $(this), col = clickedSep.closest(\"div.jstree-grid-column\"),\n                    oldPrevColWidth = parseFloat(col.css(\"width\")), newWidth = 0, diff,\n                    oldPrevHeaderInner = col.width(), newPrevColWidth;\n\n\n                    //find largest width\n                    col.find(\".jstree-grid-cell\").each(function() {\n                        var item = $(this), width;\n                        item.css(\"position\", \"absolute\");\n                        item.css(\"width\", \"auto\");\n                        width = item.outerWidth();\n                        item.css(\"position\", \"relative\");\n\n                        if (width>newWidth) {\n                            newWidth = width;\n                        }\n                    });\n\n                    diff = newWidth-oldPrevColWidth;\n\n                    // make sure that diff cannot be beyond the left limits\n                    diff = diff < 0 ? Math.max(diff,-oldPrevHeaderInner) : diff;\n                    newPrevColWidth = (oldPrevColWidth+diff)+\"px\";\n\n                    col.width(newPrevColWidth);\n                    col.css(\"min-width\",newPrevColWidth);\n                    col.css(\"max-width\",newPrevColWidth);\n                });\n            }\n        };\n        /*\n         * Override redraw_node to correctly insert the grid\n         */\n        this.redraw_node = function(obj, deep, is_callback, force_render) {\n            // first allow the parent to redraw the node\n            obj = parent.redraw_node.call(this, obj, deep, is_callback, force_render);\n            // next prepare the grid\n            if(obj) {\n                this._prepare_grid(obj);\n            }\n            return obj;\n        };\n        this.refresh = function () {\n            this._clean_grid();\n            return parent.refresh.apply(this,arguments);\n        };\n        this._hide_grid = function (node) {\n            var children = node && node.children_d ? node.children_d : [], i;\n            // go through each column, remove all children with the correct ID name\n            for (i=0;i<children.length;i++) {\n                findDataCell(this.gridWrapper,children[i]).remove();\n            }\n        };\n        this.holdingCells = {};\n        this.getHoldingCells = function (obj,col,hc) {\n            var ret = $(), children = obj.children||[], child, i;\n            // run through each child, render it, and then render its children recursively\n            for (i=0;i<children.length;i++) {\n                child = GRIDCELLID_PREFIX+escapeId(children[i])+GRIDCELLID_POSTFIX+col;\n                if (hc[child] && obj.state.opened) {\n                    ret = ret.add(hc[child]).add(this.getHoldingCells(this.get_node(children[i]),col,hc));\n                    //delete hc[child];\n                }\n            }\n            return(ret);\n        };\n        /**\n         * put a grid cell in edit mode (input field to edit the data)\n         * @name edit(obj, col)\n         * @param  {mixed} obj\n         * @param  {obj} col definition\n         * @param  {element} cell element, either span or wrapping div\n         */\n        this._edit = function (obj, col, element) {\n            if(!obj) { return false; }\n            if (element) {\n                element = $(element);\n                if (element.prop(\"tagName\").toLowerCase() === \"div\") {\n                    element = element.children(\"span:first\");\n                }\n            } else {\n                // need to find the element - later\n                return false;\n            }\n            var rtl = this._data.core.rtl,\n                w  = this.element.width(),\n                t = obj.data[col.value],\n                h1 = $(\"<\"+\"div />\", { css : { \"position\" : \"absolute\", \"top\" : \"-200px\", \"left\" : (rtl ? \"0px\" : \"-1000px\"), \"visibility\" : \"hidden\" } }).appendTo(\"body\"),\n                h2 = $(\"<\"+\"input />\", {\n                        \"value\" : t,\n                        \"class\" : \"jstree-rename-input\",\n                        \"css\" : {\n                            \"padding\" : \"0\",\n                            \"border\" : \"1px solid silver\",\n                            \"box-sizing\" : \"border-box\",\n                            \"display\" : \"inline-block\",\n                            \"height\" : (this._data.core.li_height) + \"px\",\n                            \"lineHeight\" : (this._data.core.li_height) + \"px\",\n                            \"width\" : \"150px\" // will be set a bit further down\n                        },\n                        \"blur\" : $.proxy(function () {\n                            var v = h2.val();\n                            // save the value if changed\n                            if(v === \"\" || v === t) {\n                                v = t;\n                            } else {\n                                obj.data[col.value] = v;\n                                this.element.trigger('update_cell.jstree-grid',{node:obj, col:col.value, value:v, old:t});\n                                this._prepare_grid(this.get_node(obj,true));\n                            }\n                            h2.remove();\n                            element.show();\n                        }, this),\n                        \"keydown\" : function (event) {\n                            var key = event.which;\n                            if(key === 27) {\n                                this.value = t;\n                            }\n                            if(key === 27 || key === 13 || key === 37 || key === 38 || key === 39 || key === 40 || key === 32) {\n                                event.stopImmediatePropagation();\n                            }\n                            if(key === 27 || key === 13) {\n                                event.preventDefault();\n                                this.blur();\n                            }\n                        },\n                        \"click\" : function (e) { e.stopImmediatePropagation(); },\n                        \"mousedown\" : function (e) { e.stopImmediatePropagation(); },\n                        \"keyup\" : function (event) {\n                            h2.width(Math.min(h1.text(\"pW\" + this.value).width(),w));\n                        },\n                        \"keypress\" : function(event) {\n                            if(event.which === 13) { return false; }\n                        }\n                    }),\n                fn = {\n                        fontFamily        : element.css('fontFamily')        || '',\n                        fontSize        : element.css('fontSize')            || '',\n                        fontWeight        : element.css('fontWeight')        || '',\n                        fontStyle        : element.css('fontStyle')        || '',\n                        fontStretch        : element.css('fontStretch')        || '',\n                        fontVariant        : element.css('fontVariant')        || '',\n                        letterSpacing    : element.css('letterSpacing')    || '',\n                        wordSpacing        : element.css('wordSpacing')        || ''\n                };\n            element.hide();\n            element.parent().append(h2);\n            h2.css(fn).width(Math.min(h1.text(\"pW\" + h2[0].value).width(),w))[0].select();\n        };\n        this._prepare_grid = function (obj) {\n            var gs = this._gridSettings, c = gs.treeClass, _this = this, t, cols = gs.columns || [], width, tr = gs.isThemeroller,\n            tree = this.element, rootid = this.rootid,\n            classAdd = (tr?\"themeroller\":\"regular\"), img, objData = this.get_node(obj),\n            defaultWidth = gs.columnWidth, conf = gs.defaultConf, cellClickHandler = function (tree,node,val,col,t) {\n                return function(e) {\n                    //node = tree.find(\"#\"+node.attr(\"id\"));\n                    node.children(\".jstree-anchor\").trigger(\"click.jstree\",e);\n                    tree.trigger(\"select_cell.jstree-grid\", [{value: val,column: col.header,node: node,grid:$(this),sourceName: col.value}]);\n                };\n            }, cellRightClickHandler = function (tree,node,val,col,t) {\n                return function (e) {\n                    if (gs.context) {\n                        e.preventDefault();\n                        $.vakata.context.show(this,{ 'x' : e.pageX, 'y' : e.pageY },{\n                            \"edit\":{label:\"Edit\",\"action\": function (data) {\n                                var obj = t.get_node(node);\n                                _this._edit(obj,col,e.target);\n                            }}\n                        });\n                    }\n                };\n            },\n            hoverInHandler = function (node, jsTreeInstance) {\n                return function() { jsTreeInstance.hover_node(node); };\n            },\n            hoverOutHandler = function (node, jsTreeInstance) {\n                return function() { jsTreeInstance.dehover_node(node); };\n            },\n            i, val, cl, wcl, ccl, a, last, valClass, wideValClass, span, paddingleft, title, gridCellName, gridCellParentId, gridCellParent,\n            gridCellPrev, gridCellPrevId, gridCellNext, gridCellNextId, gridCellChild, gridCellChildId,\n            col, content, tmpWidth, mw = this.midWrapper, dataCell, lid = objData.id,\n            peers = this.get_node(objData.parent).children,\n            // find my position in the list of peers. \"peers\" is the list of everyone at my level under my parent, in order\n            pos = $.inArray(lid,peers),\n            hc = this.holdingCells, rendered = false, closed;\n            // get our column definition\n            t = $(obj);\n\n            // find the a children\n            a = t.children(\"a\");\n\n            if (a.length === 1) {\n                closed = !objData.state.opened;\n                gridCellName = GRIDCELLID_PREFIX+escapeId(lid)+GRIDCELLID_POSTFIX;\n                gridCellParentId = objData.parent === \"#\" ? null : objData.parent;\n                a.addClass(c);\n                //renderAWidth(a,_this);\n                renderATitle(a,t,_this);\n                last = a;\n                for (i=0;i<cols.length;i++) {\n                    if (this.treecol === i) {\n                        continue;\n                    }\n                    col = cols[i];\n                    dataCell = mw.children(\"div:eq(\"+i+\")\");\n                    // get the cellClass, the wideCellClass, and the columnClass\n                    cl = col.cellClass || \"\";\n                    wcl = col.wideCellClass || \"\";\n                    ccl = col.columnClass || \"\";\n\n                    // add a column class to the dataCell\n                    dataCell.addClass(ccl);\n\n\n                    // get the contents of the cell - value could be a string or a function\n                    if (col.value !== undefined && col.value !== null) {\n                        if (typeof(col.value) === \"function\") {\n                            val = col.value(objData);\n                        } else if (objData.data !== null && objData.data !== undefined && objData.data[col.value] !== undefined) {\n                            val = objData.data[col.value];\n                        } else {\n                            val = \"\";\n                        }\n                    } else {\n                        val = \"\";\n                    }\n\n                    if (typeof(col.format) === \"function\") {\n                        val = col.format(val);\n                    }\n\n                    // put images instead of text if needed\n                    if (col.images) {\n                    img = col.images[val] || col.images[\"default\"];\n                    if (img) {content = img[0] === \"*\" ? '<span class=\"'+img.substr(1)+'\"></span>' : '<img src=\"'+img+'\">';}\n                    } else { content = val; }\n\n                    // content cannot be blank, or it messes up heights\n                    if (content === undefined || content === null || BLANKRE.test(content)) {\n                        content = \"&nbsp;\";\n                    }\n\n                    // get the valueClass\n                    valClass = col.valueClass && objData.data !== null && objData.data !== undefined ? objData.data[col.valueClass] || \"\" : \"\";\n                    if (valClass && col.valueClassPrefix && col.valueClassPrefix !== \"\") {\n                        valClass = col.valueClassPrefix + valClass;\n                    }\n                    // get the wideValueClass\n                    wideValClass = col.wideValueClass && objData.data !== null && objData.data !== undefined ? objData.data[col.wideValueClass] || \"\" : \"\";\n                    if (wideValClass && col.wideValueClassPrefix && col.wideValueClassPrefix !== \"\") {\n                        wideValClass = col.wideValueClassPrefix + wideValClass;\n                    }\n                    // get the title\n                    title = col.title && objData.data !== null && objData.data !== undefined ? objData.data[col.title] || \"\" : \"\";\n                    // strip out HTML\n                    title = title.replace(htmlstripre, '');\n\n                    // get the width\n                    paddingleft = 7;\n                    width = col.width || defaultWidth;\n                    if (width !== 'auto') {\n                        width = tmpWidth || (width - paddingleft);\n                    }\n\n                    last = dataCell.children(\"div#\"+gridCellName+i);\n                    if (!last || last.length < 1) {\n                        last = $(\"<div></div>\");\n                        $(\"<span></span>\").appendTo(last);\n                        last.attr(\"id\",gridCellName+i);\n                        last.addClass(gridCellName);\n                        last.attr(NODE_DATA_ATTR,lid);\n\n                    }\n                    // we need to put it in the dataCell - after the parent, but the position matters\n                    // if we have no parent, then we are one of the root nodes, but still need to look at peers\n\n\n                    // if we are first, i.e. pos === 0, we go right after the parent;\n                    // if we are not first, and our previous peer (one before us) is closed, we go right after the previous peer cell\n                    // if we are not first, and our previous peer is opened, then we have to find its youngest & lowest closed child (incl. leaf)\n                    //\n                    // probably be much easier to go *before* our next one\n                    // but that one might not be drawn yet\n                    // here is the logic for jstree drawing:\n                    //   it draws peers from first to last or from last to first\n                    //   it draws children before a parent\n                    //\n                    // so I can rely on my *parent* not being drawn, but I cannot rely on my previous peer or my next peer being drawn\n\n                    // so we do the following:\n                    //   1- We are the first child: install after the parent\n                    //   2- Our previous peer is already drawn: install after the previous peer\n                    //   3- Our previous peer is not drawn, we have a child that is drawn: install right before our first child\n                    //   4- Our previous peer is not drawn, we have no child that is drawn, our next peer is drawn: install right before our next peer\n                    //   5- Our previous peer is not drawn, we have no child that is drawn, our next peer is not drawn: install right after parent\n                    gridCellPrevId = pos <=0 ? objData.parent : findLastClosedNode(this,peers[pos-1]);\n                    gridCellPrev = findDataCell(dataCell,gridCellPrevId);\n                    gridCellNextId = pos >= peers.length-1 ? \"NULL\" : peers[pos+1];\n                    gridCellNext = findDataCell(dataCell,gridCellNextId);\n                    gridCellChildId = objData.children && objData.children.length > 0 ? objData.children[0] : \"NULL\";\n                    gridCellChild = findDataCell(dataCell,gridCellChildId);\n                    gridCellParent = findDataCell(dataCell,gridCellParentId);\n\n\n                    // if our parent is already drawn, then we put this in the right order under our parent\n                    if (gridCellParentId) {\n                        if (gridCellParent && gridCellParent.length > 0) {\n                            if (gridCellPrev && gridCellPrev.length > 0) {\n                                last.insertAfter(gridCellPrev);\n                            } else if (gridCellChild && gridCellChild.length > 0) {\n                                last.insertBefore(gridCellChild);\n                            } else if (gridCellNext && gridCellNext.length > 0) {\n                                last.insertBefore(gridCellNext);\n                            } else {\n                                last.insertAfter(gridCellParent);\n                            }\n                            rendered = true;\n                        } else {\n                            rendered = false;\n                        }\n                        // always put it in the holding cells, and then sort when the parent comes in, in case parent is (re)drawn later\n                        hc[gridCellName+i] = last;\n                    } else {\n                        if (gridCellPrev && gridCellPrev.length > 0) {\n                            last.insertAfter(gridCellPrev);\n                        } else if (gridCellChild && gridCellChild.length > 0) {\n                            last.insertBefore(gridCellChild);\n                        } else if (gridCellNext && gridCellNext.length > 0) {\n                            last.insertBefore(gridCellNext);\n                        } else {\n                            last.appendTo(dataCell);\n                        }\n                        rendered = true;\n                    }\n                    // do we have any children waiting for this cell? walk down through the children/grandchildren/etc tree\n                    if (rendered) {\n                        last.after(this.getHoldingCells(objData,i,hc));\n                    }\n                    // need to make the height of this match the line height of the tree. How?\n                    span = last.children(\"span\");\n\n                    // create a span inside the div, so we can control what happens in the whole div versus inside just the text/background\n                    span.addClass(cl+\" \"+valClass).html(content);\n                    last = last.css(conf).addClass(\"jstree-grid-cell jstree-grid-cell-root-\"+rootid+\" jstree-grid-cell-\"+classAdd+\" \"+wcl+ \" \" + wideValClass + (tr?\" ui-state-default\":\"\")).addClass(\"jstree-grid-col-\"+i);\n                    // add click handler for clicking inside a grid cell\n                    last.click(cellClickHandler(tree,t,val,col,this));\n                    last.on(\"contextmenu\",cellRightClickHandler(tree,t,val,col,this));\n                    last.hover(hoverInHandler(t, this), hoverOutHandler(t, this));\n\n                    if (title) {\n                        span.attr(\"title\",title);\n                    }\n\n                }\n                last.addClass(\"jstree-grid-cell-last\"+(tr?\" ui-state-default\":\"\"));\n                // if there is no width given for the last column, do it via automatic\n                if (cols[cols.length-1].width === undefined) {\n                    last.addClass(\"jstree-grid-width-auto\").next(\".jstree-grid-separator\").remove();\n                }\n            }\n            this.element.css({'overflow-y':'auto !important'});\n        };\n        // clean up holding cells\n        this.holdingCells = {};\n\n        // need to do alternating background colors or borders\n    };\n}));\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMTk3LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vY21zL3N0YXRpYy9jbXMvanMvbGlicy9qc3RyZWUvanN0cmVlLmdyaWQubWluLmpzPzY3NzAiXSwic291cmNlc0NvbnRlbnQiOlsiLypcbiAqIGh0dHBzOi8vZ2l0aHViLmNvbS9kZWl0Y2gvanN0cmVlLWdyaWRcbiAqXG4gKiBUaGlzIHBsdWdpbiBoYW5kbGVzIGFkZGluZyBhIGdyaWQgdG8gYSB0cmVlIHRvIGRpc3BsYXkgYWRkaXRpb25hbCBkYXRhXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlOlxuICogICBodHRwOi8vd3d3Lm9wZW5zb3VyY2Uub3JnL2xpY2Vuc2VzL21pdC1saWNlbnNlLnBocFxuICpcbiAqIFdvcmtzIG9ubHkgd2l0aCBqc3RyZWUgdmVyc2lvbiA+PSAzLjAuMFxuICpcbiAqICREYXRlOiAyMDE1LTExLTI5ICRcbiAqICRSZXZpc2lvbjogIDMuNC4yICRcbiAqXG4gKiAhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhXG4gKiAhISEgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgISEhXG4gKiAhISEgICBJTVBPUlRBTlQgaXQgc2F5cyAzLjQuMiBidXQgaXQncyBhY3R1YWxseSAzLjQuNCwgYW5kIGl0J3MgbW9kaWZpZWQhICAgISEhXG4gKiAhISEgICBsaW5lIDY0Niwgc2FtZSBhczogaHR0cHM6Ly9naXRodWIuY29tL2RlaXRjaC9qc3RyZWUtZ3JpZC9wdWxsLzE2NSAgICAgISEhXG4gKiAhISEgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgISEhXG4gKiAhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhXG4gKi9cblxuLypqc2xpbnQgbm9tZW46dHJ1ZSAqL1xuLypqc2hpbnQgdW51c2VkOnZhcnMgKi9cbi8qZ2xvYmFsIG5hdmlnYXRvciwgZG9jdW1lbnQsIGpRdWVyeSwgZGVmaW5lICovXG5cbi8qIEFNRCBzdXBwb3J0IGFkZGVkIGJ5IGpvY2hlbmJlcmdlciBwZXIgaHR0cHM6Ly9naXRodWIuY29tL2RlaXRjaC9qc3RyZWUtZ3JpZC9wdWxsLzQ5XG4gKlxuICovXG4oZnVuY3Rpb24gKGZhY3RvcnkpIHtcbiAgICBpZiAodHlwZW9mIGRlZmluZSA9PT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kKSB7XG4gICAgICAgIC8vIEFNRC4gUmVnaXN0ZXIgYXMgYW4gYW5vbnltb3VzIG1vZHVsZS5cbiAgICAgICAgZGVmaW5lKFsnanF1ZXJ5JywgJ2pzdHJlZSddLCBmYWN0b3J5KTtcbiAgICB9IGVsc2Uge1xuICAgICAgICAvLyBCcm93c2VyIGdsb2JhbHNcbiAgICAgICAgZmFjdG9yeShqUXVlcnkpO1xuICAgIH1cbn0oZnVuY3Rpb24gKCQpIHtcbiAgICB2YXIgcmVuZGVyQVdpZHRoLCByZW5kZXJBVGl0bGUsIGdldEluZGVudCwgaHRtbHN0cmlwcmUsIGZpbmRMYXN0Q2xvc2VkTm9kZSwgQkxBTktSRSA9IC9eXFxzKiQvZyxcbiAgICAgICAgSURSRUdFWCA9IC9bXFxcXDomIV58KClcXFtcXF08PkAqJyt+I1wiOyw9IFxcLyR7fSVdL2csIGVzY2FwZUlkID0gZnVuY3Rpb24gKGlkKSB7XG4gICAgICAgICAgICByZXR1cm4gKGlkfHxcIlwiKS5yZXBsYWNlKElEUkVHRVgsJ1xcXFwkJicpO1xuICAgICAgICB9LCBOT0RFX0RBVEFfQVRUUiA9IFwiZGF0YS1qc3RyZWVncmlkXCIsXG4gICAgU1BFQ0lBTF9USVRMRSA9IFwiX0RBVEFfXCIsIExFVkVMSU5ERU5UID0gMjQsIHN0eWxlZCA9IGZhbHNlLCBHUklEQ0VMTElEX1BSRUZJWCA9IFwianNncmlkX1wiLEdSSURDRUxMSURfUE9TVEZJWCA9IFwiX2NvbFwiLFxuICAgICAgICBmaW5kRGF0YUNlbGwgPSBmdW5jdGlvbiAoZnJvbSxpZCkge1xuICAgICAgICAgICAgcmV0dXJuIGZyb20uZmluZChcImRpdltcIitOT0RFX0RBVEFfQVRUUitcIj0nXCIraWQrXCInXVwiKTtcbiAgICAgICAgfSxcbiAgICAgICAgaXNDbGlja2VkU2VwID0gZmFsc2UsIHRvUmVzaXplID0gbnVsbCwgb2xkTW91c2VYID0gMCwgbmV3TW91c2VYID0gMDtcblxuICAgIC8qanNsaW50IHJlZ2V4cDp0cnVlICovXG4gICAgaHRtbHN0cmlwcmUgPSAvPFxcLz9bXj5dKz4vZ2k7XG4gICAgLypqc2xpbnQgcmVnZXhwOmZhbHNlICovXG5cbiAgICBnZXRJbmRlbnQgPSBmdW5jdGlvbihub2RlLHRyZWUpIHtcbiAgICAgICAgdmFyIGRpdiwgaSwgbGksIHdpZHRoO1xuXG4gICAgICAgIC8vIGRpZCB3ZSBhbHJlYWR5IHNhdmUgaXQgZm9yIHRoaXMgdHJlZT9cbiAgICAgICAgdHJlZS5fZ3JpZFNldHRpbmdzID0gdHJlZS5fZ3JpZFNldHRpbmdzIHx8IHt9O1xuICAgICAgICBpZiAodHJlZS5fZ3JpZFNldHRpbmdzLmluZGVudCA+IDApIHtcbiAgICAgICAgICAgIHdpZHRoID0gdHJlZS5fZ3JpZFNldHRpbmdzLmluZGVudDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIC8vIGNyZWF0ZSBhIG5ldyBkaXYgb24gdGhlIERPTSBidXQgbm90IHZpc2libGUgb24gdGhlIHBhZ2VcbiAgICAgICAgICAgIGRpdiA9ICQoXCI8ZGl2PjwvZGl2PlwiKTtcbiAgICAgICAgICAgIGkgPSBub2RlLnByZXYoXCJpXCIpO1xuICAgICAgICAgICAgbGkgPSBpLnBhcmVudCgpO1xuICAgICAgICAgICAgLy8gYWRkIHRvIHRoYXQgZGl2IGFsbCBvZiB0aGUgY2xhc3NlcyBvbiB0aGUgdHJlZSByb290XG4gICAgICAgICAgICBkaXYuYWRkQ2xhc3ModHJlZS5nZXRfbm9kZShcIiNcIix0cnVlKS5hdHRyKFwiY2xhc3NcIikpO1xuXG4gICAgICAgICAgICAvLyBtb3ZlIHRoZSBsaSB0byB0aGUgdGVtcG9yYXJ5IGRpdiByb290XG4gICAgICAgICAgICBsaS5hcHBlbmRUbyhkaXYpO1xuXG4gICAgICAgICAgICAvLyBhdHRhY2ggdG8gdGhlIGJvZHkgcXVpY2tseVxuICAgICAgICAgICAgZGl2LmFwcGVuZFRvKCQoXCJib2R5XCIpKTtcblxuICAgICAgICAgICAgLy8gZ2V0IHRoZSB3aWR0aFxuICAgICAgICAgICAgd2lkdGggPSBpLndpZHRoKCkgfHwgTEVWRUxJTkRFTlQ7XG5cbiAgICAgICAgICAgIC8vIGRldGFjaCB0aGUgbGkgZnJvbSB0aGUgbmV3IGRpdiBhbmQgZGVzdHJveSB0aGUgbmV3IGRpdlxuICAgICAgICAgICAgbGkuZGV0YWNoKCk7XG4gICAgICAgICAgICBkaXYucmVtb3ZlKCk7XG5cbiAgICAgICAgICAgIC8vIHNhdmUgaXQgZm9yIHRoZSBmdXR1cmVcbiAgICAgICAgICAgIHRyZWUuX2dyaWRTZXR0aW5ncy5pbmRlbnQgPSB3aWR0aDtcbiAgICAgICAgfVxuXG5cbiAgICAgICAgcmV0dXJuKHdpZHRoKTtcblxuICAgIH07XG5cbiAgICBmaW5kTGFzdENsb3NlZE5vZGUgPSBmdW5jdGlvbiAodHJlZSxpZCkge1xuICAgICAgICAvLyBmaXJzdCBnZXQgb3VyIG5vZGVcbiAgICAgICAgdmFyIHJldCwgbm9kZSA9IHRyZWUuZ2V0X25vZGUoaWQpLCBjaGlsZHJlbiA9IG5vZGUuY2hpbGRyZW47XG4gICAgICAgIC8vIGlzIGl0IGNsb3NlZD9cbiAgICAgICAgaWYgKCFjaGlsZHJlbiB8fCBjaGlsZHJlbi5sZW5ndGggPD0gMCB8fCAhbm9kZS5zdGF0ZS5vcGVuZWQpIHtcbiAgICAgICAgICAgIHJldCA9IGlkO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0ID0gZmluZExhc3RDbG9zZWROb2RlKHRyZWUsY2hpbGRyZW5bY2hpbGRyZW4ubGVuZ3RoLTFdKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4ocmV0KTtcbiAgICB9O1xuXG4gICAgcmVuZGVyQVdpZHRoID0gZnVuY3Rpb24obm9kZSx0cmVlKSB7XG4gICAgICAgIHZhciBkZXB0aCwgd2lkdGgsXG4gICAgICAgIGZ1bGxXaWR0aCA9IHBhcnNlSW50KHRyZWUuc2V0dGluZ3MuZ3JpZC5jb2x1bW5zWzBdLndpZHRoLDEwKSArIHBhcnNlSW50KHRyZWUuX2dyaWRTZXR0aW5ncy50cmVlV2lkdGhEaWZmLDEwKTtcbiAgICAgICAgLy8gbmVlZCB0byB1c2UgYSBzZWxlY3RvciBpbiBqcXVlcnkgMS40LjQrXG4gICAgICAgIGRlcHRoID0gdHJlZS5nZXRfbm9kZShub2RlKS5wYXJlbnRzLmxlbmd0aDtcbiAgICAgICAgd2lkdGggPSBmdWxsV2lkdGggLSBkZXB0aCpnZXRJbmRlbnQobm9kZSx0cmVlKTtcbiAgICAgICAgLy8gdGhlIGZvbGxvd2luZyBsaW5lIGlzIG5vIGxvbmdlciBuZWVkZWQsIHNpbmNlIHdlIGFyZSBkb2luZyB0aGlzIGluc2lkZSBhIDx0ZD5cbiAgICAgICAgLy9hLmNzcyh7XCJ2ZXJ0aWNhbC1hbGlnblwiOiBcInRvcFwiLCBcIm92ZXJmbG93XCI6XCJoaWRkZW5cIn0pO1xuICAgICAgICByZXR1cm4oZnVsbFdpZHRoKTtcbiAgICB9O1xuICAgIHJlbmRlckFUaXRsZSA9IGZ1bmN0aW9uKG5vZGUsdCx0cmVlKSB7XG4gICAgICAgIHZhciBhID0gbm9kZS5nZXQoMCkudGFnTmFtZS50b0xvd2VyQ2FzZSgpID09PSBcImFcIiA/IG5vZGUgOiBub2RlLmNoaWxkcmVuKFwiYVwiKSwgdGl0bGUsIGNvbCA9IHRyZWUuc2V0dGluZ3MuZ3JpZC5jb2x1bW5zWzBdO1xuICAgICAgICAvLyBnZXQgdGhlIHRpdGxlXG4gICAgICAgIHRpdGxlID0gXCJcIjtcbiAgICAgICAgaWYgKGNvbC50aXRsZSkge1xuICAgICAgICAgICAgaWYgKGNvbC50aXRsZSA9PT0gU1BFQ0lBTF9USVRMRSkge1xuICAgICAgICAgICAgICAgIHRpdGxlID0gdHJlZS5nZXRfdGV4dCh0KTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAodC5hdHRyKGNvbC50aXRsZSkpIHtcbiAgICAgICAgICAgICAgICB0aXRsZSA9IHQuYXR0cihjb2wudGl0bGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIC8vIHN0cmlwIG91dCBIVE1MXG4gICAgICAgIHRpdGxlID0gdGl0bGUucmVwbGFjZShodG1sc3RyaXByZSwgJycpO1xuICAgICAgICBpZiAodGl0bGUpIHtcbiAgICAgICAgICAgIGEuYXR0cihcInRpdGxlXCIsdGl0bGUpO1xuICAgICAgICB9XG4gICAgfTtcblxuICAgICQuanN0cmVlLmRlZmF1bHRzLmdyaWQgPSB7XG4gICAgICAgIHdpZHRoOiAnYXV0bydcbiAgICB9O1xuXG4gICAgJC5qc3RyZWUucGx1Z2lucy5ncmlkID0gZnVuY3Rpb24ob3B0aW9ucyxwYXJlbnQpIHtcbiAgICAgICAgdGhpcy5faW5pdGlhbGl6ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmICghdGhpcy5faW5pdGlhbGl6ZWQpIHtcbiAgICAgICAgICAgICAgICB2YXIgcyA9IHRoaXMuc2V0dGluZ3MuZ3JpZCB8fCB7fSwgc3R5bGVzLCAgICBjb250YWluZXIgPSB0aGlzLmVsZW1lbnQsIGdyaWRwYXJlbnQgPSBjb250YWluZXIucGFyZW50KCksIGksXG4gICAgICAgICAgICAgICAgZ3MgPSB0aGlzLl9ncmlkU2V0dGluZ3MgPSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbHVtbnMgOiBzLmNvbHVtbnMgfHwgW10sXG4gICAgICAgICAgICAgICAgICAgIHRyZWVDbGFzcyA6IFwianN0cmVlLWdyaWQtY29sLTBcIixcbiAgICAgICAgICAgICAgICAgICAgY29udGV4dDogcy5jb250ZXh0bWVudSB8fCBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgY29sdW1uV2lkdGggOiBzLmNvbHVtbldpZHRoLFxuICAgICAgICAgICAgICAgICAgICBkZWZhdWx0Q29uZiA6IHtcIipkaXNwbGF5XCI6XCJpbmxpbmVcIixcIiorZGlzcGxheVwiOlwiaW5saW5lXCJ9LFxuICAgICAgICAgICAgICAgICAgICBpc1RoZW1lcm9sbGVyIDogISF0aGlzLl9kYXRhLnRoZW1lcm9sbGVyLFxuICAgICAgICAgICAgICAgICAgICB0cmVlV2lkdGhEaWZmIDogMCxcbiAgICAgICAgICAgICAgICAgICAgcmVzaXphYmxlIDogcy5yZXNpemFibGUsXG4gICAgICAgICAgICAgICAgICAgIGluZGVudDogMFxuICAgICAgICAgICAgICAgIH0sIGNvbHMgPSBncy5jb2x1bW5zLCB0cmVlY29sID0gMDtcbiAgICAgICAgICAgICAgICAvLyBmaW5kIHdoaWNoIGNvbHVtbiBvdXIgdHJlZSBzaHVsZCBnbyBpblxuICAgICAgICAgICAgICAgIGZvciAoaT0wO2k8cy5jb2x1bW5zLmxlbmd0aDtpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHMuY29sdW1uc1tpXS50cmVlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBzYXZlIHdoaWNoIGNvbHVtbiBpdCB3YXNcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyZWVjb2wgPSBpO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gZG8gbm90IGNoZWNrIGFueSBvdGhlcnNcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8vIHNldCBhIHVuaXF1ZSBJRCBmb3IgdGhpcyB0YWJsZVxuICAgICAgICAgICAgICAgIHRoaXMudW5pcSA9IE1hdGguY2VpbChNYXRoLnJhbmRvbSgpKjEwMDApO1xuICAgICAgICAgICAgICAgIHRoaXMudHJlZWNvbCA9IHRyZWVjb2w7XG4gICAgICAgICAgICAgICAgdGhpcy5yb290aWQgPSBjb250YWluZXIuYXR0cihcImlkXCIpO1xuXG4gICAgICAgICAgICAgICAgdmFyIG1zaWUgPSAvbXNpZS8udGVzdChuYXZpZ2F0b3IudXNlckFnZW50LnRvTG93ZXJDYXNlKCkpO1xuICAgICAgICAgICAgICAgIGlmIChtc2llKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciB2ZXJzaW9uID0gcGFyc2VGbG9hdChuYXZpZ2F0b3IuYXBwVmVyc2lvbi5zcGxpdChcIk1TSUVcIilbMV0pO1xuICAgICAgICAgICAgICAgICAgICBpZiAodmVyc2lvbiA8IDgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGdzLmRlZmF1bHRDb25mLmRpc3BsYXkgPSBcImlubGluZVwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgZ3MuZGVmYXVsdENvbmYuem9vbSA9IFwiMVwiO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy8gc2V0IHVwIHRoZSBjbGFzc2VzIHdlIG5lZWRcbiAgICAgICAgICAgICAgICBpZiAoIXN0eWxlZCkge1xuICAgICAgICAgICAgICAgICAgICBzdHlsZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICBzdHlsZXMgPSBbXG4gICAgICAgICAgICAgICAgICAgICAgICAnLmpzdHJlZS1ncmlkLWNlbGwge3ZlcnRpY2FsLWFsaWduOiB0b3A7IG92ZXJmbG93OmhpZGRlbjttYXJnaW4tbGVmdDowO3Bvc2l0aW9uOnJlbGF0aXZlO3dpZHRoOiAxMDAlO3BhZGRpbmctbGVmdDo3cHg7d2hpdGUtc3BhY2U6IG5vd3JhcDt9JyxcbiAgICAgICAgICAgICAgICAgICAgICAgICcuanN0cmVlLWdyaWQtY2VsbCBzcGFuIHttYXJnaW4tcmlnaHQ6MHB4O21hcmdpbi1yaWdodDowcHg7KmRpc3BsYXk6aW5saW5lOyorZGlzcGxheTppbmxpbmU7d2hpdGUtc3BhY2U6IG5vd3JhcDt9JyxcbiAgICAgICAgICAgICAgICAgICAgICAgICcuanN0cmVlLWdyaWQtc2VwYXJhdG9yIHtwb3NpdGlvbjpyZWxhdGl2ZTsgaGVpZ2h0OjI0cHg7IGZsb2F0OnJpZ2h0O21hcmdpbi1sZWZ0OiAtMnB4OyBib3JkZXItd2lkdGg6IDAgMnB4IDAgMDsgKmRpc3BsYXk6aW5saW5lOyAqK2Rpc3BsYXk6aW5saW5lOyBtYXJnaW4tcmlnaHQ6MHB4O3dpZHRoOjBweDt9JyxcbiAgICAgICAgICAgICAgJy5qc3RyZWUtZ3JpZC1oZWFkZXItY2VsbCB7b3ZlcmZsb3c6IGhpZGRlbjsgd2hpdGUtc3BhY2U6IG5vd3JhcDtwYWRkaW5nOiAxcHggM3B4IDJweCA1cHg7fScsXG4gICAgICAgICAgICAgICAgICAgICAgICAnLmpzdHJlZS1ncmlkLWhlYWRlci10aGVtZXJvbGxlciB7Ym9yZGVyOiAwOyBwYWRkaW5nOiAxcHggM3B4O30nLFxuICAgICAgICAgICAgICAgICAgICAgICAgJy5qc3RyZWUtZ3JpZC1oZWFkZXItcmVndWxhciB7YmFja2dyb3VuZC1jb2xvcjogI0VCRjNGRDt9JyxcbiAgICAgICAgICAgICAgICAgICAgICAgICcuanN0cmVlLWdyaWQtcmVzaXphYmxlLXNlcGFyYXRvciB7Y3Vyc29yOiBjb2wtcmVzaXplOyB3aWR0aDogMnB4O30nLFxuICAgICAgICAgICAgICAgICAgICAgICAgJy5qc3RyZWUtZ3JpZC1zZXBhcmF0b3ItcmVndWxhciB7Ym9yZGVyLWNvbG9yOiAjZDBkMGQwOyBib3JkZXItc3R5bGU6IHNvbGlkO30nLFxuICAgICAgICAgICAgICAgICAgICAgICAgJy5qc3RyZWUtZ3JpZC1jZWxsLXRoZW1lcm9sbGVyIHtib3JkZXI6IG5vbmUgIWltcG9ydGFudDsgYmFja2dyb3VuZDogdHJhbnNwYXJlbnQgIWltcG9ydGFudDt9JyxcbiAgICAgICAgICAgICAgICAgICAgICAgICcuanN0cmVlLWdyaWQtd3JhcHBlciB7d2lkdGg6IDEwMCU7IG92ZXJmbG93LXg6IGF1dG87fScsXG4gICAgICAgICAgICAgICAgICAgICAgICAnLmpzdHJlZS1ncmlkLW1pZHdyYXBwZXIge2Rpc3BsYXk6IHRhYmxlLXJvdzsgb3ZlcmZsb3c6IHZpc2libGU7fScsXG4gICAgICAgICAgICAgICAgICAgICAgICAnLmpzdHJlZS1ncmlkLXdpZHRoLWF1dG8ge3dpZHRoOmF1dG87ZGlzcGxheTpibG9jazt9JyxcbiAgICAgICAgICAgICAgICAgICAgICAgICcuanN0cmVlLWdyaWQtY29sdW1uIHtkaXNwbGF5OiB0YWJsZS1jZWxsOyBvdmVyZmxvdzogaGlkZGVuO30nLFxuICAgICAgICAgICAgICAgICAgICAgICAgJy5qc3RyZWUtZ3JpZC1jb2wtMCB7d2lkdGg6IDEwMCU7fSdcbiAgICAgICAgICAgICAgICAgICAgXTtcblxuICAgICAgICAgICAgICAgICAgICAkKCc8c3R5bGUgdHlwZT1cInRleHQvY3NzXCI+JytzdHlsZXMuam9pbihcIlxcblwiKSsnPC9zdHlsZT4nKS5hcHBlbmRUbyhcImhlYWRcIik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMuZ3JpZFdyYXBwZXIgPSAkKFwiPGRpdj48L2Rpdj5cIikuYWRkQ2xhc3MoXCJqc3RyZWUtZ3JpZC13cmFwcGVyXCIpLmFwcGVuZFRvKGdyaWRwYXJlbnQpO1xuICAgICAgICAgICAgICAgIHRoaXMubWlkV3JhcHBlciA9ICQoXCI8ZGl2PjwvZGl2PlwiKS5hZGRDbGFzcyhcImpzdHJlZS1ncmlkLW1pZHdyYXBwZXJcIikuYXBwZW5kVG8odGhpcy5ncmlkV3JhcHBlcik7XG4gICAgICAgICAgICAgICAgLy8gc2V0IHRoZSB3cmFwcGVyIHdpZHRoXG4gICAgICAgICAgICAgICAgaWYgKHMud2lkdGgpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5ncmlkV3JhcHBlci53aWR0aChzLndpZHRoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLy8gY3JlYXRlIHRoZSBkYXRhIGNvbHVtbnNcbiAgICAgICAgICAgICAgICBmb3IgKGk9MDtpPGNvbHMubGVuZ3RoO2krKykge1xuICAgICAgICAgICAgICAgICAgICAvLyBjcmVhdGUgdGhlIGNvbHVtblxuICAgICAgICAgICAgICAgICAgICAkKFwiPGRpdj48L2Rpdj5cIikuYWRkQ2xhc3MoXCJqc3RyZWUtZ3JpZC1jb2x1bW4ganN0cmVlLWdyaWQtY29sdW1uLVwiK2krXCIganN0cmVlLWdyaWQtY29sdW1uLXJvb3QtXCIrdGhpcy5yb290aWQpLmFwcGVuZFRvKHRoaXMubWlkV3JhcHBlcik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMubWlkV3JhcHBlci5jaGlsZHJlbihcImRpdjplcShcIit0cmVlY29sK1wiKVwiKS5hcHBlbmQoY29udGFpbmVyKTtcbiAgICAgICAgICAgICAgICBjb250YWluZXIuYWRkQ2xhc3MoXCJqc3RyZWUtZ3JpZC1jZWxsXCIpO1xuXG4gICAgICAgICAgICAgICAgdGhpcy5faW5pdGlhbGl6ZWQgPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICB0aGlzLmluaXQgPSBmdW5jdGlvbiAoZWwsb3B0aW9ucykge1xuICAgICAgICAgICAgcGFyZW50LmluaXQuY2FsbCh0aGlzLGVsLG9wdGlvbnMpO1xuICAgICAgICAgICAgdGhpcy5faW5pdGlhbGl6ZSgpO1xuICAgICAgICB9O1xuICAgICAgICB0aGlzLmJpbmQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBwYXJlbnQuYmluZC5jYWxsKHRoaXMpO1xuICAgICAgICAgICAgdGhpcy5faW5pdGlhbGl6ZSgpO1xuICAgICAgICAgICAgdGhpcy5lbGVtZW50XG4gICAgICAgICAgICAub24oXCJtb3ZlX25vZGUuanN0cmVlIGNyZWF0ZV9ub2RlLmpzdHJlZSBjbGVhbl9ub2RlLmpzdHJlZSBjaGFuZ2Vfbm9kZS5qc3RyZWVcIiwgJC5wcm94eShmdW5jdGlvbiAoZSwgZGF0YSkge1xuICAgICAgICAgICAgICAgIHZhciB0YXJnZXQgPSB0aGlzLmdldF9ub2RlKGRhdGEgfHwgXCIjXCIsdHJ1ZSk7XG4gICAgICAgICAgICAgICAgdGhpcy5fcHJlcGFyZV9ncmlkKHRhcmdldCk7XG4gICAgICAgICAgICB9LCB0aGlzKSlcbiAgICAgICAgICAgIC5vbihcImRlbGV0ZV9ub2RlLmpzdHJlZVwiLCQucHJveHkoZnVuY3Rpb24gKGUsZGF0YSkge1xuICAgICAgICAgICAgICAgIGlmIChkYXRhLm5vZGUuaWQgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgZ3JpZCA9IHRoaXMuZ3JpZFdyYXBwZXIsIHJlbW92ZU5vZGVzID0gW2RhdGEubm9kZS5pZF0sIGk7XG4gICAgICAgICAgICAgICAgICAgIC8vIGFkZCBjaGlsZHJlbiB0byByZW1vdmUgbGlzdFxuICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YS5ub2RlICYmIGRhdGEubm9kZS5jaGlsZHJlbl9kKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZW1vdmVOb2RlcyA9IHJlbW92ZU5vZGVzLmNvbmNhdChkYXRhLm5vZGUuY2hpbGRyZW5fZCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZm9yIChpPTA7aTxyZW1vdmVOb2Rlcy5sZW5ndGg7aSsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBmaW5kRGF0YUNlbGwoZ3JpZCxyZW1vdmVOb2Rlc1tpXSkucmVtb3ZlKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB0aGlzKSlcbiAgICAgICAgICAgIC5vbihcImNsb3NlX25vZGUuanN0cmVlXCIsJC5wcm94eShmdW5jdGlvbiAoZSxkYXRhKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5faGlkZV9ncmlkKGRhdGEubm9kZSk7XG4gICAgICAgICAgICB9LCB0aGlzKSlcbiAgICAgICAgICAgIC5vbihcIm9wZW5fbm9kZS5qc3RyZWVcIiwkLnByb3h5KGZ1bmN0aW9uIChlLGRhdGEpIHtcbiAgICAgICAgICAgIH0sIHRoaXMpKVxuICAgICAgICAgICAgLm9uKFwibG9hZF9ub2RlLmpzdHJlZVwiLCQucHJveHkoZnVuY3Rpb24gKGUsZGF0YSkge1xuICAgICAgICAgICAgfSwgdGhpcykpXG4gICAgICAgICAgICAub24oXCJsb2FkZWQuanN0cmVlXCIsICQucHJveHkoZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9wcmVwYXJlX2hlYWRlcnMoKTtcbiAgICAgICAgICAgICAgICB0aGlzLmVsZW1lbnQudHJpZ2dlcihcImxvYWRlZF9ncmlkLmpzdHJlZVwiKTtcbiAgICAgICAgICAgICAgICB9LCB0aGlzKSlcbiAgICAgICAgICAgIC5vbihcInJlYWR5LmpzdHJlZVwiLCQucHJveHkoZnVuY3Rpb24gKGUsZGF0YSkge1xuICAgICAgICAgICAgICAgIC8vIGZpbmQgdGhlIGxpbmUtaGVpZ2h0IG9mIHRoZSBmaXJzdCBrbm93biBub2RlXG4gICAgICAgICAgICAgICAgdmFyIGFuY2hvckhlaWdodCA9IHRoaXMuZWxlbWVudC5maW5kKFwibGkgYTpmaXJzdFwiKS5vdXRlckhlaWdodCgpO1xuICAgICAgICAgICAgICAgICQoJzxzdHlsZSB0eXBlPVwidGV4dC9jc3NcIj5kaXYuanN0cmVlLWdyaWQtY2VsbC1yb290LScrdGhpcy5yb290aWQrJyB7bGluZS1oZWlnaHQ6ICcrYW5jaG9ySGVpZ2h0KydweH08L3N0eWxlPicpLmFwcGVuZFRvKFwiaGVhZFwiKTtcblxuICAgICAgICAgICAgICAgIC8vIGFkZCBjb250YWluZXIgY2xhc3NlcyB0byB0aGUgd3JhcHBlclxuICAgICAgICAgICAgICAgIHRoaXMuZ3JpZFdyYXBwZXIuYWRkQ2xhc3ModGhpcy5lbGVtZW50LmF0dHIoXCJjbGFzc1wiKSk7XG5cbiAgICAgICAgICAgIH0sdGhpcykpXG4gICAgICAgICAgICAub24oXCJtb3ZlX25vZGUuanN0cmVlXCIsJC5wcm94eShmdW5jdGlvbihlLGRhdGEpe1xuICAgICAgICAgICAgICAgIHZhciBub2RlID0gZGF0YS5uZXdfaW5zdGFuY2UuZWxlbWVudDtcbiAgICAgICAgICAgICAgICAvL3JlbmRlckFXaWR0aChub2RlLHRoaXMpO1xuICAgICAgICAgICAgICAgIC8vIGNoZWNrIGFsbCB0aGUgY2hpbGRyZW4sIGJlY2F1c2Ugd2UgY291bGQgZHJhZyBhIHRyZWUgb3ZlclxuICAgICAgICAgICAgICAgIG5vZGUuZmluZChcImxpID4gYVwiKS5lYWNoKCQucHJveHkoZnVuY3Rpb24oaSxlbG0pe1xuICAgICAgICAgICAgICAgICAgICAvL3JlbmRlckFXaWR0aCgkKGVsbSksdGhpcyk7XG4gICAgICAgICAgICAgICAgfSx0aGlzKSk7XG5cbiAgICAgICAgICAgIH0sdGhpcykpXG4gICAgICAgICAgICAub24oXCJob3Zlcl9ub2RlLmpzdHJlZVwiLCQucHJveHkoZnVuY3Rpb24obm9kZSxzZWxlY3RlZCxldmVudCl7XG4gICAgICAgICAgICAgICAgdmFyIGlkID0gc2VsZWN0ZWQubm9kZS5pZDtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5faG92ZXJfbm9kZSAhPT0gbnVsbCAmJiB0aGlzLl9ob3Zlcl9ub2RlICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgZmluZERhdGFDZWxsKHRoaXMuZ3JpZFdyYXBwZXIsdGhpcy5faG92ZXJfbm9kZSkucmVtb3ZlQ2xhc3MoXCJqc3RyZWUtaG92ZXJlZFwiKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5faG92ZXJfbm9kZSA9IGlkO1xuICAgICAgICAgICAgICAgIGZpbmREYXRhQ2VsbCh0aGlzLmdyaWRXcmFwcGVyLGlkKS5hZGRDbGFzcyhcImpzdHJlZS1ob3ZlcmVkXCIpO1xuICAgICAgICAgICAgfSx0aGlzKSlcbiAgICAgICAgICAgIC5vbihcImRlaG92ZXJfbm9kZS5qc3RyZWVcIiwkLnByb3h5KGZ1bmN0aW9uKG5vZGUsc2VsZWN0ZWQsZXZlbnQpe1xuICAgICAgICAgICAgICAgIHZhciBpZCA9IHNlbGVjdGVkLm5vZGUuaWQ7XG4gICAgICAgICAgICAgICAgdGhpcy5faG92ZXJfbm9kZSA9IG51bGw7XG4gICAgICAgICAgICAgICAgZmluZERhdGFDZWxsKHRoaXMuZ3JpZFdyYXBwZXIsaWQpLnJlbW92ZUNsYXNzKFwianN0cmVlLWhvdmVyZWRcIik7XG4gICAgICAgICAgICB9LHRoaXMpKVxuICAgICAgICAgICAgLm9uKFwic2VsZWN0X25vZGUuanN0cmVlXCIsJC5wcm94eShmdW5jdGlvbihub2RlLHNlbGVjdGVkLGV2ZW50KXtcbiAgICAgICAgICAgICAgICB2YXIgaWQgPSBzZWxlY3RlZC5ub2RlLmlkO1xuICAgICAgICAgICAgICAgIGZpbmREYXRhQ2VsbCh0aGlzLmdyaWRXcmFwcGVyLGlkKS5hZGRDbGFzcyhcImpzdHJlZS1jbGlja2VkXCIpO1xuICAgICAgICAgICAgICAgIHRoaXMuZ2V0X25vZGUoc2VsZWN0ZWQubm9kZS5pZCx0cnVlKS5jaGlsZHJlbihcImRpdi5qc3RyZWUtZ3JpZC1jZWxsXCIpLmFkZENsYXNzKFwianN0cmVlLWNsaWNrZWRcIik7XG4gICAgICAgICAgICB9LHRoaXMpKVxuICAgICAgICAgICAgLm9uKFwiZGVzZWxlY3Rfbm9kZS5qc3RyZWVcIiwkLnByb3h5KGZ1bmN0aW9uKG5vZGUsc2VsZWN0ZWQsZXZlbnQpe1xuICAgICAgICAgICAgICAgIHZhciBpZCA9IHNlbGVjdGVkLm5vZGUuaWQ7XG4gICAgICAgICAgICAgICAgZmluZERhdGFDZWxsKHRoaXMuZ3JpZFdyYXBwZXIsaWQpLnJlbW92ZUNsYXNzKFwianN0cmVlLWhvdmVyZWRcIik7XG4gICAgICAgICAgICB9LHRoaXMpKVxuICAgICAgICAgICAgLm9uKFwiZGVzZWxlY3RfYWxsLmpzdHJlZVwiLCQucHJveHkoZnVuY3Rpb24obm9kZSxzZWxlY3RlZCxldmVudCl7XG4gICAgICAgICAgICAgICAgLy8gZ2V0IGFsbCBvZiB0aGUgaWRzIHRoYXQgd2VyZSB1bnNlbGVjdGVkXG4gICAgICAgICAgICAgICAgdmFyIGlkcyA9IHNlbGVjdGVkLm5vZGUgfHwgW10sIGk7XG4gICAgICAgICAgICAgICAgZm9yIChpPTA7aTxpZHMubGVuZ3RoO2krKykge1xuICAgICAgICAgICAgICAgICAgICBmaW5kRGF0YUNlbGwodGhpcy5ncmlkV3JhcHBlcixpZHNbaV0pLnJlbW92ZUNsYXNzKFwianN0cmVlLWNsaWNrZWRcIik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSx0aGlzKSlcbiAgICAgICAgICAgIC5vbihcInNlYXJjaC5qc3RyZWVcIiwgJC5wcm94eShmdW5jdGlvbiAoZSwgZGF0YSkge1xuICAgICAgICAgICAgICAgIC8vIHNlYXJjaCBzb21ldGltZXMgZmlsdGVycywgc28gd2UgbmVlZCB0byBoaWRlIGFsbCBvZiB0aGUgYXBwcm9wcmlhdGUgZ3JpZCBjZWxscyBhcyB3ZWxsLCBhbmQgc2hvdyBvbmx5IHRoZSBtYXRjaGVzXG4gICAgICAgICAgICAgICAgdmFyIGdyaWQgPSB0aGlzLmdyaWRXcmFwcGVyO1xuICAgICAgICAgICAgICAgIGlmKHRoaXMuX2RhdGEuc2VhcmNoLnNvbSkge1xuICAgICAgICAgICAgICAgICAgICBpZihkYXRhLm5vZGVzLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gaGlkZSBhbGwgb2YgdGhlIGdyaWQgY2VsbHNcbiAgICAgICAgICAgICAgICAgICAgICAgIGdyaWQuZmluZCgnZGl2LmpzdHJlZS1ncmlkLWNlbGw6bm90KDpmaXJzdCknKS5oaWRlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBzaG93IG9ubHkgdGhvc2UgdGhhdCBtYXRjaFxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YS5ub2Rlcy5hZGQoZGF0YS5ub2Rlcy5wYXJlbnRzVW50aWwoXCIuanN0cmVlXCIpKS5maWx0ZXIoXCIuanN0cmVlLW5vZGVcIikuZWFjaChmdW5jdGlvbiAoaSxub2RlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGlkID0gbm9kZS5pZDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmluZERhdGFDZWxsKGdyaWQsaWQpLnNob3coKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH0sIHRoaXMpKVxuICAgICAgICAgICAgLm9uKFwiY2xlYXJfc2VhcmNoLmpzdHJlZVwiLCAkLnByb3h5KGZ1bmN0aW9uIChlLCBkYXRhKSB7XG4gICAgICAgICAgICAgICAgLy8gc2VhcmNoIGhhcyBiZWVuIGNsZWFyZWQsIHNvIHdlIG5lZWQgdG8gc2hvdyBhbGwgcm93c1xuICAgICAgICAgICAgICAgIHRoaXMuZ3JpZFdyYXBwZXIuZmluZCgnZGl2LmpzdHJlZS1ncmlkLWNlbGwnKS5zaG93KCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB9LCB0aGlzKSlcbiAgICAgICAgICAgIDtcbiAgICAgICAgICAgIGlmICh0aGlzLl9ncmlkU2V0dGluZ3MuaXNUaGVtZXJvbGxlcikge1xuICAgICAgICAgICAgICAgIHRoaXMuZWxlbWVudFxuICAgICAgICAgICAgICAgICAgICAub24oXCJzZWxlY3Rfbm9kZS5qc3RyZWVcIiwkLnByb3h5KGZ1bmN0aW9uKGUsZGF0YSl7XG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhLnJzbHQub2JqLmNoaWxkcmVuKFwiYVwiKS5uZXh0QWxsKFwiZGl2XCIpLmFkZENsYXNzKFwidWktc3RhdGUtYWN0aXZlXCIpO1xuICAgICAgICAgICAgICAgICAgICB9LHRoaXMpKVxuICAgICAgICAgICAgICAgICAgICAub24oXCJkZXNlbGVjdF9ub2RlLmpzdHJlZSBkZXNlbGVjdF9hbGwuanN0cmVlXCIsJC5wcm94eShmdW5jdGlvbihlLGRhdGEpe1xuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YS5yc2x0Lm9iai5jaGlsZHJlbihcImFcIikubmV4dEFsbChcImRpdlwiKS5yZW1vdmVDbGFzcyhcInVpLXN0YXRlLWFjdGl2ZVwiKTtcbiAgICAgICAgICAgICAgICAgICAgfSx0aGlzKSlcbiAgICAgICAgICAgICAgICAgICAgLm9uKFwiaG92ZXJfbm9kZS5qc3RyZWVcIiwkLnByb3h5KGZ1bmN0aW9uKGUsZGF0YSl7XG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhLnJzbHQub2JqLmNoaWxkcmVuKFwiYVwiKS5uZXh0QWxsKFwiZGl2XCIpLmFkZENsYXNzKFwidWktc3RhdGUtaG92ZXJcIik7XG4gICAgICAgICAgICAgICAgICAgIH0sdGhpcykpXG4gICAgICAgICAgICAgICAgICAgIC5vbihcImRlaG92ZXJfbm9kZS5qc3RyZWVcIiwkLnByb3h5KGZ1bmN0aW9uKGUsZGF0YSl7XG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhLnJzbHQub2JqLmNoaWxkcmVuKFwiYVwiKS5uZXh0QWxsKFwiZGl2XCIpLnJlbW92ZUNsYXNzKFwidWktc3RhdGUtaG92ZXJcIik7XG4gICAgICAgICAgICAgICAgICAgIH0sdGhpcykpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICAvLyB0ZWFyIGRvd24gdGhlIHRyZWUgZW50aXJlbHlcbiAgICAgICAgdGhpcy50ZWFyZG93biA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdmFyIGd3ID0gdGhpcy5ncmlkV3JhcHBlciwgY29udGFpbmVyID0gdGhpcy5lbGVtZW50LCBncmlkcGFyZW50ID0gZ3cucGFyZW50KCk7XG4gICAgICAgICAgICBjb250YWluZXIuZGV0YWNoKCk7XG4gICAgICAgICAgICBndy5yZW1vdmUoKTtcbiAgICAgICAgICAgIGdyaWRwYXJlbnQuYXBwZW5kKGNvbnRhaW5lcik7XG4gICAgICAgICAgICBwYXJlbnQudGVhcmRvd24uY2FsbCh0aGlzKTtcbiAgICAgICAgfTtcbiAgICAgICAgLy8gY2xlYW4gdGhlIGdyaWQgaW4gY2FzZSBvZiByZWRyYXcgb3IgcmVmcmVzaCBlbnRpcmUgdHJlZVxuICAgICAgICB0aGlzLl9jbGVhbl9ncmlkID0gZnVuY3Rpb24gKHRhcmdldCxpZCkge1xuICAgICAgICAgICAgdmFyIGdyaWQgPSB0aGlzLmdyaWRXcmFwcGVyO1xuICAgICAgICAgICAgaWYgKHRhcmdldCkge1xuICAgICAgICAgICAgICAgIGZpbmREYXRhQ2VsbChncmlkLGlkKS5yZW1vdmUoKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgLy8gZ2V0IGFsbCBvZiB0aGUgYGRpdmAgY2hpbGRyZW4gaW4gYWxsIG9mIHRoZSBgdGRgIGluIGRhdGFSb3cgZXhjZXB0IGZvciA6Zmlyc3QgKHRoYXQgaXMgdGhlIHRyZWUgaXRzZWxmKSBhbmQgcmVtb3ZlXG4gICAgICAgICAgICAgICAgZ3JpZC5maW5kKFwiZGl2LmpzdHJlZS1ncmlkLWNlbGw6bm90KDpmaXJzdClcIikucmVtb3ZlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIC8vIHByZXBhcmUgdGhlIGhlYWRlcnNcbiAgICAgICAgdGhpcy5fcHJlcGFyZV9oZWFkZXJzID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB2YXIgaGVhZGVyLCBpLCBjb2wsIGdzID0gdGhpcy5fZ3JpZFNldHRpbmdzLGNvbHMgPSBncy5jb2x1bW5zIHx8IFtdLCB3aWR0aCwgZGVmYXVsdFdpZHRoID0gZ3MuY29sdW1uV2lkdGgsIHJlc2l6YWJsZSA9IGdzLnJlc2l6YWJsZSB8fCBmYWxzZSxcbiAgICAgICAgICAgIGNsLCBjY2wsIHZhbCwgbWFyZ2luLCBsYXN0LCB0ciA9IGdzLmlzVGhlbWVyb2xsZXIsIGNsYXNzQWRkID0gKHRyP1widGhlbWVyb2xsZXJcIjpcInJlZ3VsYXJcIiksIHB1bGxlcixcbiAgICAgICAgICAgIGhhc0hlYWRlcnMgPSBmYWxzZSwgZ3JpZHBhcmVudCA9IHRoaXMuZ3JpZHBhcmVudCxcbiAgICAgICAgICAgIGNvbmYgPSBncy5kZWZhdWx0Q29uZixcbiAgICAgICAgICAgIGNvbE51bSA9IDAsIGJvclBhZFdpZHRoID0gMCwgdG90YWxXaWR0aCA9IDA7XG4gICAgICAgICAgICAvLyBzYXZlIHRoZSBvcmlnaW5hbCBwYXJlbnQgc28gd2UgY2FuIHJlcGFyZW50IG9uIGRlc3Ryb3lcbiAgICAgICAgICAgIHRoaXMucGFyZW50ID0gZ3JpZHBhcmVudDtcblxuXG4gICAgICAgICAgICAvLyBjcmVhdGUgdGhlIGhlYWRlcnNcbiAgICAgICAgICAgIGZvciAoaT0wO2k8Y29scy5sZW5ndGg7aSsrKSB7XG4gICAgICAgICAgICAgICAgLy9jb2wgPSAkKFwiPGNvbC8+XCIpO1xuICAgICAgICAgICAgICAgIC8vY29sLmFwcGVuZFRvKGNvbGdyb3VwKTtcbiAgICAgICAgICAgICAgICBjbCA9IGNvbHNbaV0uaGVhZGVyQ2xhc3MgfHwgXCJcIjtcbiAgICAgICAgICAgICAgICBjY2wgPSBjb2xzW2ldLmNvbHVtbkNsYXNzIHx8IFwiXCI7XG4gICAgICAgICAgICAgICAgdmFsID0gY29sc1tpXS5oZWFkZXIgfHwgXCJcIjtcbiAgICAgICAgICAgICAgICBpZiAodmFsKSB7aGFzSGVhZGVycyA9IHRydWU7fVxuICAgICAgICAgICAgICAgIHdpZHRoID0gY29sc1tpXS53aWR0aCB8fCBkZWZhdWx0V2lkdGg7XG5cbiAgICAgICAgICAgICAgICAvLyB3ZSBvbmx5IGRlYWwgd2l0aCBib3JkZXJzIGlmIHdpZHRoIGlzIG5vdCBhdXRvIGFuZCBub3QgcGVyY2VudGFnZXNcbiAgICAgICAgICAgICAgICBib3JQYWRXaWR0aCA9IHRyID8gMSs2IDogMis4OyAvLyBhY2NvdW50IGZvciB0aGUgYm9yZGVycyBhbmQgcGFkZGluZ1xuICAgICAgICAgICAgICAgIGlmICh3aWR0aCAhPT0gJ2F1dG8nICYmIHR5cGVvZih3aWR0aCkgIT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgd2lkdGggLT0gYm9yUGFkV2lkdGg7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIG1hcmdpbiA9IGkgPT09IDAgPyAzIDogMDtcbiAgICAgICAgICAgICAgICBjb2wgPSB0aGlzLm1pZFdyYXBwZXIuY2hpbGRyZW4oXCJkaXYuanN0cmVlLWdyaWQtY29sdW1uLVwiK2kpO1xuICAgICAgICAgICAgICAgIGxhc3QgPSAkKFwiPGRpdj48L2Rpdj5cIikuY3NzKGNvbmYpLmNzcyh7XCJtYXJnaW4tbGVmdFwiOiBtYXJnaW59KS5hZGRDbGFzcyhcImpzdHJlZS1ncmlkLWRpdi1cIit0aGlzLnVuaXErXCItXCIraStcIiBcIisodHI/XCJ1aS13aWRnZXQtaGVhZGVyIFwiOlwiXCIpK1wiIGpzdHJlZS1ncmlkLWhlYWRlciBqc3RyZWUtZ3JpZC1oZWFkZXItY2VsbCBqc3RyZWUtZ3JpZC1oZWFkZXItXCIrY2xhc3NBZGQrXCIgXCIrY2wrXCIgXCIrY2NsKS5odG1sKHZhbCk7XG4gICAgICAgICAgICAgICAgbGFzdC5hZGRDbGFzcygodHI/XCJ1aS13aWRnZXQtaGVhZGVyIFwiOlwiXCIpK1wianN0cmVlLWdyaWQtaGVhZGVyIGpzdHJlZS1ncmlkLWhlYWRlci1cIitjbGFzc0FkZCk7XG4gICAgICAgICAgICAgICAgbGFzdC5wcmVwZW5kVG8oY29sKTtcbiAgICAgICAgICAgICAgICB0b3RhbFdpZHRoICs9IGxhc3Qub3V0ZXJXaWR0aCgpO1xuICAgICAgICAgICAgICAgIHB1bGxlciA9ICQoXCI8ZGl2IGNsYXNzPSdqc3RyZWUtZ3JpZC1zZXBhcmF0b3IganN0cmVlLWdyaWQtc2VwYXJhdG9yLVwiK2NsYXNzQWRkKyh0ciA/IFwiIHVpLXdpZGdldC1oZWFkZXJcIiA6IFwiXCIpKyhyZXNpemFibGU/IFwiIGpzdHJlZS1ncmlkLXJlc2l6YWJsZS1zZXBhcmF0b3JcIjpcIlwiKStcIic+Jm5ic3A7PC9kaXY+XCIpLmFwcGVuZFRvKGxhc3QpO1xuICAgICAgICAgICAgICAgIGNvbC53aWR0aCh3aWR0aCk7XG4gICAgICAgICAgICAgICAgY29sLmNzcyhcIm1pbi13aWR0aFwiLHdpZHRoKTtcbiAgICAgICAgICAgICAgICBjb2wuY3NzKFwibWF4LXdpZHRoXCIsd2lkdGgpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBsYXN0LmFkZENsYXNzKCh0cj9cInVpLXdpZGdldC1oZWFkZXIgXCI6XCJcIikrXCJqc3RyZWUtZ3JpZC1oZWFkZXIganN0cmVlLWdyaWQtaGVhZGVyLWxhc3QganN0cmVlLWdyaWQtaGVhZGVyLVwiK2NsYXNzQWRkKTtcbiAgICAgICAgICAgIC8vIGlmIHRoZXJlIGlzIG5vIHdpZHRoIGdpdmVuIGZvciB0aGUgbGFzdCBjb2x1bW4sIGRvIGl0IHZpYSBhdXRvbWF0aWNcbiAgICAgICAgICAgIGlmIChjb2xzW2NvbHMubGVuZ3RoLTFdLndpZHRoID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICB0b3RhbFdpZHRoIC09IHdpZHRoO1xuICAgICAgICAgICAgICAgIGNvbC5jc3Moe3dpZHRoOlwiYXV0b1wifSk7XG4gICAgICAgICAgICAgICAgbGFzdC5hZGRDbGFzcyhcImpzdHJlZS1ncmlkLXdpZHRoLWF1dG9cIikubmV4dChcIi5qc3RyZWUtZ3JpZC1zZXBhcmF0b3JcIikucmVtb3ZlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoaGFzSGVhZGVycykge1xuICAgICAgICAgICAgICAgIC8vIHNhdmUgdGhlIG9mZnNldCBvZiB0aGUgZGl2IGZyb20gdGhlIGJvZHlcbiAgICAgICAgICAgICAgICAvL2dzLmRpdk9mZnNldCA9IGhlYWRlci5wYXJlbnQoKS5vZmZzZXQoKS5sZWZ0O1xuICAgICAgICAgICAgICAgIGdzLmhlYWRlciA9IGhlYWRlcjtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgJChcImRpdi5qc3RyZWUtZ3JpZC1oZWFkZXJcIikuaGlkZSgpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoIXRoaXMuYm91bmQgJiYgcmVzaXphYmxlKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5ib3VuZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgJChkb2N1bWVudCkubW91c2V1cChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciAgaSwgcmVmLCBjb2xzLCB3aWR0aHMsIGhlYWRlcnMsIHcsIGN1cnJlbnRUcmVlO1xuICAgICAgICAgICAgICAgICAgICBpZiAoaXNDbGlja2VkU2VwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50VHJlZSA9IHRvUmVzaXplLmNsb3Nlc3QoXCIuanN0cmVlLWdyaWQtd3JhcHBlclwiKS5maW5kKFwiLmpzdHJlZVwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlZiA9ICQuanN0cmVlLnJlZmVyZW5jZShjdXJyZW50VHJlZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb2xzID0gcmVmLnNldHRpbmdzLmdyaWQuY29sdW1ucztcbiAgICAgICAgICAgICAgICAgICAgICAgIGhlYWRlcnMgPSB0b1Jlc2l6ZS5wYXJlbnQoKS5jaGlsZHJlbihcImRpdi5qc3RyZWUtZ3JpZC1jb2x1bW5cIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB3aWR0aHMgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpc05hTihjb2xOdW0pIHx8IGNvbE51bSA8IDApIHsgcmVmLl9ncmlkU2V0dGluZ3MudHJlZVdpZHRoRGlmZiA9IGN1cnJlbnRUcmVlLmZpbmQoXCJpbnM6ZXEoMClcIikud2lkdGgoKSArIGN1cnJlbnRUcmVlLmZpbmQoXCJhOmVxKDApXCIpLndpZHRoKCkgLSByZWYuX2dyaWRTZXR0aW5ncy5jb2x1bW5zWzBdLndpZHRoOyB9XG4gICAgICAgICAgICAgICAgICAgICAgICBpc0NsaWNrZWRTZXAgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRvUmVzaXplID0gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoaT0wO2k8Y29scy5sZW5ndGg7aSsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdyA9IHBhcnNlRmxvYXQoaGVhZGVyc1tpXS5zdHlsZS53aWR0aCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGhzW2ldID0ge3c6IHcsIHI6IGk9PT1jb2xOdW0gfTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWYuX2dyaWRTZXR0aW5ncy5jb2x1bW5zW2ldLndpZHRoID0gdztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudFRyZWUudHJpZ2dlcihcInJlc2l6ZV9jb2x1bW4uanN0cmVlLWdyaWRcIiwgd2lkdGhzKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pLm1vdXNlbW92ZShmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGlzQ2xpY2tlZFNlcCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ld01vdXNlWCA9IGUucGFnZVg7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGRpZmYgPSBuZXdNb3VzZVggLSBvbGRNb3VzZVgsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb2xkUHJldkhlYWRlcklubmVyLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9sZFByZXZDb2xXaWR0aCwgbmV3UHJldkNvbFdpZHRoO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRpZmYgIT09IDApe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbGRQcmV2SGVhZGVySW5uZXIgPSB0b1Jlc2l6ZS53aWR0aCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbGRQcmV2Q29sV2lkdGggPSBwYXJzZUZsb2F0KHRvUmVzaXplLmNzcyhcIndpZHRoXCIpKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBoYW5kbGUgYSBDaHJvbWUgaXNzdWUgd2l0aCBjb2x1bW5zIHNldCB0byBhdXRvXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRoYW5rcyB0byBCcmFidXMgaHR0cHM6Ly9naXRodWIuY29tL3NpZGUtYnktc2lkZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIW9sZFByZXZDb2xXaWR0aCkge29sZFByZXZDb2xXaWR0aCA9IHRvUmVzaXplLmlubmVyV2lkdGgoKTt9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gbWFrZSBzdXJlIHRoYXQgZGlmZiBjYW5ub3QgYmUgYmV5b25kIHRoZSBsZWZ0L3JpZ2h0IGxpbWl0c1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkaWZmID0gZGlmZiA8IDAgPyBNYXRoLm1heChkaWZmLC1vbGRQcmV2SGVhZGVySW5uZXIpIDogZGlmZjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3UHJldkNvbFdpZHRoID0gKG9sZFByZXZDb2xXaWR0aCtkaWZmKStcInB4XCI7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gb25seSBkbyB0aGlzIGlmIHdlIGFyZSBub3Qgc2hyaW5raW5nIHBhc3QgMCBvbiBsZWZ0IC0gYW5kIGxpbWl0IGl0IHRvIHRoYXQgYW1vdW50XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkaWZmID4gMCB8fCBvbGRQcmV2SGVhZGVySW5uZXIgPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b1Jlc2l6ZS53aWR0aChuZXdQcmV2Q29sV2lkdGgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9SZXNpemUuY3NzKFwibWluLXdpZHRoXCIsbmV3UHJldkNvbFdpZHRoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvUmVzaXplLmNzcyhcIm1heC13aWR0aFwiLG5ld1ByZXZDb2xXaWR0aCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbGRNb3VzZVggPSBuZXdNb3VzZVg7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHRoaXMuZ3JpZFdyYXBwZXIub24oXCJzZWxlY3RzdGFydFwiLCBcIi5qc3RyZWUtZ3JpZC1yZXNpemFibGUtc2VwYXJhdG9yXCIsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgIH0pLm9uKFwibW91c2Vkb3duXCIsIFwiLmpzdHJlZS1ncmlkLXJlc2l6YWJsZS1zZXBhcmF0b3JcIiwgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgICAgICAgICAgaXNDbGlja2VkU2VwID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgb2xkTW91c2VYID0gZS5wYWdlWDtcbiAgICAgICAgICAgICAgICAgICAgdG9SZXNpemUgPSAkKHRoaXMpLmNsb3Nlc3QoXCJkaXYuanN0cmVlLWdyaWQtY29sdW1uXCIpO1xuICAgICAgICAgICAgICAgICAgICAvLyB0aGUgbWF4IHJpZ2h0bW9zdCBwb3NpdGlvbiB3ZSB3aWxsIGFsbG93IGlzIHRoZSByaWdodC1tb3N0IG9mIHRoZSB3cmFwcGVyIG1pbnVzIGEgYnVmZmVyICgxMClcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgLm9uKFwiZGJsY2xpY2tcIiwgXCIuanN0cmVlLWdyaWQtcmVzaXphYmxlLXNlcGFyYXRvclwiLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgY2xpY2tlZFNlcCA9ICQodGhpcyksIGNvbCA9IGNsaWNrZWRTZXAuY2xvc2VzdChcImRpdi5qc3RyZWUtZ3JpZC1jb2x1bW5cIiksXG4gICAgICAgICAgICAgICAgICAgIG9sZFByZXZDb2xXaWR0aCA9IHBhcnNlRmxvYXQoY29sLmNzcyhcIndpZHRoXCIpKSwgbmV3V2lkdGggPSAwLCBkaWZmLFxuICAgICAgICAgICAgICAgICAgICBvbGRQcmV2SGVhZGVySW5uZXIgPSBjb2wud2lkdGgoKSwgbmV3UHJldkNvbFdpZHRoO1xuXG5cbiAgICAgICAgICAgICAgICAgICAgLy9maW5kIGxhcmdlc3Qgd2lkdGhcbiAgICAgICAgICAgICAgICAgICAgY29sLmZpbmQoXCIuanN0cmVlLWdyaWQtY2VsbFwiKS5lYWNoKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGl0ZW0gPSAkKHRoaXMpLCB3aWR0aDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW0uY3NzKFwicG9zaXRpb25cIiwgXCJhYnNvbHV0ZVwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW0uY3NzKFwid2lkdGhcIiwgXCJhdXRvXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGggPSBpdGVtLm91dGVyV2lkdGgoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW0uY3NzKFwicG9zaXRpb25cIiwgXCJyZWxhdGl2ZVwiKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHdpZHRoPm5ld1dpZHRoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3V2lkdGggPSB3aWR0aDtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgZGlmZiA9IG5ld1dpZHRoLW9sZFByZXZDb2xXaWR0aDtcblxuICAgICAgICAgICAgICAgICAgICAvLyBtYWtlIHN1cmUgdGhhdCBkaWZmIGNhbm5vdCBiZSBiZXlvbmQgdGhlIGxlZnQgbGltaXRzXG4gICAgICAgICAgICAgICAgICAgIGRpZmYgPSBkaWZmIDwgMCA/IE1hdGgubWF4KGRpZmYsLW9sZFByZXZIZWFkZXJJbm5lcikgOiBkaWZmO1xuICAgICAgICAgICAgICAgICAgICBuZXdQcmV2Q29sV2lkdGggPSAob2xkUHJldkNvbFdpZHRoK2RpZmYpK1wicHhcIjtcblxuICAgICAgICAgICAgICAgICAgICBjb2wud2lkdGgobmV3UHJldkNvbFdpZHRoKTtcbiAgICAgICAgICAgICAgICAgICAgY29sLmNzcyhcIm1pbi13aWR0aFwiLG5ld1ByZXZDb2xXaWR0aCk7XG4gICAgICAgICAgICAgICAgICAgIGNvbC5jc3MoXCJtYXgtd2lkdGhcIixuZXdQcmV2Q29sV2lkdGgpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICAvKlxuICAgICAgICAgKiBPdmVycmlkZSByZWRyYXdfbm9kZSB0byBjb3JyZWN0bHkgaW5zZXJ0IHRoZSBncmlkXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLnJlZHJhd19ub2RlID0gZnVuY3Rpb24ob2JqLCBkZWVwLCBpc19jYWxsYmFjaywgZm9yY2VfcmVuZGVyKSB7XG4gICAgICAgICAgICAvLyBmaXJzdCBhbGxvdyB0aGUgcGFyZW50IHRvIHJlZHJhdyB0aGUgbm9kZVxuICAgICAgICAgICAgb2JqID0gcGFyZW50LnJlZHJhd19ub2RlLmNhbGwodGhpcywgb2JqLCBkZWVwLCBpc19jYWxsYmFjaywgZm9yY2VfcmVuZGVyKTtcbiAgICAgICAgICAgIC8vIG5leHQgcHJlcGFyZSB0aGUgZ3JpZFxuICAgICAgICAgICAgaWYob2JqKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fcHJlcGFyZV9ncmlkKG9iaik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gb2JqO1xuICAgICAgICB9O1xuICAgICAgICB0aGlzLnJlZnJlc2ggPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB0aGlzLl9jbGVhbl9ncmlkKCk7XG4gICAgICAgICAgICByZXR1cm4gcGFyZW50LnJlZnJlc2guYXBwbHkodGhpcyxhcmd1bWVudHMpO1xuICAgICAgICB9O1xuICAgICAgICB0aGlzLl9oaWRlX2dyaWQgPSBmdW5jdGlvbiAobm9kZSkge1xuICAgICAgICAgICAgdmFyIGNoaWxkcmVuID0gbm9kZSAmJiBub2RlLmNoaWxkcmVuX2QgPyBub2RlLmNoaWxkcmVuX2QgOiBbXSwgaTtcbiAgICAgICAgICAgIC8vIGdvIHRocm91Z2ggZWFjaCBjb2x1bW4sIHJlbW92ZSBhbGwgY2hpbGRyZW4gd2l0aCB0aGUgY29ycmVjdCBJRCBuYW1lXG4gICAgICAgICAgICBmb3IgKGk9MDtpPGNoaWxkcmVuLmxlbmd0aDtpKyspIHtcbiAgICAgICAgICAgICAgICBmaW5kRGF0YUNlbGwodGhpcy5ncmlkV3JhcHBlcixjaGlsZHJlbltpXSkucmVtb3ZlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIHRoaXMuaG9sZGluZ0NlbGxzID0ge307XG4gICAgICAgIHRoaXMuZ2V0SG9sZGluZ0NlbGxzID0gZnVuY3Rpb24gKG9iaixjb2wsaGMpIHtcbiAgICAgICAgICAgIHZhciByZXQgPSAkKCksIGNoaWxkcmVuID0gb2JqLmNoaWxkcmVufHxbXSwgY2hpbGQsIGk7XG4gICAgICAgICAgICAvLyBydW4gdGhyb3VnaCBlYWNoIGNoaWxkLCByZW5kZXIgaXQsIGFuZCB0aGVuIHJlbmRlciBpdHMgY2hpbGRyZW4gcmVjdXJzaXZlbHlcbiAgICAgICAgICAgIGZvciAoaT0wO2k8Y2hpbGRyZW4ubGVuZ3RoO2krKykge1xuICAgICAgICAgICAgICAgIGNoaWxkID0gR1JJRENFTExJRF9QUkVGSVgrZXNjYXBlSWQoY2hpbGRyZW5baV0pK0dSSURDRUxMSURfUE9TVEZJWCtjb2w7XG4gICAgICAgICAgICAgICAgaWYgKGhjW2NoaWxkXSAmJiBvYmouc3RhdGUub3BlbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldCA9IHJldC5hZGQoaGNbY2hpbGRdKS5hZGQodGhpcy5nZXRIb2xkaW5nQ2VsbHModGhpcy5nZXRfbm9kZShjaGlsZHJlbltpXSksY29sLGhjKSk7XG4gICAgICAgICAgICAgICAgICAgIC8vZGVsZXRlIGhjW2NoaWxkXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4ocmV0KTtcbiAgICAgICAgfTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIHB1dCBhIGdyaWQgY2VsbCBpbiBlZGl0IG1vZGUgKGlucHV0IGZpZWxkIHRvIGVkaXQgdGhlIGRhdGEpXG4gICAgICAgICAqIEBuYW1lIGVkaXQob2JqLCBjb2wpXG4gICAgICAgICAqIEBwYXJhbSAge21peGVkfSBvYmpcbiAgICAgICAgICogQHBhcmFtICB7b2JqfSBjb2wgZGVmaW5pdGlvblxuICAgICAgICAgKiBAcGFyYW0gIHtlbGVtZW50fSBjZWxsIGVsZW1lbnQsIGVpdGhlciBzcGFuIG9yIHdyYXBwaW5nIGRpdlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5fZWRpdCA9IGZ1bmN0aW9uIChvYmosIGNvbCwgZWxlbWVudCkge1xuICAgICAgICAgICAgaWYoIW9iaikgeyByZXR1cm4gZmFsc2U7IH1cbiAgICAgICAgICAgIGlmIChlbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgZWxlbWVudCA9ICQoZWxlbWVudCk7XG4gICAgICAgICAgICAgICAgaWYgKGVsZW1lbnQucHJvcChcInRhZ05hbWVcIikudG9Mb3dlckNhc2UoKSA9PT0gXCJkaXZcIikge1xuICAgICAgICAgICAgICAgICAgICBlbGVtZW50ID0gZWxlbWVudC5jaGlsZHJlbihcInNwYW46Zmlyc3RcIik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAvLyBuZWVkIHRvIGZpbmQgdGhlIGVsZW1lbnQgLSBsYXRlclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBydGwgPSB0aGlzLl9kYXRhLmNvcmUucnRsLFxuICAgICAgICAgICAgICAgIHcgID0gdGhpcy5lbGVtZW50LndpZHRoKCksXG4gICAgICAgICAgICAgICAgdCA9IG9iai5kYXRhW2NvbC52YWx1ZV0sXG4gICAgICAgICAgICAgICAgaDEgPSAkKFwiPFwiK1wiZGl2IC8+XCIsIHsgY3NzIDogeyBcInBvc2l0aW9uXCIgOiBcImFic29sdXRlXCIsIFwidG9wXCIgOiBcIi0yMDBweFwiLCBcImxlZnRcIiA6IChydGwgPyBcIjBweFwiIDogXCItMTAwMHB4XCIpLCBcInZpc2liaWxpdHlcIiA6IFwiaGlkZGVuXCIgfSB9KS5hcHBlbmRUbyhcImJvZHlcIiksXG4gICAgICAgICAgICAgICAgaDIgPSAkKFwiPFwiK1wiaW5wdXQgLz5cIiwge1xuICAgICAgICAgICAgICAgICAgICAgICAgXCJ2YWx1ZVwiIDogdCxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiY2xhc3NcIiA6IFwianN0cmVlLXJlbmFtZS1pbnB1dFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJjc3NcIiA6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcInBhZGRpbmdcIiA6IFwiMFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiYm9yZGVyXCIgOiBcIjFweCBzb2xpZCBzaWx2ZXJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImJveC1zaXppbmdcIiA6IFwiYm9yZGVyLWJveFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiZGlzcGxheVwiIDogXCJpbmxpbmUtYmxvY2tcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImhlaWdodFwiIDogKHRoaXMuX2RhdGEuY29yZS5saV9oZWlnaHQpICsgXCJweFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwibGluZUhlaWdodFwiIDogKHRoaXMuX2RhdGEuY29yZS5saV9oZWlnaHQpICsgXCJweFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwid2lkdGhcIiA6IFwiMTUwcHhcIiAvLyB3aWxsIGJlIHNldCBhIGJpdCBmdXJ0aGVyIGRvd25cbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBcImJsdXJcIiA6ICQucHJveHkoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB2ID0gaDIudmFsKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gc2F2ZSB0aGUgdmFsdWUgaWYgY2hhbmdlZFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKHYgPT09IFwiXCIgfHwgdiA9PT0gdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2ID0gdDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvYmouZGF0YVtjb2wudmFsdWVdID0gdjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5lbGVtZW50LnRyaWdnZXIoJ3VwZGF0ZV9jZWxsLmpzdHJlZS1ncmlkJyx7bm9kZTpvYmosIGNvbDpjb2wudmFsdWUsIHZhbHVlOnYsIG9sZDp0fSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3ByZXBhcmVfZ3JpZCh0aGlzLmdldF9ub2RlKG9iaix0cnVlKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGgyLnJlbW92ZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsZW1lbnQuc2hvdygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSwgdGhpcyksXG4gICAgICAgICAgICAgICAgICAgICAgICBcImtleWRvd25cIiA6IGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBrZXkgPSBldmVudC53aGljaDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihrZXkgPT09IDI3KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudmFsdWUgPSB0O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihrZXkgPT09IDI3IHx8IGtleSA9PT0gMTMgfHwga2V5ID09PSAzNyB8fCBrZXkgPT09IDM4IHx8IGtleSA9PT0gMzkgfHwga2V5ID09PSA0MCB8fCBrZXkgPT09IDMyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV2ZW50LnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihrZXkgPT09IDI3IHx8IGtleSA9PT0gMTMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5ibHVyKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiY2xpY2tcIiA6IGZ1bmN0aW9uIChlKSB7IGUuc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKCk7IH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBcIm1vdXNlZG93blwiIDogZnVuY3Rpb24gKGUpIHsgZS5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24oKTsgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwia2V5dXBcIiA6IGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGgyLndpZHRoKE1hdGgubWluKGgxLnRleHQoXCJwV1wiICsgdGhpcy52YWx1ZSkud2lkdGgoKSx3KSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJrZXlwcmVzc1wiIDogZnVuY3Rpb24oZXZlbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihldmVudC53aGljaCA9PT0gMTMpIHsgcmV0dXJuIGZhbHNlOyB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgIGZuID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgZm9udEZhbWlseSAgICAgICAgOiBlbGVtZW50LmNzcygnZm9udEZhbWlseScpICAgICAgICB8fCAnJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvbnRTaXplICAgICAgICA6IGVsZW1lbnQuY3NzKCdmb250U2l6ZScpICAgICAgICAgICAgfHwgJycsXG4gICAgICAgICAgICAgICAgICAgICAgICBmb250V2VpZ2h0ICAgICAgICA6IGVsZW1lbnQuY3NzKCdmb250V2VpZ2h0JykgICAgICAgIHx8ICcnLFxuICAgICAgICAgICAgICAgICAgICAgICAgZm9udFN0eWxlICAgICAgICA6IGVsZW1lbnQuY3NzKCdmb250U3R5bGUnKSAgICAgICAgfHwgJycsXG4gICAgICAgICAgICAgICAgICAgICAgICBmb250U3RyZXRjaCAgICAgICAgOiBlbGVtZW50LmNzcygnZm9udFN0cmV0Y2gnKSAgICAgICAgfHwgJycsXG4gICAgICAgICAgICAgICAgICAgICAgICBmb250VmFyaWFudCAgICAgICAgOiBlbGVtZW50LmNzcygnZm9udFZhcmlhbnQnKSAgICAgICAgfHwgJycsXG4gICAgICAgICAgICAgICAgICAgICAgICBsZXR0ZXJTcGFjaW5nICAgIDogZWxlbWVudC5jc3MoJ2xldHRlclNwYWNpbmcnKSAgICB8fCAnJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHdvcmRTcGFjaW5nICAgICAgICA6IGVsZW1lbnQuY3NzKCd3b3JkU3BhY2luZycpICAgICAgICB8fCAnJ1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICBlbGVtZW50LmhpZGUoKTtcbiAgICAgICAgICAgIGVsZW1lbnQucGFyZW50KCkuYXBwZW5kKGgyKTtcbiAgICAgICAgICAgIGgyLmNzcyhmbikud2lkdGgoTWF0aC5taW4oaDEudGV4dChcInBXXCIgKyBoMlswXS52YWx1ZSkud2lkdGgoKSx3KSlbMF0uc2VsZWN0KCk7XG4gICAgICAgIH07XG4gICAgICAgIHRoaXMuX3ByZXBhcmVfZ3JpZCA9IGZ1bmN0aW9uIChvYmopIHtcbiAgICAgICAgICAgIHZhciBncyA9IHRoaXMuX2dyaWRTZXR0aW5ncywgYyA9IGdzLnRyZWVDbGFzcywgX3RoaXMgPSB0aGlzLCB0LCBjb2xzID0gZ3MuY29sdW1ucyB8fCBbXSwgd2lkdGgsIHRyID0gZ3MuaXNUaGVtZXJvbGxlcixcbiAgICAgICAgICAgIHRyZWUgPSB0aGlzLmVsZW1lbnQsIHJvb3RpZCA9IHRoaXMucm9vdGlkLFxuICAgICAgICAgICAgY2xhc3NBZGQgPSAodHI/XCJ0aGVtZXJvbGxlclwiOlwicmVndWxhclwiKSwgaW1nLCBvYmpEYXRhID0gdGhpcy5nZXRfbm9kZShvYmopLFxuICAgICAgICAgICAgZGVmYXVsdFdpZHRoID0gZ3MuY29sdW1uV2lkdGgsIGNvbmYgPSBncy5kZWZhdWx0Q29uZiwgY2VsbENsaWNrSGFuZGxlciA9IGZ1bmN0aW9uICh0cmVlLG5vZGUsdmFsLGNvbCx0KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgICAgICAgICAgICAgLy9ub2RlID0gdHJlZS5maW5kKFwiI1wiK25vZGUuYXR0cihcImlkXCIpKTtcbiAgICAgICAgICAgICAgICAgICAgbm9kZS5jaGlsZHJlbihcIi5qc3RyZWUtYW5jaG9yXCIpLnRyaWdnZXIoXCJjbGljay5qc3RyZWVcIixlKTtcbiAgICAgICAgICAgICAgICAgICAgdHJlZS50cmlnZ2VyKFwic2VsZWN0X2NlbGwuanN0cmVlLWdyaWRcIiwgW3t2YWx1ZTogdmFsLGNvbHVtbjogY29sLmhlYWRlcixub2RlOiBub2RlLGdyaWQ6JCh0aGlzKSxzb3VyY2VOYW1lOiBjb2wudmFsdWV9XSk7XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH0sIGNlbGxSaWdodENsaWNrSGFuZGxlciA9IGZ1bmN0aW9uICh0cmVlLG5vZGUsdmFsLGNvbCx0KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChncy5jb250ZXh0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAkLnZha2F0YS5jb250ZXh0LnNob3codGhpcyx7ICd4JyA6IGUucGFnZVgsICd5JyA6IGUucGFnZVkgfSx7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJlZGl0XCI6e2xhYmVsOlwiRWRpdFwiLFwiYWN0aW9uXCI6IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBvYmogPSB0LmdldF9ub2RlKG5vZGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5fZWRpdChvYmosY29sLGUudGFyZ2V0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9fVxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGhvdmVySW5IYW5kbGVyID0gZnVuY3Rpb24gKG5vZGUsIGpzVHJlZUluc3RhbmNlKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKCkgeyBqc1RyZWVJbnN0YW5jZS5ob3Zlcl9ub2RlKG5vZGUpOyB9O1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGhvdmVyT3V0SGFuZGxlciA9IGZ1bmN0aW9uIChub2RlLCBqc1RyZWVJbnN0YW5jZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbigpIHsganNUcmVlSW5zdGFuY2UuZGVob3Zlcl9ub2RlKG5vZGUpOyB9O1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGksIHZhbCwgY2wsIHdjbCwgY2NsLCBhLCBsYXN0LCB2YWxDbGFzcywgd2lkZVZhbENsYXNzLCBzcGFuLCBwYWRkaW5nbGVmdCwgdGl0bGUsIGdyaWRDZWxsTmFtZSwgZ3JpZENlbGxQYXJlbnRJZCwgZ3JpZENlbGxQYXJlbnQsXG4gICAgICAgICAgICBncmlkQ2VsbFByZXYsIGdyaWRDZWxsUHJldklkLCBncmlkQ2VsbE5leHQsIGdyaWRDZWxsTmV4dElkLCBncmlkQ2VsbENoaWxkLCBncmlkQ2VsbENoaWxkSWQsXG4gICAgICAgICAgICBjb2wsIGNvbnRlbnQsIHRtcFdpZHRoLCBtdyA9IHRoaXMubWlkV3JhcHBlciwgZGF0YUNlbGwsIGxpZCA9IG9iakRhdGEuaWQsXG4gICAgICAgICAgICBwZWVycyA9IHRoaXMuZ2V0X25vZGUob2JqRGF0YS5wYXJlbnQpLmNoaWxkcmVuLFxuICAgICAgICAgICAgLy8gZmluZCBteSBwb3NpdGlvbiBpbiB0aGUgbGlzdCBvZiBwZWVycy4gXCJwZWVyc1wiIGlzIHRoZSBsaXN0IG9mIGV2ZXJ5b25lIGF0IG15IGxldmVsIHVuZGVyIG15IHBhcmVudCwgaW4gb3JkZXJcbiAgICAgICAgICAgIHBvcyA9ICQuaW5BcnJheShsaWQscGVlcnMpLFxuICAgICAgICAgICAgaGMgPSB0aGlzLmhvbGRpbmdDZWxscywgcmVuZGVyZWQgPSBmYWxzZSwgY2xvc2VkO1xuICAgICAgICAgICAgLy8gZ2V0IG91ciBjb2x1bW4gZGVmaW5pdGlvblxuICAgICAgICAgICAgdCA9ICQob2JqKTtcblxuICAgICAgICAgICAgLy8gZmluZCB0aGUgYSBjaGlsZHJlblxuICAgICAgICAgICAgYSA9IHQuY2hpbGRyZW4oXCJhXCIpO1xuXG4gICAgICAgICAgICBpZiAoYS5sZW5ndGggPT09IDEpIHtcbiAgICAgICAgICAgICAgICBjbG9zZWQgPSAhb2JqRGF0YS5zdGF0ZS5vcGVuZWQ7XG4gICAgICAgICAgICAgICAgZ3JpZENlbGxOYW1lID0gR1JJRENFTExJRF9QUkVGSVgrZXNjYXBlSWQobGlkKStHUklEQ0VMTElEX1BPU1RGSVg7XG4gICAgICAgICAgICAgICAgZ3JpZENlbGxQYXJlbnRJZCA9IG9iakRhdGEucGFyZW50ID09PSBcIiNcIiA/IG51bGwgOiBvYmpEYXRhLnBhcmVudDtcbiAgICAgICAgICAgICAgICBhLmFkZENsYXNzKGMpO1xuICAgICAgICAgICAgICAgIC8vcmVuZGVyQVdpZHRoKGEsX3RoaXMpO1xuICAgICAgICAgICAgICAgIHJlbmRlckFUaXRsZShhLHQsX3RoaXMpO1xuICAgICAgICAgICAgICAgIGxhc3QgPSBhO1xuICAgICAgICAgICAgICAgIGZvciAoaT0wO2k8Y29scy5sZW5ndGg7aSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLnRyZWVjb2wgPT09IGkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGNvbCA9IGNvbHNbaV07XG4gICAgICAgICAgICAgICAgICAgIGRhdGFDZWxsID0gbXcuY2hpbGRyZW4oXCJkaXY6ZXEoXCIraStcIilcIik7XG4gICAgICAgICAgICAgICAgICAgIC8vIGdldCB0aGUgY2VsbENsYXNzLCB0aGUgd2lkZUNlbGxDbGFzcywgYW5kIHRoZSBjb2x1bW5DbGFzc1xuICAgICAgICAgICAgICAgICAgICBjbCA9IGNvbC5jZWxsQ2xhc3MgfHwgXCJcIjtcbiAgICAgICAgICAgICAgICAgICAgd2NsID0gY29sLndpZGVDZWxsQ2xhc3MgfHwgXCJcIjtcbiAgICAgICAgICAgICAgICAgICAgY2NsID0gY29sLmNvbHVtbkNsYXNzIHx8IFwiXCI7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gYWRkIGEgY29sdW1uIGNsYXNzIHRvIHRoZSBkYXRhQ2VsbFxuICAgICAgICAgICAgICAgICAgICBkYXRhQ2VsbC5hZGRDbGFzcyhjY2wpO1xuXG5cbiAgICAgICAgICAgICAgICAgICAgLy8gZ2V0IHRoZSBjb250ZW50cyBvZiB0aGUgY2VsbCAtIHZhbHVlIGNvdWxkIGJlIGEgc3RyaW5nIG9yIGEgZnVuY3Rpb25cbiAgICAgICAgICAgICAgICAgICAgaWYgKGNvbC52YWx1ZSAhPT0gdW5kZWZpbmVkICYmIGNvbC52YWx1ZSAhPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZihjb2wudmFsdWUpID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWwgPSBjb2wudmFsdWUob2JqRGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKG9iakRhdGEuZGF0YSAhPT0gbnVsbCAmJiBvYmpEYXRhLmRhdGEgIT09IHVuZGVmaW5lZCAmJiBvYmpEYXRhLmRhdGFbY29sLnZhbHVlXSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsID0gb2JqRGF0YS5kYXRhW2NvbC52YWx1ZV07XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbCA9IFwiXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YWwgPSBcIlwiO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZihjb2wuZm9ybWF0KSA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YWwgPSBjb2wuZm9ybWF0KHZhbCk7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAvLyBwdXQgaW1hZ2VzIGluc3RlYWQgb2YgdGV4dCBpZiBuZWVkZWRcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNvbC5pbWFnZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgaW1nID0gY29sLmltYWdlc1t2YWxdIHx8IGNvbC5pbWFnZXNbXCJkZWZhdWx0XCJdO1xuICAgICAgICAgICAgICAgICAgICBpZiAoaW1nKSB7Y29udGVudCA9IGltZ1swXSA9PT0gXCIqXCIgPyAnPHNwYW4gY2xhc3M9XCInK2ltZy5zdWJzdHIoMSkrJ1wiPjwvc3Bhbj4nIDogJzxpbWcgc3JjPVwiJytpbWcrJ1wiPic7fVxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgeyBjb250ZW50ID0gdmFsOyB9XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gY29udGVudCBjYW5ub3QgYmUgYmxhbmssIG9yIGl0IG1lc3NlcyB1cCBoZWlnaHRzXG4gICAgICAgICAgICAgICAgICAgIGlmIChjb250ZW50ID09PSB1bmRlZmluZWQgfHwgY29udGVudCA9PT0gbnVsbCB8fCBCTEFOS1JFLnRlc3QoY29udGVudCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQgPSBcIiZuYnNwO1wiO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gZ2V0IHRoZSB2YWx1ZUNsYXNzXG4gICAgICAgICAgICAgICAgICAgIHZhbENsYXNzID0gY29sLnZhbHVlQ2xhc3MgJiYgb2JqRGF0YS5kYXRhICE9PSBudWxsICYmIG9iakRhdGEuZGF0YSAhPT0gdW5kZWZpbmVkID8gb2JqRGF0YS5kYXRhW2NvbC52YWx1ZUNsYXNzXSB8fCBcIlwiIDogXCJcIjtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHZhbENsYXNzICYmIGNvbC52YWx1ZUNsYXNzUHJlZml4ICYmIGNvbC52YWx1ZUNsYXNzUHJlZml4ICE9PSBcIlwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YWxDbGFzcyA9IGNvbC52YWx1ZUNsYXNzUHJlZml4ICsgdmFsQ2xhc3M7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgLy8gZ2V0IHRoZSB3aWRlVmFsdWVDbGFzc1xuICAgICAgICAgICAgICAgICAgICB3aWRlVmFsQ2xhc3MgPSBjb2wud2lkZVZhbHVlQ2xhc3MgJiYgb2JqRGF0YS5kYXRhICE9PSBudWxsICYmIG9iakRhdGEuZGF0YSAhPT0gdW5kZWZpbmVkID8gb2JqRGF0YS5kYXRhW2NvbC53aWRlVmFsdWVDbGFzc10gfHwgXCJcIiA6IFwiXCI7XG4gICAgICAgICAgICAgICAgICAgIGlmICh3aWRlVmFsQ2xhc3MgJiYgY29sLndpZGVWYWx1ZUNsYXNzUHJlZml4ICYmIGNvbC53aWRlVmFsdWVDbGFzc1ByZWZpeCAhPT0gXCJcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgd2lkZVZhbENsYXNzID0gY29sLndpZGVWYWx1ZUNsYXNzUHJlZml4ICsgd2lkZVZhbENsYXNzO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIC8vIGdldCB0aGUgdGl0bGVcbiAgICAgICAgICAgICAgICAgICAgdGl0bGUgPSBjb2wudGl0bGUgJiYgb2JqRGF0YS5kYXRhICE9PSBudWxsICYmIG9iakRhdGEuZGF0YSAhPT0gdW5kZWZpbmVkID8gb2JqRGF0YS5kYXRhW2NvbC50aXRsZV0gfHwgXCJcIiA6IFwiXCI7XG4gICAgICAgICAgICAgICAgICAgIC8vIHN0cmlwIG91dCBIVE1MXG4gICAgICAgICAgICAgICAgICAgIHRpdGxlID0gdGl0bGUucmVwbGFjZShodG1sc3RyaXByZSwgJycpO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIGdldCB0aGUgd2lkdGhcbiAgICAgICAgICAgICAgICAgICAgcGFkZGluZ2xlZnQgPSA3O1xuICAgICAgICAgICAgICAgICAgICB3aWR0aCA9IGNvbC53aWR0aCB8fCBkZWZhdWx0V2lkdGg7XG4gICAgICAgICAgICAgICAgICAgIGlmICh3aWR0aCAhPT0gJ2F1dG8nKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB3aWR0aCA9IHRtcFdpZHRoIHx8ICh3aWR0aCAtIHBhZGRpbmdsZWZ0KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIGxhc3QgPSBkYXRhQ2VsbC5jaGlsZHJlbihcImRpdiNcIitncmlkQ2VsbE5hbWUraSk7XG4gICAgICAgICAgICAgICAgICAgIGlmICghbGFzdCB8fCBsYXN0Lmxlbmd0aCA8IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxhc3QgPSAkKFwiPGRpdj48L2Rpdj5cIik7XG4gICAgICAgICAgICAgICAgICAgICAgICAkKFwiPHNwYW4+PC9zcGFuPlwiKS5hcHBlbmRUbyhsYXN0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxhc3QuYXR0cihcImlkXCIsZ3JpZENlbGxOYW1lK2kpO1xuICAgICAgICAgICAgICAgICAgICAgICAgbGFzdC5hZGRDbGFzcyhncmlkQ2VsbE5hbWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgbGFzdC5hdHRyKE5PREVfREFUQV9BVFRSLGxpZCk7XG5cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAvLyB3ZSBuZWVkIHRvIHB1dCBpdCBpbiB0aGUgZGF0YUNlbGwgLSBhZnRlciB0aGUgcGFyZW50LCBidXQgdGhlIHBvc2l0aW9uIG1hdHRlcnNcbiAgICAgICAgICAgICAgICAgICAgLy8gaWYgd2UgaGF2ZSBubyBwYXJlbnQsIHRoZW4gd2UgYXJlIG9uZSBvZiB0aGUgcm9vdCBub2RlcywgYnV0IHN0aWxsIG5lZWQgdG8gbG9vayBhdCBwZWVyc1xuXG5cbiAgICAgICAgICAgICAgICAgICAgLy8gaWYgd2UgYXJlIGZpcnN0LCBpLmUuIHBvcyA9PT0gMCwgd2UgZ28gcmlnaHQgYWZ0ZXIgdGhlIHBhcmVudDtcbiAgICAgICAgICAgICAgICAgICAgLy8gaWYgd2UgYXJlIG5vdCBmaXJzdCwgYW5kIG91ciBwcmV2aW91cyBwZWVyIChvbmUgYmVmb3JlIHVzKSBpcyBjbG9zZWQsIHdlIGdvIHJpZ2h0IGFmdGVyIHRoZSBwcmV2aW91cyBwZWVyIGNlbGxcbiAgICAgICAgICAgICAgICAgICAgLy8gaWYgd2UgYXJlIG5vdCBmaXJzdCwgYW5kIG91ciBwcmV2aW91cyBwZWVyIGlzIG9wZW5lZCwgdGhlbiB3ZSBoYXZlIHRvIGZpbmQgaXRzIHlvdW5nZXN0ICYgbG93ZXN0IGNsb3NlZCBjaGlsZCAoaW5jbC4gbGVhZilcbiAgICAgICAgICAgICAgICAgICAgLy9cbiAgICAgICAgICAgICAgICAgICAgLy8gcHJvYmFibHkgYmUgbXVjaCBlYXNpZXIgdG8gZ28gKmJlZm9yZSogb3VyIG5leHQgb25lXG4gICAgICAgICAgICAgICAgICAgIC8vIGJ1dCB0aGF0IG9uZSBtaWdodCBub3QgYmUgZHJhd24geWV0XG4gICAgICAgICAgICAgICAgICAgIC8vIGhlcmUgaXMgdGhlIGxvZ2ljIGZvciBqc3RyZWUgZHJhd2luZzpcbiAgICAgICAgICAgICAgICAgICAgLy8gICBpdCBkcmF3cyBwZWVycyBmcm9tIGZpcnN0IHRvIGxhc3Qgb3IgZnJvbSBsYXN0IHRvIGZpcnN0XG4gICAgICAgICAgICAgICAgICAgIC8vICAgaXQgZHJhd3MgY2hpbGRyZW4gYmVmb3JlIGEgcGFyZW50XG4gICAgICAgICAgICAgICAgICAgIC8vXG4gICAgICAgICAgICAgICAgICAgIC8vIHNvIEkgY2FuIHJlbHkgb24gbXkgKnBhcmVudCogbm90IGJlaW5nIGRyYXduLCBidXQgSSBjYW5ub3QgcmVseSBvbiBteSBwcmV2aW91cyBwZWVyIG9yIG15IG5leHQgcGVlciBiZWluZyBkcmF3blxuXG4gICAgICAgICAgICAgICAgICAgIC8vIHNvIHdlIGRvIHRoZSBmb2xsb3dpbmc6XG4gICAgICAgICAgICAgICAgICAgIC8vICAgMS0gV2UgYXJlIHRoZSBmaXJzdCBjaGlsZDogaW5zdGFsbCBhZnRlciB0aGUgcGFyZW50XG4gICAgICAgICAgICAgICAgICAgIC8vICAgMi0gT3VyIHByZXZpb3VzIHBlZXIgaXMgYWxyZWFkeSBkcmF3bjogaW5zdGFsbCBhZnRlciB0aGUgcHJldmlvdXMgcGVlclxuICAgICAgICAgICAgICAgICAgICAvLyAgIDMtIE91ciBwcmV2aW91cyBwZWVyIGlzIG5vdCBkcmF3biwgd2UgaGF2ZSBhIGNoaWxkIHRoYXQgaXMgZHJhd246IGluc3RhbGwgcmlnaHQgYmVmb3JlIG91ciBmaXJzdCBjaGlsZFxuICAgICAgICAgICAgICAgICAgICAvLyAgIDQtIE91ciBwcmV2aW91cyBwZWVyIGlzIG5vdCBkcmF3biwgd2UgaGF2ZSBubyBjaGlsZCB0aGF0IGlzIGRyYXduLCBvdXIgbmV4dCBwZWVyIGlzIGRyYXduOiBpbnN0YWxsIHJpZ2h0IGJlZm9yZSBvdXIgbmV4dCBwZWVyXG4gICAgICAgICAgICAgICAgICAgIC8vICAgNS0gT3VyIHByZXZpb3VzIHBlZXIgaXMgbm90IGRyYXduLCB3ZSBoYXZlIG5vIGNoaWxkIHRoYXQgaXMgZHJhd24sIG91ciBuZXh0IHBlZXIgaXMgbm90IGRyYXduOiBpbnN0YWxsIHJpZ2h0IGFmdGVyIHBhcmVudFxuICAgICAgICAgICAgICAgICAgICBncmlkQ2VsbFByZXZJZCA9IHBvcyA8PTAgPyBvYmpEYXRhLnBhcmVudCA6IGZpbmRMYXN0Q2xvc2VkTm9kZSh0aGlzLHBlZXJzW3Bvcy0xXSk7XG4gICAgICAgICAgICAgICAgICAgIGdyaWRDZWxsUHJldiA9IGZpbmREYXRhQ2VsbChkYXRhQ2VsbCxncmlkQ2VsbFByZXZJZCk7XG4gICAgICAgICAgICAgICAgICAgIGdyaWRDZWxsTmV4dElkID0gcG9zID49IHBlZXJzLmxlbmd0aC0xID8gXCJOVUxMXCIgOiBwZWVyc1twb3MrMV07XG4gICAgICAgICAgICAgICAgICAgIGdyaWRDZWxsTmV4dCA9IGZpbmREYXRhQ2VsbChkYXRhQ2VsbCxncmlkQ2VsbE5leHRJZCk7XG4gICAgICAgICAgICAgICAgICAgIGdyaWRDZWxsQ2hpbGRJZCA9IG9iakRhdGEuY2hpbGRyZW4gJiYgb2JqRGF0YS5jaGlsZHJlbi5sZW5ndGggPiAwID8gb2JqRGF0YS5jaGlsZHJlblswXSA6IFwiTlVMTFwiO1xuICAgICAgICAgICAgICAgICAgICBncmlkQ2VsbENoaWxkID0gZmluZERhdGFDZWxsKGRhdGFDZWxsLGdyaWRDZWxsQ2hpbGRJZCk7XG4gICAgICAgICAgICAgICAgICAgIGdyaWRDZWxsUGFyZW50ID0gZmluZERhdGFDZWxsKGRhdGFDZWxsLGdyaWRDZWxsUGFyZW50SWQpO1xuXG5cbiAgICAgICAgICAgICAgICAgICAgLy8gaWYgb3VyIHBhcmVudCBpcyBhbHJlYWR5IGRyYXduLCB0aGVuIHdlIHB1dCB0aGlzIGluIHRoZSByaWdodCBvcmRlciB1bmRlciBvdXIgcGFyZW50XG4gICAgICAgICAgICAgICAgICAgIGlmIChncmlkQ2VsbFBhcmVudElkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZ3JpZENlbGxQYXJlbnQgJiYgZ3JpZENlbGxQYXJlbnQubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChncmlkQ2VsbFByZXYgJiYgZ3JpZENlbGxQcmV2Lmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFzdC5pbnNlcnRBZnRlcihncmlkQ2VsbFByZXYpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZ3JpZENlbGxDaGlsZCAmJiBncmlkQ2VsbENoaWxkLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFzdC5pbnNlcnRCZWZvcmUoZ3JpZENlbGxDaGlsZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChncmlkQ2VsbE5leHQgJiYgZ3JpZENlbGxOZXh0Lmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFzdC5pbnNlcnRCZWZvcmUoZ3JpZENlbGxOZXh0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYXN0Lmluc2VydEFmdGVyKGdyaWRDZWxsUGFyZW50KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVuZGVyZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZW5kZXJlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gYWx3YXlzIHB1dCBpdCBpbiB0aGUgaG9sZGluZyBjZWxscywgYW5kIHRoZW4gc29ydCB3aGVuIHRoZSBwYXJlbnQgY29tZXMgaW4sIGluIGNhc2UgcGFyZW50IGlzIChyZSlkcmF3biBsYXRlclxuICAgICAgICAgICAgICAgICAgICAgICAgaGNbZ3JpZENlbGxOYW1lK2ldID0gbGFzdDtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChncmlkQ2VsbFByZXYgJiYgZ3JpZENlbGxQcmV2Lmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYXN0Lmluc2VydEFmdGVyKGdyaWRDZWxsUHJldik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGdyaWRDZWxsQ2hpbGQgJiYgZ3JpZENlbGxDaGlsZC5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFzdC5pbnNlcnRCZWZvcmUoZ3JpZENlbGxDaGlsZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGdyaWRDZWxsTmV4dCAmJiBncmlkQ2VsbE5leHQubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxhc3QuaW5zZXJ0QmVmb3JlKGdyaWRDZWxsTmV4dCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxhc3QuYXBwZW5kVG8oZGF0YUNlbGwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgcmVuZGVyZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIC8vIGRvIHdlIGhhdmUgYW55IGNoaWxkcmVuIHdhaXRpbmcgZm9yIHRoaXMgY2VsbD8gd2FsayBkb3duIHRocm91Z2ggdGhlIGNoaWxkcmVuL2dyYW5kY2hpbGRyZW4vZXRjIHRyZWVcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJlbmRlcmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBsYXN0LmFmdGVyKHRoaXMuZ2V0SG9sZGluZ0NlbGxzKG9iakRhdGEsaSxoYykpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIC8vIG5lZWQgdG8gbWFrZSB0aGUgaGVpZ2h0IG9mIHRoaXMgbWF0Y2ggdGhlIGxpbmUgaGVpZ2h0IG9mIHRoZSB0cmVlLiBIb3c/XG4gICAgICAgICAgICAgICAgICAgIHNwYW4gPSBsYXN0LmNoaWxkcmVuKFwic3BhblwiKTtcblxuICAgICAgICAgICAgICAgICAgICAvLyBjcmVhdGUgYSBzcGFuIGluc2lkZSB0aGUgZGl2LCBzbyB3ZSBjYW4gY29udHJvbCB3aGF0IGhhcHBlbnMgaW4gdGhlIHdob2xlIGRpdiB2ZXJzdXMgaW5zaWRlIGp1c3QgdGhlIHRleHQvYmFja2dyb3VuZFxuICAgICAgICAgICAgICAgICAgICBzcGFuLmFkZENsYXNzKGNsK1wiIFwiK3ZhbENsYXNzKS5odG1sKGNvbnRlbnQpO1xuICAgICAgICAgICAgICAgICAgICBsYXN0ID0gbGFzdC5jc3MoY29uZikuYWRkQ2xhc3MoXCJqc3RyZWUtZ3JpZC1jZWxsIGpzdHJlZS1ncmlkLWNlbGwtcm9vdC1cIityb290aWQrXCIganN0cmVlLWdyaWQtY2VsbC1cIitjbGFzc0FkZCtcIiBcIit3Y2wrIFwiIFwiICsgd2lkZVZhbENsYXNzICsgKHRyP1wiIHVpLXN0YXRlLWRlZmF1bHRcIjpcIlwiKSkuYWRkQ2xhc3MoXCJqc3RyZWUtZ3JpZC1jb2wtXCIraSk7XG4gICAgICAgICAgICAgICAgICAgIC8vIGFkZCBjbGljayBoYW5kbGVyIGZvciBjbGlja2luZyBpbnNpZGUgYSBncmlkIGNlbGxcbiAgICAgICAgICAgICAgICAgICAgbGFzdC5jbGljayhjZWxsQ2xpY2tIYW5kbGVyKHRyZWUsdCx2YWwsY29sLHRoaXMpKTtcbiAgICAgICAgICAgICAgICAgICAgbGFzdC5vbihcImNvbnRleHRtZW51XCIsY2VsbFJpZ2h0Q2xpY2tIYW5kbGVyKHRyZWUsdCx2YWwsY29sLHRoaXMpKTtcbiAgICAgICAgICAgICAgICAgICAgbGFzdC5ob3Zlcihob3ZlckluSGFuZGxlcih0LCB0aGlzKSwgaG92ZXJPdXRIYW5kbGVyKHQsIHRoaXMpKTtcblxuICAgICAgICAgICAgICAgICAgICBpZiAodGl0bGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNwYW4uYXR0cihcInRpdGxlXCIsdGl0bGUpO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgbGFzdC5hZGRDbGFzcyhcImpzdHJlZS1ncmlkLWNlbGwtbGFzdFwiKyh0cj9cIiB1aS1zdGF0ZS1kZWZhdWx0XCI6XCJcIikpO1xuICAgICAgICAgICAgICAgIC8vIGlmIHRoZXJlIGlzIG5vIHdpZHRoIGdpdmVuIGZvciB0aGUgbGFzdCBjb2x1bW4sIGRvIGl0IHZpYSBhdXRvbWF0aWNcbiAgICAgICAgICAgICAgICBpZiAoY29sc1tjb2xzLmxlbmd0aC0xXS53aWR0aCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIGxhc3QuYWRkQ2xhc3MoXCJqc3RyZWUtZ3JpZC13aWR0aC1hdXRvXCIpLm5leHQoXCIuanN0cmVlLWdyaWQtc2VwYXJhdG9yXCIpLnJlbW92ZSgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuZWxlbWVudC5jc3MoeydvdmVyZmxvdy15JzonYXV0byAhaW1wb3J0YW50J30pO1xuICAgICAgICB9O1xuICAgICAgICAvLyBjbGVhbiB1cCBob2xkaW5nIGNlbGxzXG4gICAgICAgIHRoaXMuaG9sZGluZ0NlbGxzID0ge307XG5cbiAgICAgICAgLy8gbmVlZCB0byBkbyBhbHRlcm5hdGluZyBiYWNrZ3JvdW5kIGNvbG9ycyBvciBib3JkZXJzXG4gICAgfTtcbn0pKTtcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vY21zL3N0YXRpYy9jbXMvanMvbGlicy9qc3RyZWUvanN0cmVlLmdyaWQubWluLmpzXG4vLyBtb2R1bGUgaWQgPSAxOTdcbi8vIG1vZHVsZSBjaHVua3MgPSAxIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///197\n");

/***/ }),

/***/ 72:
/***/ (function(module, exports, __webpack_require__) {

eval("// call something on iterator step with safe closing on error\nvar anObject = __webpack_require__(6);\nmodule.exports = function (iterator, fn, value, entries) {\n  try {\n    return entries ? fn(anObject(value)[0], value[1]) : fn(value);\n  // 7.4.6 IteratorClose(iterator, completion)\n  } catch (e) {\n    var ret = iterator['return'];\n    if (ret !== undefined) anObject(ret.call(iterator));\n    throw e;\n  }\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNzIuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvY29yZS1qcy9saWJyYXJ5L21vZHVsZXMvX2l0ZXItY2FsbC5qcz85YWM1Il0sInNvdXJjZXNDb250ZW50IjpbIi8vIGNhbGwgc29tZXRoaW5nIG9uIGl0ZXJhdG9yIHN0ZXAgd2l0aCBzYWZlIGNsb3Npbmcgb24gZXJyb3JcbnZhciBhbk9iamVjdCA9IHJlcXVpcmUoJy4vX2FuLW9iamVjdCcpO1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoaXRlcmF0b3IsIGZuLCB2YWx1ZSwgZW50cmllcykge1xuICB0cnkge1xuICAgIHJldHVybiBlbnRyaWVzID8gZm4oYW5PYmplY3QodmFsdWUpWzBdLCB2YWx1ZVsxXSkgOiBmbih2YWx1ZSk7XG4gIC8vIDcuNC42IEl0ZXJhdG9yQ2xvc2UoaXRlcmF0b3IsIGNvbXBsZXRpb24pXG4gIH0gY2F0Y2ggKGUpIHtcbiAgICB2YXIgcmV0ID0gaXRlcmF0b3JbJ3JldHVybiddO1xuICAgIGlmIChyZXQgIT09IHVuZGVmaW5lZCkgYW5PYmplY3QocmV0LmNhbGwoaXRlcmF0b3IpKTtcbiAgICB0aHJvdyBlO1xuICB9XG59O1xuXG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9ub2RlX21vZHVsZXMvY29yZS1qcy9saWJyYXJ5L21vZHVsZXMvX2l0ZXItY2FsbC5qc1xuLy8gbW9kdWxlIGlkID0gNzJcbi8vIG1vZHVsZSBjaHVua3MgPSAxIDMiXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///72\n");

/***/ }),

/***/ 73:
/***/ (function(module, exports, __webpack_require__) {

eval("// check on default Array iterator\nvar Iterators = __webpack_require__(13);\nvar ITERATOR = __webpack_require__(1)('iterator');\nvar ArrayProto = Array.prototype;\n\nmodule.exports = function (it) {\n  return it !== undefined && (Iterators.Array === it || ArrayProto[ITERATOR] === it);\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNzMuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvY29yZS1qcy9saWJyYXJ5L21vZHVsZXMvX2lzLWFycmF5LWl0ZXIuanM/MzIxYyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBjaGVjayBvbiBkZWZhdWx0IEFycmF5IGl0ZXJhdG9yXG52YXIgSXRlcmF0b3JzID0gcmVxdWlyZSgnLi9faXRlcmF0b3JzJyk7XG52YXIgSVRFUkFUT1IgPSByZXF1aXJlKCcuL193a3MnKSgnaXRlcmF0b3InKTtcbnZhciBBcnJheVByb3RvID0gQXJyYXkucHJvdG90eXBlO1xuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChpdCkge1xuICByZXR1cm4gaXQgIT09IHVuZGVmaW5lZCAmJiAoSXRlcmF0b3JzLkFycmF5ID09PSBpdCB8fCBBcnJheVByb3RvW0lURVJBVE9SXSA9PT0gaXQpO1xufTtcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL19pcy1hcnJheS1pdGVyLmpzXG4vLyBtb2R1bGUgaWQgPSA3M1xuLy8gbW9kdWxlIGNodW5rcyA9IDEgMyJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///73\n");

/***/ }),

/***/ 76:
/***/ (function(module, exports, __webpack_require__) {

eval("var ITERATOR = __webpack_require__(1)('iterator');\nvar SAFE_CLOSING = false;\n\ntry {\n  var riter = [7][ITERATOR]();\n  riter['return'] = function () { SAFE_CLOSING = true; };\n  // eslint-disable-next-line no-throw-literal\n  Array.from(riter, function () { throw 2; });\n} catch (e) { /* empty */ }\n\nmodule.exports = function (exec, skipClosing) {\n  if (!skipClosing && !SAFE_CLOSING) return false;\n  var safe = false;\n  try {\n    var arr = [7];\n    var iter = arr[ITERATOR]();\n    iter.next = function () { return { done: safe = true }; };\n    arr[ITERATOR] = function () { return iter; };\n    exec(arr);\n  } catch (e) { /* empty */ }\n  return safe;\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNzYuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvY29yZS1qcy9saWJyYXJ5L21vZHVsZXMvX2l0ZXItZGV0ZWN0LmpzPzc1OGQiXSwic291cmNlc0NvbnRlbnQiOlsidmFyIElURVJBVE9SID0gcmVxdWlyZSgnLi9fd2tzJykoJ2l0ZXJhdG9yJyk7XG52YXIgU0FGRV9DTE9TSU5HID0gZmFsc2U7XG5cbnRyeSB7XG4gIHZhciByaXRlciA9IFs3XVtJVEVSQVRPUl0oKTtcbiAgcml0ZXJbJ3JldHVybiddID0gZnVuY3Rpb24gKCkgeyBTQUZFX0NMT1NJTkcgPSB0cnVlOyB9O1xuICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tdGhyb3ctbGl0ZXJhbFxuICBBcnJheS5mcm9tKHJpdGVyLCBmdW5jdGlvbiAoKSB7IHRocm93IDI7IH0pO1xufSBjYXRjaCAoZSkgeyAvKiBlbXB0eSAqLyB9XG5cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKGV4ZWMsIHNraXBDbG9zaW5nKSB7XG4gIGlmICghc2tpcENsb3NpbmcgJiYgIVNBRkVfQ0xPU0lORykgcmV0dXJuIGZhbHNlO1xuICB2YXIgc2FmZSA9IGZhbHNlO1xuICB0cnkge1xuICAgIHZhciBhcnIgPSBbN107XG4gICAgdmFyIGl0ZXIgPSBhcnJbSVRFUkFUT1JdKCk7XG4gICAgaXRlci5uZXh0ID0gZnVuY3Rpb24gKCkgeyByZXR1cm4geyBkb25lOiBzYWZlID0gdHJ1ZSB9OyB9O1xuICAgIGFycltJVEVSQVRPUl0gPSBmdW5jdGlvbiAoKSB7IHJldHVybiBpdGVyOyB9O1xuICAgIGV4ZWMoYXJyKTtcbiAgfSBjYXRjaCAoZSkgeyAvKiBlbXB0eSAqLyB9XG4gIHJldHVybiBzYWZlO1xufTtcblxuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vbm9kZV9tb2R1bGVzL2NvcmUtanMvbGlicmFyeS9tb2R1bGVzL19pdGVyLWRldGVjdC5qc1xuLy8gbW9kdWxlIGlkID0gNzZcbi8vIG1vZHVsZSBjaHVua3MgPSAxIDMiXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///76\n");

/***/ })

},[193]);